(this["webpackJsonplive-react"]=this["webpackJsonplive-react"]||[]).push([[0],{1001:function(e,t,n){},1003:function(e,t,n){"use strict";n.r(t),n.d(t,"action",function(){return yp});var a=n(2),i=n.n(a),c=n(48),o=n.n(c),l=n(85),s=n(10),r=n(97),d=n(3),u=n(4);var v=n(1025),b=n(82),j=n(170),m=function(e){return e.SurveyTopics="surveyTopics",e.SubscribePageTopics="subscribePageTopics",e.UnSubscribePageTopics="unSubscribePageTopics",e.PublishPageTopics="publishPageTopics",e}({}),p=function(e){return e.GetSurveys="getSurveys",e.GetSurveyQuestions="getSurveyQuestions",e.UpdateSurveyQuestion="updateSurveyQuestion",e.DeleteSurveyQuestion="deleteSurveyQuestion",e.createSurveyQuestion="createSurveyQuestion",e}({}),O=function(e){return e.GetOneProject="getOneProject",e}({}),f=function(e){return e.GetSectionList="getSectionList",e.UpdateSectionList="updateSectionList",e}({}),h=function(e){return e.UpdateBioList="updateBioList",e.GetBio="getBio",e.GetRoleList="getRoleList",e}({}),g=function(e){return e.GetCalendarSetting="getCalendarSetting",e}({}),x=function(e){return e.GetRolesBio="getRolesBio",e.UpdateRoleBio="updateRolesBio",e.GetUserBio="getUserBio",e.UpdateUserBio="updateUserBio",e.GetVehicleBio="getVehicleBio",e}({}),y=function(e){return e.SearchInUser="searchInUser",e.UpdateUser="updateUser",e}({}),I=function(e){return e.Survey="survey",e.ExtendedBio="extendedBio",e.Vehicle="vehicle",e}({}),S=function(e){return e.YesNo="yes-no",e.MultipleChoice="multiple-choice",e.DropDown="dropDown",e.Bar="bar",e.Number="number",e.Date="date",e.Time="time",e.Text="text",e.ThreeButton="3-button",e.Currency="currency",e.DateTime="date-time",e.Media="media",e.Capture="capture",e.Phone="phone",e.Email="email",e.Name="name",e.File="file",e.Signature="signature",e.Category="category",e.Calendar="calendar",e.Payment="payment",e.Tag="tag",e.TagNot="TagNot",e.GPS="GPS",e.Location="location",e.Project="project",e.Service="service",e.Search="search",e.IncidentLocation="incident-location",e.TaskPicker="task-picker",e.EventName="event-name",e.Event="event",e.FixedAsset="fixed-asset",e.Responder="responder",e.ResponderExtended="responder-extended",e.Schedule="schedule",e.Customer="customer-search",e.Relation="relation",e.DispatchType="dispatchType",e.SectionDescription="section-description",e.SectionDocument="section-document",e.Password="password",e.TanF="tanF",e}({}),N=function(e){return e.GetProjectsResult="getProjects/reply",e.GetAccountsResult="getAccounts/reply",e.GetRespondersResult="getResponders/reply",e.GetAssetsResult="getAssets/reply",e.CreateEventResult="createEventPage/reply",e.CreateTicketResult="createTicketPage/reply",e.CreateRideResult="createRideRequest/reply",e.CreateSchoolResult="updateSchoolBusPage/reply",e.CreateShuttleBusResult="createShuttleBusPage/reply",e.SearchPageResult="searchInPage/reply",e.BdsEot="bdsEot",e.SearchUser="searchUser",e.SearchMessage="searchMessage",e.GroupMembers="group/members",e.SearchBds="searchBds/reply",e.GetPageAggregateBds="getPageAggregateBds/reply",e.GetPageResult="searchPage/reply",e.GetAggregateBds="aggregateBds/reply",e.Connection="connection",e.GetAdminRoles="getAdminRoles/reply",e}({}),k=n(37),T=n(5),C=n(7),w="LOGIN_SUCCESS",E="SHOW_PROGRESS",R="HIDE_PROGRESS",P="SET_USER_INFO",D="RESET_REGISTRATION_SUCCESS",A="openLoginModal",M="closeLoginModal",L="closeVerifyModal",U="openRegisterModal",q="closeRegisterModal",F=n(35),B=n(79),_=n(43),$=n.n(_),Y=n(19),H=n.n(Y);function W(){var e=(new Date).getTime(),t="undefined"!==typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var a=16*Math.random();return e>0?(a=(e+a)%16|0,e=Math.floor(e/16)):(a=(t+a)%16|0,t=Math.floor(t/16)),("x"===n?a:3&a|8).toString(16)})}function V(e,t,n,a){var i=void 0!==window.screenLeft?window.screenLeft:window.screenX,c=void 0!==window.screenTop?window.screenTop:window.screenY,o=window.innerWidth?window.innerWidth:document.documentElement.clientWidth,l=window.innerHeight?window.innerHeight:document.documentElement.clientHeight,s=o/window.screen.availWidth,r=(o-n)/2/s+i,d=(l-a)/2/s+c,u=window.open(e,t,"scrollbars=no,status=no,location=no,toolbar=no,menubar=no,width="+n+", height="+a+", top="+d+", left="+r);u&&u.focus()}function z(e){return e.replace(/-|_|\+|\./g,function(e){return"\\".concat(e)})}function Q(e){var t=e.replace(/([A-Z])/g," $1").toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}function G(e){return null===e||void 0===e?void 0:e.toLowerCase().replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")}function J(e,t){var n=e.getMinutes(),a=e.getHours(),i={Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},c=t.map(function(e){return i[e]}).join(",");return"".concat(n," ").concat(a," * 1-12 ").concat(c)}function K(e){var t=e.split(" ");if(5!==t.length)throw new Error("Invalid cron format");var n=Object(u.a)(t,5),a=n[0],i=n[1],c=(n[2],n[3],n[4]),o=new Date;return o.setMinutes(parseInt(a,10)),o.setHours(parseInt(i,10)),{date:o,daysOfWeek:c.split(",").map(function(e){switch(parseInt(e,10)){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return"Invalid day"}})}}var Z=function(e,t,n){var a;if(e.includes("-")){var i=e.split("-");"".concat(null===i||void 0===i?void 0:i[0],"."),e=null===i||void 0===i?void 0:i[1]}var c=t;return null===n||void 0===n||n.map(function(t){var n;null===t||void 0===t||null===(n=t.Cols)||void 0===n||n.map(function(t){(null===t||void 0===t?void 0:t.name)===e&&(c=t)})}),null===(a=c)||void 0===a?void 0:a.type};function X(e,t,n,a,i){var c,o,l,s,r,u,v,b,j,m,p,O,f,h,g,x,y,I,N,k,w,E,R=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";if(Array.isArray(n)){var P;if(null!==i&&void 0!==i&&null!==(P=i.account)&&void 0!==P&&P.length&&"relation"===Z(e,n,null===i||void 0===i?void 0:i.account)||"service"===Z(e,n,null===i||void 0===i?void 0:i.account))return Object(T.a)({},t,Object(C.a)(n));var D=n.map(function(e,t){if(e.option)return e.option;if("string"===typeof e)return e;var n={};return Object.keys(e).map(function(c){var o;"tag"!==c&&(o="service"!==R?e.tag?"".concat(e.tag[0].toLowerCase()+e.tag.slice(1)).concat(c[0].toUpperCase()+c.slice(1)):"".concat(c[0].toLowerCase()+c.slice(1)).concat(t):c,$.a.merge(n,X(c,o,e[c],a,i,R)))}),n});if("string"===typeof(null===D||void 0===D?void 0:D[0])){var A,M="";if(e.includes("-")){var L=e.split("-");M="".concat(null===L||void 0===L?void 0:L[0],"."),e=null===L||void 0===L?void 0:L[1]}if(null===a||void 0===a||a.map(function(t){t.Rows.map(function(t){var n;null===t||void 0===t||null===(n=t.Cols)||void 0===n||n.map(function(t){(null===t||void 0===t?void 0:t.name)===e&&(A=t)})})}),t.includes("question")){var U,q=G(null===(U=A)||void 0===U?void 0:U.label);q&&(t=q)}return t=t.replace(/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/g,""),t="".concat(M).concat(t),Object(T.a)({},t,D.join(", "))}return $.a.assign.apply($.a,D)}var F,B="";if(e.includes("-")){var _=e.split("-");B="".concat(null===_||void 0===_?void 0:_[0],"."),e=null===_||void 0===_?void 0:_[1]}var Y=n;if(null===a||void 0===a||a.map(function(t){t.Rows.map(function(t){var n;null===t||void 0===t||null===(n=t.Cols)||void 0===n||n.map(function(t){(null===t||void 0===t?void 0:t.name)===e&&(Y=t)})})}),null!==(F=t)&&void 0!==F&&F.includes("question")){var W,V=G(null===(W=Y)||void 0===W?void 0:W.label);V&&(t=V)}var z;if(t=t.replace(/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~]/g,""),t="".concat(B).concat(t),n&&""!==n)switch(null===(z=Y)||void 0===z?void 0:z.type){case"relation":return Object(T.a)({},t,Object(C.a)(n));case S.Service:return Object(T.a)({},t,n);case"event":return Object(T.a)({},t,Object(d.a)({type:"event"},n));case"customer-search":return Object(T.a)({},t,n);case"dispatchType":return Object(T.a)({},t,Object(d.a)(Object(d.a)({type:"dispatchType"},n),{},{date:n.date?null===(c=H()(n.date))||void 0===c?void 0:c.format("MM/DD/YYYY"):void 0,dateTimestamp:n.date?null===(o=H()(n.date))||void 0===o?void 0:o.toDate().getTime():void 0,time:n.time?null===(l=H()(n.time))||void 0===l?void 0:l.format("HH:mm"):void 0,timeTimestamp:n.time?null===(s=H()(n.time))||void 0===s?void 0:s.toDate().getTime():void 0}));case"rideType":return Object(T.a)({},t,Object(d.a)(Object(d.a)({type:"rideType"},n),{},{date:n.date?null===(r=H()(n.date))||void 0===r?void 0:r.format("MM/DD/YYYY"):void 0,dateTimestamp:n.date?null===(u=H()(n.date))||void 0===u?void 0:u.toDate().getTime():void 0,time:n.time?null===(v=H()(n.time))||void 0===v?void 0:v.format("HH:mm"):void 0,timeTimestamp:n.time?null===(b=H()(n.time))||void 0===b?void 0:b.toDate().getTime():void 0}));case"fareType":return Object(T.a)({},t,Object(d.a)({type:"fareType"},n));case"notifyType":return Object(T.a)({},t,Object(d.a)({type:"notifyType"},n));case"payType":return Object(T.a)({},t,Object(d.a)({type:"payType"},n));case"fixed-asset":return Object(T.a)({},t,{type:"incident-location",attributes:{title:null===n||void 0===n||null===(j=n.asset)||void 0===j?void 0:j.name},coordinates:{lat:null===n||void 0===n||null===(m=n.asset)||void 0===m||null===(p=m.location)||void 0===p||null===(O=p.coordinates)||void 0===O?void 0:O[1],long:null===n||void 0===n||null===(f=n.asset)||void 0===f||null===(h=f.location)||void 0===h||null===(g=h.coordinates)||void 0===g?void 0:g[0]}});case"responder":case"responder-extended":return[Object(T.a)({},t,Object(d.a)({type:"responder"},n)),(null===n||void 0===n?void 0:n.selectedPayment)&&{payment:{type:"payment",scheduleType:"fixed",amount:null===n||void 0===n||null===(x=n.selectedPayment)||void 0===x?void 0:x.price}}];case"vehicleType":return Object(T.a)({},t,Object(d.a)({type:"vehicleType"},n));case"vehicle":return Object(T.a)({},t,Object(d.a)({type:"vehicle"},n));case"location":case"gps":return Object(T.a)({},t,{attributes:{address:n.label},coordinates:n.value.coordinates,type:"location"});case"incident-location":return Object(T.a)({},t,{attributes:{address:n.label},coordinates:n.value.coordinates,type:"incident-location"});case"temp-location":return Object(T.a)({},t,{attributes:{address:n.label},coordinates:n.value.coordinates,type:"temp-location"});case"media":case"capture":case"file":case"signature":return Object(T.a)({},t,{files:n.files,type:"media"});case"project":return Object(T.a)({},t,{id:null===n||void 0===n?void 0:n.toString(),type:"project"});case"date":var Q,J;return H()(n,"MMDDYYYY",!0).isValid()?Object(T.a)({},t,null===(Q=H()(n,"MMDDYYYY"))||void 0===Q?void 0:Q.format("MM/DD/YYYY")):Object(T.a)({},t,null===(J=H()(n))||void 0===J?void 0:J.format("MM/DD/YYYY"));case"time":return Object(T.a)({},t,null===(y=H()(n))||void 0===y?void 0:y.format("HH:mm"));case"multiple-choice":return Object(T.a)({},t,n.option);case"task-picker":return Object(T.a)({},t,Object(d.a)(Object(d.a)({},n),{},{type:"task"}));case"payment":return Object(T.a)({},t,Object(d.a)(Object(d.a)({},n),{},{type:"payment"}));case"category":return Object(T.a)({},t,null===n||void 0===n||null===(I=n.subCategories)||void 0===I?void 0:I.toString());case"calendar":return Object(T.a)({},t,{type:"dispatchType",value:"schedule",date:null===(N=H()(n.start))||void 0===N?void 0:N.format("MM/DD/YYYY"),time:null===(k=H()(n.start))||void 0===k?void 0:k.format("HH:mm"),dateTimestamp:null===(w=H()(n.start))||void 0===w?void 0:w.toDate().getTime(),timeTimestamp:null===(E=H()(n.start))||void 0===E?void 0:E.toDate().getTime()})}return Object(T.a)({},t,null===n||void 0===n?void 0:n.toString())}var ee=function(e,t){return e/Math.pow(2,t)&1},te=function(e){var t=(e[0]+e[2])/2,n=(e[1]+e[3])/2;return{latitude:t,longitude:n,error:{latitude:e[2]-t,longitude:e[3]-n}}},ne=function(e){for(var t=85.05112878,n=-85.05112878,a=180,i=-180,c=0,o=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:52)/2,l=0;l<o;l++)c=ee(e,2*(o-l)-1),0===ee(e,2*(o-l)-2)?t=(t+n)/2:n=(t+n)/2,0===c?a=(a+i)/2:i=(a+i)/2;return[n,i,t,a]},ae=Object(F.a)("registerUser"),ie=(Object(F.a)("registerNonBeamerUser"),Object(F.a)("AUTHENTICATE_USER")),ce=Object(F.a)("encryptToken"),oe=Object(F.a)("forgotPassword"),le=Object(F.a)("verifyRegistration"),se=Object(F.a)("verifyNonBeamerRegistration"),re=Object(F.a)("add_identifier"),de="LOGOUT_USER",ue=Object(F.a)("logout"),ve=Object(F.a)("loginUser"),be=Object(F.a)("loginUserToken"),je=(Object(F.a)("loginSuccessful"),Object(F.a)("getSurvey")),me=Object(F.a)("getSurveyList"),pe=Object(F.a)("RESET_REDIRECT_STATE"),Oe=(Object(F.a)("getSurveyAnswer"),Object(F.a)("addSurvey")),fe=Object(F.a)("getRoleList"),he=Object(F.a)("setNoFound"),ge=Object(F.a)("setCategories"),xe=Object(F.a)("setCoaches"),ye=Object(F.a)("UPLOAD_MEDIA"),Ie=Object(F.a)("UPLOAD_CSV"),Se=Object(F.a)("getProjectList"),Ne=Object(F.a)("getAccountList"),ke=Object(F.a)("getResponderList"),Te=Object(F.a)("getAssetsList"),Ce=Object(F.a)("setSelectedResponder"),we=Object(F.a)("setSelectedAssets"),Ee=Object(F.a)("setSelectedPickup"),Re=Object(F.a)("setCurrentLocation"),Pe=Object(F.a)("setCurrentProject"),De=Object(F.a)("setSubmitted"),Ae=Object(F.a)("addOtherLocation"),Me=Object(F.a)("addEventLocation"),Le=Object(F.a)("clearOtherLocation"),Ue=Object(F.a)("addGeofenceLocation"),qe=Object(F.a)("addStandLocation"),Fe=Object(F.a)("removeOtherLocation"),Be=Object(F.a)("setPage"),_e=Object(F.a)("setUsers"),$e=Object(F.a)("setMessages"),Ye=Object(F.a)("appendMessage"),He=Object(F.a)("setCurrentMessage"),We=Object(F.a)("patchPage"),Ve=Object(F.a)("patchUser"),ze=Object(F.a)("patchUserStatus"),Qe=Object(F.a)("clearSummary"),Ge=Object(F.a)("getSectionList"),Je=Object(F.a)("getBio"),Ke=Object(F.a)("getProjectSurveyId"),Ze=Object(F.a)("GET_VISIT"),Xe=Object(F.a)("GET_STAFF"),et=Object(F.a)("GET_CALL_LOGS"),tt=Object(F.a)("GET_AGGREGATE"),nt=Object(F.a)("GET_TICKET_PAGES"),at=Object(F.a)("SET_URL_PARAMS"),it=Object(F.a)("GET_MAP_PLACES"),ct=Object(F.a)("decryptToken"),ot=Object(F.a)("GET_HISTORICAL_GPS"),lt=Object(F.a)("invokeWorkflow"),st=Object(F.a)("invokeAdminWorkflow"),rt=Object(F.a)("verifyIds"),dt=Object(F.a)("UPDATE_USER_INFO"),ut=Object(F.a)("VERIFICATION_CODE_SENT"),vt=Object(F.a)("getUserInfo"),bt=Object(F.a)("createSchedule"),jt=Object(F.a)("deleteSchedule"),mt=Object(F.a)("updateSchedule"),pt=Object(F.a)("getDirections"),Ot=Object(F.a)("CREATE_RIDE"),ft=Object(F.a)("CANCEL_RIDE"),ht=Object(F.a)("ACCEPT_RESERVATION"),gt=Object(F.a)("REJECT_RESERVATION"),xt=Object(F.a)("COMPLETE_TASK"),yt=Object(F.a)("GET_USER_STATUS"),It=Object(F.a)("UPDATE_USER_STATUS"),St=Object(F.a)("SAVE_RECORDING"),Nt=Object(F.a)("HOLD_CALL"),kt=Object(F.a)("ADD_PARTICIPANT"),Tt=Object(F.a)("RECORD_OUTGOING"),Ct={survey:{_id:Object(B.uuid)(),name:"",questions:[]},categories:{},coaches:[],isOpenRegisterationModal:!1,actionLogout:!1,actionSuccess:!1,identifierAdded:!1,identifierDeleted:!1,identifierVerified:!1,verificationCodeSent:!1,authenticationFailure:!1,authenticationSuccess:!1,verificationFailed:!1,loginSuccessfull:!1,registrationSuccess:!1,isLoading:!1,decryptedToken:"",registeredEmail:"",userInfo:{},surveyId:"",surveyList:[],noFound:!1,responderAnswers:[],rolesList:[],fileToSend:null,projects:[],accounts:[],responders:[],assets:[],selectedResponders:[],selectedAssets:[],selectedPickup:void 0,submitted:!1,otherLocations:{},eventLocations:{},geofenceLocation:void 0,standLocations:[],users:[],messages:[],visit:void 0,staff:void 0,selectedPage:void 0,searchByPhone:void 0,sectionList:[{sectionName:"",Rows:[{isMulti:!1,Cols:[]}]}],bio:{},urlParams:{},requestIds:{user:W(),log:W(),page:W()}},wt=function(e,t){return Object(d.a)(Object(d.a)({},e),{},{loginSuccessfull:t})},Et=function(e,t){return Object(d.a)(Object(d.a)({},e),{},{isOpenLoginModal:t})},Rt=function(e,t){return Object(d.a)(Object(d.a)({},e),{},{isOpenRegisterationModal:t})},Pt=function(e,t){return Object(d.a)(Object(d.a)({},e),{},{isOpenVerifyModal:t})},Dt=function(e,t){return console.log({action:t.payload}),Object(d.a)(Object(d.a)({},e),{},{userInfo:t.payload})},At=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ke:return Object(d.a)(Object(d.a)({},e),{},{surveyId:t.payload});case Ge:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{sectionList:t.payload||Ct.sectionList})}(e,t);case Je:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{bio:t.payload||Ct.bio})}(e,t);case je:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{survey:t.payload||Ct.survey})}(e,t);case Oe:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{survey:t.payload})}(e,t);case he:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{noFound:t.payload||!1})}(e,t);case ge:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{categories:t.payload||{}})}(e,t);case xe:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{coaches:t.payload||[]})}(e,t);case me:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{surveyList:t.payload||[]})}(e,t);case pe:return function(e){return Object(d.a)(Object(d.a)({},e),{},{passwordResetSuccessfull:!1,verificationCodeSent:!1,actionSuccess:!1,isLoading:!1,verificationFailed:!1,authenticationFailure:!1,authenticationSuccess:!1,identifierAdded:!1,identifierDeleted:!1,identifierVerified:!1})}(e);case fe:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{rolesList:t.payload})}(e,t);case"ADD_FILE":return function(e,t){return console.log("=-=-=-=-=-=-=-=--=-=-=-=-=-==-=-",t.payload),Object(d.a)(Object(d.a)({},e),{},{fileToSend:t.payload})}(e,t);case"ADD_CSV":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{csvToSend:t.payload})}(e,t);case Se:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{projects:t.payload||[]})}(e,t);case Ne:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{accounts:t.payload||[]})}(e,t);case ke:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{responders:Object(C.a)(t.payload||[])})}(e,t);case Te:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{assets:Object(C.a)(t.payload||[])})}(e,t);case Ce:return function(e,t){var n=e.selectedResponders||[],a=n.findIndex(function(e){return e.id===t.payload.id});return-1===a?n.push(t.payload):n.splice(a,1),console.log("selected",n),Object(d.a)(Object(d.a)({},e),{},{selectedResponders:n})}(e,t);case we:return function(e,t){var n=e.selectedAssets||[],a=n.findIndex(function(e){return e.id===t.payload.id});return-1===a?n.push(t.payload):n.splice(a,1),Object(d.a)(Object(d.a)({},e),{},{selectedAssets:n})}(e,t);case Ee:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{selectedPickup:t.payload})}(e,t);case Re:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{incidentLocation:t.payload||[]})}(e,t);case Pe:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{project:t.payload,responders:t.payload?e.responders:[],selectedResponders:t.payload?e.selectedResponders:[]})}(e,t);case De:return function(e,t){console.log("set submitted here",t.payload);var n=t.payload;return Object(d.a)(Object(d.a)({},e),{},{submitted:n,responders:!n||n.submitted?[]:e.responders,assets:!n||n.submitted?[]:e.assets,selectedResponders:!n||n.submitted?[]:e.selectedResponders,selectedAssets:!n||n.submitted?[]:e.selectedAssets,otherLocations:!n||n.submitted?{}:e.otherLocations,selectedPickup:void 0,geofenceLocation:void 0,standLocations:[],page:void 0})}(e,t);case"SET_ONLY_SUBMITTED":return function(e,t){var n=t.payload;return Object(d.a)(Object(d.a)({},e),{},{submitted:n})}(e,t);case at:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{urlParams:t.payload||Ct.urlParams})}(e,t);case Ae:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{otherLocations:Object(d.a)(Object(d.a)({},e.otherLocations),t.payload)})}(e,t);case Me:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{eventLocations:Object(d.a)(Object(d.a)({},e.eventLocations),t.payload)})}(e,t);case Le:return function(e){return Object(d.a)(Object(d.a)({},e),{},{otherLocations:{},eventLocations:{}})}(e);case Ue:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{geofenceLocation:t.payload})}(e,t);case qe:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{standLocations:t.payload})}(e,t);case Fe:return function(e,t){var n=e.otherLocations;return delete n[t.payload],Object(d.a)(Object(d.a)({},e),{},{otherLocations:Object(d.a)({},n)})}(e,t);case Be:return function(e,t){var n=e.pages||[];if(console.log("pages",n),console.log("update page",t.payload),n&&n.length>0){var a=n.findIndex(function(e){return e.pageId===t.payload.objectId});console.log("index",a),-1!==a&&(console.log("test index found"),n[a]=Object(d.a)({pageId:t.payload.objectId},t.payload))}return Object(d.a)(Object(d.a)({},e),{},{page:t.payload,pages:Object(C.a)(n)})}(e,t);case We:return function(e,t){var n=e.page||{};if(console.log("patch page"),n){var a,i={};if(0===t.payload.length)return Object(d.a)({},e);var c,o=Object(k.a)(t.payload);try{var l=function(){var e=c.value;a=i;var t=e.path.split("/");t.map(function(n,i){""!==n&&(n in a||(i+1===t.length?a[n]=e.value:a[n]={}),a=a[n])})};for(o.s();!(c=o.n()).done;)l()}catch(s){o.e(s)}finally{o.f()}console.log("output",i),n=$.a.merge(n,i)}return Object(d.a)(Object(d.a)({},e),{},{page:Object(d.a)({},n)})}(e,t);case Ve:return function(e,t){console.log("patch users");var n=e.users||[],a=n.findIndex(function(e){return e.id===t.payload.userId});if(-1!==a){var i,c,o={},l=Object(k.a)(t.payload.user);try{var s=function(){var e=c.value;i=o;var t=e.path.split("/");t.map(function(n,a){""!==n&&(n in i||(a+1===t.length?i[n]=e.value:i[n]={}),i=i[n])})};for(l.s();!(c=l.n()).done;)s()}catch(r){l.e(r)}finally{l.f()}n[a]=$.a.merge(n[a],o)}return Object(d.a)(Object(d.a)({},e),{},{users:Object(C.a)(n)})}(e,t);case ze:return function(e,t){console.log("patch user status",t);var n=e.users||[],a=n.findIndex(function(e){return e.id===t.payload.userId});return-1!==a&&(n[a].nonpersistent.static.live.status={name:t.payload.status,color:t.payload.status}),Object(d.a)(Object(d.a)({},e),{},{users:Object(C.a)(n)})}(e,t);case _e:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{users:t.payload})}(e,t);case"SET_USERS_REQUEST_ID":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{userRequests:Object(d.a)(Object(d.a)({},e.userRequests),{},Object(T.a)({},t.payload.id,t.payload.users))})}(e,t);case"SET_SELECTED_PAGE":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{selectedPage:t.payload})}(e,t);case"SEARCH_PAGES_BY_PHONE":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{searchByPhone:t.payload})}(e,t);case $e:return function(e,t){var n=[],a=t.payload;return a.sort(function(e,t){return parseInt(e.id)>parseInt(t.id)?1:parseInt(t.id)>parseInt(e.id)?-1:0}),null===a||void 0===a||a.map(function(e){n=function(e,t){var n,a=null===(n=t.refMessage)||void 0===n?void 0:n.referenceType,i=null===t||void 0===t?void 0:t.originalPageMessageId;if("update"!==a||t.status)if("remove"!==a||t.status)e.push(t);else{var c=e.findIndex(function(e){return e.id===i||e.originalPageMessageId===i});e.splice(c,1)}else{var o=e.findIndex(function(e){return e.id===i||e.originalPageMessageId===i});e[o]=t}return e}(n,e)}),Object(d.a)(Object(d.a)({},e),{},{messages:n})}(e,t);case Ye:return function(e,t){var n,a,i=e.messages||[],c=null===(n=t.payload.refMessage)||void 0===n?void 0:n.referenceType,o=null===(a=t.payload)||void 0===a?void 0:a.originalPageMessageId;if("update"!==c||t.payload.status)if("remove"!==c||t.payload.status)i.push(t.payload);else{var l=i.findIndex(function(e){return e.id===o||e.originalPageMessageId===o});i.splice(l,1)}else{var s=i.findIndex(function(e){return e.id===o||e.originalPageMessageId===o});i[s]=t.payload}return Object(d.a)(Object(d.a)({},e),{},{messages:Object(C.a)(i)})}(e,t);case He:return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{message:t.payload})}(e,t);case Qe:return function(e){return Object(d.a)(Object(d.a)({},e),{},{users:[],messages:[],page:void 0})}(e);case"USER_BDS":return function(e,t){var n=t.payload.map(function(e){return null===e||void 0===e?void 0:e[0]}).filter(function(e){return"cudb-live"!==e&&"cudb-root"!==e});return Object(d.a)(Object(d.a)({},e),{},{userBds:n})}(e,t);case"AGGREGATE_BDS":return function(e,t){var n;return Object(d.a)(Object(d.a)({},e),{},{pageAggregateBds:(null===(n=t.payload)||void 0===n?void 0:n.aggregateBds)||[]})}(e,t);case"LOGIN_SUCCESSFUL":return wt(e,!0);case"ADMIN_ROLES":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{adminUserRoles:t.payload||[]})}(e,t);case"SET_PAGE_RESULT":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{pages:t.payload||[]})}(e,t);case"SET_VISIT":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{visit:t.payload||[]})}(e,t);case"SET_STAFF":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{staff:t.payload||[]})}(e,t);case"ADD_MAP_ASSET_FILTER":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{assets_filter:t.payload})}(e,t);case"ADD_MAP_USER_FILTER":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{users_filter:t.payload})}(e,t);case"ADD_ENCRYPTED_TOKEN":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{encrypted_token:t.payload})}(e,t);case"SET_VEHICLES":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{vehicles:t.payload})}(e,t);case"SET_VEHICLE_TYPES":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{vehicleTypes:t.payload})}(e,t);case"ADD_GPS":return function(e,t){var n,a,i,c,o,l=t.payload.response,s=null!==(n=null===l||void 0===l||null===(a=l.data)||void 0===a||null===(i=a[0])||void 0===i?void 0:i.samples)&&void 0!==n?n:[];return(s=s.filter(function(e){return void 0!==e.dataset.locationGps})).reverse(),Object(d.a)(Object(d.a)({},e),{},{gps:{points:s,samples:null===l||void 0===l||null===(c=l.data)||void 0===c||null===(o=c[0])||void 0===o?void 0:o.samples}})}(e,t);case"SET_SELECTED_RESPONDER":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{selectedResponders:[t.payload]})}(e,t);case"SET_SELECTED_PHONE":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{primaryPhone:t.payload})}(e,t);case"SET_SELECTED_EMAIL":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{primaryEmail:t.payload})}(e,t);case"FILTER_SUB_CATEGORIES":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{filterSubCategories:t.payload})}(e,t);case"loginUser":return Object(d.a)(Object(d.a)({},e),{},{registrationSuccess:!1});case"ADD_DECRYPTED_TOKEN":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{decryptedToken:t.payload.decryptedPayload})}(e,t);case"registerNonBeamerUser":return wt(e,!1);case E:return function(e){return Object(d.a)(Object(d.a)({},e),{},{isLoading:!0})}(e);case R:return function(e){return Object(d.a)(Object(d.a)({},e),{},{isLoading:!1})}(e);case w:return function(e){return Object(d.a)(Object(d.a)({},e),{},{isOpenLoginModal:!1,loginSuccessfull:!0,actionLogout:!1,registeredEmail:"",registeredPhone:"",isLoading:!1,passwordResetSuccessfull:!1})}(e);case D:return function(e){return Object(d.a)(Object(d.a)({},e),{},{registrationSuccess:!1,isLoading:!1,actionSuccess:!1})}(e);case A:return Et(e,!0);case M:return Et(e,!1);case U:return Rt(e,!0);case q:return Rt(e,!1);case"openVerifyModal":return Pt(e,!0);case L:return Pt(e,!1);case"REGISTRATION_SUCCESS":return function(e,t){return Object(d.a)(Object(d.a)({},e),{},{isOpenLoginModal:!1,isOpenVerifyModal:!0,isOpenRegisterationModal:!1,registrationSuccess:t.payload.success,registeredEmail:t.payload.email,registeredPhone:t.payload.phone,registrationPayload:t.payload.payload,isLoading:!1,passwordResetSuccessfull:!1})}(e,t);case P:return Dt(e,t);case de:return function(e){return localStorage.removeItem("TOKEN"),localStorage.removeItem("TYPE"),localStorage.removeItem("email"),localStorage.removeItem("RID"),localStorage.removeItem("CID"),localStorage.removeItem("phone"),localStorage.removeItem("coachRoleId"),localStorage.removeItem("candidateRoleId"),localStorage.removeItem("serviceId"),localStorage.removeItem("allUsers"),localStorage.removeItem("selectedOrg"),Object(d.a)(Object(d.a)({},e),{},{actionLogout:!0,registeredEmail:"",registrationPayload:void 0,registeredPhone:"",loginSuccessfull:!1,userInfo:{}})}(e);case dt:return Dt(e,t);case ut:return function(e){return Object(d.a)(Object(d.a)({},e),{},{verificationCodeSent:!0,verificationFailed:!1,isLoading:!1})}(e);case"VERIFICATION_FAILED":return function(e){return Object(d.a)(Object(d.a)({},e),{},{verificationFailed:!0,isLoading:!1})}(e);case"AUTHENTICATION_SUCCESSFULL":return function(e){return Object(d.a)(Object(d.a)({},e),{},{authenticationSuccess:!0,isLoading:!1})}(e);case"AUTHENTICATION_FAILED":return function(e){return Object(d.a)(Object(d.a)({},e),{},{authenticationFailure:!0,isLoading:!1})}(e);default:return e}},Mt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.href;e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null};function Lt(e,t,n,a){return"info"===t?r.a.info(e,{position:n?r.a.POSITION[n]:r.a.POSITION.TOP_CENTER,autoClose:a||3e3,pauseOnFocusLoss:!0,pauseOnHover:!1}):"success"===t?r.a.success(e,{position:n?r.a.POSITION[n]:r.a.POSITION.TOP_CENTER,autoClose:a||3e3,pauseOnFocusLoss:!0,pauseOnHover:!1}):"warning"===t?r.a.warn(e,{position:n?r.a.POSITION[n]:r.a.POSITION.TOP_CENTER,autoClose:a||3e3,pauseOnFocusLoss:!0,pauseOnHover:!1}):"error"===t?r.a.error(e,{position:n?r.a.POSITION[n]:r.a.POSITION.TOP_CENTER,autoClose:a||3e3,pauseOnFocusLoss:!0,pauseOnHover:!1}):r.a.info(e,{position:n?r.a.POSITION[n]:r.a.POSITION.TOP_CENTER,autoClose:a||3e3,pauseOnFocusLoss:!0,pauseOnHover:!1})}var Ut="beamdevlive",qt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/getProjects/reply")},Ft=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/getProjects")},Bt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/getAccounts/reply")},_t=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/getAccounts")},$t=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/getResponders/reply")},Yt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/getResponders")},Ht=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/createEventPage/reply")},Wt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/createEventPage")},Vt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/createCustom")},zt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/updateCustom")},Qt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/dps/updateSchoolBusPage")},Gt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/dps/createShuttleBusPage")},Jt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/dps/cancelSchoolBusPage")},Kt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/dps/completeSchoolBusPage")},Zt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/ride-dps/shareRideDispatchUrl")},Xt=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/ride-dps/sharePaymentUrl")},en=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/ride-dps/refundPaymentIntent")},tn=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/ride-dps/refundPaymentIntent/reply")},nn=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/dps/cancelSchoolBusPage/reply")},an=function(e){return"".concat(Ut,"/service/").concat(e,"/service/live/searchInPage/reply")},cn=function(e){return"".concat(Ut,"/service/").concat(e,"/service/live/searchInPage")},on=function(e){return"".concat(Ut,"/service/").concat(e,"/service/live/updatePage/reply")},ln=function(e){return"".concat(Ut,"/service/").concat(e,"/service/live/updatePage")},sn=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/createCustom/reply")},rn=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/createCustom")},dn=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/updateCustom/reply")},un=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/updateCustom")},vn=function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/getAssets/reply")},bn=function(e,t){return"".concat(Ut,"/connection/").concat(e,"/service/").concat(t,"/searchUser/reply")},jn=function(e,t){return"".concat("beamdevlive","/connection/").concat(t,"/page/").concat(e,"/searchMessage/reply")},mn=function(e){return"".concat("beamdevlive","/service/live/page/").concat(e,"/group/members")},pn=function(e,t){return"".concat("beamdevlive","/connection/").concat(t,"/page/").concat(e,"/focusMessage")},On=function(e,t){return"".concat("beamdevlive","/user/").concat(t,"/page/").concat(e,"/focusPage")},fn=function(e){return"".concat("beamdevlive","/user/").concat(e,"/page/+/focusPage")},hn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/dps/getAdminRoles/reply")},gn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/dps/getVehicleTypes/reply")},xn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/bds/aggregateBds")},yn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/bds/aggregateBds/reply")},In=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/bds/createQuery/reply")},Sn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/ride-dps/verifyCustomer")},Nn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/ride-dps/getVehicleProjects")},kn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/ride-dps/getRideEstimation/reply")},Tn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/ride-dps/getFixedRateByLocation/reply")},Cn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/ride-dps/getBlockedAreaByLocation/reply")},wn=function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/twilio/getTwilioUser")},En=function(e){return"".concat("beamdevlive","/service/twilio/user/").concat(e,"/callAccepted")},Rn=function(e){return"".concat("beamdevlive","/service/live/user/").concat(e,"/+")},Pn=function(){return"".concat("beamdevlive","/service/ride-dps/user/+/ridePageInvitation")},Dn=function(e,t){return{id:t||W(),data:Object(d.a)({},e)}},An=function(e,t){return{accessToken:"",connectionId:e,userId:t,udid:W()}},Mn=function(){var e=Object(s.c)(function(e){return e.auth}),t=e.surveyId,n=(e.requestIds,Object(s.b)()),i=Object(l.g)().search,c=Object(a.useRef)(null);Object(a.useEffect)(function(){t&&(c.current=t)},[t]);return{handleAggregateBds:function(e){var t=null===e||void 0===e?void 0:e.response;n({type:"AGGREGATE_BDS",payload:t.data})},handleAggregate:function(e){var t,a,i,c,o,l=e.id;if(null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&null!==(i=a[0])&&void 0!==i&&i.id){var s=(null!==(c=null===e||void 0===e||null===(o=e.response)||void 0===o?void 0:o.data)&&void 0!==c?c:[]).map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;return{id:e.id.toString(),nonpersistent:{static:{live:{status:e.status}}},firstName:null===e||void 0===e||null===(t=e.live)||void 0===t||null===(n=t.profile)||void 0===n?void 0:n.firstName,lastName:null===e||void 0===e||null===(a=e.live)||void 0===a||null===(i=a.profile)||void 0===i?void 0:i.lastName,fullName:"".concat(null===e||void 0===e||null===(c=e.live)||void 0===c||null===(o=c.profile)||void 0===o?void 0:o.firstName," ").concat(null===e||void 0===e||null===(l=e.live)||void 0===l||null===(s=l.profile)||void 0===s?void 0:s.lastName),beamId:null===e||void 0===e||null===(r=e.live)||void 0===r||null===(d=r.beamIds)||void 0===d?void 0:d[0],email:null===e||void 0===e||null===(u=e.live)||void 0===u||null===(v=u.alternativeIds)||void 0===v?void 0:v.email,phone:null===e||void 0===e||null===(b=e.live)||void 0===b||null===(j=b.alternativeIds)||void 0===j?void 0:j.phone,admin:null===e||void 0===e?void 0:e.admin}});n({type:_e,payload:s}),n({type:"SET_USERS_REQUEST_ID",payload:{users:s,id:l}})}},handlePageResults:function(e){if(localStorage.getItem("pageRequestId")===(null===e||void 0===e?void 0:e.id)){console.log("payload",e);var t=null===e||void 0===e?void 0:e.response,a=null===t||void 0===t?void 0:t.data;try{var i,c=(null!==(i=null===a||void 0===a?void 0:a.map(function(e){var t,n,a,i,c;return e[Object.keys(e)[0]][0][0]&&Object(d.a)({pageId:Object.keys(e)[0],memberActive:!(null!==(t=e[Object.keys(e)[0]][0][0])&&void 0!==t&&null!==(n=t.persistent.static.metadata)&&void 0!==n&&null!==(a=n.members)&&void 0!==a&&null!==(i=a.users)&&void 0!==i&&null!==(c=i[localStorage.getItem("RID")])&&void 0!==c&&c.pending)},e[Object.keys(e)[0]][0][0])}))&&void 0!==i?i:[]).filter(function(e){return e}).sort(function(e,t){var n,a,i,c;return H()(null!==(n=null===(a=t.lastSent)||void 0===a?void 0:a.updatedAt)&&void 0!==n?n:t.persistent.static.metadata.createdAt)-H()(null!==(i=null===(c=e.lastSent)||void 0===c?void 0:c.updatedAt)&&void 0!==i?i:e.persistent.static.metadata.createdAt)});c&&n({type:"SET_PAGE_RESULT",payload:c})}catch(o){console.error("failed to fetch pages",o)}}},getUserRequestPayload:function(e){return{objectId:e,paths:[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$"],returnPaths:[arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$"]}},handleAdminUser:function(e){var t=null===e||void 0===e?void 0:e.response;n({type:"ADMIN_USER",payload:t.data})},getSurveyList:function(e){var t=Mt("surveyId")?Mt("surveyId"):c.current,a="create"===Mt("mode");if(e.data){var i={};t&&(i=e.data[0][0].find(function(e){return e._id==t}),(!a&&void 0==i||i&&0===Object.keys(i).length&&Object.getPrototypeOf(i)===Object.prototype)&&n({type:he,payload:!0})),!a&&i&&0===Object.keys(i).length&&Object.getPrototypeOf(i)===Object.prototype&&(i=Object(d.a)({},Ct.survey));var o=Mt("surveyId");!i&&o&&""!==o&&(i={_id:Mt("surveyId"),name:"",questions:[]}),n({type:je,payload:i}),n({type:me,payload:e.data[0][0]})}},getSectionList:function(e){n({type:Ge,payload:e.data[0][0]})},getBio:function(e){n({type:Je,payload:e.data[0][0]})},getRoleList:function(e){n({type:fe,payload:e.data[0][0]})},updateUserRequestPayload:function(e,t){return{objectId:e,changes:[{op:t,path:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$",value:arguments.length>3?arguments[3]:void 0}]}},updateUserRequestPayloadV2:function(e,t){return console.log({objectId:e,changes:t}),{objectId:e,changes:t}},getExtendedBioList:function(e){var t=Mt("surveyId"),a=e.data[0][0].find(function(e){return e._id===t});a||n({type:he,payload:!0});var i={_id:t,name:(null===a||void 0===a?void 0:a.name)||"",questions:(null===a||void 0===a?void 0:a.extendedBio)||[],permissions:[]};n({type:je,payload:i}),n({type:me,payload:e.data[0][0]||[]})},getVehicleExtendedBioList:function(e){var t=e.data[0][0];t||n({type:he,payload:!0}),n({type:je,payload:{_id:null,name:"Vehicle Extended Bio",questions:t||[],permissions:[]}}),n({type:me,payload:e.data[0][0]||[]})},getProjectList:function(e){var t,a;n({type:Se,payload:null!==(t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.projects)&&void 0!==t?t:[]})},getRespondersList:function(e){var t,a,i=null!==(t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.responders)&&void 0!==t?t:[];0===i.length&&Lt("No Responder available in the area","error","TOP_CENTER",1e3),n({type:ke,payload:i})},getAssetsList:function(e){var t,a,i=null!==(t=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.assets)&&void 0!==t?t:[];n({type:Te,payload:i})},setSubmitted:function(e){console.log("set submitted response",e),n({type:De,payload:e})},getPageResult:function(e){var t,a,c=e.response,o=e.id,l=new URLSearchParams(i).get("pageId"),s=localStorage.getItem("lastRideId");console.log("page id",l,o),!l&&!s||l&&l!==o||s&&s!==o||n({type:Be,payload:null===c||void 0===c||null===(t=c.data)||void 0===t||null===(a=t[0])||void 0===a?void 0:a[0]})},handlePageEot:function(e,t,a){var c=t.split("/");if(a.data&&a.data.length>0)if("page"===(null===c||void 0===c?void 0:c[3])){var o=c[4],l=new URLSearchParams(i).get("connectionId");e.publishToEvent(m.PublishPageTopics,cn(l),Dn({objectId:o,paths:["$"],returnPaths:["$"]},o))}else if("user"===(null===c||void 0===c?void 0:c[3])){var s=c[4];n({type:Ve,payload:{userId:s,user:null===a||void 0===a?void 0:a.data}})}},getUsersList:function(e,t){var a,i=(null!==(a=null===t||void 0===t?void 0:t.data)&&void 0!==a?a:[]).map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h,g,x,y,I,S,N,k,T,C,w,E,R,P,D,A,M,L,U,q,F,B,_,$,Y,H,W,V,z,Q=null===(t=Object.keys(e))||void 0===t?void 0:t[0];return{id:Q,nonpersistent:{static:{live:{status:null===e||void 0===e||null===(n=e[Q])||void 0===n||null===(a=n[0])||void 0===a?void 0:a[0]}}},firstName:null!==(i=null===e||void 0===e||null===(c=e[Q])||void 0===c||null===(o=c[1])||void 0===o||null===(l=o[0])||void 0===l||null===(s=l.profile)||void 0===s?void 0:s.firstName)&&void 0!==i?i:null===e||void 0===e||null===(r=e[Q])||void 0===r||null===(d=r[1])||void 0===d?void 0:d[0].firstName,lastName:null!==(u=null===e||void 0===e||null===(v=e[Q])||void 0===v||null===(b=v[1])||void 0===b||null===(j=b[0])||void 0===j||null===(m=j.profile)||void 0===m?void 0:m.lastName)&&void 0!==u?u:null===e||void 0===e||null===(p=e[Q])||void 0===p||null===(O=p[1])||void 0===O?void 0:O[0].lastName,fullName:"".concat(null!==(f=null===e||void 0===e||null===(h=e[Q])||void 0===h||null===(g=h[1])||void 0===g||null===(x=g[0])||void 0===x||null===(y=x.profile)||void 0===y?void 0:y.firstName)&&void 0!==f?f:null===e||void 0===e||null===(I=e[Q])||void 0===I||null===(S=I[1])||void 0===S?void 0:S[0].firstName," ").concat(null!==(N=null===e||void 0===e||null===(k=e[Q])||void 0===k||null===(T=k[1])||void 0===T||null===(C=T[0])||void 0===C||null===(w=C.profile)||void 0===w?void 0:w.lastName)&&void 0!==N?N:null===e||void 0===e||null===(E=e[Q])||void 0===E||null===(R=E[1])||void 0===R?void 0:R[0].lastName),email:null!==(P=null===e||void 0===e||null===(D=e[Q])||void 0===D||null===(A=D[1])||void 0===A||null===(M=A[0])||void 0===M||null===(L=M.alternativeIds)||void 0===L?void 0:L.email)&&void 0!==P?P:null===e||void 0===e||null===(U=e[Q])||void 0===U||null===(q=U[1])||void 0===q?void 0:q[0].email,phone:null!==(F=null===e||void 0===e||null===(B=e[Q])||void 0===B||null===(_=B[1])||void 0===_||null===($=_[0])||void 0===$||null===(Y=$.alternativeIds)||void 0===Y?void 0:Y.phone)&&void 0!==F?F:null===e||void 0===e||null===(H=e[Q])||void 0===H||null===(W=H[1])||void 0===W?void 0:W[0].phoneNumber,admin:null===e||void 0===e||null===(V=e[Q])||void 0===V||null===(z=V[2])||void 0===z?void 0:z[0]}});n({type:_e,payload:i}),n({type:"SET_USERS_REQUEST_ID",payload:{users:i,id:e}})},handleMessages:function(e,t){var a,i;console.log("response",t);var c=t,o=[];if(Array.isArray(c)){c=null!==(a=null===(i=c)||void 0===i?void 0:i.map(function(e){return e.object}))&&void 0!==a?a:[];var l,s=Object(k.a)(c);try{for(s.s();!(l=s.n()).done;){var r,d,u,v,b,j,m,p=l.value;p={messageType:p.message.attributes.eventSummarySubType||p.message.type,createdAt:p.pageInfo.createdAt,data:p.message.attributes,senderName:"user# ".concat(p.pageInfo.userId),senderId:p.pageInfo.userId,message:p.message.attributes.body,id:p.pageInfo.pageMessageId.toString(),originalPageMessageId:null===(r=p)||void 0===r||null===(d=r.pageInfo)||void 0===d||null===(u=d.originalPageMessageId)||void 0===u?void 0:u.toString(),originalCreatedAt:null===(v=p)||void 0===v||null===(b=v.pageInfo)||void 0===b?void 0:b.originalCreatedAt,refMessage:null===(j=p)||void 0===j||null===(m=j.pageInfo)||void 0===m?void 0:m.refMessage,status:p.message.attributes.eventSummaryStatus},o.push(p)}}catch(h){s.e(h)}finally{s.f()}var O=localStorage.getItem("requestId"),f=localStorage.getItem("requestService");O===e&&("summary"===f&&(o=o.filter(function(e){return"text"!==e.messageType&&"info"!==e.messageType&&"log"!==e.messageType})),o.reverse(),n({type:$e,payload:o}))}},handleAppendMessage:function(e){var t,a,i,c,o=e.data,l={messageType:o.message.attributes.eventSummarySubType||o.message.type,createdAt:o.pageInfo.publishedAt,data:o.message.attributes,senderName:"user# ".concat(o.pageInfo.userId),senderId:o.pageInfo.userId,message:o.message.attributes.body,id:o.pageInfo.pageMessageId.toString(),pageId:o.pageInfo.pageId,originalPageMessageId:null===o||void 0===o||null===(t=o.pageInfo)||void 0===t||null===(a=t.originalPageMessageId)||void 0===a?void 0:a.toString(),originalCreatedAt:null===o||void 0===o||null===(i=o.pageInfo)||void 0===i?void 0:i.originalCreatedAt,refMessage:null===o||void 0===o||null===(c=o.pageInfo)||void 0===c?void 0:c.refMessage,status:o.message.attributes.eventSummaryStatus};n({type:He,payload:l}),"summary"===localStorage.getItem("requestId")&&"text"===l.messageType||n({type:Ye,payload:l})},handleUserBds:function(e){var t=null===e||void 0===e?void 0:e.response;n({type:"USER_BDS",payload:t.data})},getAccountsList:function(e){var t,a,i;console.log("accounts",null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.accounts),n({type:Ne,payload:null!==(a=null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.accounts)&&void 0!==a?a:[]})},handleAdminRoles:function(e){var t,a,i=null===e||void 0===e||null===(t=e.data)||void 0===t||null===(a=t[0])||void 0===a?void 0:a[0];n({type:"ADMIN_ROLES",payload:i})}}},Ln=n(516),Un=n.n(Ln),qn=n(654),Fn=function(){var e=function(){var e=Object(a.useState)(),t=Object(u.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)(),o=Object(u.a)(c,2),r=o[0],d=o[1],v=Object(s.c)(function(e){return e.auth}).encrypted_token,b=Object(l.g)().search,j=Mn(),m=j.getSurveyList,O=j.getSectionList,g=j.getBio,y=j.getRoleList,I=j.getExtendedBioList,S=j.getVehicleExtendedBioList,k=j.getProjectList,T=j.getRespondersList,C=j.getAssetsList,w=j.setSubmitted,E=j.getPageResult,R=j.handlePageEot,P=j.getUsersList,D=j.handleMessages,A=j.handleAppendMessage,M=j.handleUserBds,L=j.handleAggregateBds,U=j.handlePageResults,q=j.handleAggregate,F=j.getAccountsList,B=j.handleAdminRoles,_=Object(a.useRef)({}),$=Object(a.useRef)({});Object(a.useEffect)(function(){return function(){n&&n.end(void 0,void 0,function(){console.log("Disconnected")})}},[]),Object(a.useEffect)(function(){n&&(n.on("connect",function(){console.log("Connected"),d(n)}),n.on("error",function(e){console.error("Connection error: ",e),n.end()}),n.on("reconnect",function(){console.log("Reconnecting")}),n.on("disconnect",function(){console.log("Disconnecting")}),n.on("message",V))},[n]);var Y=function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},c=arguments.length>4?arguments[4]:void 0;n&&n.publish(t,JSON.stringify(a),{qos:c||1},function(e){i(e?{status:!1}:{status:!0})})},H=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3?arguments[3]:void 0;n&&n.subscribe(t,{qos:1},function(e){if(e)console.log("Subscribe to topics error",e);else{_.current[t]||(_.current[t]=[]);var n=_.current[t].findIndex(function(e){return e.componentUuid===i});-1!==n?_.current[t][n]={componentUuid:i,callback:a}:_.current[t].push({componentUuid:i,callback:a})}})},V=function(e,t){var n,a={topic:e,message:t.toString()};if(a.message){console.log("payload",a);var i=JSON.parse(a.message);null!==(n=$.current)&&void 0!==n&&n[i.id]&&(e=$.current[i.id],i=i.response),Object.keys((null===_||void 0===_?void 0:_.current)||{}).map(function(t){var n;qn.matches(t,e)&&(null===_||void 0===_||null===(n=_.current)||void 0===n||n[t].map(function(e){(0,e.callback)(i)}))}),e===f.GetSectionList&&O(i),e===h.GetBio&&g(i),e===h.GetRoleList&&y(i),e===p.GetSurveyQuestions&&m(i),e===x.GetRolesBio&&I(i),e===x.GetVehicleBio&&S(i),e.includes(N.GetProjectsResult)&&k(i.response),e.includes(N.GetAccountsResult)&&F(i.response),e.includes(N.GetRespondersResult)&&T(i.response),e.includes(N.GetAssetsResult)&&C(i.response),(e.includes(N.CreateEventResult)||e.includes(N.CreateTicketResult)||e.includes(N.CreateRideResult)||e.includes(N.CreateSchoolResult)||e.includes(N.CreateShuttleBusResult))&&w(i.response),e.includes(N.SearchPageResult)&&E(i),e.includes(N.BdsEot)&&R({subscribeToEvent:H,publishToEvent:Y},e,i),e.includes(N.SearchUser)&&P(i.id,i.response),e.includes(N.SearchMessage)&&D(i.id,i.response),e.includes(N.GroupMembers)&&A(i),e.includes(N.SearchBds)&&M(i),e.includes(N.GetPageAggregateBds)&&L(i),e.includes(N.GetPageResult)&&U(i),e.includes(N.GetAggregateBds)&&e.includes(N.Connection)&&q(i),e.includes(N.GetPageResult)&&U(i),e.includes(N.GetAdminRoles)&&B(i)}};return{socketClient:r,socketConnect:function(){i(Un.a.connect("wss://mqtt.staging.beam.live:8091",{clientId:W(),username:"live",password:"beamL1ve",keepalive:30}))},subscribeToEventSurvey:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3?arguments[3]:void 0;_.current[t]||(_.current[t]=[]);var i=_.current[t].findIndex(function(e){return e.componentUuid===a});-1!==i?_.current[t][i]={componentUuid:a,callback:n}:_.current[t].push({componentUuid:a,callback:n})},publishToEventServiceIdSurvey:function(e,t,a,i,c){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},l=new URLSearchParams(b),s=Dn(a),r=(null===v||void 0===v?void 0:v.connectionId)||l.get("connectionId");null!==r&&void 0!==r&&""!==r||(r=Math.floor(1e5+9e4*Math.random()));var d="".concat("beamdevlive","/connection/").concat(r,"/service/").concat(c,"/").concat(t);console.log("search topic",d),n&&(n.subscribe("".concat(d,"/reply"),{qos:1},function(e){e?console.log("Subscribe to topics error",e):$.current[s.id]=i}),n.publish(d,JSON.stringify(s),{qos:1},function(e){o(e?{status:!1}:{status:!0})}))},socketSubscribeToEvent:H,socketUnSubscribeToEvent:function(e,t){n&&n.unsubscribe(t,function(e){e&&console.log("unSubsribed to topics error",e)})},socketPublishToEvent:Y}}(),t=e.socketClient,n=e.socketConnect,i=e.socketSubscribeToEvent,c=e.socketPublishToEvent,o=e.socketUnSubscribeToEvent,r=e.subscribeToEventSurvey,d=e.publishToEventServiceIdSurvey;return{client:t,subscribeToSurvey:function(e,t){r(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},arguments.length>3?arguments[3]:void 0)},publishToServiceIdSurvey:function(e,t,n,a,i){d(e,t,n,a,i,arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){})},subscribeToEvent:function(e,t){i(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},arguments.length>3?arguments[3]:void 0)},publishToEvent:function(e,t,n){c(e,t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},arguments.length>4?arguments[4]:void 0)},unSubscribeToEvent:function(e,t){o(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){})},connect:n}},Bn=n(8),_n=n(14),$n=n(1039),Yn=n(1022),Hn=n(1023),Wn=n(544),Vn=n(88),zn=n(1048),Qn=n(312),Gn=(n(655),n(204),n(159)),Jn=n(393),Kn=n(546),Zn=n(1024),Xn=n(232),ea=n(1034),ta=n(313),na=n(551),aa=n(224),ia=n(1053),ca=n(548),oa=n(1),la=function(e){var t=e.value,n=e.onChange,i=e.placeholder,c=e.disabled,o=e.min,l=e.max,s=Object(a.useState)(null!==t&&void 0!==t?t:0),r=Object(u.a)(s,2),d=r[0],v=r[1];Object(a.useEffect)(function(){"number"===typeof t&&v(t)},[t]);var b=function(e){return void 0===o||e>=o},j=function(e){return void 0===l||e<=l},m=function(e){b(e)&&j(e)&&(v(e),n(e))};return Object(oa.jsxs)("div",{className:"d-flex custom-number",children:[Object(oa.jsx)(Vn.a,{className:"beam-btn d-flex",disabled:c||void 0!==o&&d<=o,onClick:function(){return m(d-1)},children:Object(oa.jsx)(ia.a,{})}),Object(oa.jsx)(Wn.a,{className:"beam-input mx-2",placeholder:i||"Enter Number",type:"number",min:o,max:l,step:"0.01",disabled:c,value:d,onWheel:function(e){return e.target.blur()},onChange:function(e){var t=parseFloat(e.target.value);isNaN(t)||b(t)&&j(t)&&(v(t),n(t))}}),Object(oa.jsx)(Vn.a,{className:"beam-btn d-flex",disabled:c||void 0!==l&&d>=l,onClick:function(){return m(d+1)},children:Object(oa.jsx)(ca.a,{})})]})},sa=function(e){var t=e.value,n=e.suffix,i=e.onChange,c=Object(a.useState)(0|t),o=Object(u.a)(c,2),l=o[0],s=o[1];return Object(oa.jsxs)("div",{className:"d-flex custom-number",children:[Object(oa.jsx)(Vn.a,{className:"beam-btn d-flex",onClick:function(){s(parseFloat(l)-1),i(parseFloat(l)-1)},children:Object(oa.jsx)(ia.a,{})}),Object(oa.jsx)(Wn.a,{className:"beam-input w-auto mx-2",placeholder:"Enter Number",min:0,type:"number",value:l,suffix:n,onChange:function(e){s(e.target.value),i(e.target.value)}}),Object(oa.jsx)(Vn.a,{className:"beam-btn d-flex",onClick:function(){s(parseFloat(l)+1),i(parseFloat(l)+1)},children:Object(oa.jsx)(ca.a,{})})]})},ra=function(e){var t=e.value,n=e.onChange,i=e.placeholder,c=Object(a.useState)(t||[]),o=Object(u.a)(c,2),l=o[0],s=o[1],r=Object(a.useState)(!1),d=Object(u.a)(r,2),v=d[0],b=d[1],j=Object(a.useState)(""),m=Object(u.a)(j,2),p=m[0],O=m[1],f=Object(a.useRef)(null);Object(a.useEffect)(function(){var e;v&&(null===(e=f.current)||void 0===e||e.focus())},[v]);return Object(oa.jsx)(Yn.a,{className:"custom-tag",children:Object(oa.jsxs)(Hn.a,{span:24,className:"file-wrapper",children:[Object(oa.jsx)(Wn.a,{ref:f,type:"text",size:"small",className:"tag-input",placeholder:i||"Input tag here...",value:p,onChange:function(e){O(e.target.value)},onPressEnter:function(){p&&-1===l.indexOf(p)&&(s([].concat(Object(C.a)(l),[p])),n([].concat(Object(C.a)(l),[p]))),b(!1),O("")}}),Object(oa.jsx)("hr",{}),l.map(function(e,t){return Object(oa.jsx)(Kn.a,{className:"tag-item",closable:!0,onClose:function(){return function(e){var t=l.filter(function(t){return t!==e});s(t),n(t)}(e)},children:Object(oa.jsx)("span",{children:e})},e)})]})})},da=n(59),ua=n(32),va={lat:-34.397,lng:150.644},ba=Object(da.compose)(Object(da.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M&v=3.exp&libraries=geometry,drawing,places",loadingElement:Object(oa.jsx)("div",{style:{height:"100%"}}),containerElement:Object(oa.jsx)("div",{style:{height:"290px",width:"100%"}}),mapElement:Object(oa.jsx)("div",{style:{height:"100%"}})}),ua.withScriptjs,ua.withGoogleMap)(function(e){var t=e.value,n=e.onChange,i=e.isMobile,c=Object(a.useState)(t||va),o=Object(u.a)(c,2),l=o[0],s=o[1];return Object(a.useEffect)(function(){t&&s(t)},[t]),Object(oa.jsx)(ua.GoogleMap,{defaultZoom:8,center:l,onClick:function(e){i||(t={lat:e.latLng.lat(),lng:e.latLng.lng()},s(t),n(t))},children:Object(oa.jsx)(ua.Marker,{position:l})})}),ja=function(e){var t=e.value,n=e.onChange,i=Object(a.useState)(t||"@"),c=Object(u.a)(i,2),o=c[0],l=c[1];return Object(a.useEffect)(function(){console.log("email value",t),t&&t.includes("@")&&l(t)},[t]),Object(oa.jsxs)("div",{className:"custom-email",children:[Object(oa.jsx)(Wn.a,{className:"e-name",value:o.split("@")[0]||"",onChange:function(e){l(e.target.value+"@"+o.split("@")[1]),n(e.target.value+"@"+o.split("@")[1])}}),Object(oa.jsx)("span",{children:"@"}),Object(oa.jsx)(Wn.a,{value:o.split("@")[1]||"",className:"e-type",onChange:function(e){l(o.split("@")[0]+"@"+e.target.value),n(o.split("@")[0]+"@"+e.target.value)}})]})},ma=n(1032),pa=n(114),Oa=function(e){var t=e.value,n=e.onChange,i=e.placeholder,c=e.isMobile,o=e.onUploadClick,l=(e.name,Object(a.useState)(t)),r=Object(u.a)(l,2),v=r[0],b=r[1],j=Object(s.b)(),m=Object(s.c)(function(e){return e.auth}).fileToSend,p=Object(a.useState)(!1),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(a.useState)(),x=Object(u.a)(g,2),y=x[0],I=x[1];Object(a.useEffect)(function(){if(m&&y===m.id){console.log("file to send",m);var e=Object(d.a)({name:m.media.originalName,url:m.media.urls.original.url},m.media);b(e),h(!1),n(e),j({type:"ADD_FILE",payload:void 0})}},[m,y]);return Object(a.useEffect)(function(){b(t)},[t]),Object(oa.jsx)(Yn.a,{className:"custom-file-upload",children:Object(oa.jsx)(Hn.a,{span:24,children:v&&v.name?Object(oa.jsxs)("div",{className:"file-wrapper",children:[Object(oa.jsx)("p",{children:"Your dropped file:"}),Object(oa.jsx)("hr",{}),Object(oa.jsx)("ul",{children:Object(oa.jsxs)("li",{children:[Object(oa.jsx)("a",{target:"_blank",href:v.url,children:v.name}),Object(oa.jsx)(pa.a,{onClick:function(){return b(null),void n(null)}})]})}),!v.url&&Object(oa.jsx)(Yn.a,{className:"action-grp mt-4",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover w-full",onClick:function(){var e=new FormData;e.append("file",v),e.append("info",JSON.stringify({})),j(ye({form:e,id:y})),h(!0)},loading:f,children:"Upload"})})})]}):Object(oa.jsx)("div",{children:c?Object(oa.jsx)("div",{className:"file-wrapper",children:Object(oa.jsx)("div",{className:"d-flex flex-column justify-content-center align-items-center p-4 cursor-pointer",onClick:function(){o&&o()},children:Object(oa.jsx)("p",{children:"Click to upload file"})})}):Object(oa.jsx)(ma.a,{maxCount:1,beforeUpload:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return b(t),I(Object(B.uuid)()),e.a(2,!1)},e)}));return function(t,n){return e.apply(this,arguments)}}(),children:Object(oa.jsx)("div",{children:i||"Drop your file here (or click)"})})})})})},fa=n(20),ha=n(541),ga=(n(856),Gn.a.Option),xa=Wn.a.TextArea,ya=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ia=[15,30,45,60],Sa=function(e){var t,n,i,c=e.data,o=e.moveNext,l=e.moveBack,s=e.count,r=e.totalQuestions,v=e.onClose,b=Object(a.useState)(""),j=Object(u.a)(b,2),m=j[0],p=j[1],O=Object(a.useState)(c.value),f=Object(u.a)(O,2),h=f[0],g=f[1],x=Object(a.useState)(""),y=Object(u.a)(x,2),I=y[0],N=y[1],k=Object(a.useState)(""),w=Object(u.a)(k,2),E=w[0],R=w[1],P=Object(a.useState)(""),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Object(a.useState)(c.value||""),U=Object(u.a)(L,2),q=U[0],F=U[1],B=Object(a.useState)(c.value||null),_=Object(u.a)(B,2),$=_[0],Y=_[1],W=Object(a.useState)(c.value||null),V=Object(u.a)(W,2),z=V[0],Q=V[1],G=Object(a.useState)(c.value||null),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)(!1),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(),ie=Object(u.a)(ae,2),ce=ie[0],oe=ie[1],le=Object(a.useState)([]),se=Object(u.a)(le,2),re=se[0],de=se[1],ue=Object(a.useState)([]),ve=Object(u.a)(ue,2),be=ve[0],je=ve[1],me=function(e,t,n){var a=Object(C.a)(K.options);a[e].operationHours[t]=n,Z(Object(d.a)(Object(d.a)({},K),{},{options:a}))};Object(a.useEffect)(function(){var e;switch(c.type){case S.Name:var t=null===c||void 0===c||null===(e=c.value)||void 0===e?void 0:e.split(" ");N((null===t||void 0===t?void 0:t[0])||""),R((null===t||void 0===t?void 0:t[1])||""),M((null===t||void 0===t?void 0:t[2])||"");break;case S.Phone:F(c.value);break;case S.Text:g(c.value);break;case S.MultipleChoice:p(c.value);break;case S.Time:case S.DateTime:Y(c.value?c.value:null);break;case S.Category:je((null===c||void 0===c?void 0:c.value)||[])}return Z(c.value||null),ne(/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),window.addEventListener("nativeEvent",pe),function(){return window.removeEventListener("nativeEvent",pe)}},[c]);var pe=Object(a.useCallback)(function(e){var t=JSON.parse(e.detail);oe(t)},[oe]);Object(a.useEffect)(function(){if(ce&&("media"===ce.type&&Z(Object(d.a)({name:ce.attributes.body,url:ce.attributes.urls.original.url},ce.attributes)),"place"===ce.type)){var e={lat:ce.attributes.coordinates.lat,lng:ce.attributes.coordinates.long};Z(e),Q(e)}},[ce]);var Oe="",fe={marginLeft:10,fontSize:"medium"};switch(c.type){case S.ThreeButton:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsxs)(Yn.a,{className:"d-flex mb-4",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"yes"===K?"beam-btn green-btn cover w-full btn-selected":"beam-btn green-btn cover w-full",onClick:function(){return Z("yes")},children:"Yes"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"maybe"===K?"beam-btn w-full btn-selected":"beam-btn w-full",onClick:function(){return Z("maybe")},children:"Maybe"})})]}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Vn.a,{className:"no"===K?"beam-btn orange-btn cover w-full btn-selected":"beam-btn orange-btn cover w-full",onClick:function(){return Z("no")},children:"No"})})})]})});break;case S.YesNo:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)(Yn.a,{className:"d-flex",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"yes"===K?"beam-btn green-btn cover w-full btn-selected":"beam-btn green-btn cover w-full",onClick:function(){return Z("yes")},children:"Yes"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"no"===K?"beam-btn orange-btn cover w-full btn-selected":"beam-btn orange-btn cover w-full",onClick:function(){return Z("no")},children:"No"},"yes-no")})]})})});break;case S.Category:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select categories",value:re,onChange:function(e){de(e)},children:c.options.map(function(e){return Object(oa.jsx)(ga,{value:e.name,children:e.name},e.name)})})})}),c.options.length>0&&(Oe=Object(oa.jsxs)(oa.Fragment,{children:[Oe,Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select subcategories",value:be,onChange:function(e){Z(e),je(e)},children:null===c||void 0===c?void 0:c.options.filter(function(e){return re.includes(e.name)}).flatMap(function(e){return e.subCategories}).map(function(e){return Object(oa.jsx)(ga,{value:e,children:e},e)})})})})]}));break;case S.Calendar:Oe=Object(oa.jsxs)(Yn.a,{className:"tiles",children:[Object(oa.jsx)(Yn.a,{className:"mb-2 w-100",children:Object(oa.jsxs)(Hn.a,{span:24,className:"operation-time custom-tag",children:[Object(oa.jsx)(Jn.a,{style:{width:"100%"},onChange:function(e){if(e){var t=e.format("YYYY-MM-DD"),n=Object(C.a)((null===K||void 0===K?void 0:K.holidays)||[]);n=n.includes(t)?n.filter(function(e){return e!==t}):[].concat(Object(C.a)(n),[t]),Z(Object(d.a)(Object(d.a)({},K),{},{holidays:n}))}},value:null,placeholder:"Select holidays"}),Object(oa.jsx)("div",{children:null===K||void 0===K||null===(t=K.holidays)||void 0===t?void 0:t.map(function(e){return Object(oa.jsx)(Kn.a,{className:"tag-item",closable:!0,onClose:function(){return function(e){var t=Object(C.a)((null===K||void 0===K?void 0:K.holidays)||[]);t=t.filter(function(t){return t!==e}),Z(Object(d.a)(Object(d.a)({},K),{},{holidays:t}))}(e)},children:e},e)})})]})}),Object(oa.jsx)(Yn.a,{className:"mb-2 w-100",children:Object(oa.jsx)(Hn.a,{span:24,className:"operation-time custom-tag",children:Object(oa.jsx)(Gn.a,{placeholder:"Select appointment duration",onChange:function(e){var t;t=e,Z(Object(d.a)(Object(d.a)({},K),{},{appointmentDuration:t}))},style:{width:"100%"},value:null===K||void 0===K?void 0:K.appointmentDuration,children:Ia.map(function(e){return Object(oa.jsx)(ga,{value:e,children:e},e)})})})}),null===K||void 0===K||null===(n=K.options)||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsxs)(Yn.a,{gutter:8,className:"mb-3",children:[Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)(Gn.a,{placeholder:"Select operation days",onChange:function(e){!function(e,t){var n=Object(C.a)(K.options);n[e].daysOfWeek=t,Z(Object(d.a)(Object(d.a)({},K),{},{options:n}))}(t,e)},mode:"multiple",style:{width:"100%"},value:null===e||void 0===e?void 0:e.daysOfWeek,children:ya.map(function(e){return Object(oa.jsx)(ga,{value:e,children:e},e)})})}),Object(oa.jsx)(Hn.a,{span:2,className:"t-right",children:Object(oa.jsx)(Vn.a,{type:"link",onClick:function(){return function(e){var t=Object(C.a)(K.options);t.splice(e,1),Z(Object(d.a)(Object(d.a)({},c.value),{},{options:t}))}(t)},children:"X"})}),Object(oa.jsxs)(Hn.a,{span:24,className:"mt-1 t-right operation-time",children:[e.operationHours.map(function(e,n){return Object(oa.jsxs)(Yn.a,{gutter:8,className:"mt-1 t-right",children:[Object(oa.jsx)(Hn.a,{span:10,children:Object(oa.jsx)(Zn.a,{placeholder:"Start operation time",format:"HH:mm",value:null!==e&&void 0!==e&&e.startTime?H()(null===e||void 0===e?void 0:e.startTime,"HH:mm"):null,onChange:function(a){me(t,n,{startTime:a?a.format("HH:mm"):null,endTime:e.endTime})}})}),Object(oa.jsx)(Hn.a,{span:10,children:Object(oa.jsx)(Zn.a,{placeholder:"End operation time",format:"HH:mm",value:null!==e&&void 0!==e&&e.endTime?H()(null===e||void 0===e?void 0:e.endTime,"HH:mm"):null,onChange:function(a){me(t,n,{startTime:e.startTime,endTime:a?a.format("HH:mm"):null})}})}),Object(oa.jsx)(Hn.a,{span:2,className:"t-right",children:Object(oa.jsx)(Vn.a,{type:"link",onClick:function(){return function(e,t){var n=Object(C.a)(K.options);n[e].operationHours.splice(t,1),Z(Object(d.a)(Object(d.a)({},c.value),{},{options:n}))}(t,n)},children:"X"})})]},n)}),Object(oa.jsx)(Vn.a,{className:"t-right mr-2",type:"link",onClick:function(){!function(e){var t=Object(C.a)(K.options);t[e].operationHours.push({startTime:void 0,endTime:void 0}),Z(Object(d.a)(Object(d.a)({},c.value),{},{options:t}))}(t)},children:"Add operation time"})]})]},t)}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){Z(Object(d.a)(Object(d.a)({},K),{},{options:[].concat(Object(C.a)((null===K||void 0===K?void 0:K.options)||[]),[{daysOfWeek:[],operationHours:[{startTime:void 0,endTime:void 0}]}])}))},children:"Add operational days"})})]});break;case S.Payment:Oe=Object(oa.jsxs)(Yn.a,{className:"tiles",children:[null===K||void 0===K||null===(i=K.options)||void 0===i?void 0:i.map(function(e,t){return Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:22,className:"mb-3",children:Object(oa.jsx)(Wn.a,{value:e.title,className:"beam-input",onChange:function(e){var n=K.options;n[t].title=e.target.value,Z(Object(d.a)(Object(d.a)({},K),{},{options:n}))},placeholder:"title"})},t),Object(oa.jsx)(Hn.a,{span:2,className:"t-right pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){var e=K.options;e.splice(t,1),Z(Object(d.a)(Object(d.a)({},K),{},{options:e}))},children:Object(oa.jsx)(na.a,{})})}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(la,{value:e.price,onChange:function(e){var n=K.options;n[t].price=e,Z(Object(d.a)(Object(d.a)({},K),{},{options:n}))},placeholder:"amount"})})]})}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){var e=(null===K||void 0===K?void 0:K.options)||[];e.push({title:"",price:0}),Z(Object(d.a)(Object(d.a)({},K),{},{options:e}))},children:"Add service rate"})})]});break;case S.MultipleChoice:Oe=c.isMulti?Object(oa.jsx)(Yn.a,{className:"mt-3 custom-checkbox-group",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Xn.a.Group,{className:"d-block",options:c.options,defaultValue:[],onChange:function(e){return Z(e)}})})}):Object(oa.jsx)(Yn.a,{className:"d-block mt-3",children:c.options.map(function(e,t){return Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",checked:m===e,name:e,value:c.options[t],onChange:function(e){Z(e.target.value),p(e.target.value)},children:e},e)})});break;case S.Bar:Oe=Object(oa.jsx)(Yn.a,{className:"d-flex justify-content-center custom-slider-survey mt-5",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ea.a,{marks:Object(T.a)(Object(T.a)({},c.options[1],{style:fe,label:Object(oa.jsx)("strong",{children:c.options[1]})}),c.options[0],{style:fe,label:Object(oa.jsx)("strong",{children:c.options[0]})}),defaultValue:c.value,max:c.options[0],min:c.options[1],step:c.options[2],onChange:function(e){Z(e)}})})});break;case S.Date:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ha.a,{className:"custom-calendar",onChange:function(e){Z(new Date(e))},value:new Date(c.value)})})});break;case S.Number:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(la,{value:c.value,onChange:function(e){Z(e)}})});break;case S.SectionDocument:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Wn.a,{value:K,className:"w-full",onChange:function(e){Z(e.target.value)},placeholder:"Url link"})});break;case S.Text:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(xa,{autoSize:{minRows:3,maxRows:5},placeholder:"Type here...",value:h,onChange:function(e){g(e.target.value),Z(e.target.value)}})});break;case S.Name:Oe=Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Wn.a,{className:"w-full",value:I,placeholder:"First name",onChange:function(e){var t=e.target.value+" "+E+" "+A;Z(t),N(e.target.value)}}),Object(oa.jsx)(Wn.a,{className:"w-full mt-2",value:E,placeholder:"Middle name",onChange:function(e){var t=I+" "+e.target.value+" "+A;Z(t),R(e.target.value)}}),Object(oa.jsx)(Wn.a,{className:"w-full mt-2",value:A,placeholder:"Last name",onChange:function(e){var t=I+" "+E+" "+e.target.value;Z(t),M(e.target.value)}})]});break;case S.Time:Oe=Object(oa.jsx)(Yn.a,{className:"datetime-item mt-3",children:Object(oa.jsx)(Zn.a,{placeholder:"Select Time",suffixIcon:Object(oa.jsx)(aa.a,{}),value:$,onChange:function(e){Y(e),Z(e)}})});break;case S.DateTime:Oe=Object(oa.jsx)(Yn.a,{className:" w-full mt-3",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png",alt:""}),Object(oa.jsx)(Jn.a,{showTime:!0,placeholder:"Select Date",suffixIcon:Object(oa.jsx)(aa.a,{}),value:c.value?H()(c.value):void 0,onChange:function(e){Y(e),Z(null===e||void 0===e?void 0:e.format("MM/DD/YYY HH:mm:ss"))}})]})});break;case S.Currency:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(sa,{value:0,suffix:c.options[0],onChange:function(e){Z(e)}})});break;case S.Location:Oe=Object(oa.jsx)(Yn.a,{className:"custom-map mt-3",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsxs)("div",{className:"custom-map-title",onClick:function(){if(te){var e,t,n,a={type:"surveyGps"};null===(e=window)||void 0===e||null===(t=e.webkit)||void 0===t||null===(n=t.messageHandlers)||void 0===n||n.jsMessageHandler.postMessage(JSON.stringify(a));try{var i;null===(i=JSBridge)||void 0===i||i.jsMessageHandler(JSON.stringify(a))}catch(c){console.log("js bridge does not exist")}}},children:[Object(oa.jsx)(fa.a,{src:"/images/notification-icon.svg"}),Object(oa.jsx)("p",{children:te?"Click to get posiiton":"Drop your position"})]}),Object(oa.jsx)(ba,{value:z,isMobile:te,onChange:function(e,t){Q(e),Z(e)}})]})});break;case S.GPS:Oe=Object(oa.jsx)(Yn.a,{className:"custom-map mt-3",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsxs)("div",{className:"custom-map-title",onClick:function(){if(te){var e,t,n,a={type:"surveyGps"};null===(e=window)||void 0===e||null===(t=e.webkit)||void 0===t||null===(n=t.messageHandlers)||void 0===n||n.jsMessageHandler.postMessage(JSON.stringify(a));try{var i;null===(i=JSBridge)||void 0===i||i.jsMessageHandler(JSON.stringify(a))}catch(c){console.log("js bridge does not exist")}}},children:[Object(oa.jsx)(fa.a,{src:"/images/notification-icon.svg"}),Object(oa.jsx)("p",{children:te?"Click to get posiiton":"Drop your position"})]}),Object(oa.jsx)(ba,{value:z,onChange:function(e){Z(e)},isMobile:te})]})});break;case S.File:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Oa,{value:K,isMobile:te,onUploadClick:function(){var e,t,n,a={type:"surveyImage"};null===(e=window)||void 0===e||null===(t=e.webkit)||void 0===t||null===(n=t.messageHandlers)||void 0===n||n.jsMessageHandler.postMessage(JSON.stringify(a));try{var i;null===(i=JSBridge)||void 0===i||i.jsMessageHandler(JSON.stringify(a))}catch(c){console.log("js bridge does not exist")}},onChange:function(e){Z(e)}})});break;case S.Signature:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Oa,{value:K,isMobile:te,onUploadClick:function(){var e,t,n,a={type:"surveySignature"};null===(e=window)||void 0===e||null===(t=e.webkit)||void 0===t||null===(n=t.messageHandlers)||void 0===n||n.jsMessageHandler.postMessage(JSON.stringify(a));try{var i;null===(i=JSBridge)||void 0===i||i.jsMessageHandler(JSON.stringify(a))}catch(c){console.log("js bridge does not exist")}},onChange:function(e){Z(e)}})});break;case S.Media:case S.Capture:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Oa,{value:K,isMobile:te,onUploadClick:function(){var e,t,n,a={type:"surveyImage"};null===(e=window)||void 0===e||null===(t=e.webkit)||void 0===t||null===(n=t.messageHandlers)||void 0===n||n.jsMessageHandler.postMessage(JSON.stringify(a));try{var i;null===(i=JSBridge)||void 0===i||i.jsMessageHandler(JSON.stringify(a))}catch(c){console.log("js bridge does not exist")}},onChange:function(e){Z(e)}})});break;case S.Phone:Oe=Object(oa.jsx)(Yn.a,{className:"mt-3 d-flex",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Wn.a,{className:"w-full",placeholder:"phone number",value:q,onChange:function(e){var t=e.target.value;F(t),Z(t)}})})});break;case S.Email:Oe=Object(oa.jsx)("div",{className:"mt-3",children:Object(oa.jsx)(ja,{value:c.value,onChange:function(e){Z(e)}})});break;case S.Tag:Oe=Object(oa.jsx)("div",{className:"mt-3",children:Object(oa.jsx)(ra,{value:c.value,onChange:function(e){Z(c.value)}})});break;case S.TagNot:Oe=Object(oa.jsx)("div",{className:"mt-3",children:Object(oa.jsx)(ra,{value:c.value,onChange:function(e){Z(e)}})});break;default:Oe=""}return Object(oa.jsxs)("div",{children:[Object(oa.jsxs)(Yn.a,{className:"d-flex",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsxs)("h4",{children:["Project ID: ",null===ce||void 0===ce?void 0:ce.type]})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("h4",{children:"Question: 1"})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("a",{onClick:function(){return v()},children:"X"})})]}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Hn.a,{span:24,className:"mt-4",children:Object(oa.jsx)(ta.a,{className:"custom-progress",percent:s/r*100,strokeWidth:12,strokeColor:"#40CC52",format:function(){return"Answered: ".concat(s,"/").concat(r)}})}),Object(oa.jsx)(Yn.a,{className:"mb-3 mt-4",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("p",{className:"t-question",children:c.label})})}),Object(oa.jsx)(Yn.a,{className:"tiles",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{className:"mb-2",children:Object(oa.jsx)("h4",{children:"Answer: "})})}),Oe]})}),Object(oa.jsx)("hr",{className:"mt-4 mb-4"}),Object(oa.jsxs)(Yn.a,{className:"d-flex mt-4",children:[Object(oa.jsx)(Hn.a,{span:11,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:l,children:"Back"})}),Object(oa.jsx)(Hn.a,{span:11,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){o(K)},children:"Submit"})})]})]})},Na=n(301),ka=(n(366),function(e){return e.JumpToQuestion="Jump To Question",e.Notify="Notify",e.NotifyWait="Notify & Wait",e}({})),Ta=function(e){return e.LessThan="less-than",e.GreaterThan="greater-than",e.EqualTo="equal-to",e}({}),Ca=function(e){return e.AND="and",e.NOT="not",e.OR="or",e}({}),wa=function(e){return e.IN="in",e.OUT="out",e}({}),Ea=n(257),Ra=n.n(Ea),Pa=Object.values(ka).map(function(e){return{label:e,value:e}}),Da=Object.values(Ca).map(function(e){return{label:e,value:e}}),Aa=Object.values(Ta).map(function(e){return{label:e,value:e}}),Ma=Object.values(wa).map(function(e){return{label:e,value:e}}),La=function(e){var t=e.data,n=e.onCreateCancel,i=e.activeType,c=Object(a.useState)(!0),o=Object(u.a)(c,2),l=o[0],r=o[1],d=Object(a.useState)([]),v=Object(u.a)(d,2),b=v[0],j=v[1],m=Object(a.useState)(t.logic.length||0),p=Object(u.a)(m,2),O=p[0],f=p[1],h=Object(s.c)(function(e){return e.auth}).survey;Object(a.useEffect)(function(){var e=h.questions.map(function(e,t){return{label:"Q".concat(t+1),value:e._id}}).filter(function(e){return e.value!==t._id});j(e),f(t.logic.length)},[h]);var g=Object(a.useState)(t.logic||[{ops:null,action:null,value:null,jQuestion:null}]),x=Object(u.a)(g,2),y=x[0],I=x[1],N="";switch(i){case S.Location:case S.Signature:case S.ThreeButton:case S.Text:case S.Name:case S.File:case S.Tag:case S.TagNot:case S.YesNo:N=Object(oa.jsxs)(Hn.a,{children:[$.a.times(O,function(e){return Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{className:"mb-1 mt-2 mr-3",children:Object(oa.jsxs)("h3",{children:["Logic: ",e+1]})}),Object(oa.jsx)(Gn.a,{value:y[e].action,onChange:function(t){var n=Object(C.a)(y);n[e].action=t,I(Object(C.a)(n))},className:" mt-1 w-full",placeholder:"Select Action",options:Pa}),(y[e].action===ka.NotifyWait||y[e].action===ka.Notify)&&Object(oa.jsx)(Ra.a,{className:"mt-1",autoSize:{minRows:3,maxRows:5},value:y[e].jQuestion,placeholder:"Type here...",onChange:function(t){var n=Object(C.a)(y);n[e].jQuestion=t.target.value,I(Object(C.a)(n))}}),y[e].action===ka.JumpToQuestion&&Object(oa.jsx)(Gn.a,{value:y[e].jQuestion,onChange:function(t){var n=Object(C.a)(y);n[e].jQuestion=t,I(Object(C.a)(n))},className:"mt-1 w-full",placeholder:"Select Question to Jump",options:b})]},e)}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn mt-4",onClick:function(){f(O+1);var e=Object(C.a)(y);e.push({action:null,ops:null,value:null,jQuestion:null}),I(Object(C.a)(e))},children:"Add"})})]});break;case S.Number:case S.Time:case S.Date:case S.DateTime:case S.Currency:case S.Bar:N=Object(oa.jsxs)(Hn.a,{children:[$.a.times(O,function(e){return Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsxs)("h3",{className:"mb-1 mt-2",children:["Logic: ",e+1]}),Object(oa.jsx)(Gn.a,{className:"mt-1 w-full",value:y[e].ops,onChange:function(t){var n=Object(C.a)(y);n[e].ops=t,I(Object(C.a)(n))},placeholder:"Select Condition",options:Aa}),Object(oa.jsx)(Gn.a,{value:y[e].action,onChange:function(t){var n=Object(C.a)(y);n[e].action=t,I(Object(C.a)(n))},className:" mt-1 w-full",placeholder:"Select Action",options:Pa}),(y[e].action===ka.Notify||y[e].action===ka.Notify)&&Object(oa.jsx)(Ra.a,{className:"mt-1",autoSize:{minRows:3,maxRows:5},placeholder:"Type here...",onChange:function(e){t.value=e.target.value}}),y[e].action===ka.JumpToQuestion&&Object(oa.jsx)(Gn.a,{value:y[e].jQuestion,onChange:function(t){var n=Object(C.a)(y);n[e].jQuestion=t,I(Object(C.a)(n))},className:"mt-1 w-full",placeholder:"Select Question to Jump",options:b}),i===(S.Number||S.Bar||S.Currency)&&Object(oa.jsx)(Wn.a,{className:"beam-input w-full",type:"number",placeholder:"Enter Number",min:0,value:y[e].value,defaultValue:0,onChange:function(t){var n=Object(C.a)(y);n[e].value=t.target.value,I(Object(C.a)(n))}}),i===S.Time&&Object(oa.jsx)(Yn.a,{className:"datetime-item w-full",children:Object(oa.jsx)(Zn.a,{placeholder:"Select Time",suffixIcon:Object(oa.jsx)(aa.a,{}),value:H()(y[e].value).isValid()?H()(y[e].value):H()(),onChange:function(t){var n=Object(C.a)(y);n[e].value=t,I(Object(C.a)(n))}})}),i===S.Date&&Object(oa.jsx)(Yn.a,{className:" w-full",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png"}),Object(oa.jsx)(Jn.a,{placeholder:"Select Date",suffixIcon:Object(oa.jsx)(aa.a,{}),value:H()(y[e].value).isValid()?H()(y[e].value):H()(),onChange:function(t){var n=Object(C.a)(y);n[e].value=t,I(Object(C.a)(n))}})]})}),i===S.DateTime&&Object(oa.jsx)(Yn.a,{className:" w-full",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png"}),Object(oa.jsx)(Jn.a,{showTime:!0,placeholder:"Select Date",suffixIcon:Object(oa.jsx)(aa.a,{}),value:H()(y[e].value).isValid()?H()(y[e].value):H()(),onChange:function(t){var n=Object(C.a)(y);n[e].value=t,I(Object(C.a)(n))}})]})})]},e)}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn mt-4",onClick:function(){f(O+1);var e=Object(C.a)(y);e.push({action:null,ops:null,value:null,jQuestion:null}),I(Object(C.a)(e))},children:"Add"})})]});break;case S.GPS:N=Object(oa.jsxs)(Hn.a,{children:[$.a.times(O,function(e){return Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsxs)("h3",{className:"mb-1 mt-2",children:["Logic: ",e+1]}),Object(oa.jsx)(Gn.a,{value:y[e].ops,onChange:function(t){var n=Object(C.a)(y);n[e].ops=t,I(Object(C.a)(n)),I(Object(C.a)(n))},className:"w-full",placeholder:"Select Condition",options:Ma}),Object(oa.jsx)(Gn.a,{value:y[e].action,onChange:function(t){var n=Object(C.a)(y);n[e].action=t,I(Object(C.a)(n))},className:" mt-1 w-full",placeholder:"Select Action",options:Pa}),(y[e].action===ka.Notify||y[e].action===ka.Notify)&&Object(oa.jsx)(Ra.a,{className:"mt-1",autoSize:{minRows:3,maxRows:5},placeholder:"Type here...",onChange:function(e){t.value=e.target.value}}),y[e].action===ka.JumpToQuestion&&Object(oa.jsx)(Gn.a,{value:y[e].jQuestion,onChange:function(t){var n=Object(C.a)(y);n[e].jQuestion=t,I(Object(C.a)(n))},className:"mt-1 w-full",placeholder:"Select Question to Jump",options:b})]},e)}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn mt-4",onClick:function(){f(O+1);var e=Object(C.a)(y);e.push({action:null,ops:null,value:null,jQuestion:null}),I(Object(C.a)(e))},children:"Add"})})]});break;case S.MultipleChoice:N=Object(oa.jsxs)(Hn.a,{children:[$.a.times(O,function(e){return Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsxs)("h3",{className:"mb-1 mt-2",children:["Logic: ",e+1]}),Object(oa.jsx)(Gn.a,{className:"mt-1 w-full",value:y[e].ops,onChange:function(t){var n=Object(C.a)(y);n[e].ops=t,t!==Ca.OR&&t!==Ca.AND||(n[e].value=[]),I(Object(C.a)(n))},placeholder:"Select Condition",options:Da}),Object(oa.jsx)(Gn.a,{value:y[e].action,onChange:function(t){var n=Object(C.a)(y);n[e].action=t,I(Object(C.a)(n))},className:" mt-1 w-full",placeholder:"Select Action",options:Pa}),(y[e].action===ka.Notify||y[e].action===ka.Notify)&&Object(oa.jsx)(Ra.a,{className:"mt-1",autoSize:{minRows:3,maxRows:5},placeholder:"Type here...",onChange:function(e){t.value=e.target.value}}),y[e].action===ka.JumpToQuestion&&Object(oa.jsx)(Gn.a,{value:y[e].jQuestion,onChange:function(t){var n=Object(C.a)(y);n[e].jQuestion=t,I(Object(C.a)(n))},className:"mt-1 w-full",placeholder:"Select Question to Jump",options:b}),(y[e].ops===Ca.OR||y[e].ops===Ca.AND)&&Object(oa.jsx)(Gn.a,{mode:"multiple",value:y[e].value,onChange:function(t){var n=Object(C.a)(y);n[e].value=t,I(Object(C.a)(n))},className:"mt-1 w-full",placeholder:"Select Choices",options:t.options.map(function(e){return{label:e,value:e}})}),y[e].ops===Ca.NOT&&Object(oa.jsx)(Gn.a,{value:y[e].value,onChange:function(t){var n=Object(C.a)(y);n[e].value=t,I(Object(C.a)(n))},className:"mt-1 w-full",placeholder:"Select Choice",options:t.options.map(function(e){return{label:e,value:e}})})]},e)}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn mt-4",onClick:function(){f(O+1);var e=Object(C.a)(y);e.push({action:null,ops:null,value:null,jQuestion:null}),I(Object(C.a)(e))},children:"Add"})})]});break;default:N=""}return Object(oa.jsxs)($n.a,{visible:l,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!1,children:[Object(oa.jsx)(Hn.a,{className:"mb-3 t-center",children:Object(oa.jsx)("h3",{children:" Apply Logic to the Question:  "})}),N,Object(oa.jsxs)(Yn.a,{className:"d-flex justify-content-center mt-4",children:[Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full",onClick:function(){t.logic=Object(C.a)(y),n()},children:"Apply"})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:function(){r(!1),n()},children:"Cancel"})})]})]})},Ua=[{span:7,label:S.Text},{span:7,label:S.Media},{span:7,label:S.File},{span:7,label:S.Name},{span:7,label:S.Phone},{span:7,label:S.Email},{span:9,label:S.DateTime},{span:6,label:S.Date},{span:7,label:S.Time},{span:5,label:S.Bar},{span:8,label:S.Number},{span:9,label:S.Currency},{span:7,label:S.ThreeButton},{span:6,label:S.YesNo},{span:6,label:S.TanF},{span:9,label:S.MultipleChoice},{span:6,label:S.Tag},{span:6,label:S.TagNot},{span:7,label:S.Location},{span:9,label:S.GPS},{span:6,label:S.Capture},{span:7,label:S.Signature},{span:7,label:S.Category},{span:7,label:S.Calendar},{span:7,label:S.Payment},{span:11,label:S.SectionDocument},{span:11,label:S.Relation}],qa=[].concat(Ua,[{span:6,label:S.Project},{span:6,label:S.Service},{span:6,label:S.Search},{span:10,label:S.IncidentLocation},{span:6,label:S.Event},{span:6,label:S.FixedAsset},{span:6,label:S.Responder},{span:7,label:S.TaskPicker},{span:9,label:S.Customer},{span:6,label:S.DispatchType},{span:12,label:S.SectionDescription},{span:11,label:S.ResponderExtended}]),Fa=n(1051),Ba=function(e){var t,n=e.activeType,a=e.item,i=e.setItem,c=e.choiceCount,o=e.setChoiceCount,l=e.currencyCodeList,s=e.sections,r="";switch(n){case S.ThreeButton:r=Object(oa.jsx)(Yn.a,{className:"tiles",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsxs)(Yn.a,{className:"d-flex mb-4",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",children:Object(oa.jsx)(Wn.a,{className:"beam-input t-white",placeholder:"Yes"})})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full",children:Object(oa.jsx)(Wn.a,{className:"beam-input",placeholder:"Maybe"})})})]}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn cover w-full",children:Object(oa.jsx)(Wn.a,{className:"beam-input t-white",placeholder:"No"})})})})]})});break;case S.YesNo:case S.TanF:r=Object(oa.jsx)(Yn.a,{className:"tiles",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)(Yn.a,{className:"d-flex mb-4",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",children:Object(oa.jsx)(Wn.a,{className:"beam-input t-white",placeholder:"Yes"})})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn cover w-full",children:Object(oa.jsx)(Wn.a,{className:"beam-input t-white",placeholder:"No"})},"yes-no")})]})})});break;case S.Capture:r=Object(oa.jsx)(Yn.a,{className:"tiles",children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex",children:[Object(oa.jsx)(Xn.a,{className:"mb-2",checked:"image"===a.captureType,defaultChecked:!1,onChange:function(e){return i(Object(d.a)(Object(d.a)({},a),{},{captureType:"image",value:void 0}))},children:"Image"}),Object(oa.jsx)(Xn.a,{className:"mb-2",checked:"audio"===a.captureType,defaultChecked:!1,onChange:function(e){return i(Object(d.a)(Object(d.a)({},a),{},{captureType:"audio",value:void 0}))},children:"Audio"}),Object(oa.jsx)(Xn.a,{className:"mb-2",checked:"video"===a.captureType,defaultChecked:!1,onChange:function(e){return i(Object(d.a)(Object(d.a)({},a),{},{captureType:"video",value:void 0}))},children:"Video"})]})});break;case S.MultipleChoice:case S.Search:r=Object(oa.jsxs)(Yn.a,{className:"tiles",children:[Object(oa.jsx)(Xn.a,{className:"mb-2",checked:a.isMulti,defaultChecked:!1,onChange:function(e){return i(Object(d.a)(Object(d.a)({},a),{},{isMulti:e.target.checked}))},children:"MultiSelect"}),$.a.times(c,function(e){var t;return Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:14,className:"mb-3",children:Object(oa.jsx)(Wn.a,{value:a.options[e],className:"beam-input",onChange:function(t){var n=a.options;n[e]=t.target.value,i(Object(d.a)(Object(d.a)({},a),{},{options:n}))}})},e),Object(oa.jsx)(Hn.a,{span:8,className:"t-right pl-2",children:Object(oa.jsx)(Gn.a,{value:null===a||void 0===a||null===(t=a.conditionalSection)||void 0===t?void 0:t[e],allowClear:!0,onChange:function(t){var n=t,c=a.conditionalSection||{};c[e]=n,i(Object(d.a)(Object(d.a)({},a),{},{conditionalSection:c}))},className:"w-full",placeholder:"Condition section",options:null===s||void 0===s?void 0:s.filter(function(e){return e.conditional}).map(function(e){return{label:e.sectionName,value:e.sectionName}})})}),Object(oa.jsx)(Hn.a,{span:2,className:"t-right pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){o(c-1);var t=a.options;t.splice(e,1),i(Object(d.a)(Object(d.a)({},a),{},{options:t}))},children:Object(oa.jsx)(na.a,{})})})]})}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){o(c+1);var e=a.options;e.push(""),i(Object(d.a)(Object(d.a)({},a),{},{options:e}))},children:"Add"})})]});break;case S.Category:r=Object(oa.jsxs)(Yn.a,{className:"tiles",children:[null===a||void 0===a||null===(t=a.options)||void 0===t?void 0:t.map(function(e,t){return Object(oa.jsxs)(Yn.a,{gutter:8,className:"mb-3",children:[Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)(Wn.a,{value:null===e||void 0===e?void 0:e.name,placeholder:"Category",onChange:function(e){return function(e,t){var n=Object(C.a)(a.options);n[e].name=t,i(Object(d.a)(Object(d.a)({},a),{},{options:n}))}(t,e.target.value)}})}),Object(oa.jsx)(Hn.a,{span:2,className:"t-right",children:Object(oa.jsx)(Vn.a,{type:"link",onClick:function(){return function(e){var t=Object(C.a)(a.options);t.splice(e,1),i(Object(d.a)(Object(d.a)({},a),{},{options:t}))}(t)},children:"X"})}),Object(oa.jsxs)(Hn.a,{span:24,className:"mt-1 t-right",children:[e.subCategories.map(function(e,n){return Object(oa.jsxs)(Yn.a,{gutter:8,className:"mt-1 t-right",children:[Object(oa.jsx)(Hn.a,{span:10}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Wn.a,{value:e,placeholder:"Subcategory",onChange:function(e){return function(e,t,n){var c=Object(C.a)(a.options);c[e].subCategories[t]=n,i(Object(d.a)(Object(d.a)({},a),{},{options:c}))}(t,n,e.target.value)}})}),Object(oa.jsx)(Hn.a,{span:2,className:"t-right",children:Object(oa.jsx)(Vn.a,{type:"link",onClick:function(){return function(e,t){var n=Object(C.a)(a.options);n[e].subCategories.splice(t,1),i(Object(d.a)(Object(d.a)({},a),{},{options:n}))}(t,n)},children:"X"})})]},n)}),Object(oa.jsx)(Vn.a,{className:"t-right mr-2",type:"link",onClick:function(){var e=Object(C.a)(a.options);e[t].subCategories.push(""),i(Object(d.a)(Object(d.a)({},a),{},{options:e}))},children:"Add Subcategory"})]})]},t)}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){i(Object(d.a)(Object(d.a)({},a),{},{options:[].concat(Object(C.a)(a.options),[{name:"",subCategories:[""],daysOfWeek:[],operationHours:[{startTime:void 0,endTime:void 0}],appointmentDuration:0}])}))},children:"Add Category"})})]});break;case S.Text:r=Object(oa.jsx)(Yn.a,{className:"tiles",children:Object(oa.jsx)(Xn.a,{className:"mb-2",checked:a.isMulti,defaultChecked:!1,onChange:function(e){return i(Object(d.a)(Object(d.a)({},a),{},{isMulti:e.target.checked}))},children:"Multiline?"})});break;case S.SectionDocument:r=Object(oa.jsx)(Yn.a,{className:"tiles",children:Object(oa.jsx)(Wn.a,{value:a.link,className:"beam-input",placeholder:"Type link",onChange:function(e){i(Object(d.a)(Object(d.a)({},a),{},{link:e.target.value}))}})});break;case S.Bar:r=Object(oa.jsxs)(Yn.a,{style:{height:"240px"},className:"tiles d-flex justify-content-center",children:[Object(oa.jsxs)("div",{className:"slider ml-3 mr-3",children:[Object(oa.jsx)(ea.a,{vertical:!0,defaultValue:40,onChange:function(e){var t=a.options;t.length||t.push(e),t[0]=e,i(Object(d.a)(Object(d.a)({},a),{},{options:t}))}}),Object(oa.jsx)("h5",{children:"MAX"})]}),Object(oa.jsxs)("div",{className:"slider ml-3 mr-3",children:[Object(oa.jsx)(ea.a,{vertical:!0,defaultValue:30,onChange:function(e){var t=a.options;t.length||(t.push(40),t.push(e)),t[1]=e,i(Object(d.a)(Object(d.a)({},a),{},{options:t}))}}),Object(oa.jsx)("h5",{children:"MIN"})]}),Object(oa.jsxs)("div",{className:"slider ml-3 mr-3",children:[Object(oa.jsx)(ea.a,{vertical:!0,defaultValue:5,onChange:function(e){var t=a.options;t.length||(t.push(40),t.push(30),t.push(e)),t[2]=e,i(Object(d.a)(Object(d.a)({},a),{},{options:t}))}}),Object(oa.jsx)("h5",{children:"STEP"})]})]});break;case S.Currency:r=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Gn.a,{value:a.options[0],onChange:function(e){var t=e;i(Object(d.a)(Object(d.a)({},a),{},{options:[t]}))},className:"w-full",placeholder:"Select Currency",options:l})});break;case S.Relation:r=Object(oa.jsxs)(Yn.a,{className:"tiles",children:[$.a.times(c,function(e){var t,n,l;return Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:10,className:"mb-3",children:Object(oa.jsx)(Wn.a,{value:null===(t=a.value[e])||void 0===t?void 0:t.name,className:"beam-input",placeholder:"Family member name",onChange:function(t){var n=a.value||[];n[e].name=t.target.value,i(Object(d.a)(Object(d.a)({},a),{},{value:n}))}})},"name-".concat(e)),Object(oa.jsx)(Hn.a,{span:2,className:"d-flex justify-content-center",children:Object(oa.jsx)(Fa.a,{style:{fontSize:"18px",color:"#555"}})},"arrow-".concat(e)),Object(oa.jsx)(Hn.a,{span:10,className:"mb-3",children:Object(oa.jsx)(Wn.a,{value:null===(n=a.value[e])||void 0===n?void 0:n.relation,placeholder:"Enter Relation",className:"beam-input",onChange:function(t){var n=a.value||[];n[e].relation=t.target.value,i(Object(d.a)(Object(d.a)({},a),{},{value:n}))}})},"relation-".concat(e)),Object(oa.jsx)(Hn.a,{span:20,className:"mb-3",children:Object(oa.jsx)(Wn.a,{value:null===(l=a.value[e])||void 0===l?void 0:l.dateOfBirth,type:"number",maxLength:8,placeholder:"Enter Date of birth",onChange:function(t){var n=a.value||[];n[e].dateOfBirth=t.target.value,i(Object(d.a)(Object(d.a)({},a),{},{value:n}))}})},"birthDay-".concat(e)),Object(oa.jsx)(Hn.a,{span:2,className:"t-right pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){o(c-1);var t=a.value||[];t.splice(e,1),i(Object(d.a)(Object(d.a)({},a),{},{value:t}))},children:Object(oa.jsx)(na.a,{})})})]})}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){o(c+1);var e=a.value||[];e.push({name:"",relation:"",dateOfBirth:""}),i(Object(d.a)(Object(d.a)({},a),{},{value:e}))},children:"Add"})})]});break;default:r=""}return r},_a=function(e){var t=e.handleCancel,n=e.onCreate,i=e.data,c=e.isEditQuestion,o=Object(a.useState)(i||{name:"",label:"",type:S.ThreeButton,value:"",options:[],logic:[{value:null,action:null,ops:null,jQuestion:null}]}),l=Object(u.a)(o,2),s=l[0],r=l[1],v=Object(a.useState)(""),b=Object(u.a)(v,2),j=b[0],m=(b[1],Object(a.useState)(i.type||S.ThreeButton)),p=Object(u.a)(m,2),O=p[0],f=p[1],h=Object(a.useState)(1),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(a.useState)(!1),N=Object(u.a)(I,2),k=N[0],T=N[1],C=Object(a.useState)(),w=Object(u.a)(C,2),E=w[0],R=w[1];Object(a.useEffect)(function(){var e=Na.codes().map(function(e){return{label:e,value:e}});R(e)},[]),Object(a.useEffect)(function(){c&&(f(i.type),r(i),i.type===S.MultipleChoice&&y(i.options.length))},[]);return Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Yn.a,{className:"mb-4",children:Object(oa.jsx)(Yn.a,{className:"mb-1 d-flex justify-content-center",children:Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("h4",{children:"Choose the Questionaire Type:"})})})}),Object(oa.jsx)(Yn.a,{className:"d-flex",children:Ua.map(function(e,t){return Object(oa.jsx)(Hn.a,{span:e.span,className:"mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full ".concat(O===e.label?"green-btn cover":""),onClick:function(){var t;f(e.label),r(Object(d.a)(Object(d.a)({},s),{},{options:e.label!==S.Category||Array.isArray(s.options)||null!==(t=s.options)&&void 0!==t&&t.length?s.options:[{name:"",subCategories:[""]}],type:e.label}))},children:e.label})},t)})}),Object(oa.jsx)(Yn.a,{className:"mt-4 mb-4",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)(Wn.a,{value:s.name,placeholder:"Type Question name here...",onChange:function(e){r(Object(d.a)(Object(d.a)({},s),{},{name:e.target.value}))}}),j&&Object(oa.jsx)("span",{className:"error-text",children:"Please fill this field"})]})}),Object(oa.jsx)(Yn.a,{className:"mt-4 mb-4",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)(Wn.a,{value:s.label,placeholder:"Type Question here...",onChange:function(e){r(Object(d.a)(Object(d.a)({},s),{},{label:e.target.value}))}}),j&&Object(oa.jsx)("span",{className:"error-text",children:"Please fill this field"})]})}),Object(oa.jsx)(Ba,{item:s,setItem:r,choiceCount:x,setChoiceCount:y,activeType:O,currencyCodeList:E}),k&&Object(oa.jsx)(La,{data:s,onCreateCancel:function(){T(!1)},activeType:O}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:8,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){n(s)},children:c?"Edit":"Add"})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full",onClick:function(){T(!0)},children:"Logic"})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:t,children:"Cancel"})})]})]})},$a=function(e){var t=e.data,n=e.moveNext,i=e.moveBack,c=e.onCreate,o=e.isEditQuestion,l=e.onCancel,s=(e.type,e.isEditMode),r=e.count,d=e.totalQuestions,v=Object(a.useState)(!0),b=Object(u.a)(v,2),j=b[0],m=b[1],p=function(){m(!1),l()};return Object(oa.jsx)($n.a,{visible:j,onOk:function(){m(!1)},onCancel:p,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:s?Object(oa.jsx)(Sa,{data:t,count:r,totalQuestions:d,moveNext:function(e){return n(e)},moveBack:i,onClose:p}):Object(oa.jsx)(_a,{handleCancel:p,onCreate:function(e){c(e),m(!1)},data:t,isEditQuestion:o})})},Ya=function(e){return"/persistent/static/".concat(e,"/extendedBio")},Ha=function(){return{getLocalStorageItem:function(e){return localStorage.getItem(e)},setLocalStorageItem:function(e,t){localStorage.setItem(e,JSON.stringify(t))}}},Wa=function(e){var t=e.onClick;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-18 action-buttons",src:"/images/delete-icon.svg",title:"Delete Question",onClick:t})},"list-loadmore-edit")},Va=function(e){var t=e.onClick;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-18 action-buttons",src:"/images/add-icon.svg",title:"Add Question",onClick:t})},"list-loadmore-edit")},za=function(e){var t=e.onClick;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-15 action-buttons",src:"/images/copy-icon.svg",title:"Copy Question",onClick:t})},"list-loadmore-edit")},Qa=function(e){var t=e.onClick;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-12 action-buttons",src:"/images/edit-icon.svg",title:"Edit Question",onClick:t})},"list-loadmore-edit")},Ga=function(e){var t=e.onClick;return Object(oa.jsx)(Xn.a,{className:"sz-12 action-buttons ml-3",checked:!0,defaultChecked:!1,onChange:t})},Ja=function(e){e.onClose;var t,n,i,c,o=e.socket,l=Object(a.useState)(!1),r=Object(u.a)(l,2),v=r[0],b=r[1],j=Object(a.useState)(),f=Object(u.a)(j,2),h=f[0],g=f[1],N=Object(a.useState)(!0),k=Object(u.a)(N,2),T=k[0],w=k[1],E=Object(a.useState)(I.Survey),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)([]),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(!1),F=Object(u.a)(q,2),_=F[0],$=F[1],Y=Object(a.useState)(!1),V=Object(u.a)(Y,2),z=V[0],Q=V[1],G=Object(a.useState)({}),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)(0),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(),ie=Object(u.a)(ae,2),ce=ie[0],oe=ie[1],le=Object(a.useState)(),se=Object(u.a)(le,2),re=se[0],de=se[1],ue=Object(a.useState)(),ve=Object(u.a)(ue,2),be=ve[0],me=ve[1],pe=Object(a.useState)(!1),fe=Object(u.a)(pe,2),he=fe[0],ge=fe[1],xe=Object(s.b)(),ye=Object(s.c)(function(e){return e.auth}),Ie=ye.survey,Se=ye.surveyId,Ne=ye.surveyList,ke=ye.noFound,Te=ye.message,Ce=ye.messages,we=ye.fileToSend,Ee=Object(a.useState)((null===Ie||void 0===Ie?void 0:Ie.name)||""),Re=Object(u.a)(Ee,2),Pe=Re[0],De=Re[1],Ae=Mn(),Me=Ae.getUserRequestPayload,Le=Ae.updateUserRequestPayload,Ue=Ae.handleMessages,qe=Ha(),Fe=qe.getLocalStorageItem,Be=qe.setLocalStorageItem;Object(a.useEffect)(function(){var e="edit"===Mt("mode");e||Mt("type")!==I.Survey||xe({type:Oe,payload:{name:null,_id:Ie._id,questions:[]}}),Q(e),D(Mt("type")),oe(Mt("pageId")),me(Mt("liveUserId")),de(Mt("connectionId")),Be("userId",~~Mt("userId"))},[]),Object(a.useEffect)(function(){De(null===Ie||void 0===Ie?void 0:Ie.name)},[null===Ie||void 0===Ie?void 0:Ie.name]);var _e=function(e,t,n,a,i){var c=function(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,l=(new Date).getTime();return{header:Object(d.a)({},An(e,t)),messages:[{message:a,connectionInfo:{connectionMessageId:W(),connectionId:e,pageId:n,userId:t,createdAt:l,originalCreatedAt:o||l,refMessage:i,originalPageMessageId:c}}],connectionId:e,connectionPubTopic:""}}(re,be,ce,t,n,a,i);o.publishToEvent(m.PublishPageTopics,"".concat("beamdevlive","/connection/").concat(re,"/page/").concat(ce,"/group/","members"),Dn(c,e))};Object(a.useEffect)(function(){Se&&(o.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Me(Fe("userId"),"$","$..admin.survey.items"),p.GetSurveyQuestions,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,p.GetSurveyQuestions,function(){w(!1)}))},[Se]),Object(a.useEffect)(function(){var e;o.client&&(P===I.Survey?(Mt("surveyId")?(o.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Me(Fe("userId"),"$","$..admin.survey.items"),p.GetSurveyQuestions,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,p.GetSurveyQuestions,function(){w(!1)})):Mt("projectId")&&(o.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Me(Fe("userId"),"$",(e=Mt("projectId"),"$..admin.project.items.".concat(e))),O.GetOneProject,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,O.GetOneProject,function(e){var t,n;console.log("test",null===(t=e.data[0][0])||void 0===t?void 0:t.surveyId),xe({type:Ke,payload:null===(n=e.data[0][0])||void 0===n?void 0:n.surveyId})})),o.subscribeToEvent(m.SubscribePageTopics,"".concat("beamdevlive","/service/live/page/").concat(Mt("pageId"),"/group/members"))):P===I.ExtendedBio?(o.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Me(Fe("userId"),"$","$..admin.role"),x.GetRolesBio,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,x.GetRolesBio,function(){w(!1)}),Mt("uId")&&(o.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Me(Mt("uId"),"$",Ya(Mt("cudbServiceId"))),x.GetUserBio,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,n;console.log("user bio response",e);var a=null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0];Array.isArray(a)?Z(Object(C.a)(a||[])):Z([])}))):P===I.Vehicle&&(o.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Me(Fe("userId"),"$","$..admin.vehicleSettings.extendedBio"),x.GetVehicleBio,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,x.GetVehicleBio,function(){w(!1)}),Mt("uId")&&(o.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Me(Mt("uId"),"$",Ya(Mt("cudbServiceId"))),x.GetUserBio,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t=e.data[0][0];Z(t)}))),P===I.Survey&&z&&Ve(Mt("pageId"),Mt("connectionId")))},[o.client,P]),Object(a.useEffect)(function(){if(P===I.ExtendedBio&&Mt("uId")&&Object.keys(K).length){var e=0,t=Ie.questions.map(function(t){var n=K.find(function(e){return e._id===t._id});return n?(n.value&&e++,n):t});ne(e),xe({type:je,payload:Object(d.a)(Object(d.a)({},Ie),{},{questions:t})})}},[K]);var $e=function(e,t,n){switch(e){case Ta.EqualTo:return t===n;case Ta.GreaterThan:return t>n;case Ta.LessThan:return t<n;case Ca.NOT:return-1==n.indexOf(t);case Ca.OR:var a=!1;return t.map(function(e){-1!=n.indexOf(e)&&(a=!0)}),a;case Ca.AND:return n.every(function(e){return-1!==t.indexOf(e)});default:return!!t}},Ye=function(e,t){var n=!1;switch(t.type){case S.Date:case S.DateTime:case S.Time:n=$e(e.ops,H()(t.value),H()(e.value));break;case S.MultipleChoice:n=$e(e.ops,t.value,e.value);break;case S.Number:case S.Bar:case S.Currency:n=$e(e.ops,Number(t.value),Number(e.value));break;case S.GPS:break;case S.Name:case S.Capture:case S.Email:case S.File:case S.Media:case S.Phone:case S.Signature:case S.Tag:case S.TagNot:case S.Text:case S.ThreeButton:case S.YesNo:case S.Location:n=$e(e.ops,t.value,null)}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,n=null;switch(e.action){case ka.JumpToQuestion:n=Ie.questions.find(function(t){return t._id===e.jQuestion});break;case ka.Notify:_e(Ie._id,{type:"text",attributes:{body:e.jQuestion,notify:!0}});break;case ka.NotifyWait:var a=Object(C.a)(Ce).reverse().find(function(e){var n,a;return"rsvp"===e.messageType&&(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.surveyQuestion)||void 0===a?void 0:a._id)===(null===t||void 0===t?void 0:t._id)});_e(Ie._id,{type:"rsvp",attributes:{body:e.jQuestion,type:"yesNo",options:{option1:"Yes",option2:"No"},rsvpTitle:e.jQuestion,surveyQuestion:t}},a?{referenceType:"update",pageMessageId:a.pageMessageId}:void 0,a?a.originalPageMessageId?a.originalPageMessageId:a.pageMessageId:void 0,a?a.originalPageMessageCreatedAtDate:void 0),a&&Object.keys(a.data.responses).map(function(e){_e(Ie._id,{type:"removeMessage",attributes:{messageId:a.data.responses[e]}})})}!!n&&g(n)}(e,t),n},He=function(){b(!0),g({label:"",name:null,type:S.ThreeButton,value:"",options:[],logic:[]}),$(!1)},We=function(e){b(!0),g(e),$(!0)},Ve=function(e,t){var n=W();localStorage.setItem("requestId",n),localStorage.setItem("requestService","survey");var a={select:{index:{searchIndex:"".concat("beamdevlive",":message:createdAt"),searchQuery:"@pageId:{".concat(e.toString(),"}"),searchOptions:"TIMEOUT 100"},load:{object:"$"}},operations:[{sortBy:{properties:[{field:"@createdAt",order:"DESC"}]}}],result:{pagination:{offset:0,limit:1e3}},sortBy:{properties:[{field:"@createdAt",order:"DESC"}],max:1e4}};xe(tt({requestData:a,callback:function(e){console.log("message response",e),Ue(n,e)}}))};Object(a.useEffect)(function(){if(Te&&Te.data.surveyQuestion&&Te.senderId===be){var e,t=Ie.questions.findIndex(function(e){return e._id===Te.data.surveyQuestion._id});-1!==t&&"rsvp"!==Te.messageType&&"remove"===(null===Te||void 0===Te||null===(e=Te.refMessage)||void 0===e?void 0:e.referenceType)&&(Ie.questions[t].pageMessageId=void 0,Ie.questions[t].originalPageMessageCreatedAtDate=void 0,Ie.questions[t].originalPageMessageId=void 0,Ie.questions[t].value=void 0,ne(te-1))}},[Te]),Object(a.useEffect)(function(){if(Ie.questions&&Ce){var e=0,t=0;Ce.filter(function(e){return e.senderId===be&&"rsvp"!==e.messageType}).map(function(n){var a,i,c=Ie.questions.findIndex(function(e){var t;return e._id===(null===(t=n.data.surveyQuestion)||void 0===t?void 0:t._id)}),o=!1,l=Ce.find(function(e){var t,n,a;return"rsvp"===e.messageType&&(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.surveyQuestion)||void 0===n?void 0:n._id)===(null===(a=Ie.questions[c])||void 0===a?void 0:a._id)});if(!l||null!==l&&void 0!==l&&null!==(a=l.data)&&void 0!==a&&a.responseAnswers){if(l&&null!==l&&void 0!==l&&null!==(i=l.data)&&void 0!==i&&i.responseAnswers){var s,r;if(null!==l&&void 0!==l&&null!==(s=l.data)&&void 0!==s&&s.responseAnswers)Object.keys(null===l||void 0===l||null===(r=l.data)||void 0===r?void 0:r.responseAnswers).map(function(e){var t,n;"Yes"===(null===l||void 0===l||null===(t=l.data)||void 0===t||null===(n=t.responseAnswers)||void 0===n?void 0:n[e])&&(o=!0)})}}else t++;-1!==c&&(Ie.questions[c]=Object(d.a)(Object(d.a)({},n.data.surveyQuestion),{},{pageMessageId:n.id,originalPageMessageCreatedAtDate:n.originalCreatedAt,originalPageMessageId:n.originalPageMessageId},Object.assign({},l&&!o?{value:""}:{})),(!l||l&&o)&&e++)}),w(t>0),ne(e),console.log("survey questions",Ie)}},[Ce,Ie]);var ze=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2)},e)}));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){if(we&&we.id===Ie._id){var e,t,n;ge(!1),_e(Ie._id,{type:"media",attributes:Object(d.a)({body:we.media.originalName},we.media)}),xe({type:"ADD_FILE",payload:void 0});var a={type:"surveyDidSubmit"};null===(e=window)||void 0===e||null===(t=e.webkit)||void 0===t||null===(n=t.messageHandlers)||void 0===n||n.jsMessageHandler.postMessage(JSON.stringify(a));try{var i;null===(i=JSBridge)||void 0===i||i.jsMessageHandler(JSON.stringify(a))}catch(c){console.log("js bridge does not exist")}Lt("Survey PDF submitted successfully","successs","TOP_CENTER",1e3)}},[we]);return Object(oa.jsxs)($n.a,{title:"",visible:!0,width:"100%",className:"beam-modal survey-modal",footer:[],onCancel:function(){},children:[P===I.ExtendedBio&&z&&Object(oa.jsx)(Yn.a,{className:"pdf-icon d-flex justify-content-end mr-4",children:Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("a",{title:"Generate Pdf",onClick:ze,children:Object(oa.jsx)(fa.a,{src:"/images/pdf-icon.svg"})})})}),Object(oa.jsxs)(Yn.a,{className:"d-flex m-4",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsxs)("h4",{children:["Project Name: ",null===Ie||void 0===Ie?void 0:Ie.name]})}),z?Object(oa.jsx)(Hn.a,{children:Object(oa.jsxs)("h5",{children:["Answered: ",te," out of ",null===Ie||void 0===Ie||null===(t=Ie.questions)||void 0===t?void 0:t.length]})}):Object(oa.jsx)(Hn.a,{children:Object(oa.jsxs)("h5",{children:["Total Questions: ",null===Ie||void 0===Ie||null===(n=Ie.questions)||void 0===n?void 0:n.length]})})]}),Object(oa.jsx)("hr",{}),!ke&&!z&&P===I.Survey&&Object(oa.jsxs)(Yn.a,{className:"mt-4 mb-4 ml-4 w-50",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Wn.a,{value:Pe,placeholder:"Edit Survey Name",onChange:function(e){De(e.target.value)}})}),Object(oa.jsx)(Hn.a,{className:"ml-2 mt-1",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){var e=Object(C.a)(Ie.questions),t=Object(C.a)(Ne),n=Ne.findIndex(function(e){return e._id===Ie._id});n>=0?t.splice(n,1,Object(d.a)(Object(d.a)({},Ie),{},{name:Pe,questions:e})):t.splice(n,0,Object(d.a)(Object(d.a)({},Ie),{},{name:Pe,questions:e})),o.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,Le(Fe("userId"),"replace","$..admin.survey.items",t),p.UpdateSurveyQuestion,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,p.UpdateSurveyQuestion,function(){w(!1)}),Lt("Name changed successfully","successs","TOP_CENTER",1e3),xe({type:je,payload:Object(d.a)(Object(d.a)({},Ie),{},{name:Pe,questions:e})})},children:"Edit Name"})})]}),!ke&&!z&&Object(oa.jsx)("div",{children:!(null!==Ie&&void 0!==Ie&&null!==(i=Ie.questions)&&void 0!==i&&i.length)&&Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Va,{onClick:He}),Object(oa.jsx)("h5",{className:"mt-1 ml-1",children:"Add Question"})]})}),Object(oa.jsx)("div",{className:"filter-card-1",children:Object(oa.jsx)(zn.b,{className:"demo-loadmore-list",loading:T,itemLayout:"horizontal",dataSource:null===Ie||void 0===Ie?void 0:Ie.questions,renderItem:function(e,t){var n;return Object(oa.jsx)(zn.b.Item,{actions:z?[null!==e&&void 0!==e&&e.value||null!==e&&void 0!==e&&null!==(n=e.value)&&void 0!==n&&n.length?Object(oa.jsx)(Ga,{onClick:function(){return We(e)}}):Object(oa.jsx)(Qa,{onClick:function(){return We(e)}})]:[Object(oa.jsx)(Va,{onClick:He}),Object(oa.jsx)(Qa,{onClick:function(){return We(e)}}),Object(oa.jsx)(za,{onClick:function(){return function(e){var t=Object(C.a)(Ie.questions);t.push(Object(d.a)(Object(d.a)({},e),{},{_id:Object(B.uuid)()})),Lt("Question copied successfully","successs","TOP_CENTER",1e3),xe({type:je,payload:Object(d.a)(Object(d.a)({},Ie),{},{questions:t})})}(e)}}),Object(oa.jsx)(Wa,{onClick:function(){return function(e){g(e);var t=Object(C.a)(Ie.questions),n=t.findIndex(function(t){return t._id===e._id});t.splice(n,1),xe({type:je,payload:Object(d.a)(Object(d.a)({},Ie),{},{questions:t})})}(e)}})],children:Object(oa.jsx)(Qn.a,{title:!1,loading:!1,active:!0,children:Object(oa.jsx)(zn.b.Item.Meta,{title:"Q".concat(t+1,". ")+e.label})})})}})}),v&&Object(oa.jsx)($a,{data:h,moveNext:function(e){return function(e){var t,n,a,i=!1,c=Object(d.a)(Object(d.a)({},h),{},{value:e}),o=Ie.questions.findIndex(function(e){return e._id===h._id});if(c.value&&JSON.stringify(h.value)!==JSON.stringify(c.value))for(var l=0;l<c.logic.length;l++)if(Ye(c.logic[l],c)){i=!0,n=c.logic[l].action;break}if(P===I.Survey&&(console.log("value",h.value,c.value),c.value&&JSON.stringify(h.value)!==JSON.stringify(c.value)&&("string"===typeof c.value||"number"===typeof c.value?a={type:"text",attributes:{body:"".concat(c.label,": ").concat(c.value),surveyQuestion:c}}:c.value.url?a={type:"media",attributes:Object(d.a)({body:c.label,surveyQuestion:c},c.value)}:c.value.lat&&c.value.lng&&(a={type:"place",attributes:{surveyQuestion:c,body:c.label,attributes:{title:c.label},display:{type:"marker",color:"blue"},coordinates:{lat:c.value.lat,long:c.value.lng}}}),_e(c._id,a,h.pageMessageId?{referenceType:"update",pageMessageId:h.pageMessageId}:void 0,h.pageMessageId?h.originalPageMessageId?h.originalPageMessageId:h.pageMessageId:void 0,h.pageMessageId?h.originalPageMessageCreatedAtDate:void 0))),n===ka.NotifyWait)return w(!0),void b(!1);var s=Object(C.a)(L);if(s.push(c._id),U(Object(C.a)(s)),(!i||n===ka.Notify)&&o+1<Ie.questions.length){var r=Object(d.a)({},Ie.questions[o+1]);g(r)}if(o+1>=Ie.questions.length&&b(!1),Ie.questions[o]=c,xe({type:je,payload:Object(d.a)(Object(d.a)({},Ie),Ie.questions)}),null!==c&&void 0!==c&&c.value||null!==c&&void 0!==c&&null!==(t=c.value)&&void 0!==t&&t.length){var u=0;Ie.questions.map(function(e){var t;(null!==e&&void 0!==e&&e.value||null!==e&&void 0!==e&&null!==(t=e.value)&&void 0!==t&&t.length)&&u++}),ne(u)}}(e)},moveBack:function(){if(L.length>0){var e=Object(C.a)(L),t=e.pop();U(Object(C.a)(e));var n=Ie.questions.findIndex(function(e){return e._id===t});g(Ie.questions[n])}},onCreate:function(e){var t=[];if(_){var n=(t=Object(C.a)(Ie.questions)).findIndex(function(t){return t._id===e._id});t.splice(n,1,e)}else(t=Object(C.a)(Ie.questions)).push(Object(d.a)(Object(d.a)({},e),{},{_id:Object(B.uuid)()}));xe({type:je,payload:Object(d.a)(Object(d.a)({},Ie),{},{questions:t})}),b(!1)},onCancel:function(){b(!1)},isEditMode:z,isEditQuestion:_,type:P,count:te,totalQuestions:null===Ie||void 0===Ie||null===(c=Ie.questions)||void 0===c?void 0:c.length}),!z&&!ke&&Object(oa.jsx)(Yn.a,{className:"pr-2 d-flex justify-content-end",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover",onClick:function(){var e=Object(C.a)(Ne),t=Ne.findIndex(function(e){return e._id===Ie._id});P===I.Survey?t>=0?e.splice(t,1,Object(d.a)(Object(d.a)({},Ie),{},{name:Pe,questions:Ie.questions})):e.splice(t,0,Object(d.a)(Object(d.a)({},Ie),{},{name:Pe,questions:Ie.questions})):P===I.ExtendedBio&&(t>=0?e.splice(t,1,{_id:Ie._id,name:Ie.name,permissions:Ne[t].permissions,extendedBio:Ie.questions}):e.splice(t,0,{_id:Ie._id,name:Ie.name,permissions:Ne[t].permissions,extendedBio:Ie.questions}));var n="";if(P===I.Survey)w(!0),n="Survey added successfully",o.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,Le(Fe("userId"),"replace","$..admin.survey.items",e),p.UpdateSurveyQuestion,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,p.UpdateSurveyQuestion,function(e){w(!1),Lt(n,"successs","TOP_CENTER",1e3)});else if(P!==I.ExtendedBio||z){if(P===I.Vehicle){var a=null===Ie||void 0===Ie?void 0:Ie.questions;w(!0),n="Vehicle extended added successfully",o.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,Le(Fe("userId"),"replace","$..admin.vehicleSettings.extendedBio",a),p.UpdateSurveyQuestion,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,p.UpdateSurveyQuestion,function(e){w(!1),Lt(n,"successs","TOP_CENTER",1e3)})}}else w(!0),n="Extended Bio added successfully",o.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,Le(Fe("userId"),"replace","$..admin.role",e),x.UpdateRoleBio,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,x.UpdateRoleBio,function(e){w(!1),Lt(n,"successs","TOP_CENTER",1e3)})},children:"Publish"})}),z&&!ke&&Object(oa.jsx)(Yn.a,{className:"d-flex justify-content-end",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover",onClick:function(){P===I.ExtendedBio&&(w(!0),o.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,Le(Mt("uId"),"replace",Ya(Mt("cudbServiceId")),Object(C.a)(Ie.questions)),x.UpdateUserBio,Mt("cudbServiceId")),o.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(e){w(!1),Lt("Extended Bio Updated.","successs","TOP_CENTER",1e3)})),P===I.Survey&&ze()},loading:he,children:"Submit"})})]})},Ka=n(26),Za=n(1040),Xa=n(1036),ei=n(1033),ti=n(317),ni=n(320),ai=function(e){var t=e.value,n=e.placeholder,i=e.onChange,c=Object(a.useState)(""),o=Object(u.a)(c,2),l=o[0],s=o[1],r=Object(a.useState)(""),d=Object(u.a)(r,2),v=d[0],b=d[1],j=Object(a.useState)([]),m=Object(u.a)(j,2),p=m[0],O=m[1],f=Object(a.useState)(!1),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)(!1),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)({lat:37.7749,lng:-122.4194}),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(a.useRef)(null),R=Object(a.useState)(null),P=Object(u.a)(R,2),D=(P[0],P[1]),A=Object(a.useState)(null),M=Object(u.a)(A,2),L=(M[0],M[1]);Object(a.useEffect)(function(){if(t){var e,n,a=(null===(e=t.value)||void 0===e||null===(n=e.attributes)||void 0===n?void 0:n.address)||t.label;s(a),b(a),t.value.coordinates&&w({lat:t.value.coordinates.lat,lng:t.value.coordinates.long})}},[t]),Object(a.useEffect)(function(){l?(new window.google.maps.places.AutocompleteService).getPlacePredictions({input:l},function(e){return O(e||[])}):O([])},[l]),Object(a.useEffect)(function(){if(S){var e=new window.google.maps.Map(E.current,{center:C,zoom:15}),t=new window.google.maps.Marker({position:C,map:e,draggable:!0});return t.addListener("dragend",function(){var e=t.getPosition();e&&w({lat:e.lat(),lng:e.lng()})}),D(e),L(t),function(){t.setMap(null)}}},[S,C]);var U=Object(oa.jsx)(ti.a,{children:p.map(function(e){return Object(oa.jsx)(ti.a.Item,{onClick:function(){return t=e.place_id,void new window.google.maps.places.PlacesService(document.createElement("div")).getDetails({placeId:t},function(e,n){if(n===window.google.maps.places.PlacesServiceStatus.OK&&e){var a,c,o,l,r,d,u,v,j,m={address:e.formatted_address||"",zip:"",city:"",state:"",country:""};null===(a=e.address_components)||void 0===a||a.forEach(function(e){e.types.includes("postal_code")&&(m.zip=e.short_name),e.types.includes("locality")&&(m.city=e.short_name),e.types.includes("administrative_area_level_1")&&(m.state=e.short_name),e.types.includes("country")&&(m.country=e.long_name)});var p={label:e.formatted_address||"",value:{place_id:t,coordinates:{lat:(null===(c=e.geometry)||void 0===c||null===(o=c.location)||void 0===o?void 0:o.lat())||0,long:(null===(l=e.geometry)||void 0===l||null===(r=l.location)||void 0===r?void 0:r.lng())||0},attributes:m}};s(m.address),b(m.address),null===i||void 0===i||i(p),w({lat:(null===(d=e.geometry)||void 0===d||null===(u=d.location)||void 0===u?void 0:u.lat())||0,lng:(null===(v=e.geometry)||void 0===v||null===(j=v.location)||void 0===j?void 0:j.lng())||0}),x(!1)}});var t},children:e.description},e.place_id)})});return Object(oa.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[Object(oa.jsx)(ni.a,{overlay:U,visible:g&&p.length>0,placement:"bottomLeft",children:Object(oa.jsx)(Wn.a,{value:l,placeholder:n,onChange:function(e){return function(e){return s(e)}(e.target.value)},onFocus:function(){return x(!0)},onBlur:function(){return setTimeout(function(){return x(!1)},200)}})}),Object(oa.jsx)(Vn.a,{className:"ml-2 beam-btn",onClick:function(){return N(!0)},children:"Map"}),Object(oa.jsxs)($n.a,{title:"Select Location on Map",visible:S,onCancel:function(){return N(!1)},footer:null,children:[Object(oa.jsx)(Wn.a,{value:v,placeholder:"Enter address",onChange:function(e){return b(e.target.value)},style:{margin:"10px 0"}}),Object(oa.jsx)("div",{ref:E,style:{width:"100%",height:"400px"}}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{type:"primary",block:!0,onClick:function(){var e={label:v,value:{place_id:"",coordinates:{lat:C.lat,long:C.lng},attributes:{address:v}}};s(v),null===i||void 0===i||i(e),N(!1)},className:"beam-btn green-btn",children:"Confirm"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{block:!0,onClick:function(){return N(!1)},className:"beam-btn",children:"Cancel"})})]})]})]})},ii=function(e){var t=e.value,n=void 0===t?void 0:t,a=e.placeholder,i=e.onChange;return Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:a}),Object(oa.jsx)(Yn.a,{className:"mt-3 w-100",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)(Yn.a,{className:"d-flex",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover w-full ".concat("Yes"===n?"btn-selected green":""),onClick:function(){i("Yes")},children:"Yes"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover w-full ".concat("No"===n?"btn-selected red":""),onClick:function(){i("No")},children:"No"})})]})})})]})},ci=function(e){var t=e.value,n=void 0===t?void 0:t,a=e.placeholder,i=e.onChange;return Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:a}),Object(oa.jsx)(Yn.a,{className:"w-100 mt-3",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsxs)(Yn.a,{className:"d-flex mb-4",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover w-full ".concat("Yes"===n?"btn-selected green":""),onClick:function(){i("Yes")},children:"Yes"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover w-full ".concat("Maybe"===n?"btn-selected amber":""),onClick:function(){i("Maybe")},children:"Maybe"})})]}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover w-full ".concat("No"===n?"btn-selected red":""),onClick:function(){i("No")},children:"No"})})})]})})]})},oi=function(e,t,n){if(null!==t&&void 0!==t&&t[n])return null===e||void 0===e?void 0:e.find(function(e){return e.sectionName===(null===t||void 0===t?void 0:t[n])})},li=function(e){var t,n=e.value,a=void 0===n?void 0:n,c=e.placeholder,o=e.isMulti,l=e.options,s=e.onChange,r=e.conditionalSections,d=e.fieldSections,u=e.projects,v=e.addOtherLocation,b=e.onProjectChange,j=e.onCustomerSearch,m=e.adminRoles,p=e.customerDisabled,O=e.dispatchDisabled,f=e.socket,h=function(e){var t,n,c,o=Array.isArray(a)?a.findIndex(function(t){return(null===t||void 0===t?void 0:t.option)===e}):-1;return null!==a&&void 0!==a&&null!==(t=a[o])&&void 0!==t&&t.conditional?Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("br",{}),null===a||void 0===a||null===(n=a[o])||void 0===n||null===(c=n.conditional)||void 0===c?void 0:c.Rows.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:t>0?"mt-3 w-100":"w-100",children:Object(oa.jsx)(i.a.Fragment,{children:!e.isMulti&&(null===e||void 0===e?void 0:e.Cols.map(function(e,t){var n;return Object(oa.jsx)(Hn.a,{span:e.ColSize,className:"",xs:24,sm:e.ColSize,children:Object(oa.jsx)(dc,{data:e,projects:u,addOtherLocation:v,onProjectChange:b,onCustomerSearch:j,adminRoles:m,customerDisabled:p,dispatchDisabled:O,conditionalSections:r,conditionalParentName:null===a||void 0===a||null===(n=a[o])||void 0===n?void 0:n.timestamp,socket:f})},t)}))})},t)}),Object(oa.jsx)("br",{})]}):Object(oa.jsx)(i.a.Fragment,{})};return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("span",{className:"col-label",children:c}),Object(oa.jsx)("div",{className:"tiles padding-12",children:Object(oa.jsx)(Yn.a,{className:"w-100",children:Object(oa.jsx)(Hn.a,{span:24,children:o?Object(oa.jsx)("div",{className:"d-flex flex-column align-items-start",children:l.map(function(e,t){return Object(oa.jsxs)(i.a.Fragment,{children:[console.log("=-=-=-=-=-=-=-=-=MultipleChoiceInput checked value:",a,"option:",e),Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",checked:Array.isArray(a)&&a.findIndex(function(t){return(null===t||void 0===t?void 0:t.option)===e})>-1,name:e,onChange:function(n){console.log("option",e);var i=Object(C.a)(a||[]),c=null===i||void 0===i?void 0:i.findIndex(function(t){return(null===t||void 0===t?void 0:t.option)===e});-1===c?s([].concat(Object(C.a)(i),[{option:e,conditional:oi(r,d,t),timestamp:(new Date).getTime().toString()}])):(i.splice(c,1),s(i))},children:e},e),h(e)]})})}):Object(oa.jsxs)(i.a.Fragment,{children:[l.map(function(e,t){return Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",checked:e===(null===a||void 0===a?void 0:a.option)||e===a,name:e,onChange:function(n){var a;null!==d&&void 0!==d&&d[t]?a=null===r||void 0===r?void 0:r.find(function(e){return e.sectionName===(null===d||void 0===d?void 0:d[t])}):a=void 0;s({option:e,conditional:a,timestamp:(new Date).getTime().toString()})},children:e},e)}),(null===a||void 0===a?void 0:a.conditional)&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("br",{}),null===a||void 0===a||null===(t=a.conditional)||void 0===t?void 0:t.Rows.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:t>0?"mt-3":"",children:Object(oa.jsx)(i.a.Fragment,{children:!e.isMulti&&(null===e||void 0===e?void 0:e.Cols.map(function(e,t){return Object(oa.jsx)(Hn.a,{span:e.ColSize,className:"",xs:24,sm:e.ColSize,children:Object(oa.jsx)(dc,{data:e,projects:u,addOtherLocation:v,onProjectChange:b,onCustomerSearch:j,adminRoles:m,customerDisabled:p,dispatchDisabled:O,conditionalSections:r,conditionalParentName:null===a||void 0===a?void 0:a.timestamp,socket:f})},t)}))})},t)})]})]})})})})]})},si=function(e){var t=e.value,n=e.placeholder,c=(e.options,e.onChange),o=(e.socket,e.disabled),l=void 0!==o&&o,s=Object(a.useState)(1),r=Object(u.a)(s,2),v=r[0],b=(r[1],Object(a.useState)(t||[{name:"",relation:"",dateOfBirth:""}])),j=Object(u.a)(b,2),m=j[0],p=j[1];return Object(a.useEffect)(function(){t&&p(t)},[t]),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("span",{className:"col-label",children:n}),Object(oa.jsxs)(Yn.a,{className:"tiles",children:[$.a.times((null===m||void 0===m?void 0:m.length)||v,function(e){var t,n,a,i;return Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:6,className:"mb-3",children:Object(oa.jsx)(Wn.a,{disabled:l,value:null===(t=m[e])||void 0===t?void 0:t.name,className:"beam-input",placeholder:"Family member name",onChange:function(t){var n=Object(C.a)(m);n[e]=Object(d.a)(Object(d.a)({},n[e]),{},{name:t.target.value}),p(n),c(n)}})},"name-".concat(e)),Object(oa.jsx)(Hn.a,{span:2,className:"d-flex justify-content-center",children:Object(oa.jsx)(Fa.a,{style:{fontSize:"18px",color:"#555"}})}),Object(oa.jsx)(Hn.a,{span:6,className:"mb-3",children:Object(oa.jsx)(Wn.a,{disabled:l,value:null===(n=m[e])||void 0===n?void 0:n.relation,placeholder:"Enter Relation",className:"beam-input",onChange:function(t){var n=Object(C.a)(m);n[e]=Object(d.a)(Object(d.a)({},n[e]),{},{relation:t.target.value}),p(n),c(n)}})},"relation-".concat(e)),Object(oa.jsx)(Hn.a,{span:6,className:"ml-2 mb-3",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png"}),Object(oa.jsx)(Jn.a,{disabled:l,value:null!==(a=m[e])&&void 0!==a&&a.dateOfBirth?H()(null===(i=m[e])||void 0===i?void 0:i.dateOfBirth,"MM/DD/YYYY HH:mm:ss"):void 0,onChange:function(t){var n=Object(C.a)(m);n[e]=Object(d.a)(Object(d.a)({},n[e]),{},{dateOfBirth:null===t||void 0===t?void 0:t.format("MM/DD/YYYY HH:mm:ss")}),p(n),c(n)},placeholder:"Date of birth",suffixIcon:Object(oa.jsx)(aa.a,{})})]})},"dateOfBirth-".concat(e)),!l&&Object(oa.jsx)(Hn.a,{span:2,className:"t-right pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){if(m.length>1){var t=Object(C.a)(m);t.splice(e,1),p(t),c(t)}},children:Object(oa.jsx)(na.a,{})})})]})})}),!l&&Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){var e=[].concat(Object(C.a)(m),[{name:"",relation:""}]);p(e),c(e)},children:"Add"})})]})]})},ri=function(e){var t=e.value,n=void 0===t?void 0:t,i=e.placeholder,c=e.options,o=e.onChange,l={marginLeft:10,fontSize:"medium"},s=Object(a.useState)({options:[c[0],c[1],c[2]],value:n}||{options:[100,0,5],value:0}),r=Object(u.a)(s,2),d=r[0],v=r[1];return Object(a.useEffect)(function(){v({options:[c[0],c[1],c[2]],value:n})},[]),Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:i}),Object(oa.jsx)(Yn.a,{className:"mt-2 w-100",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ea.a,{marks:Object(T.a)(Object(T.a)({},d.options[1],{style:l,label:Object(oa.jsx)("strong",{children:d.options[1]})}),d.options[0],{style:l,label:Object(oa.jsx)("strong",{children:d.options[0]})}),value:n,max:d.options[0],min:d.options[1],step:d.options[2],onChange:function(e){o(e)}})})})]})},di=function(e){var t=e.value,n=void 0===t?void 0:t,a=e.placeholder,i=e.onChange,c=e.disabled,o=void 0!==c&&c;return Object(oa.jsx)(Jn.a,{inputReadOnly:!1,format:"MM/DD/YYYY",value:n?H()(n,"MM/DD/YYYY HH:mm:ss"):void 0,onChange:function(e){i(null===e||void 0===e?void 0:e.format("MM/DD/YYYY HH:mm:ss"))},disabled:o,placeholder:a,suffixIcon:Object(oa.jsx)(aa.a,{})})},ui=n(1054),vi=function(e){var t=e.value,n=e.onChange,i=e.placeholder,c=e.isMobile,o=e.onUploadClick,l=(e.name,Object(a.useState)(t)),r=Object(u.a)(l,2),v=(r[0],r[1],Object(a.useState)([])),b=Object(u.a)(v,2),j=b[0],m=b[1],p=Object(a.useState)([]),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(s.b)(),x=Object(s.c)(function(e){return e.auth}).fileToSend,y=Object(a.useState)(!1),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)(),T=Object(u.a)(k,2),w=T[0],E=T[1],R=Object(a.useState)(0),P=Object(u.a)(R,2),D=P[0],A=P[1];Object(a.useEffect)(function(){if(x&&w===x.id){console.log("file to send",x);var e=Object(d.a)({name:x.media.originalName,url:x.media.urls.original.url},x.media),t=Object(C.a)(f);t.push(e),h(t);var a=D+1;A(a),a===j.length&&(N(!1),n({files:t}),m([]),g({type:"ADD_FILE",payload:void 0}))}},[g,x,n,w]);Object(a.useEffect)(function(){console.log("value",t),null!==t&&void 0!==t&&t.files&&h(null===t||void 0===t?void 0:t.files)},[t]);var M={onRemove:function(e){m(function(t){var n=t.indexOf(e),a=t.slice();return a.splice(n,1),a})},beforeUpload:function(e){return m(function(t){return[].concat(Object(C.a)(t),[e])}),!1},fileList:j};return Object(oa.jsx)(Yn.a,{className:"custom-file-upload",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("div",{children:c?Object(oa.jsx)("div",{className:"file-wrapper",children:Object(oa.jsx)("div",{className:"d-flex flex-column justify-content-center align-items-center p-4 cursor-pointer",onClick:function(){o&&o()},children:Object(oa.jsx)("p",{children:"Click to upload file"})})}):Object(oa.jsx)(ma.a,Object(d.a)(Object(d.a)({},M),{},{showUploadList:!0,multiple:!0,children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("div",{children:i||"Drop your file here (or click)"}),Object(oa.jsxs)("div",{className:"d-flex row justify-content-center",style:{padding:0},children:[Object(oa.jsx)(Vn.a,{className:"beam-btn cover",icon:Object(oa.jsx)(ui.a,{}),children:"Select file"}),j.length>0&&Object(oa.jsx)(Vn.a,{className:"beam-btn cover ml-3",onClick:function(e){e.stopPropagation(),console.log("file list here",j);var t=Object(B.uuid)();E(t),A(0),j.map(function(e){var n=new FormData;n.append("file",e),n.append("info",JSON.stringify({})),g(ye({form:n,id:t}))}),N(!0)},loading:S,children:S?"Uploading":"Start Upload"})]})]})}))}),(null===f||void 0===f?void 0:f.length)>0&&Object(oa.jsxs)("div",{className:"file-wrapper1",children:[Object(oa.jsx)("p",{children:"Your uploaded files:"}),Object(oa.jsx)("ul",{children:null===f||void 0===f?void 0:f.map(function(e,t){return Object(oa.jsxs)("li",{children:[Object(oa.jsx)("a",{target:"_blank",href:e.url,rel:"noreferrer",children:e.name}),Object(oa.jsx)(pa.a,{onClick:function(){return function(e){var t=f.slice();t.splice(e,1),h(t),n({files:t})}(t)}})]})})})]})]})})},bi=Gn.a.Option,ji=function(e){var t,n=e.value,i=e.placeholder,c=e.onChange,o=Object(s.c)(function(e){return e.auth}),l=o.projects,r=o.assets_filter,d=Object(a.useState)(0),v=Object(u.a)(d,2),b=v[0],j=v[1],m=Object(a.useState)(!1),p=Object(u.a)(m,2),O=p[0],f=p[1],h=Object(a.useState)(!0),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(a.useState)([]),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(s.b)(),w=function(e){j(e),f(!0);var t={objectType:"asset",select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@userType:{'fixedAsset'}@serviceId:{'".concat(z(null===l||void 0===l?void 0:l.userServiceId),"'}"),searchOptions:"TIMEOUT 1000"},load:{objectId:"$.objectId",persistent:"$.persistent",latitude:"$.persistent.static.fixedAsset.location.coordinates.lat",longitude:"$.persistent.static.fixedAsset.location.coordinates.long"}},apply:{expression:"",name:""},result:{pagination:{offset:50*e,limit:50}},filter:{expression:"exists(@latitude) && @latitude !== 0"},anyStatus:!1};T({type:"GET_MAP_PLACES",payload:t}),f(!0)};return Object(a.useEffect)(function(){if(r){f(!1);var e=null===r||void 0===r?void 0:r.map(function(e){return{id:e.id,name:e.name,obj:e}}).filter(function(e){return!N.find(function(t){return e.id===t.id})});k([].concat(Object(C.a)(N),Object(C.a)(e))),0===e.length&&y(!1)}},[r]),Object(oa.jsx)(Gn.a,{showSearch:!0,value:null===n||void 0===n?void 0:n.id,className:"w-full",placeholder:i,onChange:function(e){var t=N.find(function(t){return t.id===e});c({id:e,type:"fixed-asset",asset:t.obj})},loading:O,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},onFocus:function(){var e;0===(null!==(e=null===r||void 0===r?void 0:r.length)&&void 0!==e?e:0)&&w(0)},onSearch:function(e){t&&clearTimeout(t),t=setTimeout(function(){e&&""!==e?(w(0,e),y(!1)):w(0)},500)},onPopupScroll:function(e){e.persist();var t=e.target;t.scrollTop+t.offsetHeight===t.scrollHeight&&x&&w(b+1)},children:null===N||void 0===N?void 0:N.map(function(e,t){return Object(oa.jsx)(bi,{value:e.id,children:e.name},t)})})},mi=function(e){var t,n,a,c,o,l,s,r,u,v=e.avatar,b=e.onClick,j=e.user,m=e.value;return Object(oa.jsxs)(Yn.a,{className:"person-item d-flex mt-2",style:{backgroundColor:"".concat((null===m||void 0===m?void 0:m.value)===j.id?"#f5f5f5":"#fff"),cursor:"pointer",boxShadow:"0px 0px 15px 0px rgba(223, 229, 238, 1)"},onClick:function(){b(null===j||void 0===j?void 0:j.obj)},children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("img",{width:"40",src:v})}),Object(oa.jsxs)(Hn.a,{span:14,children:[Object(oa.jsxs)("h5",{children:[null===j||void 0===j||null===(t=j.obj)||void 0===t?void 0:t.firstName," ",null===j||void 0===j||null===(n=j.obj)||void 0===n?void 0:n.lastName]}),Object(oa.jsxs)("p",{children:["Email: ",null!==(a=null===j||void 0===j||null===(c=j.obj)||void 0===c?void 0:c.email)&&void 0!==a?a:"N/A"]}),Object(oa.jsxs)("p",{children:["Phone: ",null!==(o=null===j||void 0===j||null===(l=j.obj)||void 0===l?void 0:l.phone)&&void 0!==o?o:"N/A"]})]}),Object(oa.jsx)(Hn.a,{}),Array.isArray(null===j||void 0===j||null===(s=j.obj)||void 0===s?void 0:s.extendedBio)&&(null===j||void 0===j||null===(r=j.obj)||void 0===r||null===(u=r.extendedBio)||void 0===u?void 0:u.map(function(e){var t,n,a,c,o,l,s,r,u,v,p;return Object(oa.jsxs)(i.a.Fragment,{children:["category"===(null===e||void 0===e?void 0:e.type)&&Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("h5",{children:"Service categories:"}),Object(oa.jsx)("p",{children:(null===e||void 0===e||null===(t=e.value)||void 0===t?void 0:t.toString())||"N/A"})]}),"calendar"===(null===e||void 0===e?void 0:e.type)&&Object(oa.jsxs)(Hn.a,{span:24,className:"mt-2",children:[Object(oa.jsx)("h5",{children:"Availability:"}),0===((null===e||void 0===e||null===(n=e.value)||void 0===n||null===(a=n.options)||void 0===a?void 0:a.length)||0)&&Object(oa.jsx)("p",{children:"N/A"}),null===e||void 0===e||null===(c=e.value)||void 0===c||null===(o=c.options)||void 0===o?void 0:o.map(function(e){var t,n;return Object(oa.jsxs)("div",{children:[Object(oa.jsx)("p",{children:null===e||void 0===e||null===(t=e.daysOfWeek)||void 0===t?void 0:t.toString()}),null===e||void 0===e||null===(n=e.operationHours)||void 0===n?void 0:n.map(function(e){return Object(oa.jsxs)("p",{children:[null===e||void 0===e?void 0:e.startTime,"-",null===e||void 0===e?void 0:e.endTime]})})]})})]}),"payment"===(null===e||void 0===e?void 0:e.type)&&Object(oa.jsxs)(Hn.a,{span:24,className:"mt-2 d-flex flex-column align-items-start",children:[Object(oa.jsx)("h5",{children:"Payment charges:"}),0===((null===e||void 0===e||null===(l=e.value)||void 0===l||null===(s=l.options)||void 0===s?void 0:s.length)||0)&&Object(oa.jsx)("p",{children:"N/A"}),null===e||void 0===e||null===(r=e.value)||void 0===r||null===(u=r.options)||void 0===u?void 0:u.map(function(e,t){var n;return Object(oa.jsxs)(Xn.a,{className:"mb-2 ml-0",checked:(null===m||void 0===m?void 0:m.value)===j.id&&(null===e||void 0===e?void 0:e.price)===(null===m||void 0===m||null===(n=m.selectedPayment)||void 0===n?void 0:n.price),name:null===e||void 0===e?void 0:e.price,onChange:function(t){b(Object(d.a)(Object(d.a)({},null===j||void 0===j?void 0:j.obj),{},{selectedPayment:e}))},children:[e.title," - ",e.price," USD"]},null===e||void 0===e?void 0:e.price)}),null===e||void 0===e||null===(v=e.value)||void 0===v||null===(p=v.options)||void 0===p?void 0:p.map(function(e){var t,n;return Object(oa.jsxs)("div",{children:[Object(oa.jsx)("p",{children:null===e||void 0===e||null===(t=e.daysOfWeek)||void 0===t?void 0:t.toString()}),null===e||void 0===e||null===(n=e.operationHours)||void 0===n?void 0:n.map(function(e){return Object(oa.jsxs)("p",{children:[null===e||void 0===e?void 0:e.startTime,"-",null===e||void 0===e?void 0:e.endTime]})})]})})]}),"section-document"===(null===e||void 0===e?void 0:e.type)&&Object(oa.jsx)(Hn.a,{span:24,className:"mt-2",children:Object(oa.jsx)("a",{href:null===e||void 0===e?void 0:e.value,target:"_blank",rel:"noreferrer",children:null===e||void 0===e?void 0:e.label})})]})}))]})},pi=function(e){var t=e.value,n=(e.placeholder,e.onChange),i=e.adminRoles,c=(e.multiple,Object(s.c)(function(e){return e.auth})),o=c.projects,l=c.users_filter,r=c.filterSubCategories,v=Object(a.useState)(0),b=Object(u.a)(v,2),j=b[0],m=b[1],p=Object(a.useState)(!1),O=Object(u.a)(p,2),f=(O[0],O[1]),h=Object(a.useState)(!0),g=Object(u.a)(h,2),x=(g[0],g[1]),y=Object(a.useState)([]),I=Object(u.a)(y,2),S=I[0],N=I[1];Object(a.useEffect)(function(){(null===r||void 0===r?void 0:r.length)>0&&i&&(console.log("subcategories filter",r),k&&clearTimeout(k),k=setTimeout(function(){N([]),n({type:"responder",value:void 0}),w(0,r)},500))},[r,i]);var k,T=Object(s.b)(),w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];m(e),f(!0);var n=i.filter(function(e){return-1!==e.permissions.indexOf("onMove")}).map(function(e){return"@roleId === '".concat(e._id,"'")}),a=t.map(function(e){return"contains(@extendedBioValue, '".concat(e,"')")}),c={objectType:"user",select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===o||void 0===o?void 0:o.userServiceId),"'}"),searchOptions:"TIMEOUT 1000"},load:{email:"$..live.alternativeIds.email",phone:"$..live.alternativeIds.phone",profile:"$..profile",roleId:"$..admin.profile.roleId",extendedBio:"$..extendedBio",extendedBioValue:"$..extendedBio..value"}},groupBy:{properties:["@email","@phone","@profile","@roleId","@extendedBio","@extendedBioValue"],reducers:[{func:"TOLIST",arguments:["@objectId"],name:"objectIds"}]},apply:{expression:"",name:""},result:{pagination:{offset:50*j,limit:50}},filter:{expression:"exists(@roleId) && (".concat(n.join("||"),") && exists(@extendedBioValue) ").concat((null===a||void 0===a?void 0:a.length)>0?"&& (".concat(a.join("||"),")"):"")},anyStatus:!1};T({type:"GET_MAP_PLACES",payload:c}),f(!0)};return Object(a.useEffect)(function(){if(l){f(!1);var e=null===l||void 0===l?void 0:l.map(function(e){return{id:e.id,name:e.name,obj:e}}).filter(function(e){return!S.find(function(t){return e.id===t.id})});N([].concat(Object(C.a)(S),Object(C.a)(e))),0===e.length&&x(!1)}},[l]),Object(oa.jsx)(Yn.a,{className:"mt-3",children:S.map(function(e,a){return Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(mi,{onClick:function(t){n(Object(d.a)({type:"responder",value:e.id},t))},avatar:"/images/users/user.png",user:e,value:t})})})})},Oi=Gn.a.Option,fi=function(e){var t,n,i=e.value,c=e.placeholder,o=e.onChange,l=e.adminRoles,r=e.multiple,v=Object(s.c)(function(e){return e.auth}),b=v.projects,j=v.users_filter,m=Object(a.useState)(0),p=Object(u.a)(m,2),O=p[0],f=p[1],h=Object(a.useState)(!1),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(a.useState)(!0),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(a.useState)(!1),w=Object(u.a)(T,2),E=w[0],R=w[1],P=Object(a.useState)([]),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Object(s.b)(),U=function(e){f(e),y(!0);var t=l.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")}).map(function(e){return"@roleId === '".concat(e._id,"'")}),n={objectType:"user",select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}"),searchOptions:"TIMEOUT 1000"},load:{email:"$..live.alternativeIds.email",phone:"$..live.alternativeIds.phone",beamIds:"$..beamIds",profile:"$..profile",roleId:"$..admin.profile.roleId",extendedBio:"$..extendedBio"}},groupBy:{properties:["@email","@phone","@profile","@roleId","@extendedBio","@beamIds"],reducers:[{func:"TOLIST",arguments:["@objectId"],name:"objectIds"}]},apply:{expression:"",name:""},result:{pagination:{offset:50*O,limit:50}},filter:{expression:"exists(@roleId) && (".concat(t.join("||"),")")},anyStatus:!1};y(!0),L(tt({requestData:n,callback:function(e){y(!1);var t=null===e||void 0===e?void 0:e.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h,g,x,y={id:null===e||void 0===e||null===(t=e.objectIds)||void 0===t?void 0:t.toString(),name:(null===e||void 0===e||null===(n=e.profile)||void 0===n?void 0:n.firstName)+" "+(null===(a=e.profile)||void 0===a?void 0:a.lastName),extendedBio:null===e||void 0===e?void 0:e.extendedBio,extendedBioValue:null===e||void 0===e?void 0:e.extendedBioValue,firstName:null!==(i=null===e||void 0===e||null===(c=e.profile)||void 0===c?void 0:c.firstName)&&void 0!==i?i:"",lastName:null!==(o=null===e||void 0===e||null===(l=e.profile)||void 0===l?void 0:l.lastName)&&void 0!==o?o:"",gender:null!==(s=null===e||void 0===e||null===(r=e.profile)||void 0===r?void 0:r.gender)&&void 0!==s?s:"",dob:null!==(d=null===e||void 0===e||null===(u=e.profile)||void 0===u?void 0:u.dob)&&void 0!==d?d:"",email:e.email,phone:e.phone,beamId:null!==e&&void 0!==e&&null!==(v=e.beamIds)&&void 0!==v&&v[0]?null===e||void 0===e||null===(b=e.beamIds)||void 0===b?void 0:b[0]:"".concat(null===e||void 0===e||null===(j=e.profile)||void 0===j||null===(m=j.firstName)||void 0===m?void 0:m.toLowerCase(),".").concat(null===e||void 0===e||null===(p=e.profile)||void 0===p||null===(O=p.lastName)||void 0===O?void 0:O.toLowerCase()),location:null!==e&&void 0!==e&&null!==(f=e.profile)&&void 0!==f&&null!==(h=f.location)&&void 0!==h&&h.coordinates?{coordinates:[null===e||void 0===e||null===(g=e.profile)||void 0===g?void 0:g.location.coordinates.long,null===e||void 0===e||null===(x=e.profile)||void 0===x?void 0:x.location.coordinates.lat]}:void 0};return{id:y.id,name:y.beamId,obj:y}}).filter(function(e){return!A.find(function(t){return e.id===t.id})});console.log("options",A),M([].concat(Object(C.a)(A),Object(C.a)(t))),R(!0),0===t.length&&k(!1)}}))};return Object(oa.jsx)(Gn.a,{showSearch:!0,mode:r?"multiple":void 0,className:"w-full",value:E?r?null===i||void 0===i?void 0:i.values:null===i||void 0===i?void 0:i.id:r?null===i||void 0===i||null===(t=i.responders)||void 0===t?void 0:t.map(function(e){return null===e||void 0===e?void 0:e.beamId}):null===i||void 0===i?void 0:i.beamId,placeholder:c,allowClear:!0,disabled:void 0===l,onChange:function(e){var t=[];if(r)e.map(function(e){var n=A.find(function(t){return t.id===e});n&&t.push(Object(d.a)({id:e},n.obj))}),o({type:"responder",responders:t,values:e});else{var n,a=A.find(function(t){return t.id===e});o(Object(d.a)(Object(d.a)({type:"responder",value:e},null===a||void 0===a?void 0:a.obj),{},{valueName:null===a||void 0===a||null===(n=a.obj)||void 0===n?void 0:n.name}))}},loading:x,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},onFocus:function(){var e;0===(null!==(e=null===j||void 0===j?void 0:j.length)&&void 0!==e?e:0)&&U(0)},onSearch:function(e){n&&clearTimeout(n),n=setTimeout(function(){e&&""!==e?(U(0,e),k(!1)):U(0)},500)},onPopupScroll:function(e){e.persist();var t=e.target;t.scrollTop+t.offsetHeight===t.scrollHeight&&N&&U(O+1)},children:null===A||void 0===A?void 0:A.map(function(e,t){return Object(oa.jsx)(Oi,{value:e.id,children:e.name},t)})})},hi=(Gn.a.Option,n(19)),gi=function(e){e.beginLimit;var t=e.value,n=e.onChange,i=(e.name,e.disabled),c=e.is12hour,o=e.placeholder,l=Object(a.useState)([]),s=Object(u.a)(l,2),r=(s[0],s[1],Object(a.useState)()),d=Object(u.a)(r,2),v=d[0],b=d[1];return Object(a.useEffect)(function(){},[]),Object(a.useEffect)(function(){if(t){var e;console.log("value",t);var n=hi("".concat(null===(e=hi(new Date))||void 0===e?void 0:e.format("MM/DD/YYYY")," ").concat(t),"MM/DD/YYYY ".concat(c?"h:mm a":"HH:mm"));b(n)}else b(void 0)},[t]),Object(oa.jsx)(Zn.a,{format:c?"h:mm a":"HH:mm",value:v,disabled:i,placeholder:o||"Select time",onChange:function(e){var t;e?n(null===(t=hi(e))||void 0===t?void 0:t.format("MM/DD/YYYY HH:mm")):n(void 0)}})},xi=function(e){e.value;var t=e.onChange,n=Object(a.useState)([]),i=Object(u.a)(n,2),c=i[0],o=i[1],l=Object(a.useState)([]),r=Object(u.a)(l,2),v=r[0],b=r[1],j=Object(s.c)(function(e){return e.auth}),m=j.projects,p=j.project;return Object(a.useEffect)(function(){if(p){var e,t,n,a,i,c=(null===m||void 0===m||null===(e=m.tasks)||void 0===e||null===(t=e[0])||void 0===t?void 0:t[0])||{},l=null===m||void 0===m?void 0:m.projects.find(function(e){return e.id===p}),s=null===(n=Object.keys(c))||void 0===n?void 0:n.find(function(e){return(null===l||void 0===l?void 0:l.taskId)===e}),r=null!==(a=null===c||void 0===c||null===(i=c[s])||void 0===i?void 0:i.subTasks)&&void 0!==a?a:{};o(Object.keys(r).map(function(e){return Object(d.a)({id:e},r[e])})),b([])}},[p]),Object(oa.jsx)(Xn.a.Group,{className:"d-flex flex-column",value:v,onChange:function(e){b(e);var n=e.map(function(e){return c.find(function(t){return t.id===e})});t({type:"task-picker",tasks:n})},children:c.map(function(e,t){return Object(oa.jsxs)(Yn.a,{className:"mb-2",style:{width:"100%"},children:[Object(oa.jsx)(Hn.a,{span:22,className:"pr-2 d-flex",children:Object(oa.jsx)("span",{className:"col-label",children:e.name})}),Object(oa.jsx)(Hn.a,{span:2,className:"pr-2 d-flex justify-content-end",children:Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",value:e.id})})]},t)})})},yi=n(318),Ii=n(60),Si=Gn.a.Option,Ni=Wn.a.TextArea,ki=function(e){var t,n,c,o,l=e.value,s=e.onChange,r=Object(a.useState)({title:"",repeat:!1,repeatAfter:1,repeatFrequency:"daily",repeatEnds:"never",repeatUntil:void 0,date:void 0,time:void 0,notifyTime:void 0,description:"",location:{attributes:{title:void 0,address:void 0},coordinates:void 0}}),v=Object(u.a)(r,2),b=v[0],j=v[1],m=function(e,t){j(function(n){return Object(d.a)(Object(d.a)({},n),{},Object(T.a)({},e,t))});var n=Object(d.a)(Object(d.a)({},b),{},Object(T.a)({},e,t));n.date&&(n.date=new Date(n.date).getTime()),n.time&&(n.time=new Date(n.time).getTime()),n.notifyTime&&(n.notifyTime=new Date(n.notifyTime).getTime()),n.repeatUntil&&(n.repeatUntil=new Date(n.repeatUntil).getTime()),s(n)};return Object(a.useEffect)(function(){if(l){var e=Object(d.a)({},l);e.date&&(e.date=H()(e.date).format("MM/DD/YYYY HH:mm:ss")),e.time&&(e.time=H()(e.time).format("MM/DD/YYYY HH:mm:ss")),e.notifyTime&&(e.notifyTime=H()(e.notifyTime).format("MM/DD/YYYY HH:mm:ss")),e.repeatUntil&&(e.repeatUntil=H()(e.repeatUntil).format("MM/DD/YYYY HH:mm:ss")),j(e)}},[l]),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Wn.a,{value:b.title,onChange:function(e){return m("title",e.target.value)},placeholder:"Event Title"})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Ni,{autoSize:{minRows:4,maxRows:6},placeholder:"Description",value:b.description,onChange:function(e){m("description",e.target.value)}})})}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png"}),Object(oa.jsx)(Jn.a,{value:b.date?H()(b.date,"MM/DD/YYYY HH:mm:ss"):void 0,onChange:function(e){m("date",null===e||void 0===e?void 0:e.format("MM/DD/YYYY HH:mm:ss"))},placeholder:"Date",suffixIcon:Object(oa.jsx)(aa.a,{})})]})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png"}),Object(oa.jsx)(gi,{name:"time",value:b.time?H()(b.time,"MM/DD/YYYY HH:mm:ss"):void 0,onChange:function(e){var t;m("time",null===(t=H()(e))||void 0===t?void 0:t.format("MM/DD/YYYY HH:mm:ss"))}})]})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Xn.a.Group,{options:["Repeat every"],onChange:function(e){m("repeat",-1!==e.indexOf("Repeat every"))},value:b.repeat?["Repeat every"]:[]})}),b.repeat&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{className:"mt-1",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsx)(Wn.a,{value:b.repeatAfter,onChange:function(e){m("repeatAfter",e.target.value)},type:"number",min:1})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsxs)("div",{className:"datetime-item prefix-select-wrapper",children:[Object(oa.jsx)("img",{src:"/images/refresh.png"}),Object(oa.jsxs)(Gn.a,{value:b.repeatFrequency,className:"w-full",placeholder:"Repeat",onChange:function(e){m("repeatFrequency",e)},children:[Object(oa.jsx)(Si,{value:"daily",children:"day"}),Object(oa.jsx)(Si,{value:"weekly",children:"week"}),Object(oa.jsx)(Si,{value:"monthly",children:"month"})]})]})})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("span",{className:"ant-checkbox-wrapper",children:"Ends"})}),Object(oa.jsxs)(yi.a.Group,{value:b.repeatEnds,onChange:function(e){m("repeatEnds",e.target.value)},className:"plain-radios",children:[Object(oa.jsx)(yi.a,{value:"never",className:"green-radio",children:"Never"}),Object(oa.jsx)(yi.a,{value:"on",className:"green-radio",children:"On"})]}),"on"===b.repeatEnds&&Object(oa.jsx)("div",{className:"datetime-item mt-1",children:Object(oa.jsx)(Jn.a,{value:b.repeatUntil?H()(b.repeatUntil,"MM/DD/YYYY HH:mm:ss"):void 0,onChange:function(e){m("repeatUntil",null===e||void 0===e?void 0:e.format("MM/DD/YYYY HH:mm:ss"))},placeholder:"Date",suffixIcon:Object(oa.jsx)(aa.a,{})})})]})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/warning.png"}),Object(oa.jsx)(gi,{name:"Notify Time",value:b.notifyTime?H()(b.notifyTime,"MM/DD/YYYY HH:mm:ss"):void 0,onChange:function(e){var t;m("notifyTime",null===(t=H()(e))||void 0===t?void 0:t.format("MM/DD/YYYY HH:mm:ss"))}})]})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Gn.a,{value:b.notifyVia,className:"w-full",placeholder:"Notify via",onChange:function(e){m("notifyVia",e)},options:[{label:"Push",value:"Push"},{label:"SMS",value:"SMS"},{label:"Email",value:"Email"}]})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)("div",{className:"datetime-item prefix-select-wrapper",children:[Object(oa.jsx)("img",{src:"/images/location.png"}),Object(oa.jsx)(Ii.a,{autocompletionRequest:{},selectProps:{value:null!==b&&void 0!==b&&null!==(t=b.location)&&void 0!==t&&null!==(n=t.attributes)&&void 0!==n&&null!==(c=n.value)&&void 0!==c&&c.place_id?null===b||void 0===b||null===(o=b.location)||void 0===o?void 0:o.attributes:void 0,onChange:function(e){Object(Ii.b)(e.value.place_id).then(function(t){if(t[0].geometry){var n={attributes:Object(d.a)(Object(d.a)({},e),{},{address:e.label}),coordinates:{lat:t[0].geometry.location.lat(),long:t[0].geometry.location.lng()}};m("location",n)}}).catch(function(e){return console.error(e)})},isClearable:!0,placeholder:"Search map",styles:{input:function(e){return Object(d.a)(Object(d.a)({},e),{},{fontFamily:"Nunito-Regular"})},control:function(){return{backgroundColor:"hsl(218deg 33% 95%)",display:"flex"}},container:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{width:"100%"})},placeholder:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{color:"#000",fontSize:16,padding:8})},singleValue:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{color:"#000",fontSize:16,padding:8})}}},apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"})]})})})]})},Ti=n(19),Ci=(Gn.a.Option,function(e){var t=e.value,n=e.placeholder,c=e.onChange,o=e.dispatchOptions,l=e.disabled,s=e.is12hour,r=Object(a.useState)(o||[{id:"immediate",name:"Immediate"},{id:"schedule",name:"Schedule"},{id:"deadline",name:"Deadline"}]),d=Object(u.a)(r,2),v=d[0];d[1];return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)("div",{className:"d-flex flex-column justify-content-start align-items-start",children:[Object(oa.jsx)("div",{className:"ant-col ant-form-item-label",children:Object(oa.jsx)("label",{className:"ant-form-item-required",children:n})}),Object(oa.jsx)(yi.a.Group,{value:null===t||void 0===t?void 0:t.value,onChange:function(e){c({value:e.target.value,type:"dispatchType"})},children:null===v||void 0===v?void 0:v.map(function(e,t){return Object(oa.jsx)(yi.a,{value:e.id,children:e.name})})}),t&&"immediate"!==(null===t||void 0===t?void 0:t.value)&&Object(oa.jsxs)(Yn.a,{className:"mt-3 w-100",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png",alt:""}),Object(oa.jsx)(di,{placeholder:"Select date",value:null===t||void 0===t?void 0:t.date,disabled:l,onChange:function(e){c({value:null===t||void 0===t?void 0:t.value,type:"dispatchType",date:e,time:null===t||void 0===t?void 0:t.time})}})]})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png",alt:""}),Object(oa.jsx)(gi,{name:"Select time",disabled:l,value:null!==t&&void 0!==t&&t.time?Ti(null===t||void 0===t?void 0:t.time).format(s?"h:mm a":"HH:mm"):void 0,onChange:function(e){console.log("time here",e),c({value:null===t||void 0===t?void 0:t.value,type:"dispatchType",date:null===t||void 0===t?void 0:t.date,time:e})},is12hour:s})]})})]})]})})}),wi=Gn.a.Option,Ei=function(e){var t=e.value,n=(e.placeholder,e.onChange),c=Object(a.useState)([{id:"email",name:"Email"},{id:"sms",name:"SMS"}]),o=Object(u.a)(c,2),l=o[0],s=(o[1],Object(a.useState)([{id:"5",name:"5 min"},{id:"10",name:"10 min"},{id:"15",name:"15 min"},{id:"30",name:"30 min"},{id:"45",name:"45 min"},{id:"60",name:"60 min"},{id:"custom",name:"Custom"}])),r=Object(u.a)(s,2),d=r[0];r[1];return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsx)(Gn.a,{showSearch:!0,value:null===t||void 0===t?void 0:t.notifyVia,className:"w-full",placeholder:"Notify via",allowClear:!0,onChange:function(e){void 0===e&&void 0===(null===t||void 0===t?void 0:t.notifyTime)?n(void 0):n({notifyVia:e,notifyTime:null===t||void 0===t?void 0:t.notifyTime,customTime:null===t||void 0===t?void 0:t.customTime,type:"notifyType"})},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===l||void 0===l?void 0:l.map(function(e,t){return Object(oa.jsx)(wi,{value:e.id,children:e.name},t)})})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Gn.a,{showSearch:!0,allowClear:!0,value:null===t||void 0===t?void 0:t.notifyTime,className:"w-full",placeholder:"Notify time",onChange:function(e){void 0===e&&void 0===(null===t||void 0===t?void 0:t.notifyVia)?n(void 0):n({notifyVia:null===t||void 0===t?void 0:t.notifyVia,notifyTime:e,customTime:"custom"===e?0:void 0,type:"notifyType"})},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===d||void 0===d?void 0:d.map(function(e,t){return Object(oa.jsx)(wi,{value:e.id,children:e.name},t)})})}),"custom"===(null===t||void 0===t?void 0:t.notifyTime)&&Object(oa.jsx)(Hn.a,{span:24,className:"mt-3",children:Object(oa.jsx)(la,{placeholder:"Enter notify time",value:null===t||void 0===t?void 0:t.customTime,onChange:function(e){n({notifyVia:null===t||void 0===t?void 0:t.notifyVia,notifyTime:"custom",customTime:e,type:"notifyType"})}})})]})})},Ri=n(553),Pi=n(306),Di=n(524),Ai=n(525),Mi=n(542),Li=function(e){var t=e.onChange,n=e.value,i=e.placeholder,c=e.socket,o=Object(a.useRef)(null),l=Object(a.useState)({start:new Date}),r=Object(u.a)(l,2),v=r[0],b=(r[1],Object(a.useState)("00:30:00")),j=Object(u.a)(b,2),p=j[0],O=j[1],f=Object(a.useState)([]),h=Object(u.a)(f,2),x=h[0],I=h[1],S=Object(a.useState)("dayGridMonth"),N=Object(u.a)(S,2),T=N[0],w=N[1],E=Object(a.useState)([]),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)([]),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(),F=Object(u.a)(q,2),B=F[0],_=F[1],$=Object(s.c)(function(e){return e.auth}),Y=$.selectedResponders,W=$.projects,V=$.project,z=Object(a.useState)(),Q=Object(u.a)(z,2),G=Q[0],J=Q[1],K=Mn().getUserRequestPayload;Object(a.useEffect)(function(){if(V&&G){var e,n,a,i,c,o=null===W||void 0===W||null===(e=W.projects)||void 0===e?void 0:e.find(function(e){return e.id===V}),l=null===G||void 0===G?void 0:G[null===(n=Object.keys(G||{}))||void 0===n||null===(a=n.filter(function(e){var t;return(null===o||void 0===o?void 0:o.calendarIds)&&-1!==(null===o||void 0===o||null===(t=o.calendarIds)||void 0===t?void 0:t.indexOf(e))}))||void 0===a?void 0:a[0]];if(console.log("selected calenda",l),l)l=Object(d.a)(Object(d.a)({},l),{},{options:null===(i=l)||void 0===i||null===(c=i.operationConfig)||void 0===c?void 0:c.map(function(e){var t;return{daysOfWeek:null===e||void 0===e?void 0:e.daysOfTheWeek,operationHours:null===e||void 0===e||null===(t=e.operationHours)||void 0===t?void 0:t.map(function(e){return{startTime:H()(null===e||void 0===e?void 0:e.startTime).format("HH:mm"),endTime:H()(null===e||void 0===e?void 0:e.endTime).format("HH:mm")}})}})});_(l),l||(t(void 0),U([]),D([]),I([]))}},[V,G]),Object(a.useEffect)(function(){if(Y){var e,n,a,i=null===Y||void 0===Y||null===(e=Y[0])||void 0===e?void 0:e.extendedBio;null===i||void 0===i||null===(n=i.map)||void 0===n||n.call(i,function(e){"calendar"===(null===e||void 0===e?void 0:e.type)&&(a=null===e||void 0===e?void 0:e.value)}),_(a),a||(t(void 0),U([]),D([]),I([]))}},[Y]);Object(a.useEffect)(function(){n&&(n.start&&n.end&&U([{title:"Selected timeslot",start:new Date(n.start),end:new Date(n.end)}]),null!==n&&void 0!==n&&n.setting&&_(null===n||void 0===n?void 0:n.setting))},[n]);var Z=function(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(0),e.setMilliseconds(0),e};return Object(a.useEffect)(function(){if(B){O(function(e){var t=e%60,n=Math.floor(e/60).toString().padStart(2,"0"),a=t.toString().padStart(2,"0");return"".concat(n,":").concat(a,":").concat("00")}(null===B||void 0===B?void 0:B.appointmentDuration));var e=[],t=[];null===B||void 0===B||B.options.map(function(e){var n;t=[].concat(Object(C.a)(t),Object(C.a)(null===e||void 0===e||null===(n=e.daysOfWeek)||void 0===n?void 0:n.map(function(e){return e.toLowerCase()})))}),[{name:"monday",day:1},{name:"tuesday",day:2},{name:"wednesday",day:3},{name:"thursday",day:4},{name:"friday",day:5},{name:"saturday",day:6},{name:"sunday",day:0}].map(function(n){var a;-1===(null===(a=t)||void 0===a?void 0:a.indexOf(n.name))&&e.push(n.day)}),I(e),D([])}},[B]),Object(a.useEffect)(function(){null!==W&&void 0!==W&&W.userServiceId&&(c.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,K(null===W||void 0===W?void 0:W.adminUserId,"$","$..admin.calendarManagement.items"),g.GetCalendarSetting,null===W||void 0===W?void 0:W.userServiceId),c.subscribeToSurvey(m.SurveyTopics,g.GetCalendarSetting,function(e){var t,n,a,i;console.log("calendar settings",null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]),J(null===e||void 0===e||null===(a=e.data)||void 0===a||null===(i=a[0])||void 0===i?void 0:i[0])}))},[W]),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{className:"col-label mb-3",children:i||"Select date & time on calendar"}),Object(oa.jsx)("div",{className:"mt-4",children:Object(oa.jsx)(Ri.a,{plugins:[Mi.a,Pi.b,Di.a,Ai.a],headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},initialView:"dayGridMonth",validRange:v,slotDuration:p,hiddenDays:x,ref:o,selectOverlap:!1,viewDidMount:function(e){if(o.current){var t=o.current.getApi().getDate();console.log("Selected date:",t.toISOString())}w(e.view.type)},editable:!0,selectable:!0,dayMaxEvents:!1,weekends:!0,events:"timeGridDay"===T?[].concat(Object(C.a)(P),Object(C.a)(L)):Object(C.a)(L),select:function(e){var n=e.view.calendar;"dayGridMonth"===e.view.type?(n.changeView("timeGridDay"),n.gotoDate(e.startStr)):(console.log("date",e),t({type:"calendar",start:e.start,end:e.end,setting:B}))},eventContent:function(e){return Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsx)("b",{children:e.timeText}),Object(oa.jsx)("i",{children:e.event.title})]})},datesSet:function(e){var t=e.startStr;if(console.log("Date changed. Start date:",t),B){var n,a=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],i=B.options.find(function(e){return-1!==e.daysOfWeek.map(function(e){return null===e||void 0===e?void 0:e.toLowerCase()}).indexOf(null===a||void 0===a?void 0:a[new Date(t).getDay()])});if(!i)return;console.log("selected operation",i);var c=null===i||void 0===i||null===(n=i.operationHours)||void 0===n?void 0:n.map(function(e){var n=e.startTime.split(":").map(Number),a=Object(u.a)(n,2),i=a[0],c=a[1],o=e.endTime.split(":").map(Number),l=Object(u.a)(o,2),s=l[0],r=l[1],d=new Date;d.setHours(i),d.setMinutes(c),d.setSeconds(0),d.setMilliseconds(0);var v=new Date;v.setHours(s),v.setMinutes(r),v.setSeconds(0),v.setMilliseconds(0);var b=Z(new Date(t),d),j=Z(new Date(t),v);return{startTime:b.getTime(),endTime:j.getTime()}}),o=function(e,t){var n,a=[],i=Object(k.a)(e);try{for(i.s();!(n=i.n()).done;){var c,o=n.value,l=!0,s=Object(k.a)(t);try{for(s.s();!(c=s.n()).done;){var r=c.value;if(o.startTime>=r.startTime&&o.endTime<=r.endTime){l=!1;break}}}catch(d){s.e(d)}finally{s.f()}l&&a.push(o)}}catch(d){i.e(d)}finally{i.f()}return a}(function(e,t){var n=[],a=new Date(e),i=new Date(a);i.setHours(0,0,0,0);var c=new Date(a);c.setHours(23,59,59,999);for(var o=i.getTime(),l=c.getTime(),s=60*t*1e3,r=o;r<l;r+=s)n.push({startTime:r,endTime:r+s});return n}(t,B.appointmentDuration),c),l=o.map(function(e){return{title:"Unavailable",start:new Date(e.startTime),end:new Date(e.endTime),rendering:"background",color:"lightgray"}});D(l)}}})})]})})})},Ui=Gn.a.Option,qi=function(e){var t=e.onChange,n=e.value,c=e.placeholder,o=e.options,l=Object(a.useState)([]),r=Object(u.a)(l,2),d=r[0],v=r[1],b=Object(a.useState)([]),j=Object(u.a)(b,2),m=j[0],p=j[1],O=Object(s.b)();return Object(a.useEffect)(function(){null!==n&&void 0!==n&&n.categories&&v(null===n||void 0===n?void 0:n.categories),null!==n&&void 0!==n&&n.subCategories&&(p(null===n||void 0===n?void 0:n.subCategories),O({type:"FILTER_SUB_CATEGORIES",payload:null===n||void 0===n?void 0:n.subCategories}))},[n]),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{mode:"multiple",style:{width:"100%"},placeholder:c||"Select categories",value:d,onChange:function(e){v(e),t({type:"category",categories:e,subCategories:null===n||void 0===n?void 0:n.subCategories})},children:o.map(function(e){return Object(oa.jsx)(Ui,{value:e.name,children:e.name},e.name)})})})}),o.length>0&&Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select subcategories",value:m,onChange:function(e){p(e),t({type:"category",categories:null===n||void 0===n?void 0:n.categories,subCategories:e})},children:o.filter(function(e){return d.includes(e.name)}).flatMap(function(e){return e.subCategories}).map(function(e){return Object(oa.jsx)(Ui,{value:e,children:e},e)})})})})]})},Fi=n(64),Bi=function(e){var t=e.value,n=e.onChange,i=Object(s.b)();return Object(a.useEffect)(function(){t&&t&&Object(Fi.b)(t)?i({type:"SET_SELECTED_PHONE",payload:t}):i({type:"SET_SELECTED_PHONE",payload:void 0})},[t]),Object(oa.jsx)(Fi.a,{placeholder:"Phone number",defaultCountry:"US",value:t,onChange:function(e){n(e)}})},_i=function(e){var t,n=e.value,i=e.onChange,c=e.placeholder,o=e.onProjectChange,l=(Object(s.b)(),Object(s.c)(function(e){return e.auth}).projects);return Object(a.useEffect)(function(){null!==l&&void 0!==l&&l.projects&&n&&o(n)},[l,n]),Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:c,value:n,onChange:function(e){i(e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===l||void 0===l||null===(t=l.projects)||void 0===t?void 0:t.map(function(e,t){return Object(oa.jsx)(Gn.a.Option,{value:e.id,children:e.name})})})},$i=n(1055),Yi=(n(502),Za.a.Panel,function(e){e.lastSetupIntent;var t=e.onClose,n=(e.onAdd,Object(s.b)(),Object(a.useState)(!0)),i=Object(u.a)(n,2),c=i[0],o=(i[1],Object(a.useState)(!1)),l=Object(u.a)(o,2),r=l[0],d=l[1],v=Object(b.useStripe)(),j=Object(b.useElements)();Object(a.useEffect)(function(){},[]);var m=function(){t&&t()},p=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),v&&j){e.n=1;break}return e.a(2);case 1:return d(!0),n=localStorage.getItem("form"),localStorage.setItem("formValues",n),e.n=2,v.confirmSetup({elements:j,confirmParams:{return_url:window.location.href}});case 2:a=e.v,(i=a.error)&&(console.log("error message",i.message),d(!1),Lt(i.message,"error","TOP_CENTER",3e3));case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return Object(oa.jsx)($n.a,{title:"New card",visible:c,onOk:function(){t&&t()},onCancel:m,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)("form",{onSubmit:p,children:[Object(oa.jsx)("div",{className:"mt-2",style:{height:500},children:Object(oa.jsx)(b.PaymentElement,{})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:r,children:"Save"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:m,children:"Cancel"})})]})]})})}),Hi=function(e){e.onClose;var t,n,c,o,l=e.socket,r=e.pay,v=(e.disableClose,e.payment),p=e.onShare,O=e.value,f=(e.authenticate,e.onChange),h=Object(s.b)(),g=Object(a.useState)(!0),x=Object(u.a)(g,2),y=(x[0],x[1],Object(a.useState)(!1)),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(s.c)(function(e){return e.auth}),T=k.encrypted_token,C=k.primaryPhone,w=k.project,E=k.projects,R=(Object(a.useRef)(),Object(a.useState)(void 0)),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Object(a.useState)(),L=Object(u.a)(M,2),U=L[0],q=L[1],F=Object(a.useState)(!1),B=Object(u.a)(F,2),_=(B[0],B[1],Object(a.useState)()),$=Object(u.a)(_,2),Y=$[0],H=$[1],W=Object(a.useState)(),V=Object(u.a)(W,2),z=V[0],Q=V[1],G=Object(a.useState)(void 0),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)(void 0),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(j.a)("pk_live_51MyyRYCFnkD3M6HjXbfzl6NpmEK2rc0RZzyiIhfD3A65zcqf7oEkszPqn8m8qykKN8dqxTeEURAhWhq1ACjmvytL00k1LMsAxw");Object(a.useEffect)(function(){if(w){var e,t=null===E||void 0===E||null===(e=E.projects)||void 0===e?void 0:e.find(function(e){return e.id===w});console.log("selected project",t),ne(null===t||void 0===t?void 0:t.payment)}},[w]),Object(a.useEffect)(function(){var e;T&&(v&&ie(v),l.subscribeToEvent(m.SubscribePageTopics,(e=null===T||void 0===T?void 0:T.connectionId,"".concat(Ut,"/connection/").concat(e,"/service/ride-dps/sharePaymentUrl/reply")),function(e){var t,n=e.response;H(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.memberId)}))},[T]);var ie=function(e){l.publishToEvent(m.PublishPageTopics,Xt(null===T||void 0===T?void 0:T.connectionId),Dn({userId:null===T||void 0===T?void 0:T.userId,notificationChannels:{email:null===e||void 0===e?void 0:e.email,phone:null===e||void 0===e?void 0:e.phone},skipNotification:!0}))};Object(a.useEffect)(function(){H(void 0),q([]),A(void 0),Q(void 0),C&&ie({phone:C})},[C]),Object(a.useEffect)(function(){Y&&(le(),ce())},[Y]);var ce=function(){re({userId:Y,cudbServiceId:"cudb-live",op:"retrieveSetupIntent"},function(e){var t,n;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.lastSetupIntentId?Q(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.response):oe()})},oe=function(){re({userId:Y,cudbServiceId:"cudb-live",op:"getSetupIntent"},function(e){var t,n,a;console.log("get setupIntent workflow response",e),Q(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.response),se(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.response)||void 0===a?void 0:a.id)})},le=function(){re({userId:Y,cudbServiceId:"cudb-live",op:"listPaymentMethods"},function(e){var t,n,a=(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.response)||void 0===n?void 0:n.data)||[],i=[];a.map(function(e){var t,n,a,c;i.push({id:e.id,type:null===e||void 0===e||null===(t=e.card)||void 0===t||null===(n=t.brand)||void 0===n?void 0:n.toLowerCase(),last4:null===e||void 0===e||null===(a=e.card)||void 0===a?void 0:a.last4,expiry:null===e||void 0===e||null===(c=e.card)||void 0===c?void 0:c.exp_year})}),q(i)})},se=function(e){h(dt({objectId:Y,lastSetupIntentId:e,silentRequest:!0}))},re=function(e,t){var n={changes:[],configId:"10241",request:Object(d.a)({},e),timeout:1e4};h(lt({request:n,callback:function(e){t&&t(e)}}))};return Object(a.useEffect)(function(){O&&Z(O)},[O]),Object(oa.jsx)(i.a.Fragment,{children:void 0!==Y&&Object(oa.jsxs)("div",{className:"",children:[Object(oa.jsxs)("div",{className:"d-flex justify-content-space-between",children:[Object(oa.jsx)("span",{className:"col-label",children:r?"Select card":"Saved card"}),Object(oa.jsx)($i.a,{style:{color:"#869cbd",fontSize:21,cursor:"pointer"},onClick:function(){p&&p(Y)}})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3 d-flex justify-content-center",children:[null===U||void 0===U?void 0:U.map(function(e,t){return Object(oa.jsxs)("div",{className:"credit-card ".concat(e.type," ").concat(D===e.id?"selected":"selectable"),onClick:function(){r&&A(e.id)},children:[Object(oa.jsx)("div",{className:"credit-card-last4",children:e.last4}),Object(oa.jsx)("div",{className:"credit-card-expiry",children:e.expiry}),Object(oa.jsx)("div",{className:"delete",children:Object(oa.jsx)(na.a,{onClick:function(t){var n;t.preventDefault(),t.stopPropagation(),1==window.confirm("Are you sure you want to delete payment method?")&&(n=e.id,re({userId:Y,cudbServiceId:"cudb-live",op:"detachPaymentMethod",paymentMethodId:n},function(e){le(),oe(),Lt("Payment method deleted successfully","success","TOP_CENTER",1e3)}))}})})]})}),z&&U&&0===U.length&&Object(oa.jsx)("div",{className:"credit-card new selectable",onClick:function(){N(!0)},children:Object(oa.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Object(oa.jsx)(fa.a,{src:"/images/plus-icon.svg"}),Object(oa.jsx)("h4",{className:"mt-3",children:"Add new card"})]})})]}),te&&Object(oa.jsxs)(i.a.Fragment,{children:["recurring"===(null===te||void 0===te?void 0:te.type)&&Object(oa.jsxs)("div",{className:"mt-3",children:[Object(oa.jsx)("h5",{children:"Choose your plan"}),null===te||void 0===te||null===(t=te.info)||void 0===t||null===(n=t.recurringDetails)||void 0===n?void 0:n.map(function(e){return Object(oa.jsxs)(Yn.a,{className:"person-item d-flex mt-2",style:{border:"2px solid ".concat((null===K||void 0===K?void 0:K.scheduleType)===e.billingCycle?"#40CC52":"#d9d9d9"),cursor:"pointer",boxShadow:"0px 0px 15px 0px rgba(223, 229, 238, 1)"},onClick:function(){f({type:"payment",scheduleType:e.billingCycle,amount:e.amount})},children:[Object(oa.jsxs)(Hn.a,{span:14,children:[Object(oa.jsx)("h5",{children:e.name}),Object(oa.jsxs)("p",{children:["$ ",e.amount,"/",e.billingCycle]})]}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",checked:(null===K||void 0===K?void 0:K.scheduleType)===e.billingCycle})})]})})]}),"fixed"===(null===te||void 0===te?void 0:te.type)&&Object(oa.jsxs)("div",{className:"mt-3",children:[Object(oa.jsx)("h5",{children:"Fixed plan"}),Object(oa.jsxs)(Yn.a,{className:"person-item d-flex mt-2",style:{border:"2px solid ".concat((null===K||void 0===K?void 0:K.scheduleType)===(null===te||void 0===te?void 0:te.type)?"#40CC52":"#d9d9d9"),cursor:"pointer",boxShadow:"0px 0px 15px 0px rgba(223, 229, 238, 1)"},onClick:function(){var e;f({type:"payment",scheduleType:null===te||void 0===te?void 0:te.type,amount:null===te||void 0===te||null===(e=te.info)||void 0===e?void 0:e.amount})},children:[Object(oa.jsxs)(Hn.a,{span:14,children:[Object(oa.jsx)("h5",{children:null===te||void 0===te||null===(c=te.info)||void 0===c?void 0:c.name}),Object(oa.jsxs)("p",{children:["$ ",null===te||void 0===te||null===(o=te.info)||void 0===o?void 0:o.amount]})]}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",checked:(null===K||void 0===K?void 0:K.scheduleType)===(null===te||void 0===te?void 0:te.type)})})]})]})]}),S&&Object(oa.jsx)(b.Elements,{stripe:ae,options:{clientSecret:z.client_secret},children:Object(oa.jsx)(Yi,{lastSetupIntent:z,onClose:function(){return N(!1)},onAdd:function(e){}})})]})})},Wi=n(1056),Vi=Gn.a.Option,zi=function(e){var t=e.value,n=e.placeholder,i=e.onChange,c=e.multiple,o=Object(s.c)(function(e){return e.auth}),r=o.projects,v=o.encrypted_token,b=Object(a.useState)(!1),j=Object(u.a)(b,2),m=j[0],p=j[1],O=Object(a.useState)(!1),f=Object(u.a)(O,2),h=f[0],g=f[1],x=Object(a.useState)([]),y=Object(u.a)(x,2),I=y[0],S=y[1],N=Object(s.b)(),k=Object(a.useState)(null),T=Object(u.a)(k,2),w=T[0],E=T[1],R=Object(a.useState)(t||""),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Object(l.g)(),L=new URLSearchParams(M.search),U=L.get("customerId"),q=L.get("userId");Object(a.useEffect)(function(){U&&F(U)},[U]);var F=function(e){var t="";if(e){var n=z(e);t="(exists(@name) && contains(lower(@name),lower('".concat(n,"'))) || (exists(@email) && contains(lower(@email),lower('").concat(n,"'))) || (exists(@phone) && contains(lower(@phone),lower('").concat(n,"'))) || (exists(@id) && contains(lower(@id),lower('").concat(n,"'))) || (exists(@objectId) && contains(lower(@objectId),lower('").concat(n,"')))")}p(!0);var a={select:{index:{searchIndex:"".concat("beamdevlive",":custom:id"),searchQuery:"@partitions:{'org\\:".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",name:"$..info..name",email:"$..info..email",phone:"$..info..phone",id:"$..info.id"}},filter:{expression:t}};N(tt({requestData:a,callback:function(e){p(!1);var t,n,a=null===e||void 0===e?void 0:e.map(function(e){return Object(d.a)(Object(d.a)({},e),{},{label:"".concat(null===e||void 0===e?void 0:e.name," (").concat(null===e||void 0===e?void 0:e.id,")")})});U&&null!==a&&void 0!==a&&a.length&&(A(null===(t=a[0])||void 0===t?void 0:t.id),i({id:null===(n=a[0])||void 0===n?void 0:n.id}));S(Object(C.a)(a))}}))};if(q)return Object(oa.jsx)(Wn.a,{value:D||(null===t||void 0===t?void 0:t.id)||"",placeholder:n,onChange:function(e){i({id:e.target.value}),A(e.target.value)},allowClear:!0});var B="".concat(window.location.origin,"/customer-cpc?userId=").concat(null===v||void 0===v?void 0:v.userId,"&connectionId=").concat(null===v||void 0===v?void 0:v.connectionId,"&serviceId=").concat(null===v||void 0===v?void 0:v.cudbServiceId);return Object(oa.jsxs)("div",{children:[h&&Object(oa.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:4,marginBottom:"10px"},children:[Object(oa.jsx)(Wi.a,{twoToneColor:"#52c41a",style:{fontSize:30}}),Object(oa.jsx)("span",{style:{color:"#52c41a",fontWeight:500,fontSize:16},children:"Eligible for tanF"})]}),Object(oa.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[Object(oa.jsx)(Gn.a,{showSearch:!0,value:t,mode:c?"multiple":void 0,className:"w-full",placeholder:n,allowClear:!0,onChange:function(e){if(e)if(c){var t=e.map(function(e){return I.find(function(t){return t.id===e})});i(t)}else{var n,a=I.find(function(t){return t.id===e}),o=null===a||void 0===a||null===(n=a.info)||void 0===n?void 0:n.customer,l=!!o&&Object.entries(o).some(function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return/^tanF/i.test(n)&&"Yes"===a});g(l),i(a)}else g(!1),i(void 0)},loading:m,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},onSearch:function(e){w&&clearTimeout(w);var t=setTimeout(function(){e&&""!==e&&F(e)},500);E(t)},children:null===I||void 0===I?void 0:I.map(function(e,t){return Object(oa.jsx)(Vi,{value:e.id,children:e.label},t)})}),Object(oa.jsx)("a",{href:B,target:"_blank",rel:"noopener noreferrer",style:{whiteSpace:"nowrap",fontWeight:500,color:"#1677ff",marginLeft:8,textDecoration:"underline",fontSize:14},children:"Create Profile"})]})]})},Qi=n(526),Gi=n.n(Qi),Ji=function(e){e.isBio;var t=e.onClose,n=e.onUploadSignature,i=Object(a.useState)(!0),c=Object(u.a)(i,2),o=c[0],r=c[1],v=Object(a.useState)([]),b=Object(u.a)(v,2),j=(b[0],b[1],Object(a.useState)()),m=Object(u.a)(j,2),p=m[0],O=m[1],f=Object(l.g)(),h=Object(a.useState)(""),g=Object(u.a)(h,2),x=(g[0],g[1],Object(s.c)(function(e){return e.auth}).userBds,Object(a.useState)(!1)),y=Object(u.a)(x,2),I=y[0],S=y[1],N=Object(s.c)(function(e){return e.auth}).fileToSend,k=(Object(a.useRef)(0),Object(a.useRef)()),T=function(){r(!1),t&&t()},C=Object(s.b)(),w=function(){var e=function(e){var t;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var n=e.split(",")[0].split(":")[1].split(";")[0],a=new Uint8Array(t.length),i=0;i<t.length;i++)a[i]=t.charCodeAt(i);return new Blob([a],{type:n})}(k.current.getTrimmedCanvas().toDataURL("image/png")),t=(new Date).getTime(),n=new URLSearchParams(f.search),a=n.get("customerId"),i=n.get("userId"),c=n.get("serviceId"),o=new FormData;o.append("file",e,"signature-".concat(t,".png")),o.append("info",JSON.stringify({customerId:a,userId:i,location:p?{coordinates:p,clbs:{tags:["type:media","org:".concat(c),"signature-".concat(t,".png")]}}:void 0})),C(ye({form:o,isBio:!1})),S(!0)};Object(a.useEffect)(function(){E()},[]),Object(a.useEffect)(function(){if(N){var e,a,i,c;console.log({fileToSend:N}),r(!1),t&&t(),S(!1);var o=Object(d.a)({name:null===N||void 0===N||null===(e=N.media)||void 0===e?void 0:e.originalName,url:null===N||void 0===N||null===(a=N.media)||void 0===a||null===(i=a.urls)||void 0===i||null===(c=i.original)||void 0===c?void 0:c.url},null===N||void 0===N?void 0:N.media);n({files:[o]})}},[N]);var E=function(){return new Promise(function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,n;O({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,long:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude})}):t("Geolocation is not supported by this browser.")})};return Object(a.useEffect)(function(){E()},[]),Object(oa.jsxs)($n.a,{title:"Add a signature",visible:o,onOk:w,onCancel:T,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:[Object(oa.jsx)(Gi.a,{ref:function(e){k.current=e},penColor:"black",backgroundColor:"white",canvasProps:{width:420,height:200,className:"sigCanvas"}}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:w,loading:I,children:"Upload"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:T,children:"Cancel"})})]})]})},Ki=function(e){var t,n,i=e.onChange,c=e.value,o=Object(a.useState)(!1),l=Object(u.a)(o,2),s=l[0],r=l[1],d=Object(a.useState)((null===c||void 0===c||null===(t=c.files)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.url)||""),v=Object(u.a)(d,2),b=v[0],j=v[1];Object(a.useEffect)(function(){var e,t;c&&j((null===c||void 0===c||null===(e=c.files)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.url)||"")},[c]);var m=function(){r(!1)};return Object(oa.jsx)(Yn.a,{className:"custom-file-upload",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("div",{children:Object(oa.jsx)(ma.a,{showUploadList:!1,multiple:!1,children:Object(oa.jsxs)("div",{className:"d-flex flex-column align-items-center justify-content-center w-full",style:{padding:0,textAlign:"center",minHeight:"250px"},children:[b&&Object(oa.jsx)("div",{className:"mb-2",children:Object(oa.jsx)("img",{src:b,alt:"Uploaded Signature",style:{maxWidth:"100%",maxHeight:150,border:"1px solid #d0dae9"}})}),Object(oa.jsx)(Vn.a,{className:"beam-btn cover mb-3",icon:Object(oa.jsx)(ui.a,{}),onClick:function(e){e.stopPropagation(),r(!0)},children:"Signature"})]})})}),s&&Object(oa.jsx)(Ji,{onClose:m,onUploadSignature:function(e){j(e),i(e),m()}})]})})},Zi=n(547),Xi=n(1030),ec=n(47),tc=n.n(ec),nc=function(e){return e[e.Student=1]="Student",e[e.Driver=2]="Driver",e[e.Vehicle=3]="Vehicle",e[e.Scheduler=4]="Scheduler",e[e.Dashboard=5]="Dashboard",e[e.Pricing=6]="Pricing",e[e.Equipment=7]="Equipment",e[e.Queue=8]="Queue",e[e.Timesheet=9]="Timesheet",e[e.Timeoff=10]="Timeoff",e[e.Shift=11]="Shift",e[e.Recurring=12]="Recurring",e[e.Dispatcher=13]="Dispatcher",e[e.Location=14]="Location",e[e.QuickBooks=15]="QuickBooks",e}({}),ac=function(e){return e.Responder="responder",e.Admin="admin",e.Dispatcher="dispatcher",e.Live="live",e.Manager="manager",e}({}),ic=function(e){return e.Admin="admin",e.OnMove="onMove",e.Cad="cad",e.Live="live",e}({}),cc=function(){return{key:Date.now()+Math.random(),projectId:"",deadlineDate:null,deadlineTime:null,staffId:"",schedule:"",scheduleDate:null,scheduleTime:null,included:!0}},oc=function(){return{key:Date.now()+Math.random(),categoryId:"",services:[cc()]}},lc=function(e){e.placeholder;var t=e.options,n=e.socket,i=e.onServiceChange,c=e.disabled,o=Object(s.b)(),l=new URLSearchParams(window.location.search),r=Object(a.useState)([oc()]),v=Object(u.a)(r,2),b=v[0],j=v[1],p=Object(a.useState)({catIdx:null,svcIdx:null}),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(a.useState)({catIdx:null,svcIdx:null}),I=Object(u.a)(g,2),S=I[0],N=I[1],k=Object(a.useState)(null),w=Object(u.a)(k,2),E=w[0],R=w[1],P=Object(a.useState)(null),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Mn().getUserRequestPayload,U=Object(a.useState)([]),q=Object(u.a)(U,2),F=q[0],B=q[1],_=Object(a.useState)([]),$=Object(u.a)(_,2),Y=$[0],W=$[1],V=Object(a.useState)([]),Q=Object(u.a)(V,2),G=Q[0],J=Q[1],K=Object(s.c)(function(e){return e.auth}),Z=K.projects,X=K.encrypted_token,ee=K.page,te=function(e,t){var n="@serviceId:{'".concat(z(t),"'}"),a=e.map(function(e){return"@roleId === '".concat(e._id,"'")}),i="exists(@roleId) && (".concat(a.join("||"),")"),c={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:n,searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId",beamId:"$..persistent.static.live.beamIds",createdAt:"$.persistent.static.metadata.createdAt"}},apply:{expression:"",name:""},sortBy:{properties:[{field:"@createdAt",order:"DESC"}],max:1e3},result:{pagination:{offset:0,limit:1e3}},filter:{expression:i},anyStatus:!1};o(tt({requestData:c,callback:function(e){var t=null===e||void 0===e?void 0:e.map(function(e){var t,n,a,i,c,o,l,s,r;return{id:null===e||void 0===e?void 0:e.id,beamId:null!==e&&void 0!==e&&null!==(t=e.beamId)&&void 0!==t&&t.length?null===e||void 0===e?void 0:e.beamId[0]:"".concat(null===e||void 0===e||null===(n=e.live)||void 0===n||null===(a=n.profile)||void 0===a?void 0:a.firstName,".").concat(null===e||void 0===e||null===(i=e.live)||void 0===i||null===(c=i.profile)||void 0===c?void 0:c.lastName),name:"".concat(null===e||void 0===e||null===(o=e.live)||void 0===o||null===(l=o.profile)||void 0===l?void 0:l.firstName," ").concat(null===e||void 0===e||null===(s=e.live)||void 0===s||null===(r=s.profile)||void 0===r?void 0:r.lastName)}});J(t||[])}}))};Object(a.useEffect)(function(){if(null!==n&&void 0!==n&&n.client){var e=l.get("userId"),t=l.get("serviceId");l.get("token")&&(t=null===X||void 0===X?void 0:X.cudbServiceId,e=null===Z||void 0===Z?void 0:Z.adminUserId),t||(t=null===Z||void 0===Z?void 0:Z.userServiceId),function(e,t){n.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,L(e,"$","$..persistent.static.admin.role"),hn(localStorage.getItem("CID")),t),n.subscribeToSurvey(m.SurveyTopics,hn(localStorage.getItem("CID")),function(e){if(e){var n,a,i,c=null===(n=e.data)||void 0===n||null===(a=n[0])||void 0===a||null===(i=a[0])||void 0===i?void 0:i.filter(function(e){return e.permissions.includes(ic.Cad)});te(c,t)}})}(e,t),n.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,L(e,"$","$.persistent.static.admin.project"),x.GetUserBio,t),n.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,n,a=Object.values((null===e||void 0===e||null===(t=e.data[0][0])||void 0===t?void 0:t.items)||{})||[],i=(null===e||void 0===e||null===(n=e.data[0][0])||void 0===n?void 0:n.types)||[];W(a),B(i)})}},[null===n||void 0===n?void 0:n.client]),Object(a.useEffect)(function(){if(ee){var e,n,a,i,o=null===ee||void 0===ee||null===(e=ee.persistent)||void 0===e||null===(n=e.static)||void 0===n||null===(a=n.profile)||void 0===a?void 0:a.unstructuredAttributes[void 0];null===(i=Object.keys(o))||void 0===i||i.map(function(e){var t,n;if(null!==(t=o[e])&&void 0!==t&&t.length&&"service"===(null===(n=o[e][0])||void 0===n?void 0:n.type)){var a=o[e].map(function(e){return Object(d.a)(Object(d.a)({},e),{},{services:e.services.map(function(e){return Object(d.a)(Object(d.a)({},e),{},{scheduleDate:e.scheduleDate?H()(e.scheduleDate,"YYYY-MM-DD"):null,scheduleTime:e.scheduleTime?H()(e.scheduleTime,"HH:mm"):null,deadlineDate:e.deadlineDate?H()(e.deadlineDate,"YYYY-MM-DD"):null,deadlineTime:e.deadlineTime?H()(e.deadlineTime,"HH:mm"):null})})})});j(a)}})}else if(Array.isArray(t)&&t.length>0)if(c)j(t);else{var l=t.map(function(e){return Object(d.a)(Object(d.a)({},e),{},{services:e.services.map(function(e){return Object(d.a)(Object(d.a)({},e),{},{included:!1})})})});j(l)}},[t,ee]),Object(a.useEffect)(function(){var e=b.map(function(e){var t=F.find(function(t){return t._id===e.categoryId});return Object(d.a)(Object(d.a)({},e),{},{type:"service",categoryName:t?t.name:"",services:(c?e.services:e.services.filter(function(e){return e.included})).map(function(e){var t=Y.find(function(t){return t._id===e.projectId}),n=G.find(function(t){return t.id===e.staffId});return Object(d.a)(Object(d.a)({},e),{},{projectName:t?t.name:"",staffName:n?n.name:"",staffBeamId:n?n.beamId:"",scheduleDate:e.scheduleDate?tc()(e.scheduleDate).format("YYYY-MM-DD"):"",scheduleTime:e.scheduleTime?"string"===typeof e.scheduleTime?tc()("1970-01-01 ".concat(e.scheduleTime)).format("HH:mm"):tc()(e.scheduleTime).format("HH:mm"):"",deadlineDate:e.deadlineDate?tc()(e.deadlineDate).format("YYYY-MM-DD"):"",deadlineTime:e.deadlineTime?tc()(e.deadlineTime).format("HH:mm"):""})})})});i(e)},[b,c]);var ne=function(e,t,n,a){j(function(i){return i.map(function(i,c){return c===e?Object(d.a)(Object(d.a)({},i),{},{services:i.services.map(function(e,i){return i===t?Object(d.a)(Object(d.a)({},e),{},Object(T.a)({},n,a)):e})}):i})})},ae=[];b.forEach(function(e,t){e.services.forEach(function(n,a){f.catIdx===t&&f.svcIdx===a&&"Schedule Next"===n.schedule&&n.deadlineDate&&n.deadlineTime&&setTimeout(function(){return h({catIdx:null,svcIdx:null})},0),ae.push({key:"".concat(e.key,"-").concat(n.key),category:0===a?Object(oa.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[Object(oa.jsx)(Gn.a,{disabled:!c,value:e.categoryId,onChange:function(e){return function(e,t){j(function(n){return n.map(function(n,a){return a===e?Object(d.a)(Object(d.a)({},n),{},{categoryId:t,services:n.services.map(function(e){return Object(d.a)(Object(d.a)({},e),{},{projectId:""})})}):n})})}(t,e)},placeholder:"Select category",style:{minWidth:120},size:"small",children:F.map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e._id,children:e.name},e._id)})}),Object(oa.jsx)(Vn.a,{icon:Object(oa.jsx)(na.a,{}),size:"small",type:"link",danger:!0,onClick:function(){return e=t,j(function(t){return t.filter(function(t,n){return n!==e})});var e},disabled:!c||1===b.length})]}):"",categoryRowSpan:0===a?e.services.length:0,project:Object(oa.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(oa.jsx)("input",{type:"checkbox",disabled:c,checked:n.included,onChange:function(e){return function(e,t,n){j(function(a){return a.map(function(a,i){return i===e?Object(d.a)(Object(d.a)({},a),{},{services:a.services.map(function(e,a){return a===t?Object(d.a)(Object(d.a)({},e),{},{included:n}):e})}):a})})}(t,a,e.target.checked)},style:{marginRight:8}}),Object(oa.jsx)(Gn.a,{value:n.projectId,onChange:function(e){ne(t,a,"projectId",e)},placeholder:"Select service",style:{minWidth:180},size:"small",disabled:!c||!e.categoryId,children:Y.filter(function(t){return t.typeId===e.categoryId}).map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e._id,children:e.name},e._id)})})]}),deadlineDate:Object(oa.jsx)(Jn.a,{value:n.deadlineDate,onChange:function(e){return ne(t,a,"deadlineDate",e)},placeholder:"Pick date",disabled:c||!n.included}),deadlineTime:Object(oa.jsx)(Zn.a,{value:n.deadlineTime,onChange:function(e){return ne(t,a,"deadlineTime",e)},placeholder:"Pick time",disabled:c||!n.included}),staff:Object(oa.jsx)(Gn.a,{value:n.staffId,onChange:function(e){return ne(t,a,"staffId",e)},style:{width:110},placeholder:"Select staff",disabled:c||!n.included,children:G.map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e.id,children:e.name},e.id)})}),actions:Object(oa.jsxs)(Zi.b,{children:[Object(oa.jsx)(Vn.a,{type:"Schedule Now"===n.schedule?"primary":"default",size:"small",onClick:function(){var e=H()();ne(t,a,"schedule","Schedule Now"),ne(t,a,"scheduleDate",e.format("YYYY-MM-DD")),ne(t,a,"scheduleTime",e.format("HH:mm")),N({catIdx:null,svcIdx:null})},disabled:c||!n.included,children:"Schedule Now"}),Object(oa.jsx)(Vn.a,{type:"Schedule Next"===n.schedule?"primary":"default",size:"small",onClick:function(){ne(t,a,"schedule","Schedule Next"),N({catIdx:t,svcIdx:a}),R(n.scheduleDate?H()(n.scheduleDate,"YYYY-MM-DD"):null),M(n.scheduleTime?H()(n.scheduleTime,"HH:mm"):null)},disabled:c||!n.included,children:"Schedule Next"}),Object(oa.jsx)(Vn.a,{type:"Schedule Later"===n.schedule?"primary":"default",size:"small",onClick:function(){ne(t,a,"schedule","Schedule Later"),ne(t,a,"scheduleDate",null),ne(t,a,"scheduleTime",null),N({catIdx:null,svcIdx:null})},disabled:c||!n.included,children:"Schedule Later"}),Object(oa.jsx)(Vn.a,{type:"link",icon:Object(oa.jsx)(na.a,{}),danger:!0,disabled:!c||1===e.services.length,onClick:function(){return function(e,t){j(function(n){return n.map(function(n,a){return a===e?Object(d.a)(Object(d.a)({},n),{},{services:n.services.filter(function(e,n){return n!==t})}):n})})}(t,a)}}),a===e.services.length-1&&Object(oa.jsx)(Vn.a,{type:"dashed",icon:Object(oa.jsx)(ca.a,{}),onClick:function(){return function(e){j(function(t){return t.map(function(t,n){return n===e?Object(d.a)(Object(d.a)({},t),{},{services:[].concat(Object(C.a)(t.services),[cc()])}):t})})}(t)},size:"small",disabled:!c,children:"Add"}),S.catIdx===t&&S.svcIdx===a&&Object(oa.jsxs)($n.a,{title:"Select Schedule Date & Time",visible:!0,onOk:function(){ne(t,a,"scheduleDate",E),ne(t,a,"scheduleTime",A),N({catIdx:null,svcIdx:null})},onCancel:function(){return N({catIdx:null,svcIdx:null})},okButtonProps:{disabled:!E||!A||c},cancelButtonProps:{disabled:c},children:[Object(oa.jsx)(Jn.a,{value:E,onChange:R,style:{width:"100%",marginBottom:8},placeholder:"Pick schedule date",disabled:c}),Object(oa.jsx)(Zn.a,{value:A,onChange:M,style:{width:"100%"},placeholder:"Pick schedule time",disabled:c})]})]}),scheduleDate:n.scheduleDate?tc()(n.scheduleDate).format("YYYY-MM-DD"):"",scheduleTime:n.scheduleTime?tc()(n.scheduleTime).format("HH:mm"):""})})});return Object(oa.jsxs)("div",{style:{overflowX:"auto"},children:[Object(oa.jsx)(Xi.a,{columns:[{title:"Category",dataIndex:"category",render:function(e,t,n){return{children:e,props:{rowSpan:t.categoryRowSpan}}}},{title:"Service",dataIndex:"project"},{title:"Date",dataIndex:"deadlineDate"},{title:"Time",dataIndex:"deadlineTime"},{title:"Department Staff",dataIndex:"staff"},{title:"Actions",dataIndex:"actions"}],dataSource:ae,pagination:!1,bordered:!0,scroll:{x:"max-content"}}),Object(oa.jsx)(Vn.a,{type:"dashed",icon:Object(oa.jsx)(ca.a,{}),style:{marginTop:16},onClick:function(){return j(function(e){return[].concat(Object(C.a)(e),[oc()])})},block:!0,disabled:!c,children:"Add Category"})]})},sc=Gn.a.Option,rc=Wn.a.TextArea,dc=function(e){var t,n,c=e.data,o=e.name,l=e.restFields,r=e.projects,u=e.addOtherLocation,v=e.onProjectChange,b=e.adminRoles,j=e.onCustomerSearch,m=e.dispatchDisabled,p=e.customerDisabled,O=e.conditionalSections,f=e.conditionalParentName,h=e.socket,g=(e.formValues,e.relationDisbaled),x=void 0!==g&&g,y=e.serviceDisabled,I=void 0!==y&&y,N=e.onServiceChange,k=f?["".concat(f,"-").concat(null===c||void 0===c?void 0:c.name)]:[o,null===c||void 0===c?void 0:c.name],C=Object(s.b)(),w="";switch(Object(a.useEffect)(function(){},[]),c.type){case S.Text:w=Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(rc,{autoSize:null!==c&&void 0!==c&&c.isMulti?{minRows:4,maxRows:6}:{minRows:1,maxRows:3}})})]});break;case S.DispatchType:w=Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:!0,message:"**Required Field"},{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if("schedule"!==(null===n||void 0===n?void 0:n.value)&&"deadline"!==(null===n||void 0===n?void 0:n.value)||null!==n&&void 0!==n&&n.date&&null!==n&&void 0!==n&&n.time){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(Ci,{placeholder:"Dispatch type",onChange:function(e){},disabled:m})}),Object(oa.jsx)(ei.a.Item,{name:"notify",rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(!n||n.notifyVia&&(n.notifyTime||n.customTime)){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(Ei,{onChange:function(e){}})})]});break;case S.Customer:w=Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)(zi,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){j({itemName:k,value:e})}})});break;case S.Relation:w=Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(si,{options:null===c||void 0===c?void 0:c.options,placeholder:null===c||void 0===c?void 0:c.label,value:null===c||void 0===c?void 0:c.value,disabled:x,socket:h,onChange:function(e){c.value=e}})})});break;case S.YesNo:case S.TanF:w=Object(oa.jsx)(ei.a.Item,Object(d.a)(Object(d.a)({},l),{},{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(ii,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){}})}));break;case S.ThreeButton:w=Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(ci,{placeholder:null===c||void 0===c?void 0:c.label})});break;case S.Number:w=Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(Yn.a,{className:"w-100 mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(la,{value:c.value,onChange:function(e){c.value=e}})})})})]});break;case S.SectionDescription:case S.Payment:w=Object(oa.jsx)("div",{className:"",children:Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label})});break;case S.MultipleChoice:w=Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(li,{options:null===c||void 0===c?void 0:c.options,isMulti:c.isMulti,placeholder:null===c||void 0===c?void 0:c.label,conditionalSections:O,fieldSections:null===c||void 0===c?void 0:c.conditionalSection,projects:r,addOtherLocation:u,onProjectChange:v,onCustomerSearch:j,adminRoles:b,customerDisabled:p,dispatchDisabled:p,socket:h,onChange:function(e){}})})});break;case S.Bar:w=Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(ri,{options:null===c||void 0===c?void 0:c.options,placeholder:null===c||void 0===c?void 0:c.label})});break;case S.Date:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"},{message:"**Date must be in MM/DD/YYYY format",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(a=/^(0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])\/\d{4}$/,!n||a.test(n)){e.n=1;break}return e.a(2,Promise.reject("Date must be in MM/DD/YYYY format"));case 1:return e.a(2,Promise.resolve())}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(Wn.a,{maxLength:10,placeholder:"MM/DD/YYYY"})})]})});break;case S.DateTime:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)(di,{})})]})});break;case S.Currency:w=Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(Yn.a,{className:"w-100 mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(sa,{suffix:c.options[0],onChange:function(e){}})})})})]});break;case S.Location:w=Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(ai,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){console.log("add other locatyion",Object(T.a)({},o||(f?"".concat(f,"-").concat(null===c||void 0===c?void 0:c.name):null===c||void 0===c?void 0:c.name),e)),u(Object(T.a)({},o||(f?"".concat(f,"-").concat(null===c||void 0===c?void 0:c.name):null===c||void 0===c?void 0:c.name),e))}})});break;case S.IncidentLocation:w=Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(ai,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){u(Object(T.a)({},o||Object(T.a)({},o||(f?"".concat(f,"-").concat(null===c||void 0===c?void 0:c.name):null===c||void 0===c?void 0:c.name),e),e))}})});break;case S.GPS:w=Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(ai,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){u(Object(T.a)({},o||Object(T.a)({},o||(f?"".concat(f,"-").concat(null===c||void 0===c?void 0:c.name):null===c||void 0===c?void 0:c.name),e),e))}})});break;case S.File:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("value",n),void 0!==n&&0!==(null===n||void 0===n||null===(a=n.files)||void 0===a?void 0:a.length)){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(vi,{placeholder:null===c||void 0===c?void 0:c.label,name:k,onChange:function(e){}})})})});break;case S.SectionDocument:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)("a",{href:null===c||void 0===c?void 0:c.link,target:"_blank",rel:"noreferrer",children:null===c||void 0===c?void 0:c.label})})})});break;case S.Signature:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("value",n),void 0!==n&&0!==(null===n||void 0===n||null===(a=n.files)||void 0===a?void 0:a.length)||null===c||void 0===c||!c.required){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(Ki,{value:null===c||void 0===c?void 0:c.value,onChange:function(e){}})})})});break;case S.Media:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("value",n),void 0!==n&&0!==(null===n||void 0===n||null===(a=n.files)||void 0===a?void 0:a.length)){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(vi,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){}})})})});break;case S.Capture:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("value",n),void 0!==n&&0!==(null===n||void 0===n||null===(a=n.files)||void 0===a?void 0:a.length)){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(vi,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){}})})})});break;case S.Email:w=Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"},{type:"email",message:"**Input is not valid e-mail"}],children:Object(oa.jsx)(Wn.a,{})})]});break;case S.Tag:case S.TagNot:w=Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(ra,{placeholder:null===c||void 0===c?void 0:c.label})});break;case S.Calendar:w=Object(oa.jsx)(ei.a.Item,{name:k,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("value",n),null===c||void 0===c||!c.required||null!==n&&void 0!==n&&n.start){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(Li,{placeholder:null===c||void 0===c?void 0:c.label,socket:h})});break;case S.Category:w=Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)(qi,{placeholder:null===c||void 0===c?void 0:c.label,options:null===c||void 0===c?void 0:c.options,onChange:function(e){e.subCategories}})});break;case S.FixedAsset:w=Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)(ji,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){var t,n,a,i,l,s,r;u(Object(T.a)({},o||(f?"".concat(f,"-").concat(null===c||void 0===c?void 0:c.name):null===c||void 0===c?void 0:c.name),{label:null===e||void 0===e||null===(t=e.asset)||void 0===t?void 0:t.name,value:{coordinates:{lat:null===e||void 0===e||null===(n=e.asset)||void 0===n||null===(a=n.location)||void 0===a||null===(i=a.coordinates)||void 0===i?void 0:i[1],long:null===e||void 0===e||null===(l=e.asset)||void 0===l||null===(s=l.location)||void 0===s||null===(r=s.coordinates)||void 0===r?void 0:r[0]}}}))}})});break;case S.Responder:w=Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)(fi,{placeholder:null===c||void 0===c?void 0:c.label,adminRoles:b,onChange:function(){}})});break;case S.ResponderExtended:w=Object(oa.jsx)(ei.a.Item,{name:k,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(null===c||void 0===c||!c.required||null!==n&&void 0!==n&&n.value){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()},{message:"**Required Payment Option",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(a=null===n||void 0===n?void 0:n.extendedBio.find(function(e){return"payment"===e.type}),null===c||void 0===c||!c.required||!a||null!==n&&void 0!==n&&n.selectedPayment){e.n=1;break}return e.a(2,Promise.reject("**Required payment option"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(pi,{placeholder:null===c||void 0===c?void 0:c.label,adminRoles:b,onChange:function(e){console.log("on change",e),C({type:"SET_SELECTED_RESPONDER",payload:Object(d.a)(Object(d.a)({},e),{},{profile:{firstName:null===e||void 0===e?void 0:e.firstName,lastName:null===e||void 0===e?void 0:e.lastName},beamIds:[null===e||void 0===e?void 0:e.beamId]})})}})});break;case S.Phone:w=Object(oa.jsx)(Yn.a,{className:"d-flex",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(Bi,{onChange:function(e){console.log("phone",e,k)}})})]})});break;case S.Name:w=Object(oa.jsx)(Yn.a,{className:"d-flex",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{className:"w-full"})})]})});break;case S.Payment:w=Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)(Hi,{onClose:function(){},socket:h,payment:void 0,onShare:function(){},authenticate:!0})});break;case S.Time:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png",alt:""}),Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:null===c||void 0===c?void 0:c.required,message:"**Required Field"}],children:Object(oa.jsx)(gi,{name:null===c||void 0===c?void 0:c.label,onChange:function(e){}})})]})})});break;case S.Event:w=Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(Yn.a,{className:"mt-3 w-100",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)(ki,{onChange:function(e){}})})})})]});break;case S.TaskPicker:w=Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3 w-100",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)(xi,{onChange:function(e){}})})})})]});break;case S.Project:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(_i,{placeholder:null===c||void 0===c?void 0:c.label,onProjectChange:v})})})});break;case S.Service:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,children:Object(oa.jsx)(lc,{disabled:I,placeholder:null===c||void 0===c?void 0:c.label,options:null===c||void 0===c?void 0:c.value,socket:h,onServiceChange:function(e){N({itemName:k,value:e})}})})})});break;case S.Search:w=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:k,children:null!==c&&void 0!==c&&c.isMulti?Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:null===c||void 0===c?void 0:c.label,mode:"multiple",onChange:function(e){v(e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===c||void 0===c||null===(t=c.options)||void 0===t?void 0:t.map(function(e,t){return Object(oa.jsx)(sc,{value:e,children:e})})}):Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){v(e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===c||void 0===c||null===(n=c.options)||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(sc,{value:e,children:e})})})})})});break;default:w=""}return w},uc=["key","name"],vc=function(e){var t=e.listName,n=e.cols,a=e.RenderFields,i=e.projects,c=e.addOtherLocation,o=e.onProjectChange,l=e.adminRoles;return Object(oa.jsx)(ei.a.List,{name:t,children:function(e,t){var s=t.add,r=t.remove;return Object(oa.jsxs)(oa.Fragment,{children:[e.map(function(e){var t=e.key,s=e.name,d=Object(Ka.a)(e,uc);return Object(oa.jsxs)(Yn.a,{className:"mt-3",style:{width:"100%"},children:[Object(oa.jsx)(Hn.a,{span:20,className:"pr-2",xs:24,sm:20,children:Object(oa.jsx)(Yn.a,{children:null===n||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(Hn.a,{span:e.ColSize,className:"pr-2",children:Object(oa.jsx)(a,{data:e,name:s,restField:d,projects:i,addOtherLocation:c,onProjectChange:o,adminRoles:l})},t)})})}),Object(oa.jsx)(Hn.a,{span:4,xs:24,sm:4,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",onClick:function(){r(s)},children:"Remove"})})})]},t)}),Object(oa.jsx)(Yn.a,{className:"mt-3",style:{width:"100%"},children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",onClick:function(){s()},children:"Add"})})})})]})}})},bc=["key","name"],jc=["key","name"],mc=Gn.a.Option,pc=Wn.a.TextArea,Oc=Za.a.Panel,fc=function(e){var t,n,c,o,r,v,b,j=e.socket,p=e.params,O=ei.a.useForm(),f=Object(u.a)(O,1)[0],h=Object(a.useState)(""),g=Object(u.a)(h,2),x=g[0],y=g[1],I=p.screens,S=p.setScreens,N=Object(l.g)().search,k=Object(l.f)(),C=(Ha().getLocalStorageItem,Object(s.c)(function(e){return e.auth}).projects),w=Object(s.b)(),E=Object(s.c)(function(e){return e.auth}),R=E.selectedResponders,P=E.selectedAssets,D=E.submitted,A=E.otherLocations,M=(E.page,E.encrypted_token),L=Object(a.useState)(!1),U=Object(u.a)(L,2),q=U[0],F=U[1],B=Object(a.useState)(!1),_=Object(u.a)(B,2),Y=(_[0],_[1],Object(a.useState)(!1)),W=Object(u.a)(Y,2),V=W[0],z=W[1],Q=Object(a.useState)(!1),G=Object(u.a)(Q,2),J=G[0],K=G[1],Z=Object(a.useState)([]),ee=Object(u.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(a.useState)([]),ie=Object(u.a)(ae,2),ce=(ie[0],ie[1]),oe=Object(a.useState)([]),le=Object(u.a)(oe,2),se=le[0],re=(le[1],Object(a.useState)({what:[],account:[],where:[],who:[],when:[],why:[]})),de=Object(u.a)(re,2),ue=de[0];de[1];Object(a.useEffect)(function(){D&&(q?(F(!1),K(void 0),Lt("Event page submitted successfully","success","TOP_CENTER",1e3),localStorage.removeItem("form"),localStorage.removeItem("active"),setTimeout(function(){f.resetFields()},500),w({type:De,payload:!1})):V&&(z(!1),K(D.pageId),Lt("Event page saved successfully","success","TOP_CENTER",1e3)))},[w,k,f,V,I,N,q,S,D]),Object(a.useEffect)(function(){if(null!==C&&void 0!==C&&C.settings){var e,t,n,a,i,c,o,l=[],s=[];null===C||void 0===C||null===(e=C.settings)||void 0===e||null===(t=e.whoTags)||void 0===t||t.map(function(e){l.push({label:e,value:e})}),null===(n=Array.from(Array(null!==(a=null===C||void 0===C||null===(i=C.settings)||void 0===i?void 0:i.eventPriority)&&void 0!==a?a:0).keys()))||void 0===n||n.map(function(e){s.push({label:e+1,value:e+1})}),0===(null!==(c=null===C||void 0===C||null===(o=C.settings)||void 0===o?void 0:o.eventPriority)&&void 0!==c?c:0)&&(s.push({label:1,value:1}),s.push({label:2,value:2}),s.push({label:3,value:3})),ne(s),ce(l)}},[C]),Object(a.useEffect)(function(){M&&(j.subscribeToEvent(m.SubscribePageTopics,qt(null===M||void 0===M?void 0:M.connectionId)),j.subscribeToEvent(m.SubscribePageTopics,$t(null===M||void 0===M?void 0:M.connectionId)),j.subscribeToEvent(m.SubscribePageTopics,vn(null===M||void 0===M?void 0:M.connectionId)),j.subscribeToEvent(m.SubscribePageTopics,Ht(null===M||void 0===M?void 0:M.connectionId)),j.subscribeToEvent(m.SubscribePageTopics,an(null===M||void 0===M?void 0:M.connectionId)),j.publishToEvent(m.PublishPageTopics,Ft(null===M||void 0===M?void 0:M.connectionId),Dn({userId:null===M||void 0===M?void 0:M.userId})))},[M]);var ve=function(e){w({type:Ae,payload:e}),f.setFieldsValue({incidentType:void 0}),w({type:Pe,payload:void 0})};return Object(oa.jsx)("div",{className:"main-column ride-dispatch-panel mobile-responsive mr-4",style:{height:"auto"},children:Object(oa.jsx)("div",{className:"main-content",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",initialValues:{},id:"register-form",layout:"vertical",form:f,onFinish:function(e){var t,n,a,i;e[void 0]&&($.a.merge(e,e[void 0]),delete e[void 0]);var c=R.map(function(e){return{id:e.id,beamId:e.title}}),o=P.map(function(e){return{id:e.id,title:e.title,location:e.location}}),l={};Object.keys(e).map(function(t){var n=X(t,t,e[t],se,ue);Array.isArray(n)?null===n||void 0===n||n.map(function(e){$.a.merge(l,e)}):$.a.merge(l,n)});var s=null===C||void 0===C||null===(t=C.projects)||void 0===t?void 0:t.find(function(e){return e.id===l.incidentType}),r=Object(d.a)(Object(d.a)({},l),{},{accountNumber:l.accountNumber,accountName:l.accountName,accountContactName:l.accountContactName,accountContactPhone:l.accountContactPhone,accountContactEmail:l.accountContactEmail,incidentLocation:Object(d.a)(Object(d.a)({},l.incidentLocation),{},{type:"incident-location"}),incidentType:{id:l.incidentType,type:"project"},incidentTypeName:null===s||void 0===s?void 0:s.name,incidentPriority:null===(n=l.incidentPriority)||void 0===n?void 0:n.toString(),incidentProtocols:l.incidentProtocols,incidentDate:null===(a=H()(l.incidentDate))||void 0===a?void 0:a.format("MM/DD/YYYY"),incidentTime:null===(i=H()(l.incidentTime))||void 0===i?void 0:i.format("HH:mm:ss"),incidentDescription:l.incidentDescription,callerLocation:l.callerLocation});y(void 0),F(!0),j.publishToEvent(m.PublishPageTopics,Wt(null===M||void 0===M?void 0:M.connectionId),Dn({userId:null===M||void 0===M?void 0:M.userId,attributes:r,responders:c,assets:o,connectionId:null===M||void 0===M?void 0:M.connectionId,pageId:J,submitted:!0,unstructuredAttributes:e,invitation:!0}))},requiredMark:!1,onValuesChange:function(e,t){localStorage.setItem("form",JSON.stringify(t))},children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(Xa.a,{src:"/images/incident-icon.png",preview:!1}),Object(oa.jsx)("h3",{className:"ml-3",children:"911"})]}),Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon",onClick:function(){setTimeout(function(){localStorage.removeItem("form"),localStorage.removeItem("form"),w({type:De,payload:!1}),f.resetFields()})}})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"feature",children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Features"})})})}),Object(oa.jsxs)("div",{className:"main-cards",style:{maxHeight:"calc(100vh - 100px)"},children:[Object(oa.jsxs)(Za.a,{defaultActiveKey:JSON.parse(localStorage.getItem("active")||'["where", "what", "who"]'),bordered:!1,className:"simple-collapse",onChange:function(e){localStorage.setItem("active",JSON.stringify(e))},children:[Object(oa.jsx)(Oc,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/account-icon.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"Account"})]}),children:Object(oa.jsxs)("div",{className:"sub-cards-2",children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,{name:"accountNumber",children:Object(oa.jsx)(Wn.a,{placeholder:"Account Number"})})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,{name:"accountName",children:Object(oa.jsx)(Wn.a,{placeholder:"Account Name"})})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"accountContactName",children:Object(oa.jsx)(Wn.a,{placeholder:"Contact name"})})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"accountContactPhone",children:Object(oa.jsx)(Wn.a,{placeholder:"Contact phone"})})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"accountContactEmail",rules:[{required:!1,type:"email",message:"**Enter a valid email address"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Contact email"})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:16,className:"pr-2",xs:24,sm:16,children:Object(oa.jsx)(ei.a.Item,{name:"accountContactAlternativePhone",children:Object(oa.jsx)(Wn.a,{placeholder:"Alternative phone number"})})}),Object(oa.jsx)(Hn.a,{span:8,xs:24,sm:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",children:"Profile"})})]}),null===ue||void 0===ue||null===(t=ue.account)||void 0===t?void 0:t.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3",children:null===e||void 0===e?void 0:e.Cols.map(function(t,n){return Object(oa.jsx)(Hn.a,{span:t.ColSize,className:n!==(null===e||void 0===e?void 0:e.Cols.length)-1&&"pr-2",xs:24,sm:t.ColSize,children:Object(oa.jsx)(dc,{data:t})})})})})]})},"account"),Object(oa.jsx)(Oc,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/geo-icon.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"Where"})]}),children:Object(oa.jsxs)("div",{className:"sub-cards-2",children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:20,className:"pr-2",xs:24,sm:20,children:Object(oa.jsx)(ei.a.Item,{rules:[{required:!0,message:"**Required Field"}],name:"incidentLocation",children:Object(oa.jsx)(ai,{placeholder:"Incident Location",onChange:function(e){ve({incidentLocation:e})}})})}),Object(oa.jsx)(Hn.a,{span:4,xs:24,sm:4,children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",onClick:function(){A.incidentLocation&&S(Object(d.a)(Object(d.a)({},I),{},{map:!0,form:window.innerWidth>=700}))},children:"Map"})})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:20,xs:24,sm:20,children:Object(oa.jsx)(ei.a.Item,{rules:[],name:"callerLocation",children:Object(oa.jsx)(ai,{placeholder:"Caller Location",onChange:function(e){ve({callerLocation:e})}})})}),Object(oa.jsx)(Hn.a,{span:4,className:"pl-2",xs:24,sm:4,children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",onClick:function(){var e=f.getFieldValue("callerLocation");void 0!==e&&(f.setFieldsValue({incidentLocation:e,incidentType:void 0}),w({type:Pe,payload:void 0}),ve({incidentLocation:e}))},children:"Incident"})})]}),Object(oa.jsx)(ei.a.List,{name:"otherLocations",children:function(e,t){var n=t.add,a=t.remove;return Object(oa.jsxs)(oa.Fragment,{children:[e.map(function(e){var t=e.key,n=e.name,i=Object(Ka.a)(e,bc);return Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:10,className:"pr-2",xs:24,sm:10,children:Object(oa.jsx)(ei.a.Item,Object(d.a)(Object(d.a)({},i),{},{name:[n,"location"],rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(ai,{placeholder:"Location",onChange:function(e){ve(Object(T.a)({},n,e))}})}))}),Object(oa.jsx)(Hn.a,{span:10,className:"pr-2",xs:24,sm:10,children:Object(oa.jsx)(ei.a.Item,Object(d.a)(Object(d.a)({},i),{},{name:[n,"tag"],rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Tag"})}))}),Object(oa.jsx)(Hn.a,{span:4,xs:24,sm:4,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",onClick:function(){a(n),w({type:Fe,payload:n}),f.setFieldsValue({incidentType:void 0}),w({type:Pe,payload:void 0})},children:"Remove"})})})]},t)}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",onClick:function(){n()},children:"Add"})})})})]})}}),null===ue||void 0===ue||null===(n=ue.where)||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3",children:null===e||void 0===e?void 0:e.Cols.map(function(t,n){return Object(oa.jsx)(Hn.a,{span:t.ColSize,className:n!==(null===e||void 0===e?void 0:e.Cols.length)-1&&"pr-2",xs:24,sm:t.ColSize,children:Object(oa.jsx)(dc,{data:t})})})})})]})},"where"),Object(oa.jsx)(Oc,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/pause-icon.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"What"})]}),children:Object(oa.jsxs)("div",{className:"sub-cards-2",children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,{rules:[{required:!0,message:"**Required Field"}],name:"incidentType",children:Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Incident Type",onChange:function(e){w({type:Pe,payload:e})},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===C||void 0===C||null===(c=C.projects)||void 0===c?void 0:c.map(function(e,t){return Object(oa.jsx)(mc,{value:e.id,children:e.name})})})})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,{rules:[{required:!0,message:"**Required Field"}],name:"incidentPriority",children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Priority",options:te})})})]}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{rules:[{required:!0,message:"**Required Field"}],name:"incidentProtocols",children:Object(oa.jsx)(pc,{autoSize:{minRows:4,maxRows:6},placeholder:"Protocols"})})})}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:8,className:"pr-2",xs:24,sm:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover w-full",children:"SURVEY"})}),Object(oa.jsx)(Hn.a,{span:8,className:"px-2",xs:24,sm:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover w-full",children:"NCIC"})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",xs:24,sm:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn bordered w-full",children:"NFIRS"})})]}),null===ue||void 0===ue||null===(o=ue.what)||void 0===o?void 0:o.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3",children:null===e||void 0===e?void 0:e.Cols.map(function(t,n){return Object(oa.jsx)(Hn.a,{span:t.ColSize,className:n!==(null===e||void 0===e?void 0:e.Cols.length)-1&&"pr-2",xs:24,sm:t.ColSize,children:Object(oa.jsx)(dc,{data:t})})})})})]})},"what"),Object(oa.jsx)(Oc,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/clock.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"When"})]}),children:Object(oa.jsxs)("div",{className:"sub-cards-2",children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,xs:24,sm:12,children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png"}),Object(oa.jsx)(ei.a.Item,{name:"incidentDate",rules:[{required:!1,message:"**Required Field"}],children:Object(oa.jsx)(di,{placeholder:"Incident date"})})]})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",xs:24,sm:12,children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png"}),Object(oa.jsx)(ei.a.Item,{rules:[{required:!1,message:"**Required Field"}],name:"incidentTime",children:Object(oa.jsx)(gi,{name:"Incident time",onChange:function(e){}})})]})})]}),null===ue||void 0===ue||null===(r=ue.when)||void 0===r?void 0:r.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3",children:null===e||void 0===e?void 0:e.Cols.map(function(t,n){return Object(oa.jsx)(Hn.a,{span:t.ColSize,className:n!==(null===e||void 0===e?void 0:e.Cols.length)-1&&"pr-2",xs:24,sm:t.ColSize,children:Object(oa.jsx)(dc,{data:t})})})})})]})},"when"),Object(oa.jsx)(Oc,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/why.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"Why"})]}),children:Object(oa.jsxs)("div",{className:"sub-cards-2",children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"incidentDescription",children:Object(oa.jsx)(pc,{autoSize:{minRows:4,maxRows:6},placeholder:"Description"})})})}),null===ue||void 0===ue||null===(v=ue.why)||void 0===v?void 0:v.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3",children:null===e||void 0===e?void 0:e.Cols.map(function(t,n){return Object(oa.jsx)(Hn.a,{span:t.ColSize,className:n!==(null===e||void 0===e?void 0:e.Cols.length)-1&&"pr-2",xs:24,sm:t.ColSize,children:Object(oa.jsx)(dc,{data:t})})})})})]})},"why"),Object(oa.jsxs)(Oc,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/user1-icon.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"Who"})]}),children:[Object(oa.jsx)(ei.a.List,{name:"who",children:function(e,t){var n=t.add,a=t.remove;return Object(oa.jsxs)(oa.Fragment,{children:[e.map(function(e){var t=e.key,n=e.name,i=Object(Ka.a)(e,jc);return Object(oa.jsxs)("div",{className:"sub-cards-2",children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:20,className:"pr-2",xs:24,sm:20,children:Object(oa.jsx)(ei.a.Item,Object(d.a)(Object(d.a)({},i),{},{name:[n,"tag"],rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Tag"})}))}),Object(oa.jsx)(Hn.a,{span:4,xs:24,sm:4,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",onClick:function(){a(n)},children:"Remove"})})})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,Object(d.a)(Object(d.a)({},i),{},{rules:[{required:!0,message:"**Required Field"}],name:[n,"callerFirstName"],children:Object(oa.jsx)(Wn.a,{placeholder:"First Name"})}))}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,{name:[n,"callerLastName"],children:Object(oa.jsx)(Wn.a,{placeholder:"Last name"})})})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:8,xs:24,sm:8,children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png",alt:""}),Object(oa.jsx)(ei.a.Item,{name:[n,"callerDateOfBirth"],children:Object(oa.jsx)(di,{placeholder:"Date of birth"})})]})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",xs:24,sm:8,children:Object(oa.jsx)(ei.a.Item,{name:[n,"callerAge"],children:Object(oa.jsx)(Wn.a,{placeholder:"Age"})})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",xs:24,sm:8,children:Object(oa.jsx)(ei.a.Item,{name:[n,"callerGender"],children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Gender",options:[{label:"Male",value:"Male"},{label:"Female",value:"Female"}]})})})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,{name:[n,"callerPhone"],children:Object(oa.jsx)(Wn.a,{placeholder:"Phone"})})}),Object(oa.jsx)(Hn.a,{span:12,xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,{name:[n,"callerAlternativePhone"],children:Object(oa.jsx)(Wn.a,{placeholder:"Alternative Phone"})})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:[n,"callerInstructions"],children:Object(oa.jsx)(pc,{autoSize:{minRows:4,maxRows:6},placeholder:"Instructions"})})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",children:"Profile"})})})]},t)}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full more-btn",onClick:function(){n()},children:"Add"})})})})]})}}),Object(oa.jsx)("div",{className:"sub-cards-2",children:null===ue||void 0===ue||null===(b=ue.where)||void 0===b?void 0:b.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3",children:null===e||void 0===e?void 0:e.Cols.map(function(t,n){return Object(oa.jsx)(Hn.a,{span:t.ColSize,className:n!==(null===e||void 0===e?void 0:e.Cols.length)-1&&"pr-2",xs:24,sm:t.ColSize,children:Object(oa.jsx)(dc,{data:t})})})})})})]},"who"),null===se||void 0===se?void 0:se.map(function(e,t){return Object(oa.jsx)(Oc,{header:Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h5",{className:"ml-3",children:e.sectionName})}),children:Object(oa.jsx)("div",{className:"sub-cards-2",children:null===e||void 0===e?void 0:e.Rows.map(function(t,n){return Object(oa.jsx)(Yn.a,{className:n>0?"mt-3":"",children:Object(oa.jsxs)(i.a.Fragment,{children:[!t.isMulti&&(null===t||void 0===t?void 0:t.Cols.map(function(e,t){return Object(oa.jsx)(Hn.a,{span:e.ColSize,className:"pr-2",xs:24,sm:e.ColSize,children:Object(oa.jsx)(dc,{data:e})})})),t.isMulti&&Object(oa.jsx)(vc,{listName:"".concat(e.sectionName,"MultiRow").concat(n),cols:null===t||void 0===t?void 0:t.Cols,RenderFields:dc})]})})})})},e.sectionName)})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("h4",{children:"Responder"}),R&&R.map(function(e,t){var n,a,i;return Object(oa.jsxs)(Yn.a,{className:"responder-item mt-3",children:[Object(oa.jsx)(Hn.a,{span:4,children:Object(oa.jsx)("img",{src:"/images/users/user.png",alt:"",width:"50",height:"50"})}),Object(oa.jsxs)(Hn.a,{span:8,children:[Object(oa.jsx)("h5",{children:"".concat(null===e||void 0===e||null===(n=e.profile)||void 0===n?void 0:n.firstName," ").concat(null===e||void 0===e||null===(a=e.profile)||void 0===a?void 0:a.lastName)}),Object(oa.jsxs)("p",{children:["ID: ",null===e||void 0===e||null===(i=e.beamIds)||void 0===i?void 0:i[0]]})]}),Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn action-btn",children:"Responders"})}),Object(oa.jsx)(Hn.a,{span:6,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn mr-2",children:Object(oa.jsx)("img",{src:"/images/flag-green.png",alt:"",width:"15",height:"15"})})})]})})]})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("h4",{children:"Assets"}),P&&P.filter(function(e){return"fixedAsset"===e.assetType}).map(function(e,t){var n,a,i,c;return Object(oa.jsxs)(Yn.a,{className:"responder-item mt-3",children:[Object(oa.jsx)(Hn.a,{span:4,children:Object(oa.jsx)(fa.a,{src:"/images/map-line-icon.svg"})}),Object(oa.jsxs)(Hn.a,{span:8,children:[Object(oa.jsx)("h5",{children:null===(n=e.location)||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.title}),Object(oa.jsx)("p",{children:null===(i=e.location)||void 0===i||null===(c=i.attributes)||void 0===c?void 0:c.description})]}),Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn action-btn",children:"Asset"})}),Object(oa.jsx)(Hn.a,{span:6,className:"t-right"})]})})]})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("h4",{children:"POIs"}),P&&P.filter(function(e){return"poi"===e.assetType}).map(function(e,t){var n,a,i,c;return Object(oa.jsxs)(Yn.a,{className:"responder-item mt-3",children:[Object(oa.jsx)(Hn.a,{span:4,children:Object(oa.jsx)(fa.a,{src:"/images/map-star-icon.svg"})}),Object(oa.jsxs)(Hn.a,{span:8,children:[Object(oa.jsx)("h5",{children:null===(n=e.location)||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.title}),Object(oa.jsx)("p",{children:null===(i=e.location)||void 0===i||null===(c=i.attributes)||void 0===c?void 0:c.description})]}),Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn action-btn",children:"Poi"})}),Object(oa.jsx)(Hn.a,{span:6,className:"t-right"})]})})]})})]}),x&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:x})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",xs:24,sm:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",children:"Transfer"})}),Object(oa.jsx)(Hn.a,{span:8,xs:24,sm:8,className:"px-2",onClick:function(){},children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn cover w-full",loading:V,children:"Save"})}),Object(oa.jsx)(Hn.a,{span:8,className:"pr-2",xs:24,sm:8,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:q,children:"Submit"})})})]})]})})})},hc=n(28),gc=n.n(hc),xc=Object(da.compose)(Object(da.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M&v=3.exp&libraries=geometry,drawing,places",loadingElement:Object(oa.jsx)("div",{style:{height:"100%"}}),containerElement:Object(oa.jsx)("div",{style:{height:"100%"}}),mapElement:Object(oa.jsx)("div",{style:{height:"100%"}})}),Object(da.withStateHandlers)(function(){return{isOpen:!1,activeMarker:null,directions:null,selectDirectionPin:null,drawingMode:null,activeInfo:null}},{onToggleOpen:function(e){var t=e.isOpen;return function(e){return{isOpen:!t,activeMarker:e}}},showDirection:function(){return function(e){return{directions:e}}},setDrawingMode:function(){return function(e){return{drawingMode:e}}},setSelectDirectionPin:function(){return function(e){return{selectDirectionPin:e}}},setActiveInfo:function(){return function(e){return{activeInfo:e}}}}),ua.withScriptjs,ua.withGoogleMap)(function(e){e.isOpen,e.active,e.setActive;var t,n=e.markers,i=e.assetMarkers,c=e.currentMarkers,o=e.currentLocation,l=e.getPlaces,r=e.setActiveInfo,d=e.activeInfo,u=Object(a.useRef)(null),v=Object(s.c)(function(e){return e.auth}),b=v.selectedResponders,j=v.selectedAssets,m=Object(s.b)();Object(a.useEffect)(function(){b&&b.length>0&&console.log("update component")},[b]);var p=function(){u.current&&(t&&clearTimeout(t),t=setTimeout(function(){var e=u.current.getBounds();if(e){var t=e.getNorthEast(),n=e.getSouthWest();l({center:u.current.getCenter(),bounds:{minLat:n.lat(),maxLat:t.lat(),minLon:n.lng(),maxLon:t.lng()}})}},500))};return Object(a.useEffect)(function(){!function(){var e=new google.maps.LatLngBounds;n.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),i.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),c.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),e.isEmpty()||u.current.fitBounds(e)}()},[n,c,i]),Object(oa.jsxs)(ua.GoogleMap,{defaultZoom:14,options:{maxZoom:17},center:o,onZoomChanged:function(){p()},onCenterChanged:function(){p()},onTilesLoaded:function(){u.current&&o&&p()},ref:u,children:[n.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===b.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){m({type:Ce,payload:e})},label:e.title},t)}),i.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===j.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){m({type:we,payload:e})},label:e.title},t)}),c.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===b.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){r(t)},children:d===t&&Object(oa.jsx)(ua.InfoWindow,{onCloseClick:function(){r(null)},children:Object(oa.jsx)("div",{children:Object(oa.jsx)("div",{children:e.title})})})},t)}),Object(oa.jsx)(ua.Marker,{position:o,icon:{url:"/images/map-plain-icon-blue.svg",scaledSize:new google.maps.Size(22,34)},onClick:function(){}})]})}),yc=n(107),Ic=n.n(yc),Sc={lat:51.509865,lng:-.118092};var Nc=function(e){var t=e.socket,n=e.params,i=n.screens,c=n.setScreens,o=Object(a.useState)(),r=Object(u.a)(o,2),v=(r[0],r[1],Object(a.useState)()),b=Object(u.a)(v,2),j=b[0],p=b[1],O=Object(a.useState)(!0),f=Object(u.a)(O,2),h=f[0],g=f[1],x=Object(a.useState)(!0),y=Object(u.a)(x,2),I=y[0],S=(y[1],Object(a.useState)([])),N=Object(u.a)(S,2),k=N[0],T=N[1],C=Object(a.useState)([]),w=Object(u.a)(C,2),E=w[0],R=w[1],P=Object(a.useState)([]),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Object(a.useState)(!1),U=Object(u.a)(L,2),q=U[0],F=U[1],B=Object(a.useReducer)(function(e){return e+1},0),_=Object(u.a)(B,2),$=(_[0],_[1],Object(s.c)(function(e){return e.auth})),Y=$.responders,H=($.incidentLocation,$.project),W=$.otherLocations,V=$.assets,z=$.encrypted_token,Q=$.projects,G=Object(l.g)().search,J=Object(a.useState)(),K=Object(u.a)(J,2),Z=K[0],X=K[1],ee=(Object(s.b)(),function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],i=t[1];Object(a.useEffect)(function(){i(!0)},[])}(),{createPlaceMarker:function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.geoJson)||void 0===n||null===(a=n.features)||void 0===a||a.map(function(e){(null===e||void 0===e?void 0:e.geometry.coordinates.length)>0&&(j=e.geometry)}),Object(d.a)(Object(d.a)({},e),{},{lat:null===(i=j)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c[1],lng:null===(o=j)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l[0],title:(null===(s=e.beamIds)||void 0===s?void 0:s[0])||"".concat(e.profile.firstName,".").concat(e.profile.lastName),color:"orange",paths:{lat:null===(r=j)||void 0===r||null===(u=r.coordinates)||void 0===u?void 0:u[1],lng:null===(v=j)||void 0===v||null===(b=v.coordinates)||void 0===b?void 0:b[0]},type:"marker",filter:"viewOnly",fitBounds:m})},createCurrentMarker:function(e){var t,n,a,i,c,o,l,s;return Object(d.a)(Object(d.a)({},e),{},{lat:null===e||void 0===e||null===(t=e.value)||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.lat,lng:null===e||void 0===e||null===(a=e.value)||void 0===a||null===(i=a.coordinates)||void 0===i?void 0:i.long,title:null===e||void 0===e?void 0:e.label,color:"blue",paths:{lat:null===e||void 0===e||null===(c=e.value)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o.lat,lng:null===e||void 0===e||null===(l=e.value)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s.long},type:"marker"})},createAssetMarker:function(e){var t,n,a,i,c,o,l,s,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"fixedAsset"===(null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.type)?s=null===e||void 0===e?void 0:e.asset:"poi"===(null===e||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)&&(s=null===e||void 0===e?void 0:e.poi);var u=s.location;return Object(d.a)(Object(d.a)({},s),{},{id:e.id,assetType:null===e||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.type,lat:null===u||void 0===u||null===(i=u.coordinates)||void 0===i?void 0:i.lat,lng:null===u||void 0===u||null===(c=u.coordinates)||void 0===c?void 0:c.long,title:u.attributes.title,color:"orange",paths:{lat:null===u||void 0===u||null===(o=u.coordinates)||void 0===o?void 0:o.lat,lng:null===u||void 0===u||null===(l=u.coordinates)||void 0===l?void 0:l.long},type:"marker",filter:"viewOnly",fitBounds:r})}}),te=ee.createPlaceMarker,ne=ee.createCurrentMarker,ae=ee.createAssetMarker,ie=Object(a.useState)(!1),ce=Object(u.a)(ie,2),oe=ce[0],le=ce[1];Object(a.useEffect)(function(){re()},[]),Object(a.useEffect)(function(){if(W){var e=Object.keys(W).map(function(e){return ne(W[e])});M(e)}},[W]);var se=function(e,n,a){var i=new URLSearchParams(G),c=i.get("userId")||(null===z||void 0===z?void 0:z.userId),o=i.get("connectionId")||(null===z||void 0===z?void 0:z.connectionId);le(!0),t.publishToEvent(m.PublishPageTopics,Yt(o),Dn({userId:c,projectId:H,cudbServiceId:null===Q||void 0===Q?void 0:Q.userServiceId,latLng:e,height:n,width:a})),t.publishToEvent(m.PublishPageTopics,function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/getAssets")}(o),Dn({userId:c,projectId:H,latLng:e,height:n,width:a}))};Object(a.useEffect)(function(){if(H&&Z){var e=Z.latLong,t=Z.height,n=Z.width;se(e,t,n)}},[H]),Object(a.useEffect)(function(){if(le(!1),Y&&Y.length>0){var e=Y.map(function(e){return te(e)});0===(e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng})).length&&Lt("No Responder available in the area","error","TOP_CENTER",1e3),T(e)}},[Y]),Object(a.useEffect)(function(){if(le(!1),V&&V.length>0){var e=V.map(function(e){return ae(e)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),R(e)}},[V]);var re=function(){j&&null!==j&&void 0!==j&&j.current?p(Object(d.a)({},j)):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,n,a,i,c;p({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,lng:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude,current:!0}),gc.a.fromLatLng(null===e||void 0===e||null===(a=e.coords)||void 0===a||null===(i=a.latitude)||void 0===i?void 0:i.toString(),null===(c=e.coords.longitude)||void 0===c?void 0:c.toString()).then(function(e){for(var t=0,n=e.results[0].address_components.length;t<n;t++){var a=e.results[0].address_components[t];a.types.indexOf("administrative_area_level_1")>=0&&a.short_name,a.types.indexOf("country")>=0&&a.short_name}},function(e){console.error(e)})}):(alert("Geolocation is not supported by this browser."),p(Sc))},de=function(e,t,n,a){var i=ue(n-e),c=ue(a-t),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(ue(e))*Math.cos(ue(n))*Math.sin(c/2)*Math.sin(c/2);return 1e3*(6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))))},ue=function(e){return e*(Math.PI/180)};return Object(oa.jsx)("div",{className:"main-column map-panel map-responsive mr-4",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex"}),Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon",onClick:function(){return c(Object(d.a)(Object(d.a)({},i),{},{map:!1,form:!0}))}})})]}),Object(oa.jsx)("div",{className:"search-bar mt-3",children:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)("div",{className:"g-map-search-input",children:Object(oa.jsx)(Ii.a,{autocompletionRequest:{},selectProps:{onChange:function(e){e&&function(e){Object(Ii.b)(e.place_id).then(function(e){e[0].geometry&&p({lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),current:!1})}).catch(function(e){return console.error(e)})}(e.value)},isClearable:!0,placeholder:"Search map",styles:{input:function(e){return Object(d.a)(Object(d.a)({},e),{},{fontFamily:"Nunito-Regular"})}}},apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/location-icon.svg",onClick:re})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/reload-icon.svg",onClick:function(){g(!1),F(!1),T([]),R([]),re()}})})]})}),Object(oa.jsx)("div",{className:"main-cards",style:{maxHeight:"calc(100% - 110px)"},children:Object(oa.jsxs)(Yn.a,{className:"map-container-layout",children:[Object(oa.jsx)(Hn.a,{md:i.active&&q?18:24,xs:24,children:I&&Object(oa.jsx)(xc,{currentLocation:j,markers:k,assetMarkers:E,currentMarkers:A,active:h,setActive:g,getPlaces:function(e){var t=e.bounds,n=e.center,a=de(t.minLat,t.maxLon,t.maxLat,t.maxLon),i=de(t.minLat,t.maxLon,t.minLat,t.minLon),c={lat:n.lat(),long:n.lng()};X({latLong:c,height:a,width:i})}})}),Object(oa.jsxs)(Yn.a,{className:"lock-icons",onClick:function(){if(Z){var e=Z.latLong,t=Z.height,n=Z.width;se(e,t,n)}},children:[oe&&Object(oa.jsx)(Hn.a,{span:2,children:Object(oa.jsx)(Ic.a,{type:"TailSpin",color:"#fff",height:15,width:15})}),Object(oa.jsx)(Hn.a,{span:22,children:"Search & select the available responders in the area"})]})]})})]})})},kc=n(70),Tc=n.n(kc),Cc=n(1046),wc=n(223),Ec=n(1057),Rc=n(1058),Pc=n(1059),Dc=n(18),Ac=(n(104),n(89));n(955),Za.a.Panel;Dc.d.register(Dc.a,Dc.j,Dc.e);var Mc=Gn.a.Option,Lc=function(e){var t=e.socket,n=(e.params,e.filter),c=(e.selected,e.componentUuid),o=Object(l.g)().search,r=Object(s.c)(function(e){return e.auth}),v=r.userRequests,b=r.projects,j=(r.pageAggregateBds,r.selectedPage),p=r.encrypted_token,O=r.searchByPhone,f=Object(s.b)(),h=Object(a.useState)("project"),g=Object(u.a)(h,2),x=g[0],I=g[1],S=Object(a.useState)("state"),N=Object(u.a)(S,2),k=N[0],w=N[1],E=Object(a.useState)(!1),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(void 0),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(void 0),F=Object(u.a)(q,2),B=F[0],_=F[1],$=Object(a.useState)(!1),Y=Object(u.a)($,2),H=Y[0],V=Y[1],G=Object(a.useState)(!1),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)([]),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)([]),ie=Object(u.a)(ae,2),ce=ie[0],oe=ie[1],le=Object(a.useState)([]),se=Object(u.a)(le,2),re=(se[0],se[1]),de=Object(a.useState)([]),ue=Object(u.a)(de,2),ve=(ue[0],ue[1]),be=Object(a.useRef)(W()),je=(Object(a.useRef)(W()),Object(a.useRef)(void 0)),me=Object(a.useRef)(void 0),pe=Object(a.useRef)(0),Oe=Object(a.useRef)(void 0),fe=Object(a.useState)(),he=Object(u.a)(fe,2),ge=he[0],xe=he[1],ye=Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0}),Ie=Object(u.a)(ye,2),Se=Ie[0],Ne=Ie[1],ke=Object(a.useState)(0),Te=Object(u.a)(ke,2),Ce=Te[0],we=Te[1],Ee=Object(a.useState)([]),Re=Object(u.a)(Ee,2),Pe=Re[0],De=Re[1],Ae=Object(a.useRef)(void 0),Me=Object(a.useRef)(void 0),Le=Object(a.useState)([]),Ue=Object(u.a)(Le,2),qe=Ue[0],Fe=Ue[1],Be=Object(a.useState)(!1),_e=Object(u.a)(Be,2),$e=_e[0],Ye=_e[1],He=Object(a.useState)([]),We=Object(u.a)(He,2),Ve=(We[0],We[1]),ze=Object(a.useState)(void 0),Qe=Object(u.a)(ze,2),Ge=Qe[0],Je=Qe[1],Ke=Mn().getUserRequestPayload,Ze=Object(a.useRef)(void 0),Xe=Object(a.useRef)({project:void 0,user:void 0,status:void 0,area:void 0,time:void 0,phone:void 0}),et=Object(a.useRef)({}),nt=Object(a.useRef)(),at=Object(a.useRef)([]),it=Object(a.useCallback)(Object(Ac.a)(2e3,function(){console.log("debounce"),jt()},{atBegin:!0}),[]),ot=Object(a.useCallback)(function(e){var t,n,a;null!==(t=et.current)&&void 0!==t&&t[e]||(et.current[e]=Object(Ac.a)(2e3,function(e){console.log("search page here",e),bt(e)},{atBegin:!1})),null===(n=et.current)||void 0===n||null===(a=n[e])||void 0===a||a.call(n,e)},[]),lt=function(e){Xe.current.status=e?"exists(@status) && @status === '".concat(e,"'"):void 0,Xe.current.phone=void 0,V(!0),Oe.current=e,Je(e),mt()};Object(a.useEffect)(function(){var e;O&&(console.log("search by phone",O),e=null===O||void 0===O?void 0:O.phone,Xe.current.phone=e?"exists(@phone) && contains(@phone, '".concat(e,"')"):void 0,V(!0),Xe.current.status=void 0,Oe.current="lime",Je("lime"),mt())},[O]);var st=function(e,t){if("start"===e?je.current=t:me.current=t,je.current&&me.current){var n=new Date(je.current);n.setHours(0),n.setMinutes(1);var a=new Date(me.current);a.setHours(23),a.setMinutes(59),Xe.current.time="exists(@createdAt) && @createdAt > ".concat(n.getTime()," && @createdAt < ").concat(a.getTime()),Z(!0),mt()}else je.current||je.current||(Xe.current.time=void 0,Z(!0),mt())},rt=function(e){var t;if(x!==e&&null!==b&&void 0!==b&&b.projects&&Ze.current){U(void 0),ne([]);var n=[];switch(e){case"project":null===b||void 0===b||null===(t=b.projects)||void 0===t||t.map(function(e){n.push({label:e.name,value:e.id})}),ne(n);break;case"manager":ut(Ze.current,"manager");break;case"dispatcher":ut(Ze.current,"dispatcher");break;case"responder":ut(Ze.current,"responder")}I(e)}},dt=function(e){k!==e&&(_(void 0),oe([]),vt(e),w(e))},ut=function(e,n){var a;switch(n){case"dispatcher":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1===e.permissions.indexOf("admin")});break;case"responder":a=e.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")});break;case"manager":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")})}var i=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),c={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(i.join("||"),")")},anyStatus:!1};t.publishToEvent(m.PublishPageTopics,xn(null===p||void 0===p?void 0:p.connectionId),Dn(c,"".concat(be.current,":").concat(n))),D(!0)},vt=function(e){Z(!0);var t={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===p||void 0===p?void 0:p.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(T.a)({},e,"$.persistent.static.profile.".concat(e))},groupBy:{properties:["@".concat(e)],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:""}};f(tt({requestData:t,callback:function(e){Z(!1);var t=[];null===e||void 0===e||e.map(function(e){e[Object.keys(e)[0]]&&t.push({label:e[Object.keys(e)[0]],value:e[Object.keys(e)[0]]})}),oe(t)}}))},bt=function(e){var t;if("string"===typeof e){var n={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===(t=nt.current)||void 0===t?void 0:t.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},list:{objectIds:[e]},load:{persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId"}},filter:{expression:""}};f(tt({requestData:n,callback:function(e){xe(null===e||void 0===e?void 0:e[0])}}))}},jt=function(){var e,t=["exists(@profile)","exists(@type)","@type==='event'"];if(Xe.current.time)t.push(Xe.current.time);else{var n=new Date;n.setHours(0),n.setMinutes(1),t.push("exists(@createdAt) && @createdAt > ".concat(n.getTime()))}var a={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===nt||void 0===nt||null===(e=nt.current)||void 0===e?void 0:e.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{profile:"$..profile",type:"$..persistent.static.metadata.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",status:"$.nonpersistent.static.live.status.name"}},groupBy:{properties:["@status"],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:t.join("&&")}};f(tt({requestData:a,callback:function(e){var t=0,n={amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0};e.map(function(e){n[e.status]=e.count,t+=e.count}),Ne(Object(d.a)({all:t,live:t},n))}}))};Object(a.useEffect)(function(){Se&&we(Ce+1)},[JSON.stringify(Se)]),Object(a.useEffect)(function(){if(ge){var e,t,n,a,i,c,o,l,s,r,u,v,j,m,p,O,f,h,g,x,y,I,S,N=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===ge||void 0===ge||null===(e=ge.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.profile)||{}),(null===ge||void 0===ge||null===(n=ge.persistent)||void 0===n||null===(a=n.static)||void 0===a?void 0:a.dashboard)||{}),(null===ge||void 0===ge||null===(i=ge.persistent)||void 0===i||null===(c=i.static)||void 0===c?void 0:c.ride)||{}),(null===ge||void 0===ge||null===(o=ge.persistent)||void 0===o||null===(l=o.dynamic)||void 0===l?void 0:l.ride)||{}),k=null===ge||void 0===ge||null===(s=ge.nonpersistent)||void 0===s||null===(r=s.static)||void 0===r||null===(u=r.live)||void 0===u||null===(v=u.status)||void 0===v?void 0:v.name,T=Object(C.a)(Pe),w=T.findIndex(function(e){return e.key===ge.pageId});if(it(),Oe.current&&Oe.current!==k)return void(-1!==w&&(T.splice(w,1),De(T),Ae.current=T));var E={};Object.keys(N).map(function(e){"string"===typeof N[e]&&(E[e]=N[e])});var R,P,D=Object(d.a)(Object(d.a)({key:ge.pageId,pageStatus:null===ge||void 0===ge||null===(j=ge.nonpersistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.live)||void 0===p||null===(O=p.status)||void 0===O?void 0:O.name,name:null===ge||void 0===ge||null===(f=ge.persistent)||void 0===f||null===(h=f.static)||void 0===h||null===(g=h.metadata)||void 0===g?void 0:g.title,action:{pageId:ge.pageId,page:Object(d.a)(Object(d.a)({},ge),{},{profile:N}),summary:E.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId}},E),{},{address:null!==E&&void 0!==E&&E.address&&""!==(null===E||void 0===E?void 0:E.adress)?null===E||void 0===E?void 0:E.address:null===N||void 0===N||null===(x=N.pickupLocation)||void 0===x||null===(y=x.attributes)||void 0===y?void 0:y.address,dropoffAddress:null!==E&&void 0!==E&&E.dropoffAddress&&""!==(null===E||void 0===E?void 0:E.dropoffAddress)?null===E||void 0===E?void 0:E.dropoffAddress:null===N||void 0===N||null===(I=N.dropoffLocation)||void 0===I||null===(S=I.attributes)||void 0===S?void 0:S.address});if(console.log("source updated",D),-1!==w)T[w]=Object(d.a)(Object(d.a)({},D),{},{invited:null===Ae||void 0===Ae||null===(R=Ae.current)||void 0===R||null===(P=R[w])||void 0===P?void 0:P.invited});else T.unshift(D);ve(null===T||void 0===T?void 0:T.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;return{lat:null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(i=a.static)||void 0===i||null===(c=i.live)||void 0===c||null===(o=c.location)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l.lat,lng:null===e||void 0===e||null===(s=e.action)||void 0===s||null===(r=s.page)||void 0===r||null===(d=r.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.location)||void 0===b?void 0:b.coordinates.long,title:null===e||void 0===e||null===(j=e.action)||void 0===j||null===(m=j.page)||void 0===m||null===(p=m.persistent)||void 0===p||null===(O=p.static)||void 0===O||null===(f=O.metadata)||void 0===f?void 0:f.title}})),De(T),Ae.current=T}},[ge]);var mt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=["exists(@profile)","exists(@type)","@type==='event'"];Xe.current&&Object.keys(Xe.current).map(function(e){var t,a;null!==(t=Xe.current)&&void 0!==t&&t[e]&&n.push(null===(a=Xe.current)||void 0===a?void 0:a[e])});var a={};at.current&&at.current.map(function(e){a[e.key]=e.value}),pe.current=e;var i={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===p||void 0===p?void 0:p.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",type:"$..persistent.static.metadata.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name"},k,"$..profile.".concat(k)),a)},filter:{expression:n.join("&&")},sortBy:{properties:[{field:"@updatedAt",order:"DESC"}],max:10},result:{pagination:{offset:e,limit:30}}};f(tt({requestData:i,callback:function(n){re(n),pe.current=pe.current+30;var a=e>0?Object(C.a)(Pe):[],i=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Name",key:"name",dataIndex:"name"}];null===n||void 0===n||n.map(function(e,t){var n,i,c,o,l,s,r,u,v,j=null===e||void 0===e||null===(n=e.persistent)||void 0===n||null===(i=n.static)||void 0===i?void 0:i.profile,m={};Object.keys(j).map(function(e){"string"===typeof j[e]&&(m[e]=j[e])}),a.push(Object(d.a)({key:e.pageId,pageStatus:null===e||void 0===e||null===(c=e.nonpersistent)||void 0===c||null===(o=c.static)||void 0===o||null===(l=o.live)||void 0===l||null===(s=l.status)||void 0===s?void 0:s.name,name:null===e||void 0===e||null===(r=e.persistent)||void 0===r||null===(u=r.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title,action:{pageId:e.pageId,page:e,summary:m.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId}},m))}),console.log("source data",a.length),a.map(function(e){var t,n,a,c,o=null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(c=a.static)||void 0===c?void 0:c.profile;Object.keys(o).map(function(e){-1===i.findIndex(function(t){return t.key===e})&&"string"===typeof o[e]&&i.push({title:Q(e),dataIndex:e,key:e})})}),i.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:90},children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){t.publishToEvent(m.PublishPageTopics,On(null===e||void 0===e?void 0:e.pageId,null===p||void 0===p?void 0:p.userId),{page:null===e||void 0===e?void 0:e.page})},children:Object(oa.jsx)(wc.a,{})})}),Object(oa.jsx)(Hn.a,{span:12,children:(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t;window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(null===p||void 0===p?void 0:p.connectionId,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:Object(oa.jsx)(Ec.a,{})})})]})}}),Fe(i),console.log("source data",a),De(a),ve(null===n||void 0===n?void 0:n.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),V(!1),D(!1),Z(!1)}})),it()};return Object(a.useEffect)(function(){p&&(nt.current=p,t.subscribeToEvent(m.SubscribePageTopics,qt(null===p||void 0===p?void 0:p.connectionId)),t.publishToEvent(m.PublishPageTopics,Ft(null===p||void 0===p?void 0:p.connectionId),Dn({userId:null===p||void 0===p?void 0:p.userId})),t.subscribeToEvent(m.SubscribePageTopics,Rn(null===p||void 0===p?void 0:p.userId),function(e){ot(null===e||void 0===e?void 0:e.data)},c),D(!0),mt(),vt("state"),Ve(JSON.parse(localStorage.getItem("tableHideList"))||[]))},[p]),Object(a.useEffect)(function(){if(t.client){var e=new URLSearchParams(o),n=e.get("userId"),a=e.get("connectionId"),i=e.get("token");f(i?ct({data:{payload:i},callback:function(e){}}):{type:"ADD_ENCRYPTED_TOKEN",payload:{connectionId:a,userId:n}})}},[o,t.client]),Object(a.useEffect)(function(){if(b){var e,n=[];null===b||void 0===b||null===(e=b.projects)||void 0===e||e.map(function(e){n.push({label:e.name,value:e.id})}),ne(n),null!==b&&void 0!==b&&b.adminUserId&&(a=null===b||void 0===b?void 0:b.adminUserId,i=null===b||void 0===b?void 0:b.userServiceId,Ze.current||(t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Ke(a,"$","$..role"),hn(null===p||void 0===p?void 0:p.connectionId),i),t.subscribeToSurvey(m.SurveyTopics,hn(null===p||void 0===p?void 0:p.connectionId),function(e){var t,n;Ze.current=null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]},c)),t.subscribeToEvent(m.SubscribePageTopics,bn(null===p||void 0===p?void 0:p.connectionId,null===b||void 0===b?void 0:b.userServiceId)),t.subscribeToEvent(m.SubscribePageTopics,yn(null===p||void 0===p?void 0:p.connectionId)),t.subscribeToEvent(m.SubscribePageTopics,Pn(),function(e){var t,n,a,i,c,o,l,s;console.log("ride invitation get",e);var r=null===e||void 0===e||null===(t=e.pattern)||void 0===t||null===(n=t.split("/"))||void 0===n?void 0:n[4],d=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.pageId,u=1e3*(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.timeout),v=null===e||void 0===e||null===(c=e.data)||void 0===c||null===(o=c.rideRequestAttributes)||void 0===o?void 0:o.cudbServiceId;if((null===b||void 0===b?void 0:b.userServiceId)===v){console.log("user id",r,d,u);var j=(null===(l=Me.current)||void 0===l||null===(s=l.find(function(e){return e.id===r}))||void 0===s?void 0:s.beamId)||"user# ".concat(r),m=Object(C.a)(Ae.current||[]),p=m.findIndex(function(e){var t;return(null===(t=e.key)||void 0===t?void 0:t.toString())===(null===d||void 0===d?void 0:d.toString())});-1!==p&&(m[p].invited=j,Ae.current=m,bt(d),setTimeout(function(){var e=Object(C.a)(Ae.current||[]),t=e.findIndex(function(e){var t;return(null===(t=e.key)||void 0===t?void 0:t.toString())===(null===d||void 0===d?void 0:d.toString())});-1!==t&&(console.log("clear here"),e[t].invited="",Ae.current=e,bt(d))},u))}},c))}var a,i},[b]),Object(a.useEffect)(function(){if(v&&t.client){var e,n,a;if(!Me.current&&null!==v&&void 0!==v&&v[null===(e=Object.keys(v))||void 0===e?void 0:e[0]])console.log("user requests here",null===v||void 0===v?void 0:v[null===(n=Object.keys(v))||void 0===n?void 0:n[0]]),Me.current=null===v||void 0===v?void 0:v[null===(a=Object.keys(v))||void 0===a?void 0:a[0]];if(null!==v&&void 0!==v&&v["".concat(be.current,":").concat(x)]){var i;D(!1);var c=[];null===v||void 0===v||null===(i=v["".concat(be.current,":").concat(x)])||void 0===i||i.map(function(e){c.push({label:"".concat(e.fullName,": ").concat(e.email),value:e.id})}),ne(c)}}},[v,t.client]),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{gutter:30,className:"mb-2",style:$e?{}:{display:"none"},children:[Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{gutter:16,className:"d-flex px-1 flex-wrap",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){rt("manager")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("manager"===x?"green-btn cover":""),children:"Manager"})}),Object(oa.jsx)("div",{onClick:function(){rt("project")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("project"===x?"green-btn cover":""),children:"Project"})}),Object(oa.jsx)("div",{onClick:function(){rt("dispatcher")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("dispatcher"===x?"green-btn cover":""),children:"Dispatcher"})}),Object(oa.jsx)("div",{onClick:function(){rt("responder")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("responder"===x?"green-btn cover":""),children:"Responder"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:P,value:L,allowClear:!0,options:te,onChange:function(e){!function(e){switch(U(e),x){case"project":Xe.current.project=e?"exists(@iotAssetConfigId) && @iotAssetConfigId === '".concat(e,"'"):void 0,Xe.current.user=void 0,D(!0);break;case"manager":case"responder":case"dispatcher":at.current=[{key:"user",value:"$.persistent.static.metadata.members.users.".concat(e)}],Xe.current.user=e?"exists(@user)":void 0,Xe.current.project=void 0,D(!0)}mt()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex px-2 flex-wrap mt-4",children:Object(oa.jsx)(Hn.a,{sm:24,md:4,children:Object(oa.jsx)("h5",{className:"mb-0",children:"Status"})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:H,allowClear:!0,onChange:function(e){lt(e)},children:[Object(oa.jsx)(Mc,{value:"purple",children:"Created"}),Object(oa.jsx)(Mc,{value:"blue",children:"Started"}),Object(oa.jsx)(Mc,{value:"amber",children:"Assigned"}),Object(oa.jsx)(Mc,{value:"red",children:"Escalated"}),Object(oa.jsx)(Mc,{value:"green",children:"Completed"}),Object(oa.jsx)(Mc,{value:"gray",children:"Processed"}),Object(oa.jsx)(Mc,{value:"black",children:"Cancelled"})]})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{className:"d-flex flex-wrap",id:"filters",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){dt("state")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("state"===k?"green-btn cover":""),children:"State"})}),Object(oa.jsx)("div",{onClick:function(){dt("city")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("city"===k?"green-btn cover":""),children:"City"})}),Object(oa.jsx)("div",{onClick:function(){dt("county")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("county"===k?"green-btn cover":""),children:"County"})}),Object(oa.jsx)("div",{onClick:function(){dt("zip")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("zip"===k?"green-btn cover":""),children:"Zip"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{xs:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:K,allowClear:!0,options:ce,value:B,onChange:function(e){!function(e){_(e),Xe.current.time=e?"exists(@".concat(k,") && @").concat(k," === '").concat(e,"'"):void 0,Z(!0),mt()}(e)}})})}),Object(oa.jsxs)(Yn.a,{gutter:15,className:"d-flex flex-wrap mt-3 mx-0",children:[Object(oa.jsxs)(Hn.a,{xs:24,md:10,className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png",alt:""}),Object(oa.jsx)(Jn.a,{placeholder:"From",suffixIcon:Object(oa.jsx)(aa.a,{}),onChange:function(e){st("start",e)}})]}),Object(oa.jsx)(Hn.a,{xs:24,md:4,className:"d-flex justify-content-center",children:Object(oa.jsx)(fa.a,{src:"/images/next.svg"})}),Object(oa.jsxs)(Hn.a,{xs:24,md:10,className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png",alt:""}),Object(oa.jsx)(Jn.a,{placeholder:"To",suffixIcon:Object(oa.jsx)(aa.a,{}),onChange:function(e){st("end",e)}})]})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select Hour(s)",disabled:!0})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:4,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsx)("p",{className:"mb-2 text-center",children:"Export to"}),Object(oa.jsxs)("div",{className:"d-flex flex-row flex-md-column justify-content-center",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-csv.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-xls.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-pdf.svg"})})})]})]})})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid"},children:Object(oa.jsxs)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll",paddingRight:0,paddingTop:10},children:[n&&Object(oa.jsxs)(Yn.a,{className:"d-flex mb-2",children:[Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat(void 0===Ge?"status-selected":""),onClick:function(){lt(void 0)},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"All"}),Object(oa.jsx)("h4",{children:Se.live})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("purple"===Ge?"status-selected":""),onClick:function(){lt("purple")},children:Object(oa.jsxs)("div",{className:"purple",children:[Object(oa.jsx)("span",{children:"Created"}),Object(oa.jsx)("h4",{children:Se.purple})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("amber"===Ge?"status-selected":""),onClick:function(){lt("amber")},children:Object(oa.jsxs)("div",{className:"amber",children:[Object(oa.jsx)("span",{children:"Assigned"}),Object(oa.jsx)("h4",{children:Se.amber})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("blue"===Ge?"status-selected":""),onClick:function(){lt("blue")},children:Object(oa.jsxs)("div",{className:"blue",children:[Object(oa.jsx)("span",{children:"Started"}),Object(oa.jsx)("h4",{children:Se.blue})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("red"===Ge?"status-selected":""),onClick:function(){lt("red")},children:Object(oa.jsxs)("div",{className:"red",children:[Object(oa.jsx)("span",{children:"Escalated"}),Object(oa.jsx)("h4",{children:Se.red})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("green"===Ge?"status-selected":""),onClick:function(){lt("green")},children:Object(oa.jsxs)("div",{className:"green",children:[Object(oa.jsx)("span",{children:"Completed"}),Object(oa.jsx)("h4",{children:Se.green})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("grey"===Ge?"status-selected":""),onClick:function(){lt("grey")},children:Object(oa.jsxs)("div",{className:"grey",children:[Object(oa.jsx)("span",{children:"Processed"}),Object(oa.jsx)("h4",{children:Se.grey})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("black"===Ge?"status-selected":""),onClick:function(){lt("black")},children:Object(oa.jsxs)("div",{className:"black",children:[Object(oa.jsx)("span",{children:"Cancelled"}),Object(oa.jsx)("h4",{children:Se.black})]})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0 10px 0"},onClick:function(){Ye(!$e)},children:Object(oa.jsx)(Rc.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 10px 10px 0"},loading:P||H,onClick:function(){D(!0),mt()},children:!P&&!H&&Object(oa.jsx)(Pc.a,{})})]}),Object(oa.jsx)(Xi.a,{dataSource:Pe,className:(null===Pe||void 0===Pe?void 0:Pe.length)>0?"":"table-empty",onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){var t;f({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e||null===(t=e.action)||void 0===t?void 0:t.page}})}}},columns:qe,scroll:{x:!0},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===j||void 0===j||null===(n=j.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})]})})]})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var Uc=function(e){var t=e.socket,n=(Object(l.f)(),Object(s.b)(),Object(a.useState)({form:!0,map:!0})),i=Object(u.a)(n,2),c=i[0],o=i[1],r=Object(a.useState)("map"),d=Object(u.a)(r,2),b=d[0],j=(d[1],Object(a.useState)({driver:W(),advance:W(),dispatch:W(),all:W()})),m=Object(u.a)(j,2),p=m[0],O=(m[1],{screens:c,setScreens:o});return Object(oa.jsxs)(Yn.a,{className:"main-layout",style:{transform:"scale(0.8)",transformOrigin:"0 0",width:"125vw",height:"100vh"},children:[c.form&&Object(oa.jsx)(Hn.a,{md:c.map?7:24,xs:24,className:"form"===c.active?"active-screen":"",style:{height:"calc((100vh / 0.8) - 50px)",overflow:"scroll"},children:c.form&&Object(oa.jsx)(fc,{socket:t,params:O})}),c.map&&Object(oa.jsx)(Hn.a,{span:17,style:{height:"calc((100vh / 0.8) - 50px)",overflow:"scroll"},children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:24,className:"ride-container nine-container ".concat("map"===c.active?"active-screen":""),children:"map"===b&&Object(oa.jsx)(Nc,{socket:t,params:O})}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mt-3",style:{padding:0},children:Object(oa.jsx)(Lc,{socket:t,filter:!0,componentUuid:p.all})})})})]})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})},qc=n(1061),Fc=function(e){var t=e.value,n=void 0===t?void 0:t,i=e.onChange,c=e.max,o=Object(a.useState)(1),l=Object(u.a)(o,2),s=l[0],r=l[1];return Object(a.useEffect)(function(){},[]),Object(a.useEffect)(function(){n?r(n):i(s)},[n]),Object(oa.jsxs)(Yn.a,{className:"mt-2 d-flex",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Vn.a,{className:"primary count-btn",onClick:function(){0!==s&&i(s-1)},children:"-"})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsxs)("p",{children:[s<10?"0":"",s]})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Vn.a,{className:"primary count-btn",onClick:function(){c?s<c&&i(s+1):i(s+1)},children:"+"})})]})},Bc=function(e){var t=e.value,n=void 0===t?void 0:t,i=e.onChange,c=Object(a.useState)(),o=Object(u.a)(c,2),l=o[0],s=o[1];return Object(a.useEffect)(function(){n&&s(n)},[n]),Object(oa.jsxs)(Yn.a,{className:"mt-1 d-flex d-around",children:[Object(oa.jsxs)(Hn.a,{children:[Object(oa.jsx)(Vn.a,{className:"primary beam-btn ".concat("male"===l?"blue-btn":""),onClick:function(){"male"!==l?(s("male"),i("male")):(s(void 0),i(void 0))},children:Object(oa.jsx)(fa.a,{src:"/images/male-icon.svg"})}),Object(oa.jsx)("h5",{className:"mt-2",children:Object(oa.jsx)("b",{children:"Male"})})]}),Object(oa.jsxs)(Hn.a,{children:[Object(oa.jsx)(Vn.a,{className:"primary beam-btn ".concat("female"===l?"blue-btn":""),onClick:function(){"female"!==l?(s("female"),i("female")):(s(void 0),i(void 0))},children:Object(oa.jsx)(fa.a,{src:"/images/female-icon.svg"})}),Object(oa.jsx)("h5",{className:"mt-2",children:Object(oa.jsx)("b",{children:"Female"})})]})]})},_c=(Gn.a.Option,function(e){var t=e.value,n=e.placeholder,c=e.onChange,o=e.dispatchOptions,l=Object(a.useState)(o||[{id:"oneWay",name:"One way"},{id:"roundTrip",name:"Round trip"}]),s=Object(u.a)(l,2),r=s[0];s[1];return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)("div",{className:"d-flex flex-column justify-content-start align-items-start",children:[Object(oa.jsx)("div",{className:"ant-col ant-form-item-label",children:Object(oa.jsx)("label",{className:"ant-form-item-required",children:n})}),Object(oa.jsx)(yi.a.Group,{value:null===t||void 0===t?void 0:t.value,onChange:function(e){c({value:e.target.value,type:"rideType"})},children:null===r||void 0===r?void 0:r.map(function(e,t){return Object(oa.jsx)(yi.a,{value:e.id,children:e.name})})}),t&&"oneWay"!==(null===t||void 0===t?void 0:t.value)&&Object(oa.jsxs)(Yn.a,{className:"mt-3 w-100",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png",alt:""}),Object(oa.jsx)(di,{placeholder:"Select date",valuce:null===t||void 0===t?void 0:t.date,onChange:function(e){c({value:null===t||void 0===t?void 0:t.value,type:"rideType",date:e,time:null===t||void 0===t?void 0:t.time})}})]})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png",alt:""}),Object(oa.jsx)(gi,{name:"Select time",valuce:null===t||void 0===t?void 0:t.time,onChange:function(e){c({value:null===t||void 0===t?void 0:t.value,type:"rideType",date:null===t||void 0===t?void 0:t.date,time:e})}})]})})]})]})})}),$c=n(304),Yc=n(11),Hc=n.n(Yc),Wc=function(e){var t=e.value,n=(e.placeholder,e.onChange),i=e.socket,c=Object(s.c)(function(e){return e.auth}),o=c.projects,l=c.encrypted_token,r=c.vehicleTypes,d=Object(a.useState)(!1),v=Object(u.a)(d,2),b=v[0],j=v[1],p=Object(a.useState)([]),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(s.b)(),x=Mn().getUserRequestPayload;Object(a.useEffect)(function(){null!==o&&void 0!==o&&o.userServiceId&&i.subscribeToSurvey(m.SurveyTopics,gn(null===l||void 0===l?void 0:l.connectionId),function(e){var t,n,a;j(!1);var i=(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n||null===(a=n[0])||void 0===a?void 0:a.map(function(e){return{id:e._id,name:e.name,obj:e}}).filter(function(e){return!f.find(function(t){return e.id===t.id})}))||[],c=[].concat(Object(C.a)(f),Object(C.a)(i));h(c),g({type:"SET_VEHICLE_TYPES",payload:c})})},[null===o||void 0===o?void 0:o.userServiceId]),Object(a.useEffect)(function(){r?h(r):(j(!0),i.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,x(null===o||void 0===o?void 0:o.adminUserId,"$","$..admin.vehicleSettings.types"),gn(null===l||void 0===l?void 0:l.connectionId),null===o||void 0===o?void 0:o.userServiceId))},[]);var I=null===t||void 0===t?void 0:t.value;return Object(oa.jsx)("div",{children:b?Object(oa.jsx)($c.a,{}):Object(oa.jsx)(Yn.a,{gutter:[16,16],children:f.map(function(e){return Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Cc.a,{hoverable:!0,className:Hc()("vehicle-card",{selected:I===e.id}),onClick:function(){return function(e){I===e.id?n(void 0):n({type:"vehicleType",value:e.id,name:e.name})}(e)},style:{border:I===e.id?"2px solid #1890ff":"1px solid #e8e8e8",borderRadius:8,textAlign:"center"},children:e.name})},e.id)})})})},Vc=Gn.a.Option,zc=function(e){var t,n=e.value,i=e.placeholder,c=e.onChange,o=e.socket,r=e.vehicleType,d=e.vehicleId,v=(e.vehi,Object(s.c)(function(e){return e.auth})),b=v.projects,j=(v.users_filter,v.encrypted_token),p=v.vehicles,O=(Object(l.g)().search,Object(a.useState)(0)),f=Object(u.a)(O,2),h=(f[0],f[1],Object(a.useState)(!1)),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(a.useState)(!0),w=Object(u.a)(T,2),E=(w[0],w[1],Object(a.useState)([])),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(s.b)();Mn().getUserRequestPayload;return Object(a.useEffect)(function(){var e;null!==b&&void 0!==b&&b.userServiceId&&o.subscribeToEvent(m.SubscribePageTopics,(e=null===j||void 0===j?void 0:j.connectionId,"".concat("beamdevlive","/connection/").concat(e,"/service/ride-dps/getVehicleProjects/reply")),function(e){var t,n,a;console.log("vehicles",e),k(!1);var i=null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n||null===(a=n.projects)||void 0===a?void 0:a.map(function(e){return{id:d?e.vehicleId:e.assosiatedUserId,name:"".concat(e.name).concat(e.assosiatedUserBeamId?", ".concat(e.assosiatedUserBeamId):""),obj:e}}).filter(function(e){return void 0!==e.id});A({type:"SET_VEHICLES",payload:[].concat(Object(C.a)(P),Object(C.a)(i))}),y(!0),D([].concat(Object(C.a)(P),Object(C.a)(i)))})},[null===b||void 0===b?void 0:b.userServiceId]),Object(a.useEffect)(function(){console.log("vehicle type",r)},[r]),Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",value:x?null===n||void 0===n?void 0:n.value:null===n||void 0===n?void 0:n.valueName,allowClear:!0,placeholder:i,onChange:function(e){console.log("test",e);var t=P.find(function(t){return t.id===e});c({type:"vehicle",value:e,obj:null===t||void 0===t?void 0:t.obj})},loading:N,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},onFocus:function(){null!==b&&void 0!==b&&b.userServiceId&&(p?D(p):(k(!0),o.publishToEvent(m.PublishPageTopics,Nn(null===j||void 0===j?void 0:j.connectionId),Dn({userId:null===j||void 0===j?void 0:j.userId,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId}))))},onSearch:function(e){},onPopupScroll:function(e){},children:null===P||void 0===P||null===(t=P.filter(function(e){var t;return void 0===r||r===(null===e||void 0===e||null===(t=e.obj)||void 0===t?void 0:t.typeId)}))||void 0===t?void 0:t.map(function(e,t){return Object(oa.jsx)(Vc,{value:e.id,children:e.name},t)})})},Qc=(Gn.a.Option,function(e){var t=e.value,n=e.placeholder,i=e.onChange,c=e.dispatchOptions,o=e.disabled,l=e.estimatedFare,s=c||[{id:"fixed",name:"Fixed"},{id:"variable",name:"Variable"},{id:"bid",name:"Bid"}],r=Object(a.useMemo)(function(){var e=l&&l>0;return{isBidAllowed:e,minBid:e?.7*l:0,maxBid:e?1.3*l:1/0}},[l]),d=r.isBidAllowed,u=r.minBid,v=r.maxBid;return Object(oa.jsxs)("div",{className:"d-flex flex-column justify-content-start align-items-start",children:[Object(oa.jsx)("div",{className:"ant-col ant-form-item-label",children:Object(oa.jsx)("label",{className:"ant-form-item-required",children:n})}),Object(oa.jsx)(yi.a.Group,{disabled:o,value:null===t||void 0===t?void 0:t.value,onChange:function(e){i({value:e.target.value,type:"fareType"})},children:s.map(function(e){return Object(oa.jsx)(yi.a,{value:e.id,disabled:"bid"===e.id&&!d,children:e.name},e.id)})}),"fixed"===(null===t||void 0===t?void 0:t.value)&&Object(oa.jsxs)(Yn.a,{className:"mt-3 w-100",children:[Object(oa.jsx)("label",{className:"ant-form-item-required",children:"Fixed price"}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(la,{disabled:o,placeholder:"Fixed price",value:null===t||void 0===t?void 0:t.fare,onChange:function(e){i({value:null===t||void 0===t?void 0:t.value,type:"fareType",fare:e})}})})]}),"bid"===(null===t||void 0===t?void 0:t.value)&&Object(oa.jsxs)(Yn.a,{className:"mt-3 w-100",children:[Object(oa.jsxs)("label",{className:"ant-form-item-required",children:["Bid price"," ",Object(oa.jsxs)("span",{style:{color:"#888"},children:["(allowed: ",u.toFixed(0)," - ",v.toFixed(0),")"]})]}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(la,{disabled:o,placeholder:"Bid price",value:null===t||void 0===t?void 0:t.fare,onChange:function(e){i({value:null===t||void 0===t?void 0:t.value,type:"fareType",fare:e,estimatedFare:l})}})})]})]})}),Gc=function(e){var t=e.value,n=e.placeholder,c=e.onChange,o=e.dispatchOptions,l=Object(a.useState)(o||[{id:"meter",name:"Pay-driver"},{id:"now",name:"Pay-in-advance"}]),s=Object(u.a)(l,2),r=s[0];s[1];return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)("div",{className:"d-flex flex-column justify-content-start align-items-start",children:[Object(oa.jsx)("div",{className:"ant-col ant-form-item-label",children:Object(oa.jsx)("label",{className:"ant-form-item-required",children:n})}),Object(oa.jsx)(yi.a.Group,{value:null===t||void 0===t?void 0:t.value,onChange:function(e){c({value:e.target.value,type:"payType"})},children:null===r||void 0===r?void 0:r.map(function(e,t){return Object(oa.jsx)(yi.a,{value:e.id,children:e.name})})})]})})},Jc=n(1047),Kc=(Za.a.Panel,function(e){var t=e.onClose,n=e.handleConfirm,i=e.message,c=Object(a.useState)(!0),o=Object(u.a)(c,2),l=o[0],s=o[1],r=ei.a.useForm(),d=Object(u.a)(r,1)[0],v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=b[0],m=b[1],p=function(){s(!1),t&&t()};return Object(oa.jsx)($n.a,{title:"Please Confirm",visible:l,onCancel:p,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"confirmation-form",id:"confirmation-form",layout:"vertical",form:d,requiredMark:!1,children:[Object(oa.jsx)(ei.a.Item,{name:"password",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(Jc.a,{children:i||"Are you sure you want to continue?"})}),Object(oa.jsx)(ei.a.Item,{className:"action-grp mt-4",children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{loading:j,className:"beam-btn green-btn cover w-full",onClick:function(){m(!0),n()},children:"Confirm"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:p,children:"Cancel"})})]})})]})})}),Zc=n(1060),Xc=n(556);n(244),Za.a.Panel;Dc.d.register(Dc.a,Dc.j,Dc.e);Gn.a.Option;var eo=function(e){e.socket,e.params,e.filter;var t=e.selected,n=(e.componentUuid,e.onClose),c=e.phone,o=(Object(l.g)().search,Object(s.c)(function(e){return e.auth})),r=(o.userRequests,o.projects),v=(o.pageAggregateBds,o.selectedPage),b=o.encrypted_token,j=(o.searchByPhone,Object(s.b)()),m=Object(a.useState)(!0),p=Object(u.a)(m,2),O=p[0],f=p[1],h=Object(a.useState)("project"),g=Object(u.a)(h,2),x=(g[0],g[1],Object(a.useState)("state")),y=Object(u.a)(x,2),I=(y[0],y[1],Object(a.useState)(!1)),S=Object(u.a)(I,2),N=(S[0],S[1]),k=Object(a.useState)(void 0),T=Object(u.a)(k,2),w=(T[0],T[1],Object(a.useState)(void 0)),E=Object(u.a)(w,2),R=(E[0],E[1],Object(a.useState)(!1)),P=Object(u.a)(R,2),D=(P[0],P[1]),A=Object(a.useState)(!1),M=Object(u.a)(A,2),L=(M[0],M[1]),U=Object(a.useState)([]),q=Object(u.a)(U,2),F=(q[0],q[1]),B=Object(a.useState)([]),_=Object(u.a)(B,2),$=(_[0],_[1],Object(a.useState)([])),Y=Object(u.a)($,2),H=(Y[0],Y[1]),Q=Object(a.useState)([]),G=Object(u.a)(Q,2),J=(G[0],G[1]),K=(Object(a.useRef)(W()),Object(a.useRef)(W()),Object(a.useRef)(void 0),Object(a.useRef)(void 0),Object(a.useRef)(0)),Z=Object(a.useRef)(void 0),X=Object(a.useState)(),ee=Object(u.a)(X,2),te=(ee[0],ee[1],Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0})),ne=Object(u.a)(te,2),ae=(ne[0],ne[1],Object(a.useState)(0)),ie=Object(u.a)(ae,2),ce=(ie[0],ie[1],Object(a.useState)([])),oe=Object(u.a)(ce,2),le=oe[0],se=oe[1],re=Object(a.useRef)(void 0),de=(Object(a.useRef)(void 0),Object(a.useState)([])),ue=Object(u.a)(de,2),ve=ue[0],be=ue[1],je=Object(a.useState)(!1),me=Object(u.a)(je,2),pe=(me[0],me[1],Object(a.useState)([])),Oe=Object(u.a)(pe,2),fe=(Oe[0],Oe[1],Object(a.useState)(void 0)),he=Object(u.a)(fe,2),ge=(he[0],he[1]),xe=(Mn().getUserRequestPayload,Object(a.useRef)(void 0),Object(a.useRef)({project:void 0,user:void 0,status:void 0,area:void 0,time:void 0,phone:void 0})),ye=(Object(a.useRef)({}),Object(a.useRef)()),Ie=Object(a.useRef)([]),Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n={};Ie.current&&Ie.current.map(function(e){n[e.key]=e.value}),K.current=e;var a={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{'".concat(null===b||void 0===b?void 0:b.userId,"'}(-@rideType:{hail})@pageType:{event}@passengerPhoneNumber:{").concat(z(xe.current.phone),"}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)({profile:"$..profile",dashboard:"$..dashboard",ride:"$.persistent.static.ride",dynamic:"$.persistent.dynamic.ride",rideType:"$..profile.type",pageId:"$.objectId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",phone:"$..dashboard.passengerPhoneNumber"},n)},filter:{expression:[].join("&&")},sortBy:{properties:["advance"===t?{field:"@createdAt",order:"ASC"}:{field:"@updatedAt",order:"DESC"}],max:1e3},result:xe.current.phone?{pagination:{offset:e,limit:50}}:{}};j(tt({requestData:a,callback:function(t){console.log("resppnse",t),H(t),K.current=K.current+30;var n=e>0?Object(C.a)(le):[],a=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Pickup Address",key:"address",dataIndex:"address"},{title:"Dropoff Address",key:"dropoffAddress",dataIndex:"dropoffAddress"},{title:"Passenger Name",key:"passengerName",dataIndex:"passengerName"},{title:"Passenger Phone",key:"passengerPhoneNumber",dataIndex:"passengerPhoneNumber"},{title:"Driver Name",key:"driverName",dataIndex:"driverName"},{title:"Vehicle Name",key:"vehicleName",dataIndex:"vehicleName"},{title:"Fixed Fare",key:"fixedFare",dataIndex:"fixedFare"}];null===t||void 0===t||t.map(function(e,t){var a,i,c,o,l=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),s={};Object.keys(l).map(function(e){"string"===typeof l[e]&&(s[e]=l[e])}),n.push(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:l}),summary:s.summary,cudbServiceId:null===r||void 0===r?void 0:r.userServiceId}},s),{},{address:null!==s&&void 0!==s&&s.address&&""!==(null===s||void 0===s?void 0:s.adress)?null===s||void 0===s?void 0:s.address:null===l||void 0===l||null===(a=l.pickupLocation)||void 0===a||null===(i=a.attributes)||void 0===i?void 0:i.address,dropoffAddress:null!==s&&void 0!==s&&s.dropoffAddress&&""!==(null===s||void 0===s?void 0:s.dropoffAddress)?null===s||void 0===s?void 0:s.dropoffAddress:null===l||void 0===l||null===(c=l.dropoffLocation)||void 0===c||null===(o=c.attributes)||void 0===o?void 0:o.address,invited:""}))}),console.log("source data",n),n.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===a.findIndex(function(t){return t.key===e})&&t[e]})}),a.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:90},children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){V("".concat("https://live.staging.beam.live","/page/").concat(null===e||void 0===e?void 0:e.pageId),"BeamLive",.7*window.innerWidth,.9*window.innerHeight)},children:Object(oa.jsx)(Zc.a,{})})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){j({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e?void 0:e.page,ignorePage:!0}})},children:Object(oa.jsx)(Xc.a,{})})})]})}}),be(a),console.log("set source date",n),se(n),re.current=n,J(null===t||void 0===t?void 0:t.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),D(!1),N(!1),L(!1)}}))};Object(a.useEffect)(function(){var e;b&&(ye.current=b,N(!0),e=c,xe.current.phone=e,D(!0),xe.current.status=void 0,Z.current="lime",ge("lime"),Se())},[b]),Object(a.useEffect)(function(){if(r){var e,t=[];null===r||void 0===r||null===(e=r.projects)||void 0===e||e.map(function(e){t.push({label:e.name,value:e.id})}),F(t)}},[r]);return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)($n.a,{title:"Search",visible:O,onCancel:function(){f(!1),n&&n()},width:"1000px",bodyStyle:{height:600},className:"beam-modal analytics-summary-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid",transformOrigin:"0px 0px",transform:"scale(0.8)",width:"125%"},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:le,className:(null===le||void 0===le?void 0:le.length)>0?"":"table-empty-1",onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)}}},columns:ve,scroll:{x:!0},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===v||void 0===v||null===(n=v.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})})})})},to=(Wn.a.TextArea,function(e){var t=e.onClose,n=e.socket,i=Object(a.useState)(!0),c=Object(u.a)(i,2),o=c[0],l=c[1],r=Object(a.useState)(""),d=Object(u.a)(r,2),v=(d[0],d[1],ei.a.useForm()),b=Object(u.a)(v,1)[0],j=Object(a.useState)(""),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)(!1),g=Object(u.a)(h,2),x=g[0],y=(g[1],Object(a.useState)("email")),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(s.c)(function(e){return e.auth}),T=k.encrypted_token,C=k.projects,w=(Object(s.b)(),function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(a){var i,c,o,s;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(i=a.email,c=a.phone,o=a.nickname,f(""),i||c){e.n=1;break}return f("Please enter email or phone number"),e.a(2);case 1:s=[],i&&s.push({email:i}),c&&s.push({phone:c}),n.publishToEvent(m.PublishPageTopics,Zt(null===T||void 0===T?void 0:T.connectionId),Dn({userId:null===T||void 0===T?void 0:T.userId,notificationChannels:{email:i,phone:c},nickname:o,cudbServiceId:null===C||void 0===C?void 0:C.userServiceId})),l(!1),t&&t(),Lt("Link shared successfully","success","TOP_CENTER",1e3);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());return Object(oa.jsx)($n.a,{title:"Share dispatch",visible:o,onCancel:function(){l(!1),t&&t()},width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:b,onFinish:w,requiredMark:!1,children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{onClick:function(){N("email")},className:"beam-btn ".concat("email"===S?"green-btn cover":""),children:"Email"})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{onClick:function(){N("phone")},className:"beam-btn ".concat("phone"===S?"green-btn cover":""),children:"Phone"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-4 mb-4",children:Object(oa.jsxs)(Hn.a,{span:24,children:["email"===S&&Object(oa.jsx)(ei.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid Email!"},{required:!0,message:"**Required field"}],children:Object(oa.jsx)(Wn.a,{type:"email",placeholder:"Email"})}),"phone"===S&&Object(oa.jsx)(ei.a.Item,{name:"phone",rules:[{required:!0,message:"**Required field"}],children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:"Phone number (include +)"})}),O&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:O})})]})}),Object(oa.jsx)(Yn.a,{className:"action-grp",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:x,type:"primary",htmlType:"submit",onClick:function(){return f("")},children:"Invite"})})})})]})})});gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var no,ao=Wn.a.TextArea,io=function(e){var t,n,c,o,r,v,b,j,p=e.socket,O=e.params,f=e.fullScreen,h=e.scale,g=(e.componentUuids,ei.a.useForm()),x=Object(u.a)(g,1)[0],I=Object(a.useState)(""),S=Object(u.a)(I,2),N=S[0],k=S[1],T=O.screens,C=O.setScreens,w=Object(l.g)().search,E=Object(l.f)(),R=Object(s.c)(function(e){return e.auth}),P=R.projects,D=R.accounts,A=Object(s.b)(),M=Object(s.c)(function(e){return e.auth}),L=M.selectedResponders,U=M.submitted,q=M.page,F=M.encrypted_token,B=M.selectedPickup,_=M.standLocations,Y=M.selectedPage,H=Object(a.useState)(!1),V=Object(u.a)(H,2),Q=V[0],G=V[1],J=Object(a.useState)(!1),K=Object(u.a)(J,2),Z=K[0],ee=(K[1],Object(a.useState)(void 0)),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ie=Object(a.useState)(void 0),ce=Object(u.a)(ie,2),oe=ce[0],le=ce[1],se=Object(a.useState)(void 0),re=Object(u.a)(se,2),de=re[0],ue=re[1],ve=Mn().getUserRequestPayload,be=(Object(a.useRef)(void 0),Object(a.useRef)(W())),je=Object(a.useState)(),me=Object(u.a)(je,2),pe=me[0],Oe=me[1],fe=Object(a.useState)(),he=Object(u.a)(fe,2),ge=he[0],xe=he[1],ye=Object(a.useState)(),Ie=Object(u.a)(ye,2),Se=Ie[0],Ne=Ie[1],ke=Object(a.useState)(),Te=Object(u.a)(ke,2),Ce=Te[0],we=Te[1],Ee=Object(a.useState)(),Re=Object(u.a)(Ee,2),Pe=Re[0],Me=Re[1],Le=Object(a.useState)(void 0),Fe=Object(u.a)(Le,2),Be=Fe[0],_e=Fe[1],$e=Object(a.useState)(void 0),Ye=Object(u.a)($e,2),He=Ye[0],We=Ye[1],Ve=Object(a.useState)(!1),ze=Object(u.a)(Ve,2),Qe=ze[0],Ge=ze[1],Je=Object(a.useState)(),Ke=Object(u.a)(Je,2),Ze=Ke[0],Xe=Ke[1],et=Object(a.useState)(!1),nt=Object(u.a)(et,2),at=nt[0],it=nt[1],ot=Object(a.useRef)(!0),lt=Object(a.useRef)(void 0),st=Object(a.useState)(!1),rt=Object(u.a)(st,2),dt=rt[0],ut=rt[1],vt=Object(a.useRef)({pickup:void 0,dropoff:void 0}),bt=Object(a.useState)(!1),jt=Object(u.a)(bt,2),mt=jt[0],pt=jt[1],ht=Object(a.useState)(!1),gt=Object(u.a)(ht,2),xt=gt[0],yt=gt[1],It=Object(a.useState)(window.innerWidth<=768),St=Object(u.a)(It,2),Nt=St[0],kt=St[1];Object(a.useEffect)(function(){var e=function(){return kt(window.innerWidth<=768)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[]);ti.a,ti.a.Item;var Tt=function(e,t){var n=6378.137,a=Math.PI,i=1/(2*a/360*n)/1e3;return{lat:e+417*i,long:t+417*(i=1/(2*a/360*n)/1e3)/(0,Math.cos)(e*(a/180))}},Ct=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a,i,c,o,l,s,r,u,v,b,j,O,f,h,g,x,y,I,S,N,T,C,w,E,R;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(!((null===_||void 0===_?void 0:_.length)>0)){e.n=1;break}return e.a(2);case 1:if(!dt||n){e.n=2;break}return ue(t),g=null===F||void 0===F?void 0:F.connectionId,p.publishToEvent(m.PublishPageTopics,Sn(g),Dn({notificationChannels:{phone:null===(f=t)||void 0===f?void 0:f.passengerPhoneNumber,email:null===(h=t)||void 0===h?void 0:h.passengerEmail},userServiceId:null===P||void 0===P?void 0:P.userServiceId})),Lt("Verification code sent on notification channels","success","TOP_CENTER",3e3),e.a(2);case 2:return x=null===F||void 0===F?void 0:F.userId,y=ne,I=null===F||void 0===F?void 0:F.connectionId,S=L.map(function(e){return{id:e.id,beamId:e.title}}),t[void 0]&&(t=t[void 0]),t.pickupLocation.type="incident-location",t.dropoffLocation&&(t.dropoffLocation.type="incident-location"),N={},Object.keys(t).map(function(e){var n=X(e,e,t[e],[],{});Array.isArray(n)?null===n||void 0===n||n.map(function(e){$.a.merge(N,e)}):$.a.merge(N,n)}),T=Object(d.a)(Object(d.a)({},N),{},{accountName:null===D||void 0===D||null===(a=D.find(function(e){var t;return(null===e||void 0===e||null===(t=e.objectId)||void 0===t?void 0:t.toString())===(null===N||void 0===N?void 0:N.account)}))||void 0===a||null===(i=a.info)||void 0===i?void 0:i.name,fixedFare:"fixed"===(null===N||void 0===N||null===(c=N.fareType)||void 0===c?void 0:c.value)||"bid"===(null===N||void 0===N||null===(o=N.fareType)||void 0===o?void 0:o.value)?null===N||void 0===N||null===(l=N.fareType)||void 0===l||null===(s=l.fare)||void 0===s?void 0:s.toString():dt&&ge?ge:void 0,estimatedFare:"bid"===(null===N||void 0===N||null===(r=N.fareType)||void 0===r?void 0:r.value)?ge:void 0,fareType:dt&&ge&&"bid"!==(null===N||void 0===N||null===(u=N.fareType)||void 0===u?void 0:u.value)?"fixed":null===N||void 0===N||null===(v=N.fareType)||void 0===v?void 0:v.value,payType:null!==(b=null===N||void 0===N||null===(j=N.payType)||void 0===j?void 0:j.value)&&void 0!==b?b:void 0,sharePassengerLink:t.sharePassengerLink},dt?Object(d.a)(Object(d.a)({sharePassengerLink:!0},null!==P&&void 0!==P&&null!==(O=P.webSettings)&&void 0!==O&&O.webBookerMeterPayment?{payType:"meter"}:{payType:"now"}),{},{verifyCustomer:!0,bookingOtp:n}):{}),Object.keys(T).map(function(e){var t,n;"vehicle"===(null===T||void 0===T||null===(t=T[e])||void 0===t?void 0:t.type)&&(C=null===T||void 0===T||null===(n=T[e])||void 0===n?void 0:n.value)}),C&&S.push({id:C,beamId:""}),w=[],e.n=3,Promise.all(Object.keys(T).map(function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(a){var i,c,o,l,s,r,u,v,b,j,m,p,O,f,h,g,N,k,C,D,A,M,L,U,q,F,B,_,$,Y,H,W,V,z,Q,G,J,K,Z,X,ee,te,ne,ae,ie,ce,oe,le,se,re,de;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if("dispatchType"!==(null===T||void 0===T||null===(i=T[a])||void 0===i?void 0:i.type)){e.n=2;break}return N=Object(d.a)({},T),"schedule"===(null===T||void 0===T||null===(l=T[a])||void 0===l?void 0:l.value)?(N.scheduleDate=null===N||void 0===N||null===(k=N[a])||void 0===k?void 0:k.date,N.scheduleTime=null===N||void 0===N||null===(C=N[a])||void 0===C?void 0:C.time,M=new Date(null===N||void 0===N||null===(D=N[a])||void 0===D?void 0:D.dateTimestamp),L=new Date(null===N||void 0===N||null===(A=N[a])||void 0===A?void 0:A.timeTimestamp),M.setHours(L.getHours()),M.setMinutes(L.getMinutes()),U=dt?20:(null===N||void 0===N?void 0:N.leadTime)||0,E=M.getTime()-6e4*U<(new Date).getTime()?{type:"immediate"}:{utcDateTime:new Date(M.getTime()-6e4*U).toUTCString(),rideDateTime:new Date(M.getTime()).toUTCString(),ridelocalDateTime:M.getTime(),type:"schedule"}):E={type:"immediate"},null===N||void 0===N||delete N.leadTime,null===N||void 0===N||delete N.roundTripLeadTime,null===N||void 0===N||delete N.roundTripNotify,null!==N&&void 0!==N&&null!==(s=N.notify)&&void 0!==s&&s.customTime&&(N.notify.notifyTime=N.notify.customTime.toString()),N.vehicleTypeName=null===(r=N.vehicleType)||void 0===r?void 0:r.name,N.vehicleType=null===(u=N.vehicleType)||void 0===u?void 0:u.value,q=Tt(null===N||void 0===N||null===(v=N.pickupLocation)||void 0===v||null===(b=v.coordinates)||void 0===b?void 0:b.lat,null===N||void 0===N||null===(j=N.pickupLocation)||void 0===j||null===(m=j.coordinates)||void 0===m?void 0:m.long),e.n=1,At(q);case 1:F=e.v,w.push(Object(d.a)({userId:x,rideRequestAttributes:Object(d.a)(Object(d.a)({},N),{},{drivers:S,pickupAddress:null===N||void 0===N||null===(p=N.pickupLocation)||void 0===p||null===(O=p.attributes)||void 0===O?void 0:O.address,dropoffAddress:null===N||void 0===N||null===(f=N.dropoffLocation)||void 0===f||null===(h=f.attributes)||void 0===h?void 0:h.address,maskedPickupLocation:{attributes:{address:F},coordinates:q},maskedPickupAddress:F,cudbServiceId:null===P||void 0===P?void 0:P.userServiceId}),drivers:S,connectionId:I,unstructuredAttributes:Object(d.a)(Object(d.a)({},t),{},{rideType:{type:"rideType",value:"oneWay"},vehicle:void 0,fixedPriceList:vt.current}),pageId:ot.current?y:void 0,title:(new Date).toLocaleString(),dispatch:E,createdAt:(null===(g=E)||void 0===g?void 0:g.ridelocalDateTime)||(new Date).getTime(),cudbServiceId:null===P||void 0===P?void 0:P.userServiceId},dt?{verifyCustomer:!0,bookingOtp:n}:{}));case 2:if("rideType"!==(null===T||void 0===T||null===(c=T[a])||void 0===c?void 0:c.type)||"roundTrip"!==(null===T||void 0===T||null===(o=T[a])||void 0===o?void 0:o.value)){e.n=4;break}return ne=Object(d.a)({},T),ae=Object(d.a)({},t),ne.scheduleDate=null===ne||void 0===ne||null===(B=ne[a])||void 0===B?void 0:B.date,ne.scheduleTime=null===ne||void 0===ne||null===(_=ne[a])||void 0===_?void 0:_.time,ie=new Date(null===ne||void 0===ne||null===($=ne[a])||void 0===$?void 0:$.dateTimestamp),ce=new Date(null===ne||void 0===ne||null===(Y=ne[a])||void 0===Y?void 0:Y.timeTimestamp),ie.setHours(ce.getHours()),ie.setMinutes(ce.getMinutes()),oe=dt?20:(null===ne||void 0===ne?void 0:ne.roundTripLeadTime)||0,R={utcDateTime:new Date(ie.getTime()-6e4*oe).toUTCString(),rideDateTime:new Date(ie.getTime()).toUTCString(),ridelocalDateTime:ie.getTime(),type:"schedule"},le=ne.pickupLocation,ne.pickupLocation=ne.dropoffLocation,ne.dropoffLocation=le,se=ae.pickupLocation,ae.pickupLocation=ae.dropoffLocation,ae.dropoffLocation=se,ae.dispatch={date:ae.rideType.date,time:ae.rideType.time,type:"dispatchType",value:"schedule"},ae.rideType={type:"rideType",value:"oneWay"},ne.notify=null===ne||void 0===ne?void 0:ne.roundTripNotify,null===ne||void 0===ne||delete ne.leadTime,null===ne||void 0===ne||delete ne.roundTripLeadTime,null===ne||void 0===ne||delete ne.roundTripNotify,null!==ne&&void 0!==ne&&null!==(H=ne.notify)&&void 0!==H&&H.customTime&&(ne.notify.notifyTime=ne.notify.customTime.toString()),ne.vehicleTypeName=null===(W=ne.vehicleType)||void 0===W?void 0:W.name,ne.vehicleType=null===(V=ne.vehicleType)||void 0===V?void 0:V.value,re=Tt(null===ne||void 0===ne||null===(z=ne.pickupLocation)||void 0===z||null===(Q=z.coordinates)||void 0===Q?void 0:Q.lat,null===ne||void 0===ne||null===(G=ne.pickupLocation)||void 0===G||null===(J=G.coordinates)||void 0===J?void 0:J.long),e.n=3,At(re);case 3:de=e.v,w.push(Object(d.a)({userId:x,rideRequestAttributes:Object(d.a)(Object(d.a)({},ne),{},{drivers:S,pickupAddress:null===ne||void 0===ne||null===(K=ne.pickupLocation)||void 0===K||null===(Z=K.attributes)||void 0===Z?void 0:Z.address,dropoffAddress:null===ne||void 0===ne||null===(X=ne.dropoffLocation)||void 0===X||null===(ee=X.attributes)||void 0===ee?void 0:ee.address,maskedPickupLocation:{attributes:{address:de},coordinates:re},maskedPickupAddress:de,cudbServiceId:null===P||void 0===P?void 0:P.userServiceId}),drivers:[],connectionId:I,unstructuredAttributes:Object(d.a)(Object(d.a)({},ae),{},{vehicle:void 0,fixedPriceList:vt.current}),pageId:ot.current?y:void 0,title:(new Date).toLocaleString(),dispatch:R,createdAt:(null===(te=R)||void 0===te?void 0:te.ridelocalDateTime)||(new Date).getTime(),cudbServiceId:null===P||void 0===P?void 0:P.userServiceId},dt?{verifyCustomer:!0,bookingOtp:n}:{}));case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()));case 3:console.log("requests here",w),w.length>0?(k(void 0),G(!0)):Lt("Something went wrong. please refresh","error","TOP_CENTER",3e3),w.map(function(e){A(Ot({requestData:e,callback:function(e){G(!1),console.log("response",e),e.pageId?(Lt("Ride request submitted","success","TOP_CENTER",1e3),A({type:De,payload:!1}),Dt(),ue(void 0),dt&&(localStorage.setItem("lastRideId",e.pageId),p.publishToEvent(m.PublishPageTopics,cn(null===F||void 0===F?void 0:F.connectionId),Dn({objectId:e.pageId,paths:["$"],returnPaths:["$"]},e.pageId)))):e.pageId||(Lt((null===e||void 0===e?void 0:e.details)||"Ride request failed","error","TOP_CENTER",3e3),A({type:De,payload:!1}))}}))});case 4:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){var e,t,n,a,i,c,o,l,s;Y&&(console.log("selected page",Y),Et(Object(d.a)(Object(d.a)({},null===Y||void 0===Y?void 0:Y.page),{},{persistent:{static:{profile:null===Y||void 0===Y||null===(e=Y.page)||void 0===e?void 0:e.profile}}})),null!==Y&&void 0!==Y&&Y.ignorePage?(ae(void 0),le(void 0)):(ae(null===Y||void 0===Y||null===(t=Y.page)||void 0===t||null===(n=t.pageId)||void 0===n?void 0:n.toString()),le((null===Y||void 0===Y||null===(a=Y.page)||void 0===a?void 0:a.status)||(null===Y||void 0===Y||null===(i=Y.page)||void 0===i||null===(c=i.nonpersistent)||void 0===c||null===(o=c.static)||void 0===o||null===(l=o.live)||void 0===l||null===(s=l.status)||void 0===s?void 0:s.name))))},[Y]);var wt=function(e,t){var n={select:{index:{searchIndex:"".concat("beamdevlive",":custom:id"),searchQuery:"@partitions:{'org\\:".concat(z(null===P||void 0===P?void 0:P.userServiceId),"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",email:"$..email",phone:"$..phone",objectId:"$.objectId"}},filter:{expression:"(exists(@email) && @email=='".concat(e,"') || (exists(@phone) && @phone=='").concat(t,"')")}};A(tt({requestData:n,callback:function(e){var t,n=null===e||void 0===e?void 0:e[0];n?null!==n&&void 0!==n&&null!==(t=n.info)&&void 0!==t&&t.blockedAt?pt(!0):pt(!1):pt(!1)}}))};Object(a.useEffect)(function(){if(B){var e,t;console.log("set pickup",B);var n={type:"incident-location",label:null===(e=B.location.attributes)||void 0===e?void 0:e.address,value:{description:null===B||void 0===B||null===(t=B.location.attributes)||void 0===t?void 0:t.address,place_id:"",coordinates:null===B||void 0===B?void 0:B.location.coordinates}};x.setFieldsValue({pickupLocation:n}),n&&(Pt({pickupLocation:n}),C(Object(d.a)(Object(d.a)({},T),{},{map:!0})),A({type:Ue,payload:void 0}),A({type:qe,payload:[]}))}},[B]);var Et=function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m,p,O,f,h,g,y,I,S,N,k,T,C,w,E,R,D,M,L,U,q,F,B,_,$,H,W,V,z,Q,G,J,K,Z,X,ee;(x.resetFields(),A({type:De,payload:!1}),console.log("page check here",e),x.setFieldsValue(Object(d.a)(Object(d.a)({},null!==(t=null===e||void 0===e||null===(n=e.persistent)||void 0===n||null===(a=n.static)||void 0===a||null===(i=a.profile)||void 0===i?void 0:i.unstructuredAttributes)&&void 0!==t?t:{}),null!==Y&&void 0!==Y&&Y.ignorePage?{dispatch:{type:"dispatchType",value:"immediate"},vehilce:void 0,vehicleType:void 0}:{})),vt.current=(null===e||void 0===e||null===(c=e.persistent)||void 0===c||null===(o=c.static)||void 0===o||null===(l=o.profile)||void 0===l||null===(s=l.unstructuredAttributes)||void 0===s?void 0:s.fixedPriceList)||{},null!==e&&void 0!==e&&null!==(r=e.persistent)&&void 0!==r&&null!==(u=r.static)&&void 0!==u&&null!==(v=u.profile)&&void 0!==v&&null!==(b=v.unstructuredAttributes)&&void 0!==b&&b.pickupLocation)&&Pt({pickupLocation:null===e||void 0===e||null===(C=e.persistent)||void 0===C||null===(w=C.static)||void 0===w||null===(E=w.profile)||void 0===E||null===(R=E.unstructuredAttributes)||void 0===R?void 0:R.pickupLocation});null!==e&&void 0!==e&&null!==(j=e.persistent)&&void 0!==j&&null!==(m=j.static)&&void 0!==m&&null!==(p=m.profile)&&void 0!==p&&null!==(O=p.unstructuredAttributes)&&void 0!==O&&O.dropoffLocation&&Pt({dropoffLocation:null===e||void 0===e||null===(D=e.persistent)||void 0===D||null===(M=D.static)||void 0===M||null===(L=M.profile)||void 0===L||null===(U=L.unstructuredAttributes)||void 0===U?void 0:U.dropoffLocation});null!==Y&&void 0!==Y&&Y.ignorePage?Ne("immediate"):Ne((null===e||void 0===e||null===(q=e.persistent)||void 0===q||null===(F=q.static)||void 0===F||null===(B=F.profile)||void 0===B||null===(_=B.unstructuredAttributes)||void 0===_||null===($=_.dispatch)||void 0===$?void 0:$.value)||"immediate");(we((null===e||void 0===e||null===(f=e.persistent)||void 0===f||null===(h=f.static)||void 0===h||null===(g=h.profile)||void 0===g||null===(y=g.unstructuredAttributes)||void 0===y||null===(I=y.rideType)||void 0===I?void 0:I.value)||"oneWay"),null!==P&&void 0!==P&&null!==(S=P.webSettings)&&void 0!==S&&S.webBookerMeterPayment&&dt)||Xe({phone:null===e||void 0===e||null===(H=e.persistent)||void 0===H||null===(W=H.static)||void 0===W||null===(V=W.profile)||void 0===V||null===(z=V.unstructuredAttributes)||void 0===z?void 0:z.passengerPhoneNumber,email:null===e||void 0===e||null===(Q=e.persistent)||void 0===Q||null===(G=Q.static)||void 0===G||null===(J=G.profile)||void 0===J||null===(K=J.unstructuredAttributes)||void 0===K?void 0:K.passengerEmail});null!==e&&void 0!==e&&null!==(N=e.persistent)&&void 0!==N&&null!==(k=N.static)&&void 0!==k&&null!==(T=k.profile)&&void 0!==T&&T.estimatedFare&&xe(null===e||void 0===e||null===(Z=e.persistent)||void 0===Z||null===(X=Z.static)||void 0===X||null===(ee=X.profile)||void 0===ee?void 0:ee.estimatedFare)};Object(a.useEffect)(function(){var e,t,n,a,i,c,o;q&&(Et(Object(d.a)(Object(d.a)({},q),{},{persistent:{static:{profile:null===q||void 0===q||null===(e=q.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.ride}}})),ae(null===q||void 0===q||null===(n=q.objectId)||void 0===n?void 0:n.toString()),le(null===q||void 0===q||null===(a=q.nonpersistent)||void 0===a||null===(i=a.static)||void 0===i||null===(c=i.live)||void 0===c||null===(o=c.status)||void 0===o?void 0:o.name))},[JSON.stringify(null!==(t=null===q||void 0===q||null===(n=q.persistent)||void 0===n||null===(c=n.static)||void 0===c?void 0:c.profile)&&void 0!==t?t:{})]),Object(a.useEffect)(function(){},[q]),Object(a.useEffect)(function(){if(U)if(console.log("submitted here",U),G(!1),U.status)Lt("Ride request submitted","success","TOP_CENTER",1e3),A({type:De,payload:!1}),Dt();else if(!1===U.status){var e;Lt((null===U||void 0===U||null===(e=U.data)||void 0===e?void 0:e.details)||"Ride request failed","error","TOP_CENTER",3e3),A({type:De,payload:!1})}},[A,E,x,Z,T,w,Q,C,U]);var Rt=function(e,t,n){var a,i,c=null===F||void 0===F?void 0:F.connectionId,o=null===F||void 0===F?void 0:F.userId;Oe(void 0),xe(void 0),p.publishToEvent(m.PublishPageTopics,function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/ride-dps/getRideEstimation")}(c),Dn({pickupLocation:{coordinates:null===e||void 0===e||null===(a=e.value)||void 0===a?void 0:a.coordinates},dropoffLocation:{coordinates:null===t||void 0===t||null===(i=t.value)||void 0===i?void 0:i.coordinates},userId:o,startTime:(new Date).getTime(),cudbServiceId:null===P||void 0===P?void 0:P.userServiceId,vehicleType:n}))};Object(a.useEffect)(function(){if(null!==P&&void 0!==P&&P.adminUserId){console.log("test",P);var e=null===F||void 0===F?void 0:F.connectionId,t=null===F||void 0===F?void 0:F.userId;p.subscribeToEvent(m.SubscribePageTopics,yn(e)),p.subscribeToEvent(m.SubscribePageTopics,bn(e,null===P||void 0===P?void 0:P.userServiceId)),p.subscribeToEvent(m.SubscribePageTopics,En(t),function(e){console.log("response",e),_e(null===e||void 0===e?void 0:e.data)}),yt(!0)}},[P]),Object(a.useEffect)(function(){xt&&(console.log("loaded true",xt),function(){var e=null===F||void 0===F?void 0:F.connectionId,t={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===P||void 0===P?void 0:P.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",firstName:"$..profile.firstName"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@firstName)"},anyStatus:!1};p.publishToEvent(m.PublishPageTopics,xn(e),Dn(t,be.current))}(),p.publishToEvent(m.PublishPageTopics,Nn(null===F||void 0===F?void 0:F.connectionId),Dn({userId:null===F||void 0===F?void 0:F.userId,cudbServiceId:null===P||void 0===P?void 0:P.userServiceId})),p.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,ve(null===P||void 0===P?void 0:P.adminUserId,"$","$..admin.vehicleSettings.types"),gn(null===F||void 0===F?void 0:F.connectionId),null===P||void 0===P?void 0:P.userServiceId))},[xt]),Object(a.useEffect)(function(){if(F){var e=new URLSearchParams(w),t=e.get("token"),n=e.get("setup_intent_client_secret");if(t&&n){console.log("re submit here");var a=JSON.parse(localStorage.getItem("formValues"));console.log("form here",a),a&&x.setFieldsValue(Object(d.a)({},a))}p.subscribeToEvent(m.SubscribePageTopics,qt(null===F||void 0===F?void 0:F.connectionId)),p.subscribeToEvent(m.SubscribePageTopics,Bt(null===F||void 0===F?void 0:F.connectionId)),p.subscribeToEvent(m.SubscribePageTopics,$t(null===F||void 0===F?void 0:F.connectionId)),p.subscribeToEvent(m.SubscribePageTopics,vn(null===F||void 0===F?void 0:F.connectionId)),p.subscribeToEvent(m.SubscribePageTopics,(o=null===F||void 0===F?void 0:F.connectionId,"".concat(Ut,"/connection/").concat(o,"/service/ride-dps/createRideRequest/reply"))),p.subscribeToEvent(m.SubscribePageTopics,fn(null===F||void 0===F?void 0:F.userId),function(e){var t,n,a;Et(Object(d.a)(Object(d.a)({},null===e||void 0===e?void 0:e.page),{},{persistent:{static:{profile:null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.profile}}})),ae(null===e||void 0===e||null===(n=e.page)||void 0===n||null===(a=n.pageId)||void 0===a?void 0:a.toString())}),p.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat(Ut,"/connection/").concat(e,"/service/ride-dps/cancelRideEvent/reply")}(null===F||void 0===F?void 0:F.connectionId),function(e){Lt("Ride cancelled successfully","success","TOP_CENTER",1e3),A({type:De,payload:!1}),Dt(),localStorage.removeItem("lastRideId")}),p.subscribeToEvent(m.SubscribePageTopics,an(null===F||void 0===F?void 0:F.connectionId)),p.publishToEvent(m.PublishPageTopics,Ft(null===F||void 0===F?void 0:F.connectionId),Dn({userId:null===F||void 0===F?void 0:F.userId,cudbServiceId:(null===F||void 0===F?void 0:F.cudbServiceId)||(null===F||void 0===F?void 0:F.serviceId)})),p.publishToEvent(m.PublishPageTopics,_t(null===F||void 0===F?void 0:F.connectionId),Dn({userId:null===F||void 0===F?void 0:F.userId,cudbServiceId:(null===F||void 0===F?void 0:F.cudbServiceId)||(null===F||void 0===F?void 0:F.serviceId)})),p.subscribeToEvent(m.SubscribePageTopics,Tn(null===F||void 0===F?void 0:F.connectionId),function(e){var t,n,a,i,c,o,l,s=e.response;console.log("fixed rate response",s);var r,u=null===s||void 0===s||null===(t=s.data)||void 0===t||null===(n=t.fixedRate)||void 0===n?void 0:n.priceConfig,v=x.getFieldValue("numberOfPeople"),b=null===u||void 0===u?void 0:u.find(function(e){return(null===e||void 0===e?void 0:e.numberOfPassengers)===v});(b||(null===u||void 0===u||u.sort(function(e,t){return parseFloat(t.price)-parseFloat(e.price)}),b=null===u||void 0===u?void 0:u[0]),console.log("selected price",b),null!==(a=b)&&void 0!==a&&a.price&&null!==s&&void 0!==s&&null!==(i=s.data)&&void 0!==i&&null!==(c=i.fixedRate)&&void 0!==c&&c[lt.current])&&x.setFieldsValue({fareType:Object(d.a)({type:"fareType",value:"fixed",fare:null===(r=b)||void 0===r?void 0:r.price},b)});vt.current[lt.current]=u,null!==(o=vt.current)&&void 0!==o&&o.pickup||null!==(l=vt.current)&&void 0!==l&&l.dropoff||x.setFieldsValue({fareType:{type:"fareType",value:"variable"}})}),p.subscribeToEvent(m.SubscribePageTopics,Cn(null===F||void 0===F?void 0:F.connectionId),function(e){var t,n,a,i,c,o=e.response;(console.log("blocked area response",o),null!==o&&void 0!==o&&null!==(t=o.data)&&void 0!==t&&t.blockedArea)?(A({type:Ue,payload:null===o||void 0===o||null===(n=o.data)||void 0===n||null===(a=n.blockedArea)||void 0===a?void 0:a.geofence}),A({type:qe,payload:null===o||void 0===o||null===(i=o.data)||void 0===i||null===(c=i.blockedArea)||void 0===c?void 0:c.pois})):(A({type:Ue,payload:void 0}),A({type:qe,payload:[]}))}),p.subscribeToEvent(m.SubscribePageTopics,kn(null===F||void 0===F?void 0:F.connectionId),function(e){var t,n,a=null===e||void 0===e?void 0:e.response;if(console.log("estimation",null===a||void 0===a?void 0:a.data),(null===a||void 0===a||null===(t=a.data)||void 0===t?void 0:t.leadTime)>-1?x.setFieldsValue({leadTime:Math.ceil(null===a||void 0===a?void 0:a.data.leadTime)}):x.setFieldsValue({leadTime:15}),(null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.roundTripLeadTime)>-1&&x.setFieldsValue({roundTripLeadTime:Math.ceil(null===a||void 0===a?void 0:a.data.roundTripLeadTime)}),null!==a&&void 0!==a&&a.data.estimate){var i=[];i.push({label:"Estimate",value:"".concat(null===a||void 0===a?void 0:a.data.estimate," ").concat(null===a||void 0===a?void 0:a.data.currency)}),i.push({label:"Distance",value:"".concat(((null===a||void 0===a?void 0:a.data.distance)/1e3*.6214).toFixed(2)," miles")}),i.push({label:"Duration",value:"".concat(((null===a||void 0===a?void 0:a.data.duration)/60).toFixed(2)," mins")}),i.push({label:"Wait time",value:"".concat(((null===a||void 0===a?void 0:a.data.waitTime)/60).toFixed(2)," mins")}),Oe(i),xe(null===a||void 0===a?void 0:a.data.estimate)}});var i=localStorage.getItem("lastRideId"),c=void 0!==(null===F||void 0===F?void 0:F.cudbServiceId);(null!==F&&void 0!==F&&F.pageId||i&&c)&&(console.log("last ride id",i),p.publishToEvent(m.PublishPageTopics,cn(null===F||void 0===F?void 0:F.connectionId),Dn({objectId:(null===F||void 0===F?void 0:F.pageId)||i,paths:["$"],returnPaths:["$"]},(null===F||void 0===F?void 0:F.pageId)||i))),ut(c)}var o},[F]),Object(a.useEffect)(function(){if(p.client){console.log("subscribe here");var e=new URLSearchParams(w),t=e.get("userId"),n=e.get("connectionId"),a=e.get("pageId"),i=e.get("token"),c=e.get("cudbServiceId"),o=c&&"null"!==c&&"undefined"!==c&&""!==c.trim()?c:"org-saferide-africa";ae(a),i?(console.log("decry"),A(ct({data:{payload:i},callback:function(e){}}))):A({type:"ADD_ENCRYPTED_TOKEN",payload:{connectionId:n,userId:t,pageId:a,cudbServiceId:o}})}},[w,p.client]);var Pt=function(e){A({type:Ae,payload:e})},Dt=function(){setTimeout(function(){var e=new URLSearchParams(w);e.delete("pageId"),e.delete("sessionId"),E.replace({search:e.toString()}),localStorage.removeItem("form"),localStorage.removeItem("formValues"),localStorage.removeItem("active"),A({type:De,payload:!1}),A({type:"SET_SELECTED_PAGE",payload:{page:void 0}}),x.resetFields(),x.setFieldsValue({dispatch:{type:"dispatchType",value:"immediate"},rideType:{type:"rideType",value:"oneWay"},fareType:{type:"fareType",value:"variable"},payType:{type:"payType",value:"meter"},leadTime:15}),Oe(void 0),xe(void 0),ae(void 0),pt(!1),Xe(void 0),vt.current=void 0})},At=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n;return Object(Bn.a)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,gc.a.fromLatLng(t.lat,t.long);case 1:return n=e.v,e.a(2,n.results[0].formatted_address);case 2:return e.p=2,e.v,e.a(2,"Unknown")}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),Mt=function(){return new Promise(function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){var n,a;e({lat:null===t||void 0===t||null===(n=t.coords)||void 0===n?void 0:n.latitude,long:null===t||void 0===t||null===(a=t.coords)||void 0===a?void 0:a.longitude})}):t("Geolocation is not supported by this browser.")})};return Object(oa.jsxs)("div",{className:"main-column ride-dispatch-panel ".concat(Nt?"":"mr-4"),style:h?{height:"auto"}:{},children:[Object(oa.jsx)("div",{className:"main-content",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",initialValues:{dispatch:{type:"dispatchType",value:"immediate"},rideType:{type:"rideType",value:"oneWay"},fareType:{type:"fareType",value:"variable"},payType:{type:"payType",value:"meter"},leadTime:15},id:"register-form",layout:"vertical",form:x,onFinish:Ct,requiredMark:!1,onValuesChange:function(e,t){localStorage.setItem("form",JSON.stringify(t))},style:f?{}:{height:"48vh"},children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsxs)("div",{className:"d-flex align-items-center",children:[Object(oa.jsx)("img",{src:"/images/logo-icon.svg",alt:"Beam Logo",style:{height:32,marginRight:12}}),Object(oa.jsx)("h3",{className:"ml-3",children:ne&&q?"".concat(null===q||void 0===q||null===(o=q.persistent)||void 0===o||null===(r=o.static)||void 0===r||null===(v=r.metatdata)||void 0===v?void 0:v.title):"Ride booking"})]}),Object(oa.jsx)("div",{className:"d-flex",children:F&&!dt&&Object(oa.jsx)($i.a,{style:{color:"#869cbd",fontSize:21,cursor:"pointer"},onClick:function(){Ge(!0)}})})]}),Object(oa.jsxs)("div",{className:"main-cards",style:{maxHeight:h?"calc(100vh)":"calc(100vh - 200px)"},children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"passengerName",children:Object(oa.jsx)(Wn.a,{placeholder:"Passenger name",autoComplete:"on"})})})}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsxs)(Hn.a,{span:F&&!dt?21:24,className:"",children:[Object(oa.jsx)(ei.a.Item,{name:"passengerPhoneNumber",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Fi.a,{placeholder:"Phone number",defaultCountry:"US",onChange:function(e){if(console.log("phone",e),e&&Object(Fi.b)(e)){var t,n=x.getFieldValue("passengerPhoneNumber"),a=x.getFieldValue("passengerEmail");null!==P&&void 0!==P&&null!==(t=P.webSettings)&&void 0!==t&&t.webBookerMeterPayment&&dt||Xe({phone:n,email:a})}else Xe(void 0)}})}),mt&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:"**Blocked customer"})})]}),F&&!dt&&Object(oa.jsx)(Hn.a,{span:3,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var e=x.getFieldValue("passengerPhoneNumber");We({phone:e})},children:"Search"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"passengerEmail",children:Object(oa.jsx)(Wn.a,{placeholder:"Email",autoComplete:"email",onChange:function(e){var t=e.target.value;no&&clearTimeout(no),no=setTimeout(function(){wt(t,void 0)},500)}})})})}),Object(oa.jsx)("hr",{}),F&&!dt&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"account",children:Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Account name",onChange:function(e){},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===D||void 0===D?void 0:D.map(function(e,t){var n;return Object(oa.jsx)(Gn.a.Option,{value:null===(n=e.objectId)||void 0===n?void 0:n.toString(),children:e.info.name})})})})})}),Object(oa.jsx)("hr",{})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsxs)(Hn.a,{span:22,children:[Object(oa.jsx)(ei.a.Item,{name:"pickupLocation",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(ai,{placeholder:"Pick up location",onChange:function(e){var t;Pt({pickupLocation:e}),C(Object(d.a)(Object(d.a)({},T),{},{map:!0}));var n=x.getFieldValue("dropoffLocation");null!==n&&void 0!==n&&null!==(t=n.value)&&void 0!==t&&t.coordinates&&Rt(e,n),lt.current="pickup"}})}),(null===_||void 0===_?void 0:_.length)>0&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:"**Blocked Area. Please select nearest pickup point on the map"})})]}),Object(oa.jsx)(Hn.a,{span:2,className:"d-flex align-items-center justify-content-center",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:Object(_n.a)(Object(Bn.a)().m(function e(){var t,n,a,i,c;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Mt();case 1:return n=e.v,console.log("location",n),e.n=2,At(n);case 2:a=e.v,console.log("address",a),i={type:"incident-location",label:a,value:{description:a,place_id:"",coordinates:n}},x.setFieldsValue({pickupLocation:i}),Pt({pickupLocation:i}),C(Object(d.a)(Object(d.a)({},T),{},{map:!0})),null!==(c=x.getFieldValue("dropoffLocation"))&&void 0!==c&&null!==(t=c.value)&&void 0!==t&&t.coordinates&&Rt(i,c),lt.current="pickup";case 3:return e.a(2)}},e)})),children:Object(oa.jsx)(qc.a,{})})})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)(ei.a.Item,{name:"dropoffLocation",rules:dt?[{required:!0,message:"**Required Field"}]:[],children:Object(oa.jsx)(ai,{placeholder:"Drop off location",onChange:function(e){var t;Pt({dropoffLocation:e});var n=x.getFieldValue("pickupLocation");null!==n&&void 0!==n&&null!==(t=n.value)&&void 0!==t&&t.coordinates&&Rt(n,e),lt.current="dropoff"}})})}),Object(oa.jsx)(Hn.a,{span:2,className:"d-flex align-items-center justify-content-center",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:Object(_n.a)(Object(Bn.a)().m(function e(){var t,n,a,i,c;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Mt();case 1:return n=e.v,console.log("location",n),e.n=2,At(n);case 2:a=e.v,console.log("address",a),i={type:"incident-location",label:a,value:{description:a,place_id:"",coordinates:n}},x.setFieldsValue({dropoffLocation:i}),Pt({dropoffLocation:i}),C(Object(d.a)(Object(d.a)({},T),{},{map:!0})),null!==(c=x.getFieldValue("pickupLocation"))&&void 0!==c&&null!==(t=c.value)&&void 0!==t&&t.coordinates&&Rt(c,i),lt.current="dropoff";case 3:return e.a(2)}},e)})),children:Object(oa.jsx)(qc.a,{})})})]}),pe&&Object(oa.jsxs)(Yn.a,{className:"beam-modal summary-modal analytics-summary-modal d-flex mt-3",children:[Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("h4",{children:"Estimation"})}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("ul",{className:"incident-information mt-2",children:pe.map(function(e,t){return Object(oa.jsx)("li",{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.label})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.value})})]})},t)})})})]}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"vehicleType",label:"Select vehicle type",children:Object(oa.jsx)(Wc,{placeholder:"Select vehicle type",onChange:function(e){var t,n;Me(null===e||void 0===e?void 0:e.value);var a=x.getFieldValue("pickupLocation"),i=x.getFieldValue("dropoffLocation");null!==a&&void 0!==a&&null!==(t=a.value)&&void 0!==t&&t.coordinates&&null!==i&&void 0!==i&&null!==(n=i.value)&&void 0!==n&&n.coordinates&&Rt(a,i,null===e||void 0===e?void 0:e.value)},socket:p})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"dispatch",rules:[{required:!0,message:"**Required Field"},{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if("schedule"!==(null===n||void 0===n?void 0:n.value)||null!==n&&void 0!==n&&n.date&&null!==n&&void 0!==n&&n.time){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(Ci,{placeholder:"Select dispatch",dispatchOptions:[{id:"immediate",name:"Immediate"},{id:"schedule",name:"Schedule"}],onChange:function(e){Ne(e.value)},is12hour:dt})})})}),"schedule"===Se&&!dt&&Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"leadTime",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(la,{placeholder:"Enter lead time",onChange:function(e){}})})})})}),Object(oa.jsx)("hr",{}),F&&!dt&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"rideType",rules:[{required:!0,message:"**Required Field"},{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if("roundTrip"!==(null===n||void 0===n?void 0:n.value)||null!==n&&void 0!==n&&n.date&&null!==n&&void 0!==n&&n.time){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(_c,{placeholder:"Select ride",onChange:function(e){we(e.value)}})})})}),"roundTrip"===Ce&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"roundTripLeadTime",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(la,{placeholder:"Enter lead time",onChange:function(e){}})})})}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"roundTripNotify"})})})]}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"fareType",rules:[{required:!0,message:"**Required Field"},{validator:function(e,t){if("bid"===(null===t||void 0===t?void 0:t.value)&&(null===t||void 0===t?void 0:t.estimatedFare)>0){var n=.7*(null===t||void 0===t?void 0:t.estimatedFare),a=1.3*(null===t||void 0===t?void 0:t.estimatedFare);if((null===t||void 0===t?void 0:t.fare)<n||(null===t||void 0===t?void 0:t.fare)>a)return Promise.reject("Bid must be between ".concat(n.toFixed(0)," and ").concat(a.toFixed(0)))}return Promise.resolve()}}],children:Object(oa.jsx)(Qc,{placeholder:"Select fare",estimatedFare:ge,onChange:function(e){}})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"payType",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Gc,{placeholder:"Select payment option",onChange:function(e){}})})})}),Object(oa.jsx)("hr",{})]}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"vehicle",children:Object(oa.jsx)(zc,{placeholder:"Select vehicle",onChange:function(e){},socket:p,vehicleType:Pe})})})}),Object(oa.jsx)("hr",{})]}),dt&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"fareType",rules:[{required:!0,message:"**Required Field"},{validator:function(e,t){if("bid"===(null===t||void 0===t?void 0:t.value)&&(null===t||void 0===t?void 0:t.estimatedFare)>0){var n=.7*(null===t||void 0===t?void 0:t.estimatedFare),a=1.3*(null===t||void 0===t?void 0:t.estimatedFare);if((null===t||void 0===t?void 0:t.fare)<n||(null===t||void 0===t?void 0:t.fare)>a)return Promise.reject("Bid must be between ".concat(n.toFixed(0)," and ").concat(a.toFixed(0)))}return Promise.resolve()}}],children:Object(oa.jsx)(Qc,{placeholder:"Select fare",estimatedFare:ge,dispatchOptions:[{id:"variable",name:"Auto (Metered)"},{id:"bid",name:"Bid"}]})})})}),Object(oa.jsx)("hr",{}),(null===P||void 0===P||null===(b=P.webSettings)||void 0===b?void 0:b.webBookerMeterPayment)&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"payType",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Gc,{placeholder:"Select pay",onChange:function(e){},dispatchOptions:dt?[{id:"meter",name:"Cash"},{id:"now",name:"Card"}]:void 0})})})}),Object(oa.jsx)("hr",{})]})]}),Ze&&Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Hi,{onClose:function(){Xe(void 0)},socket:p,payment:Ze,onShare:function(){var e=x.getFieldValue("passengerPhoneNumber"),t=x.getFieldValue("passengerEmail");(e&&""!==e||t&&""!==t)&&(p.publishToEvent(m.PublishPageTopics,Xt(null===F||void 0===F?void 0:F.connectionId),Dn({userId:null===F||void 0===F?void 0:F.userId,notificationChannels:{email:t,phone:e}})),Lt("Payment link shared successfully","success","TOP_CENTER",1e3))}})})}),Object(oa.jsxs)("div",{className:"d-flex mt-3",children:[Object(oa.jsxs)("div",{className:"sub-cards-block mr-1",children:[Object(oa.jsx)("h5",{children:"Number of people"}),Object(oa.jsx)(ei.a.Item,{name:"numberOfPeople",children:Object(oa.jsx)(Fc,{onChange:function(e){var t,n,a,i,c,o,l,s,r;console.log("number of people",e),console.log("test",vt.current);var u,v,b,j,m=null===(t=vt.current)||void 0===t||null===(n=t.pickup)||void 0===n?void 0:n.find(function(t){return(null===t||void 0===t?void 0:t.numberOfPassengers)===e});m||(null===(u=vt.current)||void 0===u||null===(v=u.pickup)||void 0===v||v.sort(function(e,t){return parseFloat(t.price)-parseFloat(e.price)}),m=null===(b=vt.current)||void 0===b||null===(j=b.pickup)||void 0===j?void 0:j[0]);var p,O,f,h,g=null===(a=vt.current)||void 0===a||null===(i=a.dropoff)||void 0===i?void 0:i.find(function(t){return(null===t||void 0===t?void 0:t.numberOfPassengers)===e});g||(null===(p=vt.current)||void 0===p||null===(O=p.dropoff)||void 0===O||O.sort(function(e,t){return parseFloat(t.price)-parseFloat(e.price)}),g=null===(f=vt.current)||void 0===f||null===(h=f.dropoff)||void 0===h?void 0:h[0]);var y,I={price:-1};((null===(c=m)||void 0===c?void 0:c.price)>(null===(o=I)||void 0===o?void 0:o.price)&&(I=m),(null===(l=g)||void 0===l?void 0:l.price)>(null===(s=I)||void 0===s?void 0:s.price)&&(I=g),(null===(r=I)||void 0===r?void 0:r.price)>0)&&x.setFieldsValue({fareType:Object(d.a)({type:"fareType",value:"fixed",fare:null===(y=I)||void 0===y?void 0:y.price},I)})}})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)("h5",{children:"Number of luggage"}),Object(oa.jsx)(ei.a.Item,{name:"numberOfLuggage",children:Object(oa.jsx)(Fc,{onChange:function(){}})})]}),Object(oa.jsxs)("div",{className:"sub-cards-block mx-1",children:[Object(oa.jsx)("h5",{children:"Preferred Driver Gender"}),Object(oa.jsx)(ei.a.Item,{name:"driverGender",children:Object(oa.jsx)(Bc,{onChange:function(){}})})]})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"instructions",children:Object(oa.jsx)(ao,{autoSize:{minRows:4,maxRows:6},placeholder:"Instructions"})})})}),Object(oa.jsxs)(Yn.a,{className:"d-flex px-2",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("p",{children:"Optional"})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("p",{children:"max. 500 character"})})]}),L&&L.length>0&&Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("h4",{children:"Drivers"}),L&&L.map(function(e,t){var n,a,i;return Object(oa.jsxs)(Yn.a,{className:"responder-item mt-3",children:[Object(oa.jsx)(Hn.a,{span:4,children:Object(oa.jsx)("img",{src:"/images/users/user.png",alt:"",width:"50",height:"50"})}),Object(oa.jsxs)(Hn.a,{span:8,children:[Object(oa.jsx)("h5",{children:"".concat(null===e||void 0===e||null===(n=e.profile)||void 0===n?void 0:n.firstName," ").concat(null===e||void 0===e||null===(a=e.profile)||void 0===a?void 0:a.lastName)}),Object(oa.jsxs)("p",{children:["ID: ",null===e||void 0===e||null===(i=e.beamIds)||void 0===i?void 0:i[0]]})]}),Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn action-btn",children:"Driver"})}),Object(oa.jsx)(Hn.a,{span:6,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn mr-2",children:Object(oa.jsx)("img",{src:"/images/flag-green.png",alt:"",width:"15",height:"15"})})})]})})]})}),F&&!dt&&Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"sharePassengerLink",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Do you want to share link with passenger?"})})})})]}),N&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:N})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:ne?dt?8:6:12,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full w-full",onClick:function(){Dt(),localStorage.removeItem("lastRideId")},children:"Clear"})}),ne&&Object(oa.jsx)(Hn.a,{span:dt?8:6,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full w-full",onClick:function(){it(!0)},disabled:"black"===oe,children:"Cancel"})}),Object(oa.jsx)(Hn.a,{span:ne?dt?8:6:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:Q,disabled:mt||"green"===oe,onClick:function(){ot.current=!0},children:ne?"Update":"Dispatch"})}),ne&&!dt&&Object(oa.jsx)(Hn.a,{span:6,className:"pl-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full",htmlType:"submit",loading:Q,disabled:mt,onClick:function(){ot.current=!1},children:"New"})})]})]})}),at&&Object(oa.jsx)(Kc,{onClose:function(){it(void 0)},handleConfirm:function(){A(ft({requestData:{pageId:ne,userId:null===F||void 0===F?void 0:F.userId,cudbServiceId:null===P||void 0===P?void 0:P.userServiceId,dispatcher:!0},callback:function(e){console.log("response",e),Lt("Ride cancelled successfully","success","TOP_CENTER",1e3),A({type:De,payload:!1}),Dt()}})),it(void 0)},message:"Are you sure you want to cancel ride?"}),(null===He||void 0===He?void 0:He.phone)&&Object(oa.jsx)(eo,{socket:p,phone:null===He||void 0===He?void 0:He.phone,onClose:function(){We(void 0)}}),Qe&&Object(oa.jsx)(to,{onClose:function(){Ge(!1)},socket:p}),(null===Be||void 0===Be?void 0:Be.reservation)&&Object(oa.jsx)(Kc,{onClose:function(){_e(void 0)},handleConfirm:function(){var e;wt(void 0,null===Be||void 0===Be||null===(e=Be.reservation)||void 0===e?void 0:e.phoneNumber),_e(void 0)},message:"Incoming call: ".concat(null===Be||void 0===Be||null===(j=Be.reservation)||void 0===j?void 0:j.phoneNumber)}),void 0!==de&&Object(oa.jsx)($n.a,{visible:!0,onOk:function(){ue(void 0)},onCancel:function(){ue(void 0)},width:"480px",className:"auth-layout",footer:null,destroyOnClose:!0,children:Object(oa.jsx)("div",{className:"page-container auth-page",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"resend-form",id:"resend-form",layout:"vertical",onFinish:function(e){console.log("otp values",e),Ct(de,e.verificationCode)},requiredMark:!1,children:[Object(oa.jsx)("h3",{children:"Verify Code"}),Object(oa.jsx)("span",{children:"Please enter code you received email or phone"}),Object(oa.jsx)(ei.a.Item,{className:"mt-2",name:"verificationCode",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:"Booking Verification Code"})}),N&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:N})}),Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"btn",loading:Q,type:"primary",htmlType:"submit",onClick:function(){return k("")},children:"Verify"})})]})})})]})},co=Object(da.compose)(Object(da.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M&v=3.exp&libraries=geometry,drawing,places",loadingElement:Object(oa.jsx)("div",{style:{height:"100%"}}),containerElement:Object(oa.jsx)("div",{style:{height:"100%"}}),mapElement:Object(oa.jsx)("div",{style:{height:"100%"}})}),Object(da.withStateHandlers)(function(){return{isOpen:!1,activeMarker:null,directions:null,selectDirectionPin:null,drawingMode:null,activeInfo:null,activePolygon:null}},{onToggleOpen:function(e){var t=e.isOpen;return function(e){return{isOpen:!t,activeMarker:e}}},showDirection:function(){return function(e){return{directions:e}}},setActivePolygon:function(){return function(e){return{activePolygon:e}}},setDrawingMode:function(){return function(e){return{drawingMode:e}}},setSelectDirectionPin:function(){return function(e){return{selectDirectionPin:e}}},setActiveInfo:function(){return function(e){return{activeInfo:e}}}}),ua.withScriptjs,ua.withGoogleMap)(function(e){e.isOpen,e.active,e.setActive;var t,n,i,c=e.markers,o=e.assetMarkers,l=e.currentMarkers,r=e.currentLocation,d=e.getPlaces,u=e.setActiveInfo,v=e.activeInfo,b=e.showDirection,j=e.directions,m=e.polygon,p=e.circle,O=e.stands,f=e.polygons,h=e.setActivePolygon,g=e.activePolygon,x=Object(a.useRef)(null),y=Object(a.useRef)(!1),I=Object(s.c)(function(e){return e.auth}),S=I.selectedResponders,N=I.selectedAssets,k=Object(s.b)();Object(a.useEffect)(function(){S&&S.length>0&&console.log("update component")},[S]);var T=function(){i&&clearTimeout(i),i=setTimeout(function(){if(x.current){var e=x.current.getBounds();if(e){var t=e.getNorthEast(),n=e.getSouthWest();d({center:x.current.getCenter(),bounds:{minLat:n.lat(),maxLat:t.lat(),minLon:n.lng(),maxLon:t.lng()}})}}},500)};function C(e){var t=new window.google.maps.LatLngBounds;return e.forEach(function(e){return t.extend(e)}),t.getCenter()}Object(a.useEffect)(function(){var e,t;!function(){var e=new google.maps.LatLngBounds;c.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),o.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),l.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),O.forEach(function(t){var n,a;e.extend({lat:null===(n=t.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=t.location.coordinates)||void 0===a?void 0:a.long})}),e.isEmpty()||x.current.fitBounds(e)}(),l&&2===l.length?(y.current=!0,e=l[0],t=l[1],(new google.maps.DirectionsService).route({origin:new google.maps.LatLng(e.lat,e.lng),destination:new google.maps.LatLng(t.lat,t.lng),travelMode:google.maps.TravelMode.DRIVING},function(e,t){t===google.maps.DirectionsStatus.OK?y.current&&b(e):console.error("error fetching directions ".concat(e))})):(y.current=!1,b(void 0))},[c,l,o,O]);return Object(oa.jsxs)(ua.GoogleMap,{defaultZoom:14,options:{maxZoom:19,styles:[{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]}]},center:r,onZoomChanged:function(){T()},onCenterChanged:function(){T()},onTilesLoaded:function(){x.current&&r&&T()},ref:x,children:[m&&Object(oa.jsx)(ua.Polygon,{path:m.paths,editable:!1,options:{strokeColor:"#FF0000",fillColor:"#FF0000"},onClick:function(e){}}),f.map(function(e,t){return Object(oa.jsxs)("div",{children:[Object(oa.jsx)(ua.Polygon,{path:e.paths,editable:!1,options:{strokeColor:"#000",fillColor:"rgba(0, 0, 0, 0.3)"},onClick:function(n){console.log("on clci",e),h(t)}}),g===t&&Object(oa.jsx)(ua.InfoWindow,{position:C(e.paths),onCloseClick:function(){return h(null)},children:Object(oa.jsx)("div",{style:{color:"black",background:"transparent"},children:e.name})})]},t)}),p&&Object(oa.jsx)(ua.Circle,{center:{lat:null===(t=p.location.coordinates)||void 0===t?void 0:t[1],lng:null===(n=p.location.coordinates)||void 0===n?void 0:n[0]},radius:p.radius,options:{strokeColor:"FF0000",fillColor:"FF0000"},onClick:function(e){}}),null===O||void 0===O?void 0:O.map(function(e,t){var n,a;return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-green.svg",scaledSize:new google.maps.Size(22,34)},position:{lat:null===(n=e.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=e.location.coordinates)||void 0===a?void 0:a.long},onClick:function(){k({type:Ee,payload:e})}},t)}),c.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/car-".concat(-1===S.findIndex(function(t){return t.id===e.id})?e.status:"blue",".svg"),scaledSize:new google.maps.Size(60,60)},position:{lat:e.lat,lng:e.lng},onClick:function(){"green"===(null===e||void 0===e?void 0:e.status)&&k({type:Ce,payload:e})},label:e.title},t)}),o.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===N.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){k({type:we,payload:e})},label:e.title},t)}),l.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===S.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){u(t)},children:v===t&&Object(oa.jsx)(ua.InfoWindow,{onCloseClick:function(){u(null)},children:Object(oa.jsx)("div",{children:Object(oa.jsx)("div",{children:e.title})})})},t)}),Object(oa.jsx)(ua.Marker,{position:r,icon:{url:"/images/map-plain-icon-blue.svg",scaledSize:new google.maps.Size(22,34)},onClick:function(){}}),j&&Object(oa.jsx)(ua.DirectionsRenderer,{directions:j,options:{markerOptions:{opacity:1},panel:document.getElementById("direction-panel")}})]})}),oo={lat:29.95106579999999,lng:-90.0715323};var lo=function(e){var t=e.socket,n=e.params,i=n.screens,c=(n.setScreens,Object(a.useState)()),o=Object(u.a)(c,2),r=(o[0],o[1],Object(a.useState)()),v=Object(u.a)(r,2),b=v[0],j=v[1],p=Object(a.useState)(!0),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(a.useState)(!0),I=Object(u.a)(g,2),S=I[0],N=(I[1],Object(a.useState)([])),k=Object(u.a)(N,2),T=k[0],C=k[1],w=Object(a.useState)([]),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useState)([]),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Object(a.useState)(!1),q=Object(u.a)(U,2),F=q[0],B=q[1],_=Object(a.useReducer)(function(e){return e+1},0),$=Object(u.a)(_,2),Y=($[0],$[1],Object(s.c)(function(e){return e.auth})),H=Y.responders,W=Y.vehicles,V=(Y.incidentLocation,Y.project),z=Y.otherLocations,Q=Y.assets,G=Y.geofenceLocation,J=Y.standLocations,K=Y.encrypted_token,Z=Y.projects,X=Object(l.g)().search,ee=Object(a.useState)(),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ie=(Object(s.b)(),function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],i=t[1];Object(a.useEffect)(function(){i(!0)},[])}(),{createPlaceMarker:function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m=arguments.length>1&&void 0!==arguments[1]&&arguments[1],p=arguments.length>2?arguments[2]:void 0;null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.geoJson)||void 0===n||null===(a=n.features)||void 0===a||a.map(function(e){(null===e||void 0===e?void 0:e.geometry.coordinates.length)>0&&(j=e.geometry)});var O=(null===(i=e.beamIds)||void 0===i?void 0:i[0])||"".concat(e.profile.firstName,".").concat(e.profile.lastName);return null===p||void 0===p||p.map(function(t){t.id===e.id&&(O=t.name)}),Object(d.a)(Object(d.a)({},e),{},{lat:null===(c=j)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o[1],lng:null===(l=j)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s[0],title:O,color:"orange",paths:{lat:null===(r=j)||void 0===r||null===(u=r.coordinates)||void 0===u?void 0:u[1],lng:null===(v=j)||void 0===v||null===(b=v.coordinates)||void 0===b?void 0:b[0]},type:"marker",filter:"viewOnly",fitBounds:m})},createCurrentMarker:function(e){var t,n,a,i,c,o,l,s;return console.log("render point here",e),Object(d.a)(Object(d.a)({},e),{},{lat:null===e||void 0===e||null===(t=e.value)||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.lat,lng:null===e||void 0===e||null===(a=e.value)||void 0===a||null===(i=a.coordinates)||void 0===i?void 0:i.long,title:null===e||void 0===e?void 0:e.label,color:"blue",paths:{lat:null===e||void 0===e||null===(c=e.value)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o.lat,lng:null===e||void 0===e||null===(l=e.value)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s.long},type:"marker"})},createAssetMarker:function(e){var t,n,a,i,c,o,l,s,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"fixedAsset"===(null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.type)?s=null===e||void 0===e?void 0:e.asset:"poi"===(null===e||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)&&(s=null===e||void 0===e?void 0:e.poi);var u=s.location;return Object(d.a)(Object(d.a)({},s),{},{id:e.id,assetType:null===e||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.type,lat:null===u||void 0===u||null===(i=u.coordinates)||void 0===i?void 0:i.lat,lng:null===u||void 0===u||null===(c=u.coordinates)||void 0===c?void 0:c.long,title:u.attributes.title,color:"orange",paths:{lat:null===u||void 0===u||null===(o=u.coordinates)||void 0===o?void 0:o.lat,lng:null===u||void 0===u||null===(l=u.coordinates)||void 0===l?void 0:l.long},type:"marker",filter:"viewOnly",fitBounds:r})}}),ce=ie.createPlaceMarker,oe=ie.createCurrentMarker,le=ie.createAssetMarker,se=Object(a.useState)(!1),re=Object(u.a)(se,2),de=re[0],ue=re[1],ve=Object(a.useState)(void 0),be=Object(u.a)(ve,2),je=be[0],me=be[1],pe=Object(a.useState)(void 0),Oe=Object(u.a)(pe,2),fe=Oe[0],he=Oe[1],ge=Object(a.useState)([]),xe=Object(u.a)(ge,2),ye=xe[0],Ie=xe[1],Se=Object(a.useState)([]),Ne=Object(u.a)(Se,2),ke=Ne[0],Te=Ne[1],Ce=Mn().getUserRequestPayload;Object(a.useEffect)(function(){var e=new URLSearchParams(X),t=e.get("lat"),n=e.get("lng");t&&n?j({lat:parseFloat(t),lng:parseFloat(n),current:!0}):Pe()},[X]),Object(a.useEffect)(function(){if(z){console.log("other locations",z);var e=Object.keys(z).map(function(e){return oe(z[e])});L(e)}},[z]),Object(a.useEffect)(function(){if(G)if(console.log("geofence location",G),"Polygon"===(null===G||void 0===G?void 0:G.location.type)){var e=null===G||void 0===G?void 0:G.location.coordinates.map(function(e){return{lat:null===e||void 0===e?void 0:e[1],lng:null===e||void 0===e?void 0:e[0]}});me({paths:e})}else he(G);else me(void 0),he(void 0)},[G]),Object(a.useEffect)(function(){J&&(console.log("stand locations",J),Ie(J))},[J]);var we=function(e,n,a){ue(!0),t.publishToEvent(m.PublishPageTopics,Yt(null===K||void 0===K?void 0:K.connectionId),Dn({userId:null===K||void 0===K?void 0:K.userId,projectId:V,cudbServiceId:null===Z||void 0===Z?void 0:Z.userServiceId,latLng:e,height:3e5,width:3e5}))};Object(a.useEffect)(function(){null!==Z&&void 0!==Z&&Z.adminUserId&&null!==b&&void 0!==b&&b.current&&we({lat:b.lat,long:b.lng})},[Z,b]),Object(a.useEffect)(function(){null!==Z&&void 0!==Z&&Z.adminUserId&&Re()},[Z]);var Ee=function(e){var t,n,a,i,c,o,l,s,r;return"Polygon"===(null===e||void 0===e||null===(t=e.location)||void 0===t?void 0:t.type)?{id:e._id,name:e.name,paths:null===e||void 0===e||null===(a=e.location)||void 0===a||null===(i=a.coordinates)||void 0===i||null===(c=i[0])||void 0===c?void 0:c.map(function(e){return{lat:null===e||void 0===e?void 0:e[1],lng:null===e||void 0===e?void 0:e[0]}})}:"Circle"===(null===e||void 0===e||null===(n=e.location)||void 0===n?void 0:n.type)?{radius:e.radius,lat:null===e||void 0===e||null===(o=e.location)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l[1],lng:null===e||void 0===e||null===(s=e.location)||void 0===s||null===(r=s.coordinates)||void 0===r?void 0:r[0],id:e._id,name:e.name}:void 0},Re=function(){t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Ce(null===Z||void 0===Z?void 0:Z.adminUserId,"$","$..persistent.static.admin.fleetZones.items"),x.GetUserBio,null===Z||void 0===Z?void 0:Z.userServiceId),t.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,n,a,i,c;console.log("fleets",null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]);var o=null===e||void 0===e||null===(a=e.data)||void 0===a||null===(i=a[0])||void 0===i?void 0:i[0],l=[],s=[];null===(c=Object.values(o||{}))||void 0===c||c.map(function(e){var t,n,a,i;"Polygon"===(null===e||void 0===e||null===(t=e.zoneGeofenceId)||void 0===t||null===(n=t.location)||void 0===n?void 0:n.type)?l.push(Ee(null===e||void 0===e?void 0:e.zoneGeofenceId)):"Circle"===(null===e||void 0===e||null===(a=e.zoneGeofenceId)||void 0===a||null===(i=a.location)||void 0===i?void 0:i.type)&&s.push(Ee(null===e||void 0===e?void 0:e.zoneGeofenceId))}),console.log("polygons",l),console.log("circles",s),Te(l)})};Object(a.useEffect)(function(){if(ue(!1),H){var e=H.map(function(e){return ce(e,!1,W)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),console.log("markers here",e),C(e)}},[H]),Object(a.useEffect)(function(){if(ue(!1),Q&&Q.length>0){console.log("assets here",Q);var e=Q.map(function(e){return le(e)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),P(e)}},[Q]);var Pe=function(){b&&null!==b&&void 0!==b&&b.current?j(Object(d.a)({},b)):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,n,a,i,c;j({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,lng:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude,current:!0}),gc.a.fromLatLng(null===e||void 0===e||null===(a=e.coords)||void 0===a||null===(i=a.latitude)||void 0===i?void 0:i.toString(),null===(c=e.coords.longitude)||void 0===c?void 0:c.toString()).then(function(e){for(var t=0,n=e.results[0].address_components.length;t<n;t++){var a=e.results[0].address_components[t];a.types.indexOf("administrative_area_level_1")>=0&&a.short_name,a.types.indexOf("country")>=0&&a.short_name}},function(e){console.error(e),j(oo)})},function(e){console.error(e),j(oo)}):(alert("Geolocation is not supported by this browser."),j(oo))},De=function(e,t,n,a){var i=Ae(n-e),c=Ae(a-t),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(Ae(e))*Math.cos(Ae(n))*Math.sin(c/2)*Math.sin(c/2);return 1e3*(6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))))},Ae=function(e){return e*(Math.PI/180)};return Object(oa.jsx)("div",{className:"main-column map-panel mr-4",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsx)("div",{className:"search-bar mt-3",children:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)("div",{className:"g-map-search-input",children:Object(oa.jsx)(Ii.a,{autocompletionRequest:{},selectProps:{onChange:function(e){e&&function(e){Object(Ii.b)(e.place_id).then(function(e){e[0].geometry&&j({lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),current:!1})}).catch(function(e){return console.error(e)})}(e.value)},isClearable:!0,placeholder:"Search map",styles:{input:function(e){return Object(d.a)(Object(d.a)({},e),{},{fontFamily:"Nunito-Regular"})}}},apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/location-icon.svg",onClick:Pe})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/reload-icon.svg",onClick:function(){h(!1),B(!1),C([]),P([]),Pe()}})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",onClick:function(){if(!de&&ne){var e=ne.latLong;ne.height,ne.width;we(e)}},children:de?Object(oa.jsx)(Ic.a,{type:"TailSpin",color:"#95a8c8",height:20,width:20}):Object(oa.jsx)(fa.a,{src:"/images/car.svg",className:"car-icon"})})]})}),Object(oa.jsx)("div",{className:"main-cards",children:Object(oa.jsxs)(Yn.a,{className:"map-container-layout",children:[Object(oa.jsx)(Hn.a,{md:i.active&&F?6:0,children:Object(oa.jsx)("div",{id:"direction-panel"})}),Object(oa.jsx)(Hn.a,{md:i.active&&F?18:24,children:S&&Object(oa.jsx)(co,{currentLocation:b,markers:T,assetMarkers:R,currentMarkers:M,polygon:je,polygons:ke,circle:fe,stands:ye,active:f,setActive:h,getPlaces:function(e){var t=e.bounds,n=e.center,a=De(t.minLat,t.maxLon,t.maxLat,t.maxLon),i=De(t.minLat,t.maxLon,t.minLat,t.minLon),c={lat:n.lat(),long:n.lng()};ae({latLong:c,height:a,width:i})}})})]})})]})})},so=n(182);Dc.d.register(Dc.c,Dc.g,Dc.b,Dc.i,Dc.j,Dc.e);var ro=function(e){var t=e.data;return Object(oa.jsx)(so.a,{options:{responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:""}}},data:t})},uo=(n(957),Object(da.compose)(Object(da.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M&v=3.exp&libraries=geometry,drawing,places",loadingElement:Object(oa.jsx)("div",{style:{height:"100%"}}),containerElement:Object(oa.jsx)("div",{style:{height:"100%"}}),mapElement:Object(oa.jsx)("div",{style:{height:"100%"}})}),Object(da.withStateHandlers)(function(){return{isOpen:!1,activeMarker:null,directions:null,activeInfo:null}},{onToggleOpen:function(e){var t=e.isOpen;return function(e){return{isOpen:!t,activeMarker:e}}},showDirection:function(e){e.directions;return function(e){return{directions:e}}},setActiveInfo:function(){return function(e){return{activeInfo:e}}}}),ua.withScriptjs,ua.withGoogleMap)(function(e){var t=e.location,n=e.locations,i=e.onClick,c=e.setActiveInfo,o=e.activeInfo,l=Object(a.useRef)(null);return Object(a.useEffect)(function(){!function(){var e=new google.maps.LatLngBounds;n.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),e.isEmpty()||l.current.fitBounds(e)}()},[n]),Object(oa.jsx)(ua.GoogleMap,{defaultZoom:14,center:t,onClick:i,ref:l,defaultOptions:{fullscreenControl:!1},children:null===n||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:{url:"/images/Place-icon.png"},position:{lat:e.lat,lng:e.lng},onClick:function(){c(t)},children:o===t&&Object(oa.jsx)(ua.InfoWindow,{onCloseClick:function(){c(null)},children:Object(oa.jsx)("div",{children:Object(oa.jsx)("div",{children:e.title||""})})})},t)})})})),vo=function(e){var t=e.location,n=e.locations;return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(uo,{onClick:function(){},location:t,locations:n})})},bo=function(e){var t=e.onClose,n=e.socket,i=e.columns,c=e.tableHideList,o=e.onChange,r=(Object(s.b)(),Object(a.useState)(!1)),d=Object(u.a)(r,2),v=(d[0],d[1],Object(a.useState)([])),b=Object(u.a)(v,2),j=(b[0],b[1],Object(a.useState)()),m=Object(u.a)(j,2),p=m[0],O=m[1];Object(s.c)(function(e){return e.auth}).encrypted_token,Object(l.g)().search;Object(a.useEffect)(function(){n.client},[n.client]);return Object(a.useEffect)(function(){O(null===i||void 0===i?void 0:i.filter(function(e){return-1===(null===c||void 0===c?void 0:c.indexOf(e.key))}).map(function(e){return e.key}))},[]),Object(oa.jsxs)($n.a,{title:"Filter columns",visible:!0,onOk:function(e){},onCancel:function(){t()},width:"480px",className:"beam-modal scrollable",footer:[],destroyOnClose:!0,closable:!0,children:[Object(oa.jsx)(Yn.a,{className:"scrollable-body mt-4",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Xn.a.Group,{className:"plain-radios w-100",onChange:function(e){O(e)},value:p,children:i&&i.map(function(e,t){return Object(oa.jsxs)(Yn.a,{className:"person-item",children:[Object(oa.jsx)(Hn.a,{span:21,children:Object(oa.jsx)("h5",{children:null===e||void 0===e?void 0:e.title})}),Object(oa.jsx)(Hn.a,{span:3,className:"d-block t-right",children:Object(oa.jsx)(Xn.a,{value:null===e||void 0===e?void 0:e.key,className:"green-radio"})})]},t)})})})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-4 sticky-footer",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){var e=[];null===i||void 0===i||i.map(function(t){-1===(null===p||void 0===p?void 0:p.indexOf(t.key))&&e.push(t.key)}),o(e)},children:"Save"})})})]})};n(958);Dc.d.register(Dc.a,Dc.j,Dc.e);var jo=Gn.a.Option,mo=function(e){var t=e.socket,n=Object(l.g)().search,c=Object(s.c)(function(e){return e.auth}),o=c.userRequests,r=c.projects,v=Object(s.b)(),b=Object(a.useState)("project"),j=Object(u.a)(b,2),p=j[0],O=j[1],f=Object(a.useState)("state"),h=Object(u.a)(f,2),g=h[0],x=h[1],I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1],w=Object(a.useState)(void 0),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useState)(void 0),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Object(a.useState)(!1),q=Object(u.a)(U,2),F=q[0],B=q[1],_=Object(a.useState)(!1),$=Object(u.a)(_,2),Y=$[0],H=$[1],V=Object(a.useState)([]),G=Object(u.a)(V,2),J=G[0],K=G[1],Z=Object(a.useState)([]),X=Object(u.a)(Z,2),ee=X[0],te=X[1],ne=Object(a.useState)(),ae=Object(u.a)(ne,2),ie=ae[0],ce=ae[1],oe=Object(a.useState)([]),le=Object(u.a)(oe,2),se=le[0],re=le[1],de=Object(a.useRef)(W()),ue=Object(a.useRef)(void 0),ve=Object(a.useRef)(void 0),be=Object(a.useRef)(0),je=Object(a.useRef)(void 0),me=[{label:"Created",name:"purple",color:"#463BBD"},{label:"Started",name:"blue",color:"#508AFA"},{label:"Assigned",name:"amber",color:"#FBAE16"},{label:"Escalated",name:"red",color:"#FF5F25"},{label:"Completed",name:"green",color:"#40CC52"},{label:"Processed",name:"grey",color:"#91A5C6"},{label:"Cancelled",name:"black",color:"#00000"}],pe=Object(a.useState)(),Oe=Object(u.a)(pe,2),fe=Oe[0],he=Oe[1],ge=Object(a.useState)(Object(d.a)({all:0,live:0},me.reduce(function(e,t){return Object(d.a)(Object(d.a)({},e),{},Object(T.a)({},t.name,0))},{}))),xe=Object(u.a)(ge,2),ye=xe[0],Ie=xe[1],Se=Object(a.useState)(0),Ne=Object(u.a)(Se,2),ke=Ne[0],Te=Ne[1],Ce=Object(a.useState)({labels:me.map(function(e){return e.label}),datasets:[{label:"Page status",data:[1,0,0,0,0,0,0],backgroundColor:me.map(function(e){return e.color}),borderWidth:1}]}),we=Object(u.a)(Ce,2),Ee=we[0],Re=we[1],Pe=Object(a.useState)({labels:["Status"],datasets:me.map(function(e){return{label:e.label,data:[0],backgroundColor:e.color}})}),De=Object(u.a)(Pe,2),Ae=De[0],Me=De[1],Le=Object(a.useState)([]),Ue=Object(u.a)(Le,2),qe=Ue[0],Fe=Ue[1],Be=Object(a.useState)([]),_e=Object(u.a)(Be,2),$e=_e[0],Ye=_e[1],He=Object(a.useState)(!1),We=Object(u.a)(He,2),Ve=We[0],ze=We[1],Qe=Object(a.useState)([]),Ge=Object(u.a)(Qe,2),Je=Ge[0],Ke=Ge[1],Ze=Mn().getUserRequestPayload,Xe=Object(a.useRef)(void 0),et=Object(a.useRef)({project:void 0,user:void 0,status:void 0,area:void 0,time:void 0}),nt=Object(a.useRef)([]),at=function(e){et.current.status=e?"exists(@status) && @status === '".concat(e,"'"):void 0,B(!0),je.current=e,dt()},it=function(e,t){"start"===e?ue.current=t:ve.current=t,ue.current&&ve.current?(et.current.time="exists(@createdAt) && @createdAt > ".concat(new Date(ue.current).getTime()," && @createdAt < ").concat(new Date(ve.current).getTime()),H(!0),dt()):ue.current||ue.current||(et.current.time=void 0,H(!0),dt())},ct=function(e){var t;if(p!==e&&null!==r&&void 0!==r&&r.projects&&Xe.current){P(void 0),K([]);var n=[];switch(e){case"project":null===r||void 0===r||null===(t=r.projects)||void 0===t||t.map(function(e){n.push({label:e.name,value:e.id})}),K(n);break;case"manager":lt(Xe.current,"manager");break;case"dispatcher":lt(Xe.current,"dispatcher");break;case"responder":lt(Xe.current,"responder")}O(e)}},ot=function(e){g!==e&&(L(void 0),te([]),st(e),x(e))},lt=function(e,a){var i,c=new URLSearchParams(n).get("connectionId");switch(a){case"dispatcher":i=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1===e.permissions.indexOf("admin")});break;case"responder":i=e.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")});break;case"manager":i=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")})}var o=i.map(function(e){return"@roleId === '".concat(e._id,"'")}),l={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(o.join("||"),")")},anyStatus:!1};t.publishToEvent(m.PublishPageTopics,xn(c),Dn(l,"".concat(de.current,":").concat(a))),k(!0)},st=function(e){var t=new URLSearchParams(n).get("userId");H(!0);var a={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(t,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(T.a)({},e,"$.persistent.static.profile.".concat(e))},groupBy:{properties:["@".concat(e)],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:""}};v(tt({requestData:a,callback:function(e){H(!1);var t=[];null===e||void 0===e||e.map(function(e){e[Object.keys(e)[0]]&&t.push({label:e[Object.keys(e)[0]],value:e[Object.keys(e)[0]]})}),te(t)}}))},rt=function(){var e=new URLSearchParams(n).get("userId"),t={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(e,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{profile:"$..profile",type:"$..persistent.static.metadata.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",status:"$.nonpersistent.static.live.status.name"}},groupBy:{properties:["@status"],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:["exists(@profile)","exists(@type)","@type==='event'"].join("&&")}};v(tt({requestData:t,callback:function(e){var t=0,n=Object(d.a)({},me.reduce(function(e,t){return Object(d.a)(Object(d.a)({},e),{},Object(T.a)({},t.name,0))},{}));e.map(function(e){n[e.status]=e.count,t+=e.count});var a=Object(d.a)({},Ee);a.datasets[0].data=[n.purple,n.blue,n.amber,n.red,n.green,n.grey,n.black];var i=Object(d.a)({},Ae);i.datasets[0].data[0]=n.purple,i.datasets[1].data[0]=n.blue,i.datasets[2].data[0]=n.amber,i.datasets[3].data[0]=n.red,i.datasets[4].data[0]=n.green,i.datasets[5].data[0]=n.grey,i.datasets[6].data[0]=n.black,Re(a),Me(i),Ie(Object(d.a)({all:t,live:t},n))}}))};Object(a.useEffect)(function(){ye&&Te(ke+1)},[JSON.stringify(ye)]),Object(a.useEffect)(function(){if(fe){var e,t,n,a,i,c,o,l,s,u,v,b,j,m=(null===fe||void 0===fe||null===(e=fe.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.profile)||{},p=null===fe||void 0===fe||null===(n=fe.nonpersistent)||void 0===n||null===(a=n.static)||void 0===a||null===(i=a.live)||void 0===i||null===(c=i.status)||void 0===c?void 0:c.name,O=Object(C.a)(qe),f=O.findIndex(function(e){return e.key===fe.pageId});if(rt(),je.current&&je.current!==p)return void(-1!==f&&(O.splice(f,1),Fe(O)));var h={};Object.keys(m).map(function(e){"string"===typeof m[e]&&(h[e]=m[e])});var g=Object(d.a)({key:fe.pageId,pageStatus:null===fe||void 0===fe||null===(o=fe.nonpersistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(u=s.status)||void 0===u?void 0:u.name,name:null===fe||void 0===fe||null===(v=fe.persistent)||void 0===v||null===(b=v.static)||void 0===b||null===(j=b.metadata)||void 0===j?void 0:j.title,action:{pageId:fe.pageId,page:fe,summary:h.summary,cudbServiceId:null===r||void 0===r?void 0:r.userServiceId}},h);-1!==f?O[f]=g:O.unshift(g),re(null===O||void 0===O?void 0:O.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;return{lat:null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(i=a.static)||void 0===i||null===(c=i.live)||void 0===c||null===(o=c.location)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l.lat,lng:null===e||void 0===e||null===(s=e.action)||void 0===s||null===(r=s.page)||void 0===r||null===(d=r.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.location)||void 0===b?void 0:b.coordinates.long,title:null===e||void 0===e||null===(j=e.action)||void 0===j||null===(m=j.page)||void 0===m||null===(p=m.persistent)||void 0===p||null===(O=p.static)||void 0===O||null===(f=O.metadata)||void 0===f?void 0:f.title}})),Fe(O)}},[fe]);var dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=new URLSearchParams(n).get("userId"),i=["exists(@profile)","exists(@type)","@type==='event'"];et.current&&Object.keys(et.current).map(function(e){var t,n;null!==(t=et.current)&&void 0!==t&&t[e]&&i.push(null===(n=et.current)||void 0===n?void 0:n[e])});var c={};nt.current&&nt.current.map(function(e){c[e.key]=e.value}),be.current=e;var o={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(a,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",type:"$..persistent.static.metadata.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name"},g,"$..profile.".concat(g)),c)},filter:{expression:i.join("&&")},sortBy:{properties:[{field:"@updatedAt",order:"DESC"}],max:10},result:{pagination:{offset:e,limit:30}}};v(tt({requestData:o,callback:function(a){var i;ce(a),be.current=be.current+30;var c=e>0?Object(C.a)(qe):[],o=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Name",key:"name",dataIndex:"name"}];null===a||void 0===a||a.map(function(e,t){var n,a,i,o,l,s,u,v,b,j=null===e||void 0===e||null===(n=e.persistent)||void 0===n||null===(a=n.static)||void 0===a?void 0:a.profile,m={};Object.keys(j).map(function(e){"string"===typeof j[e]&&(m[e]=j[e])}),c.push(Object(d.a)({key:e.pageId,pageStatus:null===e||void 0===e||null===(i=e.nonpersistent)||void 0===i||null===(o=i.static)||void 0===o||null===(l=o.live)||void 0===l||null===(s=l.status)||void 0===s?void 0:s.name,name:null===e||void 0===e||null===(u=e.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.metadata)||void 0===b?void 0:b.title,action:{pageId:e.pageId,page:e,summary:m.summary,cudbServiceId:null===r||void 0===r?void 0:r.userServiceId}},m))}),c.map(function(e){var t,n,a,i,c=null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(i=a.static)||void 0===i?void 0:i.profile;Object.keys(c).map(function(e){-1===o.findIndex(function(t){return t.key===e})&&"string"===typeof c[e]&&o.push({title:Q(e),dataIndex:e,key:e})})}),o.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:90},children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){var a=new URLSearchParams(n).get("userId");t.publishToEvent(m.PublishPageTopics,On(null===e||void 0===e?void 0:e.pageId,a),{page:null===e||void 0===e?void 0:e.page})},children:Object(oa.jsx)(wc.a,{})})}),Object(oa.jsx)(Hn.a,{span:12,children:(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t,a=new URLSearchParams(n).get("connectionId");window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(a,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:Object(oa.jsx)(Ec.a,{})})})]})}}),Ye(o),Fe(c),re(null===a||void 0===a||null===(i=a.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}}))||void 0===i?void 0:i.filter(function(e){return e.lat&&e.lng})),B(!1),k(!1),H(!1)}})),rt()};Object(a.useEffect)(function(){if(t.client){var e=new URLSearchParams(n),a=e.get("userId"),i=e.get("connectionId");t.subscribeToEvent(m.SubscribePageTopics,qt(i)),t.publishToEvent(m.PublishPageTopics,Ft(i),Dn({userId:a})),t.subscribeToEvent(m.SubscribePageTopics,Rn(a),function(e){!function(e){if("string"===typeof e){var t=new URLSearchParams(n).get("userId"),a={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(t,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},list:{objectIds:[e]},load:{persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId"}},filter:{expression:""}};v(tt({requestData:a,callback:function(e){he(null===e||void 0===e?void 0:e[0])}}))}}(null===e||void 0===e?void 0:e.data)}),k(!0),dt(),st("state"),Ke(JSON.parse(localStorage.getItem("tableHideList"))||[])}},[n,t.client]),Object(a.useEffect)(function(){if(r){var e,a=new URLSearchParams(n).get("connectionId"),i=[];null===r||void 0===r||null===(e=r.projects)||void 0===e||e.map(function(e){i.push({label:e.name,value:e.id})}),K(i),null!==r&&void 0!==r&&r.adminUserId&&(!function(e,a){var i=new URLSearchParams(n).get("connectionId");t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Ze(e,"$","$..role"),hn(i),a),t.subscribeToSurvey(m.SurveyTopics,hn(i),function(e){var t,n;Xe.current=null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]})}(null===r||void 0===r?void 0:r.adminUserId,null===r||void 0===r?void 0:r.userServiceId),t.subscribeToEvent(m.SubscribePageTopics,bn(a,null===r||void 0===r?void 0:r.userServiceId)),t.subscribeToEvent(m.SubscribePageTopics,yn(a)))}},[r]),Object(a.useEffect)(function(){if(o&&t.client&&null!==o&&void 0!==o&&o["".concat(de.current,":").concat(p)]){var e;k(!1);var n=[];null===o||void 0===o||null===(e=o["".concat(de.current,":").concat(p)])||void 0===e||e.map(function(e){n.push({label:"".concat(e.fullName,": ").concat(e.email),value:e.id})}),K(n)}},[o,t.client]);var ut=Object(a.useMemo)(function(){return Object(oa.jsx)(vo,{locations:se,location:{lat:31.5272253,lng:74.4155498}})},[JSON.stringify(se)]);return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{gutter:30,children:[Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{gutter:16,className:"d-flex px-1 flex-wrap",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){ct("manager")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("manager"===p?"green-btn cover":""),children:"Manager"})}),Object(oa.jsx)("div",{onClick:function(){ct("project")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("project"===p?"green-btn cover":""),children:"Project"})}),Object(oa.jsx)("div",{onClick:function(){ct("dispatcher")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("dispatcher"===p?"green-btn cover":""),children:"Dispatcher"})}),Object(oa.jsx)("div",{onClick:function(){ct("responder")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("responder"===p?"green-btn cover":""),children:"Responder"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:N,value:R,allowClear:!0,options:J,onChange:function(e){!function(e){switch(P(e),p){case"project":et.current.project=e?"exists(@iotAssetConfigId) && @iotAssetConfigId === '".concat(e,"'"):void 0,et.current.user=void 0,k(!0);break;case"manager":case"responder":case"dispatcher":nt.current=[{key:"user",value:"$.persistent.static.metadata.members.users.".concat(e)}],et.current.user=e?"exists(@user)":void 0,et.current.project=void 0,k(!0)}dt()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex px-2 flex-wrap mt-4",children:Object(oa.jsx)(Hn.a,{sm:24,md:4,children:Object(oa.jsx)("h5",{className:"mb-0",children:"Status"})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:F,allowClear:!0,onChange:function(e){at(e)},children:me.map(function(e,t){return Object(oa.jsx)(jo,{value:e.name,children:e.label})})})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{className:"d-flex flex-wrap",id:"filters",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){ot("state")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("state"===g?"green-btn cover":""),children:"State"})}),Object(oa.jsx)("div",{onClick:function(){ot("city")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("city"===g?"green-btn cover":""),children:"City"})}),Object(oa.jsx)("div",{onClick:function(){ot("county")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("county"===g?"green-btn cover":""),children:"County"})}),Object(oa.jsx)("div",{onClick:function(){ot("zip")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("zip"===g?"green-btn cover":""),children:"Zip"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{xs:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:Y,allowClear:!0,options:ee,value:M,onChange:function(e){!function(e){L(e),et.current.time=e?"exists(@".concat(g,") && @").concat(g," === '").concat(e,"'"):void 0,H(!0),dt()}(e)}})})}),Object(oa.jsxs)(Yn.a,{gutter:15,className:"d-flex flex-wrap mt-3 mx-0",children:[Object(oa.jsxs)(Hn.a,{xs:24,md:10,className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png",alt:""}),Object(oa.jsx)(Jn.a,{placeholder:"From",suffixIcon:Object(oa.jsx)(aa.a,{}),onChange:function(e){it("start",e)}})]}),Object(oa.jsx)(Hn.a,{xs:24,md:4,className:"d-flex justify-content-center",children:Object(oa.jsx)(fa.a,{src:"/images/next.svg"})}),Object(oa.jsxs)(Hn.a,{xs:24,md:10,className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png",alt:""}),Object(oa.jsx)(Jn.a,{placeholder:"To",suffixIcon:Object(oa.jsx)(aa.a,{}),onChange:function(e){it("end",e)}})]})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select Hour(s)",disabled:!0})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:4,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsx)("p",{className:"mb-2 text-center",children:"Export to"}),Object(oa.jsxs)("div",{className:"d-flex flex-row flex-md-column justify-content-center",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-csv.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-xls.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-pdf.svg"})})})]})]})})]}),ie&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{className:"map-chart mt-4",children:[Object(oa.jsx)(Hn.a,{xs:24,sm:12,md:8,children:Object(oa.jsx)("div",{className:"main-column message-panel mr-4",children:Object(oa.jsxs)("div",{className:"main-content p-0",children:[Object(oa.jsxs)("div",{className:"main-header pt-3 pr-5 pl-4 border-bottom-0",children:[Object(oa.jsx)("div",{className:"d-flex"}),Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/expand-icon.svg",className:"close-icon mr-4"}),Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon"})]})]}),ut]})})}),Object(oa.jsx)(Hn.a,{xs:24,sm:12,md:8,children:Object(oa.jsx)("div",{className:"main-column message-panel mr-4",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex"}),Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/expand-icon.svg",className:"close-icon mr-4"}),Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon"})]})]}),Object(oa.jsx)("div",{className:"d-flex justify-content-center align-self-center",children:Object(oa.jsx)(so.c,{data:Ee,redraw:!0},ke)})]})})}),Object(oa.jsx)(Hn.a,{xs:24,sm:12,md:8,children:Object(oa.jsx)("div",{className:"main-column message-panel",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex"}),Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/expand-icon.svg",className:"close-icon mr-4"}),Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon"})]})]}),Object(oa.jsx)(ro,{data:Ae})]})})})]}),Object(oa.jsxs)(Yn.a,{className:"d-flex mt-3",children:[Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer",onClick:function(){at(void 0)},children:Object(oa.jsxs)("div",{className:"",children:[Object(oa.jsx)("span",{children:"All"}),Object(oa.jsx)("h4",{children:ye.live})]})}),me.map(function(e,t){return Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer",onClick:function(){at(e.name)},children:Object(oa.jsxs)("div",{className:e.name,children:[Object(oa.jsx)("span",{children:e.label}),Object(oa.jsx)("h4",{children:ye[e.name]})]})})})]})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"mt-4 scrollable-table",children:Object(oa.jsxs)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:[Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0 10px 0"},onClick:function(){ze(!0)},children:Object(oa.jsx)(Rc.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 10px 10px 0"},loading:N||F,onClick:function(){k(!0),dt()},children:!N&&!F&&Object(oa.jsx)(Pc.a,{})}),Object(oa.jsx)(Xi.a,{dataSource:qe,onRow:function(e){return{onDoubleClick:function(){var a,i,c=new URLSearchParams(n).get("userId");t.publishToEvent(m.PublishPageTopics,On(null===e||void 0===e||null===(a=e.action)||void 0===a?void 0:a.pageId,c),{page:null===e||void 0===e||null===(i=e.action)||void 0===i?void 0:i.page})}}},columns:null===$e||void 0===$e?void 0:$e.filter(function(e){return-1===(null===Je||void 0===Je?void 0:Je.indexOf(e.key))}),scroll:{x:!0}}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,className:"d-flex justify-content-center align-items-center",children:Object(oa.jsx)(Vn.a,{className:"beam-btn mt-3 mb-3",loading:N,onClick:function(){k(!0),dt(be.current)},children:"Load more"})})}),Ve&&Object(oa.jsx)(bo,{socket:t,tableHideList:Je,onChange:function(e){Ke(e),localStorage.setItem("tableHideList",JSON.stringify(e)),ze(!1)},columns:$e,onClose:function(){ze(!1)}})]})})]})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var po=function(e){var t=e.socket,n=(Object(l.f)(),Object(s.b)(),Object(a.useState)(void 0)),i=Object(u.a)(n,2),c=(i[0],i[1],Object(a.useState)(!1)),o=Object(u.a)(c,2),r=(o[0],o[1],Object(a.useState)(!1)),d=Object(u.a)(r,2),b=(d[0],d[1],Object(a.useState)({form:!0,map:!0})),j=Object(u.a)(b,2),m=j[0],p={screens:m,setScreens:j[1]};return Object(oa.jsxs)(Yn.a,{className:"main-layout",children:[m.form&&Object(oa.jsx)(Hn.a,{md:m.map?12:24,xs:24,className:"form"===m.active?"active-screen":"",style:{height:"65vh"},children:m.form&&Object(oa.jsx)(io,{socket:t,params:p})}),m.map&&Object(oa.jsx)(Hn.a,{md:12,xs:24,className:"map"===m.active?"active-screen":"",style:{height:"65vh"},children:Object(oa.jsx)(lo,{socket:t,params:p})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}}),Object(oa.jsx)(Hn.a,{span:24,style:{width:"calc(100vw - 60px)"},children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mt-3 pr-5 pl-4",style:{padding:0},children:Object(oa.jsx)(mo,{socket:t})})})})]})},Oo=n(1062);Dc.d.register(Dc.a,Dc.j,Dc.e);var fo,ho=function(e){var t=e.socket,n=(e.params,e.onClose),c=e.payment,o=Object(s.c)(function(e){return e.auth}).encrypted_token,l=(Object(s.b)(),Object(a.useState)(!0)),r=Object(u.a)(l,2),d=r[0],v=r[1],b=Object(a.useState)(!1),j=Object(u.a)(b,2),p=j[0],O=j[1],f=Object(a.useState)([]),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)(),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useRef)();Object(a.useEffect)(function(){if(o){k.current=o;var e=[];console.log("payment",c),Object.keys((null===c||void 0===c?void 0:c.stripe)||{}).map(function(t){"string"!==typeof c.stripe[t]&&"number"!==typeof c.stripe[t]||e.push({name:t,value:c.stripe[t]}),"status"===t&&N(c.stripe[t])}),x(e),t.subscribeToEvent(m.SubscribePageTopics,tn(null===o||void 0===o?void 0:o.connectionId),function(e){var t,n=e.response;(O(!1),null!==n&&void 0!==n&&n.status)?Lt("Refund Successful","success","TOP_CENTER",3e3):Lt(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.details,"error","TOP_CENTER",3e3)})}},[o]);return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)($n.a,{title:"Payment",visible:d,onCancel:function(){v(!1),n&&n()},width:"600px",className:"beam-modal",footer:[],destroyOnClose:!0,children:[Object(oa.jsx)(Yn.a,{className:"beam-modal analytics-summary-modal",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("ul",{className:"incident-information mt-2",children:g.map(function(e,t){return Object(oa.jsx)("li",{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.name})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.value})})]})},t)})})})}),"succeeded"===S&&Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full",loading:p,disabled:!0,onClick:function(){},children:"Partial Refund"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:p,onClick:function(){1==window.confirm("Are you sure you want to refund amount?")&&(O(!0),t.publishToEvent(m.PublishPageTopics,en(null===o||void 0===o?void 0:o.connectionId),Dn({userId:null===o||void 0===o?void 0:o.userId,pageId:null===c||void 0===c?void 0:c.pageId})))},children:"Refund"})})]})]})})},go=n(1049);Za.a.Panel;Dc.d.register(Dc.a,Dc.j,Dc.e);var xo=function(e){return e.Advance="advance",e.Dispatching="dispatching",e.Assigned="assigned",e.Started="started",e.Completed="completed",e.Escalated="escalated",e.Arrived="arrived",e.Cancelled="cancelled",e.Processed="processed",e}({}),yo={green:xo.Completed,amber:xo.Assigned,red:xo.Escalated,blue:xo.Started,purple:xo.Dispatching,black:xo.Cancelled,brown:xo.Advance,aqua:xo.Arrived,gray:xo.Processed},Io=Jn.a.RangePicker,So=Gn.a.Option;var No=function(e){var t=e.value,n=e.onChange,i=Object(a.useState)(t),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)(null),r=Object(u.a)(s,2),d=r[0],v=r[1];Object(a.useEffect)(function(){t&&l(t)},[t]);var b=function(e,t){n&&n({startTimestamp:e,endTimestamp:t})};return Object(oa.jsxs)("div",{className:"w-100",children:[Object(oa.jsxs)(Gn.a,{style:{width:200},placeholder:"Select time range",className:"w-100",value:o,onChange:function(e){var t,n=H()(),a=n.valueOf();switch("customRange"!==e&&v(null),e){case"last24hours":t=n.subtract(24,"hours").valueOf();break;case"last3days":t=n.subtract(3,"days").valueOf();break;case"last1week":t=n.subtract(7,"days").valueOf();break;case"last1month":t=n.subtract(1,"month").valueOf();break;case"customRange":d?(t=d[0],a=d[1]):console.warn("Select a custom range from the date picker.");break;default:return void console.warn("Invalid selection")}l(e),b(t,a)},children:[Object(oa.jsx)(So,{value:"last24hours",children:"Last 24 Hours"}),Object(oa.jsx)(So,{value:"last3days",children:"Last 3 Days"}),Object(oa.jsx)(So,{value:"last1week",children:"Last 1 Week"}),Object(oa.jsx)(So,{value:"last1month",children:"Last 1 Month"}),Object(oa.jsx)(So,{value:"customRange",children:"Custom Range"})]}),"customRange"===o&&Object(oa.jsx)(Io,{style:{marginTop:16},onChange:function(e){if(e){var t=e[0].valueOf(),n=e[1].valueOf();v([t,n]),b(t,n)}else v(null)},format:"YYYY-MM-DD",disabledTime:function(){return{}},showTime:!1})]})},ko=function(e){var t=e.socket,n=(e.params,e.filter),c=e.selected,o=e.componentUuid,r=(Object(l.g)().search,Object(s.c)(function(e){return e.auth})),v=r.userRequests,b=r.projects,j=(r.pageAggregateBds,r.selectedPage),p=r.encrypted_token,O=r.searchByPhone,f=Object(s.b)(),h=Object(a.useState)("project"),g=Object(u.a)(h,2),x=g[0],I=g[1],S=Object(a.useState)("state"),N=Object(u.a)(S,2),k=N[0],w=N[1],E=Object(a.useState)(!1),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(void 0),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(void 0),F=Object(u.a)(q,2),B=F[0],_=F[1],$=Object(a.useState)(!1),Y=Object(u.a)($,2),H=Y[0],Q=Y[1],G=Object(a.useState)(!1),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)([]),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)([]),ie=Object(u.a)(ae,2),ce=ie[0],oe=ie[1],le=Object(a.useState)([]),se=Object(u.a)(le,2),re=(se[0],se[1]),de=Object(a.useState)([]),ue=Object(u.a)(de,2),ve=(ue[0],ue[1]),be=Object(a.useState)(),je=Object(u.a)(be,2),me=je[0],pe=je[1],Oe=Object(a.useRef)(W()),fe=(Object(a.useRef)(W()),Object(a.useRef)(void 0)),he=Object(a.useRef)(void 0),ge=Object(a.useRef)(0),xe=Object(a.useRef)(void 0),ye=Object(a.useRef)(!1),Ie=Object(a.useState)(),Se=Object(u.a)(Ie,2),Ne=Se[0],ke=Se[1],Te=Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0}),Ce=Object(u.a)(Te,2),we=Ce[0],Ee=Ce[1],Re=Object(a.useState)(0),Pe=Object(u.a)(Re,2),De=Pe[0],Ae=Pe[1],Me=function(e){var t=Object(a.useState)(e),n=Object(u.a)(t,2),i=n[0],c=n[1],o=Object(a.useRef)(!1);return[i,Object(a.useCallback)(function(e){if(o.current)console.warn("State update blocked - another update is in progress");else{o.current=!0;try{c(function(t){return"function"===typeof e?e(t):e})}finally{o.current=!1}}},[])]}([]),Le=Object(u.a)(Me,2),Ue=Le[0],qe=Le[1],Fe=Object(a.useRef)(void 0),Be=Object(a.useRef)(void 0),_e=Object(a.useState)([]),$e=Object(u.a)(_e,2),Ye=$e[0],He=$e[1],We=Object(a.useState)(!1),Ve=Object(u.a)(We,2),ze=Ve[0],Qe=Ve[1],Ge=Object(a.useState)([]),Je=Object(u.a)(Ge,2),Ke=(Je[0],Je[1]),Ze=Object(a.useState)(void 0),Xe=Object(u.a)(Ze,2),et=Xe[0],nt=Xe[1],at=Mn().getUserRequestPayload,it=Object(a.useRef)(void 0),ct=Object(a.useRef)({project:void 0,user:void 0,area:void 0,time:void 0}),ot=Object(a.useRef)({status:"-@rideStatus:{advance}",time:void 0,phone:void 0}),lt=Object(a.useRef)({}),st=Object(a.useRef)(),rt=Object(a.useRef)([]),dt=Object(a.useRef)(),ut=Object(a.useCallback)(Object(Ac.a)(2e3,function(){console.log("debounce"),gt()},{atBegin:!0}),[]),vt=Object(a.useCallback)(function(e){var t,n,a;null!==(t=lt.current)&&void 0!==t&&t[e]||(lt.current[e]=Object(Ac.a)(2e3,function(e){console.log("search page here",e),ht(null===e||void 0===e?void 0:e.toString())},{atBegin:!1})),null===(n=lt.current)||void 0===n||null===(a=n[e])||void 0===a||a.call(n,e)},[]),bt=function(e){ot.current.status=e?"@rideStatus:{".concat(yo[e],"}"):"-@rideStatus:{advance}",ot.current.phone=void 0,Q(!0),xe.current=e,nt(e),xt()},jt=function(e){ot.current.phone=e?"@passengerPhoneNumber:{".concat(z(e),"}"):void 0,Q(!0),ot.current.status=void 0,xe.current="lime",nt("lime"),xt()};Object(a.useEffect)(function(){O&&(console.log("search by phone",O),jt(null===O||void 0===O?void 0:O.phone))},[O]);var mt=function(e){var t;if(x!==e&&null!==b&&void 0!==b&&b.projects&&it.current){U(void 0),ne([]);var n=[];switch(e){case"project":null===b||void 0===b||null===(t=b.projects)||void 0===t||t.map(function(e){n.push({label:e.name,value:e.id})}),ne(n);break;case"manager":Ot(it.current,"manager");break;case"dispatcher":Ot(it.current,"dispatcher");break;case"responder":Ot(it.current,"responder")}I(e)}},pt=function(e){k!==e&&(_(void 0),oe([]),ft(e),w(e))},Ot=function(e,n){var a;switch(n){case"dispatcher":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1===e.permissions.indexOf("admin")});break;case"responder":a=e.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")});break;case"manager":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")})}var i=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),c={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(i.join("||"),")")},anyStatus:!1};t.publishToEvent(m.PublishPageTopics,xn(null===p||void 0===p?void 0:p.connectionId),Dn(c,"".concat(Oe.current,":").concat(n))),D(!0)},ft=function(e){Z(!0);var t={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===p||void 0===p?void 0:p.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(T.a)({},e,"$.persistent.static.profile.".concat(e))},groupBy:{properties:["@".concat(e)],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:""}};f(tt({requestData:t,callback:function(e){Z(!1);var t=[];null===e||void 0===e||e.map(function(e){e[Object.keys(e)[0]]&&t.push({label:e[Object.keys(e)[0]],value:e[Object.keys(e)[0]]})}),oe(t)}}))},ht=function(e){var t;if("string"===typeof e){var n={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===(t=st.current)||void 0===t?void 0:t.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},list:{objectIds:[e]},load:{persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId"}},filter:{expression:""}};f(tt({requestData:n,callback:function(e){ke(null===e||void 0===e?void 0:e[0])}}))}},gt=function(){var e,t=["!exists(@pageType)"],n="";if(ot.current.time)n+=ot.current.time;else{var a=new Date;a.setHours(0),a.setMinutes(1),n+="@createdAt:[".concat(a.getTime(),",+inf]")}ct.current&&Object.keys(ct.current).map(function(e){var n,a;null!==(n=ct.current)&&void 0!==n&&n[e]&&t.push(null===(a=ct.current)||void 0===a?void 0:a[e])});var i={};rt.current&&rt.current.map(function(e){i[e.key]=e.value});var c={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{'".concat(null===st||void 0===st||null===(e=st.current)||void 0===e?void 0:e.userId,"'}").concat(ye.current?"":"(-@rideType:{hail})","@pageType:{event}").concat(n),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)({profile:"$..profile",rideType:"$..profile.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",status:"$.nonpersistent.static.live.status.name",pageType:"$..pageType"},i)},groupBy:{properties:["@status"],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:t.join("&&")}};f(tt({requestData:c,callback:function(e){var t=0,n={amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0};e.map(function(e){n[e.status]=e.count,t+=e.count}),Ee(Object(d.a)({all:t-n.brown,live:t-n.brown},n))}}))};Object(a.useEffect)(function(){we&&Ae(De+1)},[JSON.stringify(we)]),Object(a.useEffect)(function(){if(Ne){var e,t,n,a,i,c,o,l,s,r,u,v,j,m,p,O,f,h,g,x,y,I,S,N,k,T,w,E,R,P,D,A,M,L,U,q,F,B,_,$,Y,H,W,V,z=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===Ne||void 0===Ne||null===(e=Ne.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.profile)||{}),(null===Ne||void 0===Ne||null===(n=Ne.persistent)||void 0===n||null===(a=n.static)||void 0===a?void 0:a.dashboard)||{}),(null===Ne||void 0===Ne||null===(i=Ne.persistent)||void 0===i||null===(c=i.static)||void 0===c?void 0:c.ride)||{}),(null===Ne||void 0===Ne||null===(o=Ne.persistent)||void 0===o||null===(l=o.dynamic)||void 0===l?void 0:l.ride)||{}),Q=null===Ne||void 0===Ne||null===(s=Ne.nonpersistent)||void 0===s||null===(r=s.static)||void 0===r||null===(u=r.live)||void 0===u||null===(v=u.status)||void 0===v?void 0:v.name,G=null===Ne||void 0===Ne||null===(j=Ne.persistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.profile)||void 0===p?void 0:p.type,J=null===Ne||void 0===Ne||null===(O=Ne.persistent)||void 0===O||null===(f=O.static)||void 0===f||null===(h=f.metadata)||void 0===h?void 0:h.type;if("inspection"===(null===Ne||void 0===Ne||null===(g=Ne.persistent)||void 0===g||null===(x=g.static)||void 0===x||null===(y=x.ride)||void 0===y||null===(I=y.rideRequestAttributes)||void 0===I?void 0:I.pageType))return;if(!ye.current&&"hail"===G||"event"!==J)return void console.log("show hail false");var K=Object(C.a)(Ue),Z=K.findIndex(function(e){return e.key===Ne.pageId});if(ut(),xe.current&&xe.current!==Q||!xe.current&&"brown"===Q)return void(-1!==Z&&(K.splice(Z,1),qe(K),Fe.current=K));var X={};Object.keys(z).map(function(e){"string"===typeof z[e]&&(X[e]=z[e])});var ee,te,ne,ae,ie,ce=(null===(S=Be.current)||void 0===S||null===(N=S.find(function(e){var t,n,a;return e.id===(null===Ne||void 0===Ne||null===(t=Ne.nonpersistent)||void 0===t||null===(n=t.dynamic)||void 0===n||null===(a=n.ride)||void 0===a?void 0:a.dispatchRequestBy)}))||void 0===N?void 0:N.beamId)||"",oe=(null===(k=Be.current)||void 0===k||null===(T=k.find(function(e){var t,n,a,i;return e.id===(null===(t=Object.keys((null===Ne||void 0===Ne||null===(n=Ne.nonpersistent)||void 0===n||null===(a=n.dynamic)||void 0===a||null===(i=a.ride)||void 0===i?void 0:i.manualUsers)||{}))||void 0===t?void 0:t[0])||""}))||void 0===T?void 0:T.beamId)||"";if(null===(w=Object.keys((null===Ne||void 0===Ne||null===(E=Ne.persistent)||void 0===E||null===(R=E.static)||void 0===R||null===(P=R.payment)||void 0===P?void 0:P.stripe)||{}))||void 0===w||w.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Ne||void 0===Ne||null===(t=Ne.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"succeeded"===(null===Ne||void 0===Ne||null===(o=Ne.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(ee=null===Ne||void 0===Ne||null===(u=Ne.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])}),!ee)null===(te=Object.keys((null===Ne||void 0===Ne||null===(ne=Ne.persistent)||void 0===ne||null===(ae=ne.static)||void 0===ae||null===(ie=ae.payment)||void 0===ie?void 0:ie.stripe)||{}))||void 0===te||te.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Ne||void 0===Ne||null===(t=Ne.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"requires_capture"===(null===Ne||void 0===Ne||null===(o=Ne.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(ee=null===Ne||void 0===Ne||null===(u=Ne.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])});var le,se,re=Object(d.a)(Object(d.a)({key:Ne.pageId,pageStatus:null===Ne||void 0===Ne||null===(D=Ne.nonpersistent)||void 0===D||null===(A=D.static)||void 0===A||null===(M=A.live)||void 0===M||null===(L=M.status)||void 0===L?void 0:L.name,requestedBy:ce,requestedAt:new Date(null===Ne||void 0===Ne||null===(U=Ne.persistent)||void 0===U||null===(q=U.static)||void 0===q||null===(F=q.metadata)||void 0===F?void 0:F.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:oe,name:null===Ne||void 0===Ne||null===(B=Ne.persistent)||void 0===B||null===(_=B.static)||void 0===_||null===($=_.metadata)||void 0===$?void 0:$.title,action:{pageId:Ne.pageId,page:Object(d.a)(Object(d.a)({},Ne),{},{profile:z}),summary:X.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId,stripe:ee}},X),{},{address:null!==X&&void 0!==X&&X.address&&""!==(null===X||void 0===X?void 0:X.adress)?null===X||void 0===X?void 0:X.address:null===z||void 0===z||null===(Y=z.pickupLocation)||void 0===Y||null===(H=Y.attributes)||void 0===H?void 0:H.address,dropoffAddress:null!==X&&void 0!==X&&X.dropoffAddress&&""!==(null===X||void 0===X?void 0:X.dropoffAddress)?null===X||void 0===X?void 0:X.dropoffAddress:null===z||void 0===z||null===(W=z.dropoffLocation)||void 0===W||null===(V=W.attributes)||void 0===V?void 0:V.address});if(console.log("source updated",re),-1!==Z)K[Z]=Object(d.a)(Object(d.a)({},re),{},{invited:null===Fe||void 0===Fe||null===(le=Fe.current)||void 0===le||null===(se=le[Z])||void 0===se?void 0:se.invited});else K.unshift(re);ve(null===K||void 0===K?void 0:K.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;return{lat:null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(i=a.static)||void 0===i||null===(c=i.live)||void 0===c||null===(o=c.location)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l.lat,lng:null===e||void 0===e||null===(s=e.action)||void 0===s||null===(r=s.page)||void 0===r||null===(d=r.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.location)||void 0===b?void 0:b.coordinates.long,title:null===e||void 0===e||null===(j=e.action)||void 0===j||null===(m=j.page)||void 0===m||null===(p=m.persistent)||void 0===p||null===(O=p.static)||void 0===O||null===(f=O.metadata)||void 0===f?void 0:f.title}})),qe(K),Fe.current=K}},[Ne]);var xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=["!exists(@pageType)"],n="",a="",i="";if("advance"===c)xe.current="brown",a="@rideStatus:{".concat(yo.brown,"}");else if("dispatch"===c)xe.current="purple",a="@rideStatus:{".concat(yo.purple,"}");else if(ct.current)if(Object.keys(ct.current).map(function(e){var n,a;null!==(n=ct.current)&&void 0!==n&&n[e]&&t.push(null===(a=ct.current)||void 0===a?void 0:a[e])}),ot.current.time||ot.current.phone)ot.current.time&&(n+=ot.current.time);else{var o=new Date;o.setHours(0),o.setMinutes(1),n+="@createdAt:[".concat(o.getTime(),",+inf]")}ot.current.status&&"advance"!==c&&"dispatch"!==c&&(a=ot.current.status),ot.current.phone&&(i=ot.current.phone);var l={};rt.current&&rt.current.map(function(e){l[e.key]=e.value}),ge.current=e;var s={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===p||void 0===p?void 0:p.userId,"}").concat(ye.current?"":"(-@rideType:{hail})","@pageType:{event}").concat(n).concat(a).concat(i),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",dashboard:"$..dashboard",ride:"$.persistent.static.ride",stripe:"$.persistent.static.payment.stripe",dynamic:"$.persistent.dynamic.ride",type:"$..persistent.static.metadata.type",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",requestedBy:"$.nonpersistent.dynamic.ride.dispatchRequestBy",manualUsers:"$.nonpersistent.dynamic.ride.manualUsers",rideType:"$..profile.type",phone:"$..dashboard.passengerPhoneNumber",pageType:"$..pageType"},k,"$..dashboard.".concat(k)),l)},filter:{expression:t.join("&&")},sortBy:{properties:["advance"===c?{field:"@createdAt",order:"ASC"}:{field:"@updatedAt",order:"DESC"}],max:1e3},result:ot.current.phone?{pagination:{offset:e,limit:50}}:{}};f(tt({requestData:s,callback:function(t){console.log("page resppnse",t),re(t),ge.current=ge.current+30;var n=e>0?Object(C.a)(Ue):[],a=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Schedule Date",key:"scheduleDate",dataIndex:"scheduleDate"},{title:"Schedule Time",key:"scheduleTime",dataIndex:"scheduleTime"},{title:"Requested at",key:"requestedAt",dataIndex:"requestedAt"},{title:"Pickup Address",key:"address",dataIndex:"address"},{title:"Dropoff Address",key:"dropoffAddress",dataIndex:"dropoffAddress"},{title:"Passenger Name",key:"passengerName",dataIndex:"passengerName"},{title:"Passenger Phone",key:"passengerPhoneNumber",dataIndex:"passengerPhoneNumber"},{title:"Account name",key:"accountName",dataIndex:"accountName"},{title:"Driver Name",key:"driverName",dataIndex:"driverName"},{title:"Vehicle Name",key:"vehicleName",dataIndex:"vehicleName"},{title:"Fixed Fare",key:"fixedFare",dataIndex:"fixedFare"},{title:"Invited Driver",key:"invited",dataIndex:"invited"},{title:"Assigned Driver",key:"assigned",dataIndex:"assigned"},{title:"Requested by",key:"requestedBy",dataIndex:"requestedBy"}];null===t||void 0===t||t.map(function(e,t){var a,i,c,o,l,s,r,u=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),v={};Object.keys(u).map(function(e){"string"===typeof u[e]&&(v[e]=u[e])});var j,m,p=Be.current||JSON.parse(localStorage.getItem("rideUsers")||"[]"),O=(null===p||void 0===p||null===(a=p.find(function(t){var n;return t.id===(null===e||void 0===e||null===(n=e.requestedBy)||void 0===n?void 0:n.toString())}))||void 0===a?void 0:a.beamId)||"",f=(null===p||void 0===p||null===(i=p.find(function(t){var n;return t.id===(null===(n=Object.keys((null===e||void 0===e?void 0:e.manualUsers)||{}))||void 0===n?void 0:n[0])||""}))||void 0===i?void 0:i.beamId)||"";(null===(c=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===c||c.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"succeeded"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(j=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}),j)||(null===(m=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===m||m.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"requires_capture"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(j=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}));n.push(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:u}),summary:v.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId,stripe:j}},v),{},{address:null!==v&&void 0!==v&&v.address&&""!==(null===v||void 0===v?void 0:v.adress)?null===v||void 0===v?void 0:v.address:null===u||void 0===u||null===(o=u.pickupLocation)||void 0===o||null===(l=o.attributes)||void 0===l?void 0:l.address,dropoffAddress:null!==v&&void 0!==v&&v.dropoffAddress&&""!==(null===v||void 0===v?void 0:v.dropoffAddress)?null===v||void 0===v?void 0:v.dropoffAddress:null===u||void 0===u||null===(s=u.dropoffLocation)||void 0===s||null===(r=s.attributes)||void 0===r?void 0:r.address,invited:"",requestedBy:O,requestedAt:new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:f}))}),n.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===a.findIndex(function(t){return t.key===e})&&t[e]})}),a.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){V("".concat("https://live.staging.beam.live","/page/").concat(null===e||void 0===e?void 0:e.pageId),"BeamLive",.7*window.innerWidth,.9*window.innerHeight)},children:Object(oa.jsx)(Zc.a,{})})}),(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t;window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(null===p||void 0===p?void 0:p.connectionId,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:Object(oa.jsx)(Ec.a,{})})}),(null===e||void 0===e?void 0:e.stripe)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){pe({stripe:null===e||void 0===e?void 0:e.stripe,pageId:null===e||void 0===e?void 0:e.pageId})},children:Object(oa.jsx)(Oo.a,{})})})]})}}),He(a),qe(n),Fe.current=n,ve(null===t||void 0===t?void 0:t.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),Q(!1),D(!1),Z(!1)}})),ut()};Object(a.useEffect)(function(){p&&(st.current=p,t.subscribeToEvent(m.SubscribePageTopics,"".concat("beamdevlive","/service/live/user/").concat(null===p||void 0===p?void 0:p.userId,"/ridePageUpdated"),function(e){vt(null===e||void 0===e?void 0:e.data)},o),D(!0),xt(),dt.current&&clearInterval(dt.current),dt.current=setInterval(function(){xt()},2e4),ft("state"),Ke(JSON.parse(localStorage.getItem("tableHideList"))||[]))},[p]),Object(a.useEffect)(function(){return function(){dt.current&&clearInterval(dt.current)}},[]),Object(a.useEffect)(function(){if(b){var e,n=[];null===b||void 0===b||null===(e=b.projects)||void 0===e||e.map(function(e){n.push({label:e.name,value:e.id})}),ne(n),null!==b&&void 0!==b&&b.adminUserId&&(a=null===b||void 0===b?void 0:b.adminUserId,i=null===b||void 0===b?void 0:b.userServiceId,it.current||(t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,at(a,"$","$..role"),hn(null===p||void 0===p?void 0:p.connectionId),i),t.subscribeToSurvey(m.SurveyTopics,hn(null===p||void 0===p?void 0:p.connectionId),function(e){var t,n;it.current=null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]},o)),t.subscribeToEvent(m.SubscribePageTopics,bn(null===p||void 0===p?void 0:p.connectionId,null===b||void 0===b?void 0:b.userServiceId)),t.subscribeToEvent(m.SubscribePageTopics,yn(null===p||void 0===p?void 0:p.connectionId)),t.subscribeToEvent(m.SubscribePageTopics,Pn(),function(e){var t,n,a,i,c,o,l,s;console.log("ride invitation get",e);var r=null===e||void 0===e||null===(t=e.pattern)||void 0===t||null===(n=t.split("/"))||void 0===n?void 0:n[4],d=null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.pageId,u=1e3*(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.timeout)-2e3,v=null===e||void 0===e||null===(c=e.data)||void 0===c||null===(o=c.rideRequestAttributes)||void 0===o?void 0:o.cudbServiceId;if((null===b||void 0===b?void 0:b.userServiceId)===v){console.log("user id",r,d,u);var j=(null===(l=Be.current)||void 0===l||null===(s=l.find(function(e){return e.id===r}))||void 0===s?void 0:s.beamId)||"user# ".concat(r),m=Object(C.a)(Fe.current||[]),p=m.findIndex(function(e){var t;return(null===(t=e.key)||void 0===t?void 0:t.toString())===(null===d||void 0===d?void 0:d.toString())});-1!==p&&(m[p].invited=j,Fe.current=m,ht(null===d||void 0===d?void 0:d.toString()),setTimeout(function(){var e=Object(C.a)(Fe.current||[]),t=e.findIndex(function(e){var t;return(null===(t=e.key)||void 0===t?void 0:t.toString())===(null===d||void 0===d?void 0:d.toString())});-1!==t&&(console.log("clear here"),e[t].invited="",Fe.current=e,ht(null===d||void 0===d?void 0:d.toString()))},u))}},o))}var a,i},[b]),Object(a.useEffect)(function(){if(v&&t.client){var e,n,a;if(!Be.current&&null!==v&&void 0!==v&&v[null===(e=Object.keys(v))||void 0===e?void 0:e[0]])console.log("user requests here",null===v||void 0===v?void 0:v[null===(n=Object.keys(v))||void 0===n?void 0:n[0]]),Be.current=null===v||void 0===v?void 0:v[null===(a=Object.keys(v))||void 0===a?void 0:a[0]],localStorage.setItem("rideUsers",JSON.stringify(Be.current));if(null!==v&&void 0!==v&&v["".concat(Oe.current,":").concat(x)]){var i;D(!1);var c=[];null===v||void 0===v||null===(i=v["".concat(Oe.current,":").concat(x)])||void 0===i||i.map(function(e){c.push({label:"".concat(e.fullName,": ").concat(e.email),value:e.id})}),ne(c)}}},[v,t.client]);return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{gutter:30,className:"mb-2",style:ze?{}:{display:"none"},children:[Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{gutter:16,className:"d-flex px-1 flex-wrap",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){mt("manager")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("manager"===x?"green-btn cover":""),children:"Manager"})}),Object(oa.jsx)("div",{onClick:function(){mt("project")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("project"===x?"green-btn cover":""),children:"Project"})}),Object(oa.jsx)("div",{onClick:function(){mt("dispatcher")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("dispatcher"===x?"green-btn cover":""),children:"Dispatcher"})}),Object(oa.jsx)("div",{onClick:function(){mt("responder")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("responder"===x?"green-btn cover":""),children:"Responder"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:P,value:L,allowClear:!0,showSearch:!0,filterOption:function(e,t){var n;return null===(n=t.label)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},options:te,onChange:function(e){!function(e){switch(U(e),x){case"project":ct.current.project=e?"exists(@iotAssetConfigId) && @iotAssetConfigId === '".concat(e,"'"):void 0,ct.current.user=void 0,D(!0);break;case"manager":case"responder":case"dispatcher":rt.current=[{key:"user",value:"$.persistent.static.metadata.members.users.".concat(e)}],ct.current.user=e?"exists(@user)":void 0,ct.current.project=void 0,D(!0)}xt()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex px-2 flex-wrap mt-4",children:Object(oa.jsx)(Hn.a,{sm:24,md:4,children:Object(oa.jsx)("h5",{className:"mb-0",children:"Search"})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Fi.a,{placeholder:"Phone number",defaultCountry:"US",allowClear:!0,onChange:function(e){console.log("phone",e),fo&&clearTimeout(fo),fo=setTimeout(function(){jt(e)},700)}})})}),Object(oa.jsx)(Yn.a,{className:"d-flex px-2 flex-wrap mt-4",children:Object(oa.jsxs)(Hn.a,{span:24,style:{display:"flex",alignItems:"center"},children:[Object(oa.jsx)("h5",{className:"mr-3",children:"Show hail rides"}),Object(oa.jsx)(go.a,{onChange:function(e){!function(e){ye.current=e,Q(!0),xt()}(e)},defaultChecked:ye.current})]})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{className:"d-flex flex-wrap",id:"filters",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){pt("state")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("state"===k?"green-btn cover":""),children:"State"})}),Object(oa.jsx)("div",{onClick:function(){pt("city")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("city"===k?"green-btn cover":""),children:"City"})}),Object(oa.jsx)("div",{onClick:function(){pt("county")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("county"===k?"green-btn cover":""),children:"County"})}),Object(oa.jsx)("div",{onClick:function(){pt("zip")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("zip"===k?"green-btn cover":""),children:"Zip"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{xs:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:K,allowClear:!0,options:ce,value:B,onChange:function(e){!function(e){_(e),ct.current.time=e?"exists(@".concat(k,") && @").concat(k," === '").concat(e,"'"):void 0,Z(!0),xt()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex flex-wrap mt-3 mx-0",children:Object(oa.jsx)(No,{onChange:function(e){console.log("value here",e),function(e){if(fe.current=e.startTimestamp,he.current=e.endTimestamp,fe.current&&he.current){var t=new Date(fe.current);t.setHours(0),t.setMinutes(1);var n=new Date(he.current);n.setHours(23),n.setMinutes(59),ot.current.time="@createdAt:[".concat(t.getTime(),",+inf]@createdAt:[-inf, ").concat(n.getTime(),"]"),Z(!0),xt()}else fe.current||fe.current||(ot.current.time="",Z(!0),xt())}(e)},value:void 0})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select Hour(s)",disabled:!0})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:4,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsx)("p",{className:"mb-2 text-center",children:"Export to"}),Object(oa.jsxs)("div",{className:"d-flex flex-row flex-md-column justify-content-center",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-csv.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-xls.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-pdf.svg"})})})]})]})})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid"},children:Object(oa.jsxs)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:[n&&Object(oa.jsxs)(Yn.a,{className:"d-flex mb-2",children:[Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat(void 0===et?"status-selected":""),onClick:function(){bt(void 0)},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"All"}),Object(oa.jsx)("h4",{children:we.live})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("brown"===et?"status-selected":""),onClick:function(){bt("brown")},children:Object(oa.jsxs)("div",{className:"brown",children:[Object(oa.jsx)("span",{children:"Advance"}),Object(oa.jsx)("h4",{children:we.brown})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("purple"===et?"status-selected":""),onClick:function(){bt("purple")},children:Object(oa.jsxs)("div",{className:"purple",children:[Object(oa.jsx)("span",{children:"Dispatching"}),Object(oa.jsx)("h4",{children:we.purple})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("amber"===et?"status-selected":""),onClick:function(){bt("amber")},children:Object(oa.jsxs)("div",{className:"amber",children:[Object(oa.jsx)("span",{children:"Assigned"}),Object(oa.jsx)("h4",{children:we.amber})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("aqua"===et?"status-selected":""),onClick:function(){bt("aqua")},children:Object(oa.jsxs)("div",{className:"aqua",children:[Object(oa.jsx)("span",{children:"Arrived"}),Object(oa.jsx)("h4",{children:we.aqua})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("blue"===et?"status-selected":""),onClick:function(){bt("blue")},children:Object(oa.jsxs)("div",{className:"blue",children:[Object(oa.jsx)("span",{children:"Started"}),Object(oa.jsx)("h4",{children:we.blue})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("red"===et?"status-selected":""),onClick:function(){bt("red")},children:Object(oa.jsxs)("div",{className:"red",children:[Object(oa.jsx)("span",{children:"Escalated"}),Object(oa.jsx)("h4",{children:we.red})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("green"===et?"status-selected":""),onClick:function(){bt("green")},children:Object(oa.jsxs)("div",{className:"green",children:[Object(oa.jsx)("span",{children:"Completed"}),Object(oa.jsx)("h4",{children:we.green})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("grey"===et?"status-selected":""),onClick:function(){bt("grey")},children:Object(oa.jsxs)("div",{className:"grey",children:[Object(oa.jsx)("span",{children:"Processed"}),Object(oa.jsx)("h4",{children:we.grey})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("black"===et?"status-selected":""),onClick:function(){bt("black")},children:Object(oa.jsxs)("div",{className:"black",children:[Object(oa.jsx)("span",{children:"Cancelled"}),Object(oa.jsx)("h4",{children:we.black})]})}),Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0 10px 0"},onClick:function(){Qe(!ze)},children:Object(oa.jsx)(Rc.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 10px 10px 0"},loading:P||H,onClick:function(){D(!0),xt()},children:!P&&!H&&Object(oa.jsx)(Pc.a,{})})]})]}),!n&&Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",position:"fixed",top:50,right:70},loading:P||H,onClick:function(){D(!0),xt()},children:!P&&!H&&Object(oa.jsx)(Pc.a,{})}),Object(oa.jsx)(Xi.a,{dataSource:Ue,className:(null===Ue||void 0===Ue?void 0:Ue.length)>0?"":"table-empty",onRow:function(e){return{onDoubleClick:function(){var t;f({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e||null===(t=e.action)||void 0===t?void 0:t.page}})},onClick:function(){}}},columns:Ye,scroll:{x:!0},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===j||void 0===j||null===(n=j.page)||void 0===n?void 0:n.pageId)?"row-selected ".concat(e.pageStatus,"-row"):"".concat(e.pageStatus,"-row")}})]})}),me&&Object(oa.jsx)(ho,{socket:t,payment:me,onClose:function(){pe(void 0)}})]})};Za.a.Panel;Dc.d.register(Dc.a,Dc.j,Dc.e);Gn.a.Option;var To=function(e){var t=e.socket,n=(e.params,e.componentUuid,Object(l.g)().search,Object(s.c)(function(e){return e.auth})),c=(n.userRequests,n.projects),o=(n.pageAggregateBds,n.selectedPage),r=n.encrypted_token,v=n.responders,b=n.vehicles,j=(Object(s.b)(),Object(a.useState)([])),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)([]),g=Object(u.a)(h,2),x=g[0],y=g[1];Object(a.useState)(!1);var I=Object(a.useState)([]),S=Object(u.a)(I,2),N=(S[0],S[1],Mn().getUserRequestPayload,Object(a.useState)(void 0)),T=Object(u.a)(N,2),w=(T[0],T[1],Object(a.useState)(void 0)),E=Object(u.a)(w,2),R=E[0],P=(E[1],Object(a.useRef)()),D=Object(a.useState)(),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Object(a.useState)(!1),q=Object(u.a)(U,2),F=(q[0],q[1]),B=Object(a.useRef)(),_=Object(a.useRef)(!0),$=Object(a.useState)("all"),Y=Object(u.a)($,2),H=Y[0],W=Y[1],V=function(e){F(!0),t.publishToEvent(m.PublishPageTopics,Yt(null===r||void 0===r?void 0:r.connectionId),Dn({userId:null===r||void 0===r?void 0:r.userId,cudbServiceId:null===c||void 0===c?void 0:c.userServiceId,latLng:e,height:3e5,width:3e5}))},z={assigned:"R",arrived:"A",started:"P"};return Object(a.useEffect)(function(){if(v){console.log("responders",v),F(!1);var e=[],t=[{title:"",key:"displayStatusName",dataIndex:"displayStatusName",render:function(e){var t="";return"green"===(null===e||void 0===e?void 0:e.status)?t="O":"gray"===(null===e||void 0===e?void 0:e.status)?t="B":null!==e&&void 0!==e&&e.displayName&&(t=null===z||void 0===z?void 0:z[null===e||void 0===e?void 0:e.displayName]),Object(oa.jsx)("span",{children:t})}},{title:"Status",key:"userStatus",dataIndex:"userStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Name",key:"driverName",dataIndex:"driverName"},{title:"Vehicle name",key:"vehicle",dataIndex:"vehicle"},{title:"Custom id",key:"driverCustomId",dataIndex:"driverCustomId"},{title:"Email",key:"driverEmail",dataIndex:"driverEmail"},{title:"Phone",key:"driverPhone",dataIndex:"driverPhone"}];console.log("vehicles",b),null===v||void 0===v||v.map(function(t,n){var a,i,c,o,l,s,r;e.push({key:t.id,userStatus:null===t||void 0===t?void 0:t.status,displayStatusName:{displayName:null===t||void 0===t?void 0:t.displayStatusName,status:null===t||void 0===t?void 0:t.status},driverName:"".concat(null===t||void 0===t||null===(a=t.profile)||void 0===a?void 0:a.firstName," ").concat(null===t||void 0===t||null===(i=t.profile)||void 0===i?void 0:i.lastName),driverEmail:null===t||void 0===t||null===(c=t.alternativeIds)||void 0===c?void 0:c.email,driverPhone:null===t||void 0===t||null===(o=t.alternativeIds)||void 0===o?void 0:o.phone,driverCustomId:null===t||void 0===t||null===(l=t.alternativeIds)||void 0===l?void 0:l.customId,vehicle:(null===b||void 0===b||null===(s=b.find(function(e){return e.id===t.id}))||void 0===s||null===(r=s.obj)||void 0===r?void 0:r.name)||""})}),P.current=e,y(t),f(e)}},[v]),Object(a.useEffect)(function(){return _.current=!0,function(){_.current=!1,console.log("clear timeput"),B.current&&clearInterval(B.current)}},[]),Object(a.useEffect)(function(){if(R){var e,t=R.pattern,n=R.data,a=null===t||void 0===t||null===(e=t.split("/"))||void 0===e?void 0:e[4],i=Object(C.a)(O),c=i.findIndex(function(e){var t;return(null===e||void 0===e||null===(t=e.key)||void 0===t?void 0:t.toString())===a});if(-1!==c){var o,l,s,r,d,u,v,b,j,m,p={},h=Object(k.a)(n);try{var g=function(){var e=u.value;d=p;var t=e.path.split("/");t.map(function(n,a){""!==n&&(n in d||(a+1===t.length?d[n]=e.value:d[n]={}),d=d[n])})};for(h.s();!(u=h.n()).done;)g()}catch(x){h.e(x)}finally{h.f()}if(null!==p&&void 0!==p&&null!==(o=p.nonpersistent)&&void 0!==o&&null!==(l=o.static)&&void 0!==l&&null!==(s=l.live)&&void 0!==s&&null!==(r=s.status)&&void 0!==r&&r.name)i[c].userStatus=null===p||void 0===p||null===(v=p.nonpersistent)||void 0===v||null===(b=v.static)||void 0===b||null===(j=b.live)||void 0===j||null===(m=j.status)||void 0===m?void 0:m.name,f(i)}y([{title:"Status",key:"userStatus",dataIndex:"userStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Name",key:"driverName",dataIndex:"driverName"},{title:"Custom id",key:"driverCustomId",dataIndex:"driverCustomId"},{title:"Email",key:"driverEmail",dataIndex:"driverEmail"},{title:"Phone",key:"driverPhone",dataIndex:"driverPhone"}])}},[R]),Object(a.useEffect)(function(){r&&(M&&null!==M&&void 0!==M&&M.current?L(Object(d.a)({},M)):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,n,a,i;L({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,lng:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude,current:!0}),_.current?(V({lat:null===e||void 0===e||null===(a=e.coords)||void 0===a?void 0:a.latitude,long:null===e||void 0===e||null===(i=e.coords)||void 0===i?void 0:i.longitude}),B.current&&clearInterval(B.current),console.log("interval set"),B.current=setInterval(function(){var t,n;console.log("get responders"),V({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,long:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude})},1e4)):console.log("un mounted")}):alert("Geolocation is not supported by this browser."))},[r]),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Cc.a,{className:"filter-card",style:{marginRight:10},children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select status",allowClear:!0,value:H,showSearch:!0,options:[{label:"All",value:"all"},{label:"Available",value:"available"},{label:"Unavailable",value:"unavailable"},{label:"In Route",value:"assigned"},{label:"Arrived",value:"arrived"},{label:"Pickup",value:"pickup"}],onChange:function(e){W(e)}})})})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid"},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:O.filter(function(e){var t,n,a,i,c;return"all"===H||!H||("available"===H?"green"===(null===e||void 0===e||null===(t=e.displayStatusName)||void 0===t?void 0:t.status):"unavailable"===H?"gray"===(null===e||void 0===e||null===(n=e.displayStatusName)||void 0===n?void 0:n.status):"assigned"===H?"assigned"===(null===e||void 0===e||null===(a=e.displayStatusName)||void 0===a?void 0:a.displayName):"arrived"===H?"arrived"===(null===e||void 0===e||null===(i=e.displayStatusName)||void 0===i?void 0:i.displayName):"pickup"!==H||"started"===(null===e||void 0===e||null===(c=e.displayStatusName)||void 0===c?void 0:c.displayName))}),className:(null===O||void 0===O?void 0:O.length)>0?"":"table-empty",onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},columns:x,scroll:{x:!0},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})})]})},Co=n(1050),wo=n(557),Eo=n(1052),Ro=(Jn.a.RangePicker,Zn.a.RangePicker),Po=function(e){var t=e.value,n=void 0===t?[]:t,i=e.onChange,c=void 0===i?function(e){}:i,o=e.startDate,l=e.endDate,r=e.drivers,v=e.userId,b=void 0===v?void 0:v,j=Object(a.useState)([]),m=Object(u.a)(j,2),p=m[0],O=m[1],f=Object(a.useState)(null),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)(!1),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)([]),w=Object(u.a)(k,2),E=w[0],R=w[1],P=Object(a.useState)(null),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Object(a.useState)([]),U=Object(u.a)(L,2),q=U[0],F=U[1],B=Object(s.c)(function(e){return e.auth}),_=(B.projects,B.encrypted_token),$=Object(s.b)(),Y=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){var a=tc()(t).startOf("day").valueOf(),i=tc()(t).endOf("day").valueOf(),c={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===_||void 0===_?void 0:_.userId,"}(-@rideType:{hail})@pageType:{event}@createdAt:[").concat(a,",+inf]@createdAt:[-inf, ").concat(i,"]"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{pageId:"$.objectId",messages:"$..customMessages",createdAt:"$.createdAt",members:"$..members.users"}},filter:{expression:[].join("&&")},sortBy:{properties:[],max:1e3},result:{}};$(tt({requestData:c,callback:function(t){console.log("resppnse",t);var n=[];null===t||void 0===t||t.map(function(e){var t,a=null===e||void 0===e||null===(t=e.messages)||void 0===t?void 0:t.filter(function(e){return"text"===e.type});(null===a||void 0===a?void 0:a.length)>0&&a.map(function(t){Object.keys((null===e||void 0===e?void 0:e.members)||{}).map(function(e){var a;n.push({name:null===t||void 0===t||null===(a=t.attributes)||void 0===a?void 0:a.body,driverId:e.toString()})})})}),e(n)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return M(t),e.n=1,Y(t);case 1:n=e.v,F(n);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){n&&n.length>0?z(n):(console.log("create scheduke"),W(o,l))},[JSON.stringify(n)]);var W=function(e,t){if(e&&t){for(var n=[],a=tc()(e),i=function(){var e={key:a.format("YYYY-MM-DD"),date:a.format("dddd, YYYY-MM-DD")};r.forEach(function(t){e[t.driverId]=[]}),n.push(e),a=a.add(1,"day")};a.isBefore(t)||a.isSame(t,"day");)i();O(Q(n)),c&&c(Q(n))}},V=function(e,t){if(!b){x({key:e,column:t});var n=p.find(function(t){return t.key===e}),a=n&&n[t]?n[t].map(function(e){return e.map(function(e){return tc()(e)})}):[];R(a),N(!0)}},z=function(e){var t=e.map(function(e){var t=Object(d.a)({},e);return r.forEach(function(e){t.hasOwnProperty(e.driverId)||(t[e.driverId]=[])}),Object.keys(t).forEach(function(e){"key"===e||"date"===e||r.some(function(t){return t.driverId.toString()===e})||delete t[e]}),t});console.log("updated data",t),O(t),c&&c(Q(t))},Q=function(e){return console.log("data",e),e.map(function(e){var t=Object(d.a)({},e);return Object.keys(e).forEach(function(n){Array.isArray(e[n])&&(t[n]=e[n].map(function(e){return e.map(function(e){return"string"===typeof e?e:e.format("YYYY-MM-DD HH:mm")})}))}),t})},G=Object(a.useMemo)(function(){var e=r.map(function(e){return{title:e.driverName,dataIndex:e.driverId,key:e.driverId,render:function(t,n){return Object(oa.jsx)("div",{onClick:function(){return V(n.key,e.driverId)},style:{cursor:"pointer"},children:t&&t.length>0?t.map(function(e){return Array.isArray(e)?"".concat(e[0].split(" ")[1],"-").concat(e[1].split(" ")[1]):e}).join(", "):b?"N/A":"Click to add"})}}});return[{title:"Date",dataIndex:"date",key:"date",fixed:"left",render:function(e,t){return Object(oa.jsx)("div",{onClick:function(){return H(t.key)},style:{cursor:"pointer",fontWeight:"bold"},children:e})}}].concat(Object(C.a)(e))},[r,p,b]),J=[{title:"Driver",dataIndex:"driverName",key:"driverName"},{title:"Time Slots",dataIndex:"timeSlots",key:"timeSlots",render:function(e,t){return Object(oa.jsxs)("div",{onClick:function(){return V(A,t.driverId)},style:{cursor:"pointer"},children:[e&&e.length>0?e.map(function(e){return Array.isArray(e)?"".concat(e[0].split(" ")[1],"-").concat(e[1].split(" ")[1]):e}).join(", "):b?"N/A":"Click to add",Object(oa.jsxs)("div",{style:{marginTop:5,fontSize:"12px",color:"#888"},children:[Object(oa.jsx)("strong",{children:"Tasks:"})," ",q.filter(function(e){return e.driverId.toString()===t.driverId.toString()}).length>0?Object(oa.jsx)("ul",{children:q.filter(function(e){return e.driverId.toString()===t.driverId.toString()}).map(function(e,t){return Object(oa.jsx)("li",{children:e.name},t)})}):Object(oa.jsx)("span",{children:" No tasks assigned"})]})]})}}],K=A?r.map(function(e){var t;return{key:e.driverId,driverName:e.driverName,driverId:e.driverId,timeSlots:(null===(t=p.find(function(e){return e.key===A}))||void 0===t?void 0:t[e.driverId])||[]}}):[];return Object(oa.jsxs)("div",{children:[A?Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:10},children:[Object(oa.jsx)(Vn.a,{onClick:function(){M(null),F([])},icon:Object(oa.jsx)(Eo.a,{})}),Object(oa.jsx)("h5",{style:{marginLeft:16},children:tc()(A).format("dddd, YYYY-MM-DD")})]}),Object(oa.jsx)(Xi.a,{columns:J,dataSource:K,pagination:!1,scroll:{x:"max-content"}})]}):Object(oa.jsx)(Xi.a,{columns:G,dataSource:p,pagination:!1,scroll:{x:"max-content"}}),Object(oa.jsxs)($n.a,{title:"Add Time Slots",className:"beam-modal",footer:[],visible:S,onCancel:function(){R([]),N(!1)},children:[Object(oa.jsx)(Ro,{onChange:function(e){e&&R(function(t){return[].concat(Object(C.a)(t),[e])})},format:"HH:mm"}),Object(oa.jsxs)("div",{style:{marginTop:20},children:[Object(oa.jsx)("h5",{children:"Selected Time Slots:"}),Object(oa.jsx)("ul",{children:E.map(function(e,t){return Object(oa.jsxs)("li",{className:"d-flex justify-content-space-between align-items-center mt-2",children:[e[0].format("HH:mm")," - ",e[1].format("HH:mm"),Object(oa.jsx)(Vn.a,{onClick:function(){return function(e){R(function(t){return t.filter(function(t,n){return n!==e})})}(t)},style:{boxShadow:"none",width:35,height:35,display:"flex",justifyContent:"center",alignItems:"center"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})]},t)})})]}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",type:"primary",htmlType:"submit",onClick:function(){if(g){var e=p.map(function(e){return e.key===g.key?Object(d.a)(Object(d.a)({},e),{},Object(T.a)({},g.column,E)):e});O(Q(e)),c&&c(Q(e))}R([]),N(!1)},children:"OK"})}),Object(oa.jsx)(Hn.a,{span:12,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full w-full",onClick:function(){R([]),N(!1)},children:"Cancel"})})]})]})]})},Do=function(e){var t,n,i,c=e.onClose,o=e.socket,l=e.student,r=(e.adminRoles,e.onAdd,e.drivers),d=e.userId,v=Object(a.useState)(!0),b=Object(u.a)(v,2),j=b[0],p=b[1],O=ei.a.useForm(),f=Object(u.a)(O,1)[0],h=Object(a.useState)(""),g=Object(u.a)(h,2),x=(g[0],g[1]),y=Object(a.useState)(!1),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(s.c)(function(e){return e.auth}),T=(k.projects,k.encrypted_token),C=(Mn().updateUserRequestPayloadV2,Object(a.useState)("1")),w=Object(u.a)(C,2),E=(w[0],w[1],null===l||void 0===l||null===(t=l.info)||void 0===t?void 0:t.startTimestamp),R=null===l||void 0===l||null===(n=l.info)||void 0===n?void 0:n.endTimestamp;Object(a.useEffect)(function(){var e,t,n;(o.subscribeToEvent(m.SubscribePageTopics,dn(null===T||void 0===T?void 0:T.connectionId),function(e){console.log("response",e),Lt("Shift saved successfully","success","TOP_CENTER",1e3),N(!1)},"editShift"),(null===l||void 0===l||null===(e=l.info)||void 0===e||null===(t=e.shift)||void 0===t?void 0:t.length)>0)&&f.setFieldsValue({shift:null===l||void 0===l||null===(n=l.info)||void 0===n?void 0:n.shift})},[]);var P=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:console.log("values",t),N(!0),D(l.objectId,t.shift);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:o.publishToEvent(m.PublishPageTopics,un(null===T||void 0===T?void 0:T.connectionId),Dn({objectId:t,changes:[{op:"replace",path:"/info/shift",value:n}]}));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}();return Object(oa.jsx)($n.a,{title:(null===l||void 0===l||null===(i=l.info)||void 0===i?void 0:i.name)||"Shift",visible:j,onCancel:function(){p(!1),c&&c(),localStorage.setItem("selectedTab","1")},width:d?"800px":"1200px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:f,onFinish:P,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsx)(ei.a.Item,{name:"shift",children:Object(oa.jsx)(Po,{startDate:E,endDate:R,drivers:r,userId:d})})}),!d&&Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:S,type:"primary",htmlType:"submit",onClick:function(){return x("")},children:"Save"})})})})]})})};Dc.d.register(Dc.a,Dc.j,Dc.e);var Ao=Gn.a.Option,Mo=function(e){var t=e.socket,n=(e.params,e.componentUuid,e.userId),c=Object(s.c)(function(e){return e.auth}),o=c.selectedPage,l=c.encrypted_token,r=c.projects,v=c.adminUserRoles,b=Object(s.b)(),j=Object(a.useState)([]),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)([]),g=Object(u.a)(h,2),x=g[0],y=g[1];Object(a.useState)(!1);var I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1];Object(a.useState)(!1);Mn().getUserRequestPayload,Object(a.useRef)();var T=Object(a.useState)(void 0),w=Object(u.a)(T,2),E=w[0],R=w[1],P=Object(a.useRef)(!0),D=Object(a.useRef)(),A=(Mn().updateUserRequestPayloadV2,Object(a.useState)(!1)),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(""),F=Object(u.a)(q,2),B=F[0],_=(F[1],Object(a.useState)("")),$=Object(u.a)(_,2),Y=($[0],$[1]),H=Object(a.useState)(!1),W=Object(u.a)(H,2),z=W[0],Q=W[1],G=Object(a.useState)([]),J=Object(u.a)(G,2),K=J[0],Z=(J[1],Object(a.useState)(void 0)),X=Object(u.a)(Z,2),ee=(X[0],X[1],function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,o,s,u,v,j,m,p,O,f,h,g,x,y,I;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:Q(!0),console.log("values",t),g=Object(d.a)(Object(d.a)({},t),{},{inspectionDate:t.inspectionDate.format("YYYY-MM-DD"),inspectionTime:t.inspectionTime.format("hh:mm"),vehicleName:null===t||void 0===t||null===(n=t.vehicle)||void 0===n||null===(a=n.obj)||void 0===a?void 0:a.name,driverName:null===t||void 0===t||null===(i=t.vehicle)||void 0===i||null===(c=i.obj)||void 0===c?void 0:c.assosiatedUserBeamId}),console.log("test request",g),x=new Date(t.inspectionDate.valueOf()),y=new Date(t.inspectionTime.valueOf()),x.setHours(y.getHours()),x.setMinutes(y.getMinutes()),I={userId:null===l||void 0===l?void 0:l.userId,rideRequestAttributes:Object(d.a)({pickupLocation:{type:"incident-location",coordinates:null===t||void 0===t||null===(o=t.inspectionLocation)||void 0===o||null===(s=o.value)||void 0===s?void 0:s.coordinates,attributes:null===t||void 0===t||null===(u=t.inspectionLocation)||void 0===u||null===(v=u.value)||void 0===v?void 0:v.attributes},dispatch:{type:"dispatchType",value:"schedule",date:t.inspectionDate.format("YYYY-MM-DD"),time:t.inspectionTime.format("hh:mm"),dateTimestamp:x.getTime(),timeTimestamp:x.getTime()},rideType:{type:"rideType",value:"oneWay"},fareType:"variable",payType:"meter",pageType:"inspection",drivers:[{id:null===t||void 0===t||null===(j=t.vehicle)||void 0===j||null===(m=j.obj)||void 0===m?void 0:m.assosiatedUserId,beamId:""}],cudbServiceId:null===r||void 0===r?void 0:r.userServiceId},g),drivers:[{id:null===t||void 0===t||null===(p=t.vehicle)||void 0===p||null===(O=p.obj)||void 0===O?void 0:O.assosiatedUserId,beamId:""}],connectionId:null===l||void 0===l?void 0:l.connectionId,unstructuredAttributes:Object(d.a)({pickupLocation:null===t||void 0===t?void 0:t.inspectionLocation,dispatch:{value:"schedule",type:"dispatchType",date:t.inspectionDate.format("MM/DD/YYYY HH:mm:ss"),time:t.inspectionTime.format("MM/DD/YYYY HH:mm:ss")},numberOfPeople:1,numberOfLuggage:1,rideType:{type:"rideType",value:"oneWay"},fareType:{type:"fareType",value:"variable"},payType:{type:"payType",value:"meter"}},g),title:"Inspection, ".concat(null===t||void 0===t||null===(f=t.vehicle)||void 0===f||null===(h=f.obj)||void 0===h?void 0:h.assosiatedUserBeamId,", ").concat(t.inspectionDate.format("YYYY-MM-DD")," ").concat(t.inspectionTime.format("hh:mm")),dispatch:{utcDateTime:new Date(x.getTime()).toUTCString(),rideDateTime:new Date(x.getTime()).toUTCString(),ridelocalDateTime:x.getTime(),type:"schedule"},createdAt:x.getTime(),cudbServiceId:null===r||void 0===r?void 0:r.userServiceId},console.log("ride request",I),b(Ot({requestData:I,callback:function(e){Q(!1),U(!1),console.log("response",e),e.pageId?(Lt("Ride request submitted","success","TOP_CENTER",1e3),ne()):e.pageId||Lt((null===e||void 0===e?void 0:e.details)||"Ride request failed","error","TOP_CENTER",3e3)}}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),te=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:t.publishToEvent(m.PublishPageTopics,un(null===l||void 0===l?void 0:l.connectionId),Dn({objectId:n,changes:[{op:"replace",path:"/objectStatus",value:"deleted"}]}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=new Date;t.setHours(0),t.setMinutes(1);var n={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===l||void 0===l?void 0:l.userId,"}@pageType:{event}@createdAt:[").concat(t.getTime(),",+inf]"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{profile:"$..profile",dashboard:"$..dashboard",ride:"$.persistent.static.ride",stripe:"$.persistent.static.payment.stripe",dynamic:"$.persistent.dynamic.ride",type:"$..persistent.static.metadata.type",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",requestedBy:"$.nonpersistent.dynamic.ride.dispatchRequestBy",manualUsers:"$.nonpersistent.dynamic.ride.manualUsers",rideType:"$..profile.type",phone:"$..dashboard.passengerPhoneNumber",pageType:"$..pageType"}},filter:{expression:["exists(@pageType) && @pageType === 'inspection'"].join("&&")},sortBy:{properties:[{field:"@updatedAt",order:"DESC"}],max:1e3},result:{}};console.log("page request",n),b(tt({requestData:n,callback:function(t){console.log("resppnse",t);var n=e>0?Object(C.a)(O):[],a=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Inspection Date",key:"inspectionDate",dataIndex:"inspectionDate"},{title:"Inspection Time",key:"inspectionTime",dataIndex:"inspectionTime"},{title:"Inspection Type",key:"inspectionType",dataIndex:"inspectionType"},{title:"Inspection Address",key:"address",dataIndex:"address"},{title:"Inspector Name",key:"inspectorName",dataIndex:"inspectorName"},{title:"Inspector Id",key:"inspectorId",dataIndex:"inspectorId"},{title:"Driver Name",key:"driverName",dataIndex:"driverName"},{title:"Vehicle Name",key:"vehicleName",dataIndex:"vehicleName"}];null===t||void 0===t||t.map(function(e,t){var a,i,c,o,l,s,u,v=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),b={};(Object.keys(v).map(function(e){"string"===typeof v[e]&&(b[e]=v[e])}),null===(a=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===a||a.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"succeeded"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(s=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}),s)||(null===(u=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===u||u.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"requires_capture"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(s=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}));n.push(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:v}),summary:b.summary,cudbServiceId:null===r||void 0===r?void 0:r.userServiceId,stripe:s}},b),{},{address:null!==b&&void 0!==b&&b.address&&""!==(null===b||void 0===b?void 0:b.adress)?null===b||void 0===b?void 0:b.address:null===v||void 0===v||null===(i=v.pickupLocation)||void 0===i||null===(c=i.attributes)||void 0===c?void 0:c.address,dropoffAddress:null!==b&&void 0!==b&&b.dropoffAddress&&""!==(null===b||void 0===b?void 0:b.dropoffAddress)?null===b||void 0===b?void 0:b.dropoffAddress:null===v||void 0===v||null===(o=v.dropoffLocation)||void 0===o||null===(l=o.attributes)||void 0===l?void 0:l.address,invited:"",requestedBy:"",requestedAt:new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:""}))}),console.log("source data",n),n.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===a.findIndex(function(t){return t.key===e})&&t[e]})}),a.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){V("".concat("https://live.staging.beam.live","/page/").concat(null===e||void 0===e?void 0:e.pageId),"BeamLive",.7*window.innerWidth,.9*window.innerHeight)},children:Object(oa.jsx)(Zc.a,{})})}),(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t;window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(null===l||void 0===l?void 0:l.connectionId,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:Object(oa.jsx)(Ec.a,{})})}),(null===e||void 0===e?void 0:e.stripe)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){},children:Object(oa.jsx)(Oo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Co.a,{title:"Cancel inspection?",onConfirm:function(){var t,n;console.log("cancel here",null===e||void 0===e||null===(t=e.pageId)||void 0===t?void 0:t.toString()),b(ft({requestData:{pageId:null===e||void 0===e||null===(n=e.pageId)||void 0===n?void 0:n.toString(),userId:null===l||void 0===l?void 0:l.userId,cudbServiceId:null===r||void 0===r?void 0:r.userServiceId,dispatcher:!0},callback:function(e){console.log("response",e),Lt("Inspection cancelled successfully","success","TOP_CENTER",1e3),ne()}}))},children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover ml-2",children:Object(oa.jsx)(na.a,{})})})})]})}}),y(a),f(n)}}))},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new Date;t.setHours(0),t.setMinutes(1);var a={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===l||void 0===l?void 0:l.userId,"}(-@rideType:{hail})@pageType:{event}@createdAt:[").concat(t.getTime(),",+inf]"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{ride:"$.persistent.static.ride",stripe:"$.persistent.static.payment.stripe",dynamic:"$.persistent.dynamic.ride",type:"$..persistent.static.metadata.type",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",requestedBy:"$.nonpersistent.dynamic.ride.dispatchRequestBy",manualUsers:"$.nonpersistent.dynamic.ride.manualUsers",rideType:"$..profile.type",phone:"$..dashboard.passengerPhoneNumber",state:"$..dashboard.state"}},filter:{expression:""},sortBy:{properties:[{field:"@updatedAt",order:"DESC"}],max:1e3},result:{}};e||k(!0),b(tt({requestData:a,callback:function(e){console.log("response here",e),f(null===e||void 0===e?void 0:e.map(function(e){return Object(d.a)(Object(d.a)({key:null===e||void 0===e?void 0:e.objectId},null===e||void 0===e?void 0:e.info),{},{action:e})})),y([{title:"Name",key:"name",dataIndex:"name"},{title:"Start date",key:"startDate",dataIndex:"startDate"},{title:"End date",key:"endDate",dataIndex:"endDate"},n?{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsx)(Yn.a,{style:{width:135},children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),R(e)},children:Object(oa.jsx)(wc.a,{})})})})}}:{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),R(e)},children:Object(oa.jsx)(wo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Co.a,{title:"Are you sure to delete this shift schedule?",onConfirm:Object(_n.a)(Object(Bn.a)().m(function t(){return Object(Bn.a)().w(function(t){for(;;)switch(t.n){case 0:te(e.objectId);case 1:return t.a(2)}},t)})),children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})})})]})}}]),k(!1)}}))};Object(a.useEffect)(function(){return P.current=!0,function(){P.current=!1}},[]),Object(a.useEffect)(function(){null!==r&&void 0!==r&&r.adminUserId&&(ne(),t.subscribeToEvent(m.SubscribePageTopics,sn(null===l||void 0===l?void 0:l.connectionId),function(e){var t,n;console.log("response",null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.id),U(!1),Q(!1),ae()}),t.subscribeToEvent(m.SubscribePageTopics,dn(null===l||void 0===l?void 0:l.connectionId),function(e){console.log("response",e),ae(!0)}))},[r]),Object(a.useEffect)(function(){return P.current=!0,D.current=setInterval(function(){console.log("get zone responders"),ne()},1e4),function(){P.current=!1,console.log("clear timeput"),D.current&&clearInterval(D.current)}},[]);var ie=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],ce=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[!n&&Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsx)("div",{style:{height:50}}),Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn green-btn cover",onClick:function(){U(!0)},children:"Add"})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:N?ce:O,columns:N?ie:x,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==E&&Object(oa.jsx)(Do,{socket:t,student:E,onClose:function(){R(void 0)},adminRoles:v,drivers:K,onAdd:function(e){ae(!0)},userId:n}),L&&Object(oa.jsx)($n.a,{title:"Add New Inspection",visible:!0,onCancel:function(){return U(!1)},okButtonProps:{disabled:!B.trim()},className:"beam-modal",footer:[],children:Object(oa.jsxs)(ei.a,{layout:"vertical",className:"auth-form",onFinish:ee,children:[Object(oa.jsx)(ei.a.Item,{name:"inspectionType",label:"Inspection Type",rules:[{required:!0,message:"Please select inspection type"}],children:Object(oa.jsx)(Gn.a,{placeholder:"Select inspection type",children:["1-Mile","5-Mile","Annual"].map(function(e){return Object(oa.jsx)(Ao,{value:e,children:e},e)})})}),Object(oa.jsx)(ei.a.Item,{label:"Inspection Date",name:"inspectionDate",rules:[{required:!0,message:"Please select date"}],className:"mt-3",children:Object(oa.jsx)(Jn.a,{className:"w-full"})}),Object(oa.jsx)(ei.a.Item,{name:"inspectionTime",label:"Inspection Time",rules:[{required:!0,message:"Please select time"}],className:"mt-3",children:Object(oa.jsx)(Zn.a,{style:{width:"100%"},format:"hh:mm"})}),Object(oa.jsx)(ei.a.Item,{name:"inspectionLocation",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",label:"Inspection Location",children:Object(oa.jsx)(ai,{placeholder:"Inspection location",onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{name:"vehicle",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",label:"Select driver/vehicle",children:Object(oa.jsx)(zc,{placeholder:"Select vehicle",onChange:function(e){},socket:t})}),Object(oa.jsx)(ei.a.Item,{name:"inspectorName",label:"Assigned Inspector Name (Optional)",className:"mt-3",children:Object(oa.jsx)(Wn.a,{})}),Object(oa.jsx)(ei.a.Item,{name:"inspectorId",label:"Inspector Employee ID/Badge Number (Optional)",className:"mt-3",children:Object(oa.jsx)(Wn.a,{})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:z,type:"primary",htmlType:"submit",onClick:function(){return Y("")},children:"Save"})})})})]})})]})},Lo=n(527);Za.a.Panel;Dc.d.register(Dc.a,Dc.j,Dc.e);Gn.a.Option;var Uo=function(e){var t,n=e.socket,c=(e.params,e.componentUuid,Object(l.g)().search,Object(s.c)(function(e){return e.auth})),o=(c.userRequests,c.projects),r=(c.pageAggregateBds,c.selectedPage,c.encrypted_token),v=c.responders,b=(Object(s.b)(),Object(a.useState)([])),j=Object(u.a)(b,2),p=j[0],O=j[1],f=Object(a.useState)([]),h=Object(u.a)(f,2);h[0],h[1];Object(a.useState)(!1);var g=Object(a.useState)([]),I=Object(u.a)(g,2),S=(I[0],I[1],Mn().getUserRequestPayload),N=Object(a.useState)(void 0),k=Object(u.a)(N,2),C=(k[0],k[1],Object(a.useState)(void 0)),w=Object(u.a)(C,2),E=(w[0],w[1],Object(a.useRef)(),Object(a.useState)()),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(!1),F=Object(u.a)(q,2),B=(F[0],F[1]),_=Object(a.useRef)(),$=Object(a.useRef)(!0),Y=Object(a.useState)("all"),H=Object(u.a)(Y,2),W=(H[0],H[1],Object(a.useState)("stand")),V=Object(u.a)(W,2),z=V[0],Q=V[1],G=Object(a.useState)({}),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=function(e){B(!0),n.publishToEvent(m.PublishPageTopics,Yt(null===r||void 0===r?void 0:r.connectionId),Dn({userId:null===r||void 0===r?void 0:r.userId,cudbServiceId:null===o||void 0===o?void 0:o.userServiceId,latLng:e,height:3e5,width:3e5}))},ee=function(e,t,n){var a,i;return"Polygon"===(null===n||void 0===n||null===(a=n.location)||void 0===a?void 0:a.type)?te(e,t,n.location.coordinates):"Point"===(null===n||void 0===n||null===(i=n.location)||void 0===i?void 0:i.type)&&ne(e,t,n.location.coordinates,n.radius)},te=function(e,t,n){for(var a=!1,i=t,c=e,o=n[0],l=0,s=o.length-1;l<o.length;s=l++){var r=Object(u.a)(o[l],2),d=r[0],v=r[1],b=Object(u.a)(o[s],2),j=b[0],m=b[1];v>c!==m>c&&i<(j-d)*(c-v)/(m-v)+d&&(a=!a)}return a},ne=function(e,t,n,a){var i=Object(u.a)(n,2),c=i[0],o=i[1],l=function(e){return e*(Math.PI/180)},s=l(e-o),r=l(t-c),d=Math.pow(Math.sin(s/2),2)+Math.cos(l(o))*Math.cos(l(e))*Math.pow(Math.sin(r/2),2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))<=a},ae=function(){P&&null!==P&&void 0!==P&&P.current?D(Object(d.a)({},P)):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,a,i,c,l;(D({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,lng:null===e||void 0===e||null===(a=e.coords)||void 0===a?void 0:a.longitude,current:!0}),$.current)?(l={lat:null===e||void 0===e||null===(i=e.coords)||void 0===i?void 0:i.latitude,long:null===e||void 0===e||null===(c=e.coords)||void 0===c?void 0:c.longitude},n.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,S(null===o||void 0===o?void 0:o.adminUserId,"$","$..persistent.static.admin.fleetZones.items"),x.GetUserBio,null===o||void 0===o?void 0:o.userServiceId),B(!0),n.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,n,a,i;console.log("fleet management",null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]),U(null===e||void 0===e||null===(a=e.data)||void 0===a||null===(i=a[0])||void 0===i?void 0:i[0]),X(l)}),_.current&&clearInterval(_.current),console.log("interval set"),_.current=setInterval(function(){var t,n;console.log("get zone responders"),X({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,long:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude})},1e4)):console.log("un mounted")}):alert("Geolocation is not supported by this browser.")};Object(a.useEffect)(function(){if(v){var e;console.log("responders",v);var t={};null===(e=Object.values(L||{}))||void 0===e||e.map(function(e){var n,a;null===(n=e.zoneGeofenceId)||void 0===n||!n.name||null!==t&&void 0!==t&&t[e.zoneGeofenceId.name]||(t[e.zoneGeofenceId.name]={name:e.zoneGeofenceId.name,id:e.zoneGeofenceId._id,users:[],type:"zone"}),null===(a=e.standGeofenceId)||void 0===a||!a.name||null!==t&&void 0!==t&&t[e.standGeofenceId.name]||(t[e.standGeofenceId.name]={name:e.standGeofenceId.name,id:e.standGeofenceId._id,users:[],type:"stand"});var i=[],c=[];null===v||void 0===v||v.map(function(n,a){var o,l,s,r,d,u,v,b,j,m,p,O=null===n||void 0===n||null===(o=n.location)||void 0===o||null===(l=o.geoJson)||void 0===l||null===(s=l.features)||void 0===s||null===(r=s[0])||void 0===r?void 0:r.geometry;null!==O&&void 0!==O&&O.coordinates&&(ee(null===O||void 0===O||null===(v=O.coordinates)||void 0===v?void 0:v[1],null===O||void 0===O||null===(b=O.coordinates)||void 0===b?void 0:b[0],e.zoneGeofenceId)&&(console.log("user inside zone"),i.push(n)),null!==(j=e.standGeofenceId)&&void 0!==j&&j.name&&ee(null===O||void 0===O||null===(m=O.coordinates)||void 0===m?void 0:m[1],null===O||void 0===O||null===(p=O.coordinates)||void 0===p?void 0:p[0],e.standGeofenceId)&&(console.log("user inside stand"),c.push(n)));null!==(d=e.zoneGeofenceId)&&void 0!==d&&d.name&&(t[e.zoneGeofenceId.name].users=i,t[e.zoneGeofenceId.name].type="zone"),null!==(u=e.standGeofenceId)&&void 0!==u&&u.name&&(t[e.standGeofenceId.name].users=c,t[e.standGeofenceId.name].type="stand")})}),console.log("inside here",t),function(e){var t,n=e.data,a=Object.entries(n).sort(function(e,t){var n,a,i=Object(u.a)(e,2)[1];return((null===(n=Object(u.a)(t,2)[1].users)||void 0===n?void 0:n.length)||0)-((null===(a=i.users)||void 0===a?void 0:a.length)||0)}).reduce(function(e,t){var n=Object(u.a)(t,2),a=n[0],i=n[1];return Object(d.a)(Object(d.a)({},e),{},Object(T.a)({},a,i))},{}),i={};null===(t=Object.values(a))||void 0===t||t.map(function(e){"stand"===e.type&&e.users.map(function(t,n){var a;t.id.toString()===(null===r||void 0===r||null===(a=r.userId)||void 0===a?void 0:a.toString())&&(i={name:e.name,cars:e.users.filter(function(e){return"green"===e.status}).length,queue:"green"===t.status?n+1:"N/A"})})}),Z(i),O(Object.values(a))}({data:t}),B(!1);var n=[];null===v||void 0===v||v.map(function(e,t){var a,i,c,o,l;n.push({key:e.id,userStatus:null===e||void 0===e?void 0:e.status,displayStatusName:{displayName:null===e||void 0===e?void 0:e.displayStatusName,status:null===e||void 0===e?void 0:e.status},driverName:"".concat(null===e||void 0===e||null===(a=e.profile)||void 0===a?void 0:a.firstName," ").concat(null===e||void 0===e||null===(i=e.profile)||void 0===i?void 0:i.lastName),driverEmail:null===e||void 0===e||null===(c=e.alternativeIds)||void 0===c?void 0:c.email,driverPhone:null===e||void 0===e||null===(o=e.alternativeIds)||void 0===o?void 0:o.phone,driverCustomId:null===e||void 0===e||null===(l=e.alternativeIds)||void 0===l?void 0:l.customId})})}},[v]),Object(a.useEffect)(function(){return $.current=!0,function(){$.current=!1,console.log("clear timeput"),_.current&&clearInterval(_.current)}},[]),Object(a.useEffect)(function(){r&&(ae(),n.subscribeToEvent(m.SubscribePageTopics,$t(null===r||void 0===r?void 0:r.connectionId)))},[r]);var ie=Object(a.useState)(null),ce=Object(u.a)(ie,2),oe=ce[0],le=ce[1];return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Cc.a,{className:"filter-card mt-3",style:{marginRight:10},children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-3",children:"Current"})}),Object(oa.jsxs)(Yn.a,{className:"d-flex mb-2",children:[Object(oa.jsx)(Hn.a,{span:6,className:"border rounded text-center p-2 mx-2 cursor-pointer status-selected",onClick:function(){},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"Stand"}),Object(oa.jsx)("h4",{children:(null===K||void 0===K?void 0:K.name)||"N/A"})]})}),Object(oa.jsx)(Hn.a,{span:6,className:"border rounded text-center p-2 mx-2 cursor-pointer status-selected",onClick:function(){},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"Cars"}),Object(oa.jsx)("h4",{children:(null===K||void 0===K?void 0:K.cars)||"N/A"})]})}),Object(oa.jsx)(Hn.a,{span:7,className:"border rounded text-center p-2 mx-2 cursor-pointer status-selected",onClick:function(){},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"Queue"}),Object(oa.jsx)("h4",{children:(null===K||void 0===K?void 0:K.queue)||"N/A"})]})})]})]}),Object(oa.jsxs)(Cc.a,{className:"filter-card mt-3",style:{marginRight:10},children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:7,children:Object(oa.jsx)(Vn.a,{onClick:function(){Q("stand")},className:"beam-btn ".concat("stand"===z?"green-btn cover":""),children:"Stand"})}),Object(oa.jsx)(Hn.a,{span:7,children:Object(oa.jsx)(Vn.a,{onClick:function(){Q("zone")},className:"beam-btn ".concat("zone"===z?"green-btn cover":""),children:"Zone"})})]}),Object(oa.jsx)(Yn.a,{className:"d-flex mt-3",children:null===(t=p.filter(function(e){return z===e.type}))||void 0===t?void 0:t.map(function(e,t){var n,a,i;return Object(oa.jsx)(Hn.a,{span:7,className:"border rounded text-center p-2 mx-2 cursor-pointer mb-2 status-selected",onClick:function(){},children:Object(oa.jsx)(Lo.a,{content:Object(oa.jsx)("span",{children:null===e||void 0===e||null===(n=e.users)||void 0===n||null===(a=n.filter(function(e){return"green"===e.status}).map(function(e,t){var n;return"".concat(t+1,": ").concat(null===e||void 0===e||null===(n=e.beamIds)||void 0===n?void 0:n[0])}))||void 0===a?void 0:a.join(",")}),title:"stand"===e.type?"Queue":"Drivers",trigger:"click",visible:oe===e.id,onVisibleChange:function(t){!function(e,t){le(t?e:null)}(e.id,t)},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:e.name}),Object(oa.jsxs)("h4",{children:[(null===e||void 0===e||null===(i=e.users)||void 0===i?void 0:i.filter(function(e){return"green"===e.status}).length)||0," cars"]})]})})})})})]})]})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var qo=function(e){var t=e.socket,n=(Object(l.f)(),Object(s.b)(),Object(a.useState)({form:!0,map:!0})),i=Object(u.a)(n,2),c=i[0],o=i[1],r=Object(a.useState)("map"),d=Object(u.a)(r,2),b=d[0],j=d[1],m=Object(a.useState)({driver:W(),advance:W(),dispatch:W(),inspection:W(),all:W()}),p=Object(u.a)(m,2),O=p[0],f=(p[1],{screens:c,setScreens:o});return Object(oa.jsxs)(Yn.a,{className:"main-layout",style:{transform:"scale(0.8)",transformOrigin:"0 0",width:"125vw",height:"100vh"},children:[c.form&&Object(oa.jsx)(Hn.a,{md:c.map?7:24,xs:24,className:"form"===c.active?"active-screen":"",style:{height:"calc((100vh / 0.8) - 50px)",overflow:"scroll"},children:c.form&&Object(oa.jsx)(io,{socket:t,params:f,fullScreen:!0,scale:!0})}),c.map&&Object(oa.jsx)(Hn.a,{span:17,style:{height:"calc((100vh / 0.8) - 70px)",overflow:"scroll"},children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsxs)(Hn.a,{span:24,className:"ride-container ".concat("map"===c.active?"active-screen":""),children:[Object(oa.jsxs)("div",{className:"d-flex justify-content-start main-column map-content",children:[Object(oa.jsx)(Vn.a,{onClick:function(){j("map")},className:"beam-btn m-3 ".concat("map"===b?"green-btn cover":""),children:"Map"}),Object(oa.jsx)(Vn.a,{onClick:function(){j("advance")},className:"beam-btn m-3 ".concat("advance"===b?"green-btn cover":""),children:"Advance booking"}),Object(oa.jsx)(Vn.a,{onClick:function(){j("dispatch")},className:"beam-btn m-3 ".concat("dispatch"===b?"green-btn cover":""),children:"Dispatching"}),Object(oa.jsx)(Vn.a,{onClick:function(){j("driver")},className:"beam-btn m-3 ".concat("driver"===b?"green-btn cover":""),children:"Drivers"}),Object(oa.jsx)(Vn.a,{onClick:function(){j("geofence")},className:"beam-btn m-3 ".concat("geofence"===b?"green-btn cover":""),children:"Zones"}),Object(oa.jsx)(Vn.a,{onClick:function(){j("inspection")},className:"beam-btn m-3 ".concat("inspection"===b?"green-btn cover":""),children:"Inspection"})]}),"map"===b&&Object(oa.jsx)(lo,{socket:t,params:f}),"driver"===b&&Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(To,{socket:t,componentUuid:O.driver})})}),"geofence"===b&&Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(Uo,{socket:t,componentUuid:O.driver})})}),"inspection"===b&&Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(Mo,{socket:t,componentUuid:O.inspection})})}),"dispatch"===b&&Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(ko,{socket:t,filter:!1,selected:b,componentUuid:O.advance})})}),"advance"===b&&Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(ko,{socket:t,filter:!1,selected:b,componentUuid:O.advance})})})]}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mt-3",style:{padding:0},children:Object(oa.jsx)(ko,{socket:t,filter:!0,componentUuid:O.all})})})})]})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})},Fo=(Za.a.Panel,function(e){var t=e.onClose,n=e.handleConfirm,i=e.message,c=Object(a.useState)(!0),o=Object(u.a)(c,2),l=o[0],s=o[1],r=ei.a.useForm(),d=Object(u.a)(r,1)[0],v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=b[0],m=b[1],p=function(){s(!1),t&&t()};return Object(oa.jsx)($n.a,{title:"Please Confirm",visible:l,onCancel:p,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"confirmation-form",id:"confirmation-form",layout:"vertical",form:d,requiredMark:!1,children:[Object(oa.jsx)(ei.a.Item,{name:"password",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(Jc.a,{children:i||"Are you sure you want to continue?"})}),Object(oa.jsx)(ei.a.Item,{className:"action-grp mt-4",children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{loading:j,className:"beam-btn green-btn cover w-full",onClick:function(){m(!0),n()},children:"Confirm"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:p,children:"Cancel"})})]})})]})})});n(129),Za.a.Panel;Dc.d.register(Dc.a,Dc.j,Dc.e);Gn.a.Option;var Bo=function(e){e.socket,e.params,e.filter;var t=e.selected,n=(e.componentUuid,e.onClose),c=e.phone,o=(Object(l.g)().search,Object(s.c)(function(e){return e.auth})),r=(o.userRequests,o.projects),v=(o.pageAggregateBds,o.selectedPage),b=o.encrypted_token,j=(o.searchByPhone,Object(s.b)()),m=Object(a.useState)(!0),p=Object(u.a)(m,2),O=p[0],f=p[1],h=Object(a.useState)("project"),g=Object(u.a)(h,2),x=(g[0],g[1],Object(a.useState)("state")),y=Object(u.a)(x,2),I=(y[0],y[1],Object(a.useState)(!1)),S=Object(u.a)(I,2),N=(S[0],S[1]),k=Object(a.useState)(void 0),T=Object(u.a)(k,2),w=(T[0],T[1],Object(a.useState)(void 0)),E=Object(u.a)(w,2),R=(E[0],E[1],Object(a.useState)(!1)),P=Object(u.a)(R,2),D=(P[0],P[1]),A=Object(a.useState)(!1),M=Object(u.a)(A,2),L=(M[0],M[1]),U=Object(a.useState)([]),q=Object(u.a)(U,2),F=(q[0],q[1]),B=Object(a.useState)([]),_=Object(u.a)(B,2),$=(_[0],_[1],Object(a.useState)([])),Y=Object(u.a)($,2),H=(Y[0],Y[1]),Q=Object(a.useState)([]),G=Object(u.a)(Q,2),J=(G[0],G[1]),K=(Object(a.useRef)(W()),Object(a.useRef)(W()),Object(a.useRef)(void 0),Object(a.useRef)(void 0),Object(a.useRef)(0)),Z=Object(a.useRef)(void 0),X=Object(a.useState)(),ee=Object(u.a)(X,2),te=(ee[0],ee[1],Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0})),ne=Object(u.a)(te,2),ae=(ne[0],ne[1],Object(a.useState)(0)),ie=Object(u.a)(ae,2),ce=(ie[0],ie[1],Object(a.useState)([])),oe=Object(u.a)(ce,2),le=oe[0],se=oe[1],re=Object(a.useRef)(void 0),de=(Object(a.useRef)(void 0),Object(a.useState)([])),ue=Object(u.a)(de,2),ve=ue[0],be=ue[1],je=Object(a.useState)(!1),me=Object(u.a)(je,2),pe=(me[0],me[1],Object(a.useState)([])),Oe=Object(u.a)(pe,2),fe=(Oe[0],Oe[1],Object(a.useState)(void 0)),he=Object(u.a)(fe,2),ge=(he[0],he[1]),xe=(Mn().getUserRequestPayload,Object(a.useRef)(void 0),Object(a.useRef)({project:void 0,user:void 0,status:void 0,area:void 0,time:void 0,phone:void 0})),ye=(Object(a.useRef)({}),Object(a.useRef)()),Ie=Object(a.useRef)([]),Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n={};Ie.current&&Ie.current.map(function(e){n[e.key]=e.value}),K.current=e;var a={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{'".concat(null===b||void 0===b?void 0:b.userId,"'}(-@rideType:{hail})@pageType:{event}@passengerPhoneNumber:{").concat(z(xe.current.phone),"}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)({profile:"$..profile",dashboard:"$..dashboard",ride:"$.persistent.static.ride",dynamic:"$.persistent.dynamic.ride",rideType:"$..profile.type",pageId:"$.objectId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",phone:"$..dashboard.passengerPhoneNumber"},n)},filter:{expression:[].join("&&")},sortBy:{properties:["advance"===t?{field:"@createdAt",order:"ASC"}:{field:"@updatedAt",order:"DESC"}],max:1e3},result:xe.current.phone?{pagination:{offset:e,limit:50}}:{}};j(tt({requestData:a,callback:function(t){console.log("resppnse",t),H(t),K.current=K.current+30;var n=e>0?Object(C.a)(le):[],a=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Pickup Address",key:"address",dataIndex:"address"},{title:"Dropoff Address",key:"dropoffAddress",dataIndex:"dropoffAddress"},{title:"Passenger Name",key:"passengerName",dataIndex:"passengerName"},{title:"Passenger Phone",key:"passengerPhoneNumber",dataIndex:"passengerPhoneNumber"},{title:"Driver Name",key:"driverName",dataIndex:"driverName"},{title:"Vehicle Name",key:"vehicleName",dataIndex:"vehicleName"},{title:"Fixed Fare",key:"fixedFare",dataIndex:"fixedFare"}];null===t||void 0===t||t.map(function(e,t){var a,i,c,o,l=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),s={};Object.keys(l).map(function(e){"string"===typeof l[e]&&(s[e]=l[e])}),n.push(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:l}),summary:s.summary,cudbServiceId:null===r||void 0===r?void 0:r.userServiceId}},s),{},{address:null!==s&&void 0!==s&&s.address&&""!==(null===s||void 0===s?void 0:s.adress)?null===s||void 0===s?void 0:s.address:null===l||void 0===l||null===(a=l.pickupLocation)||void 0===a||null===(i=a.attributes)||void 0===i?void 0:i.address,dropoffAddress:null!==s&&void 0!==s&&s.dropoffAddress&&""!==(null===s||void 0===s?void 0:s.dropoffAddress)?null===s||void 0===s?void 0:s.dropoffAddress:null===l||void 0===l||null===(c=l.dropoffLocation)||void 0===c||null===(o=c.attributes)||void 0===o?void 0:o.address,invited:""}))}),console.log("source data",n),n.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===a.findIndex(function(t){return t.key===e})&&t[e]})}),a.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:90},children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){V("".concat("https://live.staging.beam.live","/page/").concat(null===e||void 0===e?void 0:e.pageId),"BeamLive",.7*window.innerWidth,.9*window.innerHeight)},children:Object(oa.jsx)(Zc.a,{})})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){j({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e?void 0:e.page,ignorePage:!0}})},children:Object(oa.jsx)(Xc.a,{})})})]})}}),be(a),console.log("set source date",n),se(n),re.current=n,J(null===t||void 0===t?void 0:t.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),D(!1),N(!1),L(!1)}}))};Object(a.useEffect)(function(){var e;b&&(ye.current=b,N(!0),e=c,xe.current.phone=e,D(!0),xe.current.status=void 0,Z.current="lime",ge("lime"),Se())},[b]),Object(a.useEffect)(function(){if(r){var e,t=[];null===r||void 0===r||null===(e=r.projects)||void 0===e||e.map(function(e){t.push({label:e.name,value:e.id})}),F(t)}},[r]);return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)($n.a,{title:"Search",visible:O,onCancel:function(){f(!1),n&&n()},width:"1000px",bodyStyle:{height:600},className:"beam-modal analytics-summary-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid",transformOrigin:"0px 0px",transform:"scale(0.8)",width:"125%"},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:le,className:(null===le||void 0===le?void 0:le.length)>0?"":"table-empty-1",onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)}}},columns:ve,scroll:{x:!0},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===v||void 0===v||null===(n=v.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})})})})},_o=n(1026),$o=n(307),Yo=n.n($o),Ho=Gn.a.Option,Wo=function(e){var t,n=e.value,i=e.placeholder,c=e.onChange,o=e.socket,l=Object(s.c)(function(e){return e.auth}),r=l.projects,d=l.assets_filter,v=Mn().getUserRequestPayload,b=Object(a.useState)(0),j=Object(u.a)(b,2),p=j[0],O=j[1],f=Object(a.useState)(!1),h=Object(u.a)(f,2),g=h[0],I=h[1],S=Object(a.useState)(!1),N=Object(u.a)(S,2),k=N[0],T=N[1],w=Object(a.useState)(!0),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useState)([]),A=Object(u.a)(D,2),M=A[0],L=A[1],U=(Object(s.b)(),function(e){O(e),T(!0),o.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,v(null===r||void 0===r?void 0:r.adminUserId,"$","$.persistent.static.admin.pricingManagement.items"),x.GetUserBio,null===r||void 0===r?void 0:r.userServiceId),o.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,n,a,i,c;console.log("pricing management",null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]);var o=[];null===Object||void 0===Object||null===(a=Object.values((null===e||void 0===e||null===(i=e.data)||void 0===i||null===(c=i[0])||void 0===c?void 0:c[0])||{}))||void 0===a||a.map(function(e,t){o.push({id:e._id,name:null===e||void 0===e?void 0:e.name,obj:e})}),o=o.filter(function(e){return!M.find(function(t){return e.id===t.id})}),L([].concat(Object(C.a)(M),Object(C.a)(o))),I(!0),0===o.length&&P(!1),T(!1)})});return Object(oa.jsx)(Gn.a,{showSearch:!0,value:g?null===n||void 0===n?void 0:n.id:null===n||void 0===n?void 0:n.valueName,className:"w-full",placeholder:i,onChange:function(e){var t=M.find(function(t){return t.id===e});c({id:e,type:"pricing",value:t.obj})},loading:k,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},onFocus:function(){var e;0===(null!==(e=null===d||void 0===d?void 0:d.length)&&void 0!==e?e:0)&&U(0)},onSearch:function(e){t&&clearTimeout(t),t=setTimeout(function(){e&&""!==e?(U(0,e),P(!1)):U(0)},500)},onPopupScroll:function(e){e.persist();var t=e.target;t.scrollTop+t.offsetHeight===t.scrollHeight&&R&&U(p+1)},children:null===M||void 0===M?void 0:M.map(function(e,t){return Object(oa.jsx)(Ho,{value:e.id,children:e.name},t)})})},Vo=Gn.a.Option,zo=function(e){var t,n,c=e.value,o=(e.placeholder,e.onChange),l=e.socket,r=Object(s.c)(function(e){return e.auth}),d=r.projects,v=r.assets_filter,b=Mn().getUserRequestPayload,j=Object(a.useState)(0),p=Object(u.a)(j,2),O=(p[0],p[1]),f=Object(a.useState)(!1),h=Object(u.a)(f,2),g=h[0],I=h[1],S=Object(a.useState)(!0),N=Object(u.a)(S,2),k=(N[0],N[1]),T=Object(a.useState)([]),w=Object(u.a)(T,2),E=w[0],R=w[1],P=(Object(s.b)(),Object(a.useState)([])),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Object(a.useState)([]),U=Object(u.a)(L,2),q=U[0],F=U[1];Object(a.useEffect)(function(){null!==c&&void 0!==c&&c.categories&&M(null===c||void 0===c?void 0:c.categories),null!==c&&void 0!==c&&c.subCategories&&F(null===c||void 0===c?void 0:c.subCategories)},[c]);return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{mode:"multiple",className:"w-full",placeholder:"Select type",value:A,onChange:function(e){M(e),console.log("categories",e),o({type:"equipment",categories:e,subCategories:null===c||void 0===c?void 0:c.subCategories})},loading:g,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},onFocus:function(){var e;0===(null!==(e=null===v||void 0===v?void 0:v.length)&&void 0!==e?e:0)&&(O(0),I(!0),l.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,b(null===d||void 0===d?void 0:d.adminUserId,"$","$.persistent.static.admin.equipmentManagement.items"),x.GetUserBio,null===d||void 0===d?void 0:d.userServiceId),l.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,n,a,i,c;console.log("equipment management",null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]);var o=[];null===Object||void 0===Object||null===(a=Object.values((null===e||void 0===e||null===(i=e.data)||void 0===i||null===(c=i[0])||void 0===c?void 0:c[0])||{}))||void 0===a||a.map(function(e,t){var n;o.push({id:e._id,name:null===e||void 0===e?void 0:e.name,subcategories:null===e||void 0===e||null===(n=e.equipments)||void 0===n?void 0:n.map(function(e){return"".concat(e.name,": ").concat(e.description)})})}),o=o.filter(function(e){return!E.find(function(t){return e.id===t.id})}),console.log("options",o),R([].concat(Object(C.a)(E),Object(C.a)(o))),0===o.length&&k(!1),I(!1)}))},children:null===E||void 0===E?void 0:E.map(function(e,t){return Object(oa.jsx)(Vo,{value:e.name,children:e.name},e.name)})})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select equipment",value:q,onChange:function(e){F(e),o({type:"equipment",categories:null===c||void 0===c?void 0:c.categories,subCategories:e})},children:null===E||void 0===E||null===(t=E.filter(function(e){return A.includes(e.name)}))||void 0===t||null===(n=t.flatMap(function(e){return e.subcategories}))||void 0===n?void 0:n.map(function(e){return Object(oa.jsx)(Vo,{value:e,children:e},e)})})})})]})},Qo=n(1038);Wn.a.TextArea;function Go(e,t){return 0===t.length?null:t[0]}var Jo=function(e){var t=e.onClose,n=(e.socket,e.values),i=e.onApply,c=Object(a.useState)(!0),o=Object(u.a)(c,2),l=o[0],r=o[1],v=Object(a.useState)(""),b=Object(u.a)(v,2),j=(b[0],b[1],ei.a.useForm()),m=(Object(u.a)(j,1)[0],Object(a.useState)("")),p=Object(u.a)(m,2),O=(p[0],p[1],Object(a.useState)(!1)),f=Object(u.a)(O,2),h=(f[0],f[1],Object(a.useState)("email")),g=Object(u.a)(h,2),x=(g[0],g[1],Object(a.useState)(0)),y=Object(u.a)(x,2),I=y[0],S=y[1],N=(Object(s.c)(function(e){return e.auth}).encrypted_token,Object(a.useState)()),k=Object(u.a)(N,2),w=(k[0],k[1],Object(a.useState)([])),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useState)([]),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Object(a.useState)(),q=Object(u.a)(U,2),F=q[0],B=q[1],_=Object(a.useState)({baseRate:0,tripKmRate:2.82,additionalStaffRate:{baseRate:20,kmRate:2,waitTime:49},wheelchairFee:{oneWay:10,twoWay:20},brodaFee:{oneWay:15,twoWay:30},waitTimeRate:{oneWayPerHour:10,twoWayPerHour:20},oxygenRate:{oneWayPerLiter:5,twoWayPerLiter:10},overnightFee:{oneWay:0,twoWay:50},taxRate:.13}),$=Object(u.a)(_,2),Y=$[0],H=$[1],W=function(e,t){return new Promise(function(n,a){var i,c,o=null===e||void 0===e||null===(i=e.value)||void 0===i?void 0:i.coordinates,l=null===t||void 0===t||null===(c=t.value)||void 0===c?void 0:c.coordinates;(new google.maps.DirectionsService).route({origin:new google.maps.LatLng(o.lat,o.long),destination:new google.maps.LatLng(l.lat,l.long),travelMode:google.maps.TravelMode.DRIVING,drivingOptions:{departureTime:new Date,trafficModel:google.maps.TrafficModel.PESSIMISTIC}},function(e,t){var i,c,o,l;if(t===google.maps.DirectionsStatus.OK)if(console.log("direction result here",e),(null===e||void 0===e||null===(i=e.routes)||void 0===i?void 0:i.length)>0&&(null===e||void 0===e||null===(c=e.routes)||void 0===c||null===(o=c[0])||void 0===o||null===(l=o.legs)||void 0===l?void 0:l.length)>0){var s=e.routes[0].legs[0],r=s.distance.value,d=s.duration.value,u=s.duration_in_traffic?s.duration_in_traffic.value:null;n({distance:r,duration:d,durationInTraffic:u})}else a("cannot find distance between start and end");else a("error fetching directions ".concat(e))})})};Object(a.useEffect)(function(){var e;if(console.log("values",n),null!==n&&void 0!==n&&null!==(e=n.pricingType)&&void 0!==e&&e.value){var t=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h,g,x,y;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(P(null===t||void 0===t||null===(n=t.pricingType)||void 0===n||null===(a=n.value)||void 0===a?void 0:a.locations),L(null===t||void 0===t||null===(i=t.pricingType)||void 0===i||null===(c=i.value)||void 0===c?void 0:c.rates),null===t||void 0===t||null===(o=t.pickupLocation)||void 0===o||null===(l=o.value)||void 0===l||!l.coordinates||null===t||void 0===t||null===(s=t.dropoffLocation)||void 0===s||null===(r=s.value)||void 0===r||!r.coordinates){e.n=4;break}return p=Go(null===t||void 0===t||null===(d=t.pickupLocation)||void 0===d||null===(u=d.value)||void 0===u||u.coordinates,null===t||void 0===t||null===(v=t.pricingType)||void 0===v||null===(b=v.value)||void 0===b?void 0:b.locations),O=t.pickupLocation,f=t.dropoffLocation,e.n=1,W({value:null===p||void 0===p?void 0:p.address},O);case 1:return h=e.v,e.n=2,W(O,f);case 2:return g=e.v,e.n=3,W(f,{value:null===p||void 0===p?void 0:p.address});case 3:x=e.v,B(p),console.log(" closest estimation",h),console.log("estimation",g),(y=Object(C.a)(Q))[1].input=(((null===g||void 0===g?void 0:g.distance)||0)+((null===h||void 0===h?void 0:h.distance)||0)+((null===x||void 0===x?void 0:x.distance)||0))/1e3,y[2].input=parseInt(null===t||void 0===t?void 0:t.numberOfStaff)-1||0,y[3].input=null===t||void 0===t||null===(j=t.equipmentNeeded)||void 0===j?void 0:j.includes("bringWheelchair"),y[4].input=null===t||void 0===t||null===(m=t.equipmentNeeded)||void 0===m?void 0:m.includes("bringBroda"),y[5].input=(parseInt(null===t||void 0===t?void 0:t.waitTime)||0)/60,y[6].input=parseInt(null===t||void 0===t?void 0:t.oxygen)||0,G(y);case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();t(n)}},[]),Object(a.useEffect)(function(){if(F&&(null===M||void 0===M?void 0:M.length)>0){var e,t,a=null===n||void 0===n?void 0:n.transferType;if("Wheelchair Transfer"===a||"Ambulatory Transfer"===a||"Electric Wheelchair Transfer"===a?t=null===M||void 0===M?void 0:M.filter(function(e){return"Wheelchair"===(null===e||void 0===e?void 0:e.service)}):"Stretcher Transfer"===a?t=null===M||void 0===M?void 0:M.filter(function(e){return"Stretcher"===(null===e||void 0===e?void 0:e.service)}):"Broda Transfer"===a&&(t=null===M||void 0===M?void 0:M.filter(function(e){return"Broda"===(null===e||void 0===e?void 0:e.service)})),(null===(e=t)||void 0===e?void 0:e.length)>0){var i,c,o,l,s,r,u,v,b;console.log("selected rates",t);var j=null===M||void 0===M?void 0:M.find(function(e){return"Oxygen"===(null===e||void 0===e?void 0:e.service)}),m=null===M||void 0===M?void 0:M.find(function(e){return"Hulpr Wheelchair"===(null===e||void 0===e?void 0:e.service)}),p=null===M||void 0===M?void 0:M.find(function(e){return"Hulpr Broda"===(null===e||void 0===e?void 0:e.service)}),O=null===M||void 0===M?void 0:M.find(function(e){return"Overnight"===(null===e||void 0===e?void 0:e.service)}),f=null===M||void 0===M?void 0:M.filter(function(e){return"Additional staff (Per Person)"===(null===e||void 0===e?void 0:e.service)}),h=null===M||void 0===M?void 0:M.find(function(e){return"Tax"===(null===e||void 0===e?void 0:e.service)});H(Object(d.a)(Object(d.a)({},Y),{},{baseRate:parseFloat(null===(i=t)||void 0===i||null===(c=i[0])||void 0===c?void 0:c[null===F||void 0===F?void 0:F.name]),tripKmRate:parseFloat(null===(o=t)||void 0===o||null===(l=o[1])||void 0===l?void 0:l[null===F||void 0===F?void 0:F.name]),waitTimeRate:{oneWayPerHour:0,twoWayPerHour:parseFloat(null===(s=t)||void 0===s||null===(r=s[2])||void 0===r?void 0:r[null===F||void 0===F?void 0:F.name])},oxygenRate:{oneWayPerLiter:"hulpr"===(null===n||void 0===n?void 0:n.oxygenSupplied)?parseFloat(null===j||void 0===j?void 0:j[null===F||void 0===F?void 0:F.name]):0,twoWayPerLiter:"hulpr"===(null===n||void 0===n?void 0:n.oxygenSupplied)?parseFloat(null===j||void 0===j?void 0:j[null===F||void 0===F?void 0:F.name]):0},wheelchairFee:{oneWay:parseFloat(null===m||void 0===m?void 0:m[null===F||void 0===F?void 0:F.name]),twoWay:2*parseFloat(null===m||void 0===m?void 0:m[null===F||void 0===F?void 0:F.name])},brodaFee:{oneWay:parseFloat(null===p||void 0===p?void 0:p[null===F||void 0===F?void 0:F.name]),twoWay:2*parseFloat(null===p||void 0===p?void 0:p[null===F||void 0===F?void 0:F.name])},overnightFee:{oneWay:parseFloat(null===O||void 0===O?void 0:O[null===F||void 0===F?void 0:F.name]),twoWay:parseFloat(null===O||void 0===O?void 0:O[null===F||void 0===F?void 0:F.name])},additionalStaffRate:{baseRate:parseFloat(null===f||void 0===f||null===(u=f[0])||void 0===u?void 0:u[null===F||void 0===F?void 0:F.name]),kmRate:parseFloat(null===f||void 0===f||null===(v=f[1])||void 0===v?void 0:v[null===F||void 0===F?void 0:F.name]),waitTime:parseFloat(null===f||void 0===f||null===(b=f[2])||void 0===b?void 0:b[null===F||void 0===F?void 0:F.name])},taxRate:parseFloat(null===h||void 0===h?void 0:h[null===F||void 0===F?void 0:F.name])/100}))}}},[F,M]),Object(a.useEffect)(function(){if(Y){var e=Object(C.a)(Q);J(e)}},[Y]);var V=Object(a.useState)([{key:"0",description:"Base Rate",input:Y.baseRate,oneWay:Y.baseRate,twoWay:2*Y.baseRate,isFixed:!0},{key:"1",description:"Trip KMs",input:0,oneWay:0,twoWay:0},{key:"2",description:"Additional staff",input:0,oneWay:0,twoWay:0},{key:"3",description:"Hulpr Wheelchair?",input:!1,oneWay:0,twoWay:0,isCheckbox:!0},{key:"4",description:"Hulpr Broda?",input:!1,oneWay:0,twoWay:0,isCheckbox:!0},{key:"5",description:"Wait Time (hrs)",input:0,oneWay:0,twoWay:0},{key:"6",description:"Oxygen L/min",input:0,oneWay:0,twoWay:0},{key:"7",description:"Overnight (2300-0500) or Holiday",input:!1,oneWay:0,twoWay:1,isCheckbox:!0}]),z=Object(u.a)(V,2),Q=z[0],G=z[1],J=function(e){var t=e.map(function(t){var n=t.isFixed?Y.baseRate:0,a=t.isFixed?2*Y.baseRate:0;if("1"===t.key)a=2*(n=(t.input-20>0?t.input-20:0)*Y.tripKmRate);else if("2"===t.key)if(t.input<=0)n=0,a=0;else{var i,c,o=parseFloat(null===e||void 0===e||null===(i=e[1])||void 0===i?void 0:i.input),l=parseFloat(null===e||void 0===e||null===(c=e[5])||void 0===c?void 0:c.input);o-20>0?o-=20:o=0,n+=parseInt(t.input)*(Y.additionalStaffRate.baseRate+Y.additionalStaffRate.kmRate*o),a+=parseInt(t.input)*(2*(Y.additionalStaffRate.baseRate+Y.additionalStaffRate.kmRate*o)+Y.additionalStaffRate.waitTime*l)}else"3"===t.key&&t.input?(n+=Y.wheelchairFee.oneWay,a+=Y.wheelchairFee.twoWay):"4"===t.key&&t.input?(n+=Y.brodaFee.oneWay,a+=Y.brodaFee.twoWay):"5"===t.key?(n+=t.input*Y.waitTimeRate.oneWayPerHour,a+=t.input*Y.waitTimeRate.twoWayPerHour):"6"===t.key?(n+=t.input*Y.oxygenRate.oneWayPerLiter,a+=t.input*Y.oxygenRate.twoWayPerLiter):"7"===t.key&&t.input&&(n+=Y.overnightFee.oneWay,a+=Y.overnightFee.twoWay);return Object(d.a)(Object(d.a)({},t),{},{oneWay:Math.round(100*n)/100,twoWay:Math.round(100*a)/100})});G(t)},K=[{title:"Description",dataIndex:"description",key:"description"},{title:"Input",dataIndex:"input",key:"input",render:function(e,t){return t.isCheckbox?Object(oa.jsx)(Xn.a,{checked:t.input,onChange:function(e){return function(e,t){var n=Object(C.a)(Q),a=n.findIndex(function(e){return t===e.key});if(a>-1){var i=n[a];n.splice(a,1,Object(d.a)(Object(d.a)({},i),{},{input:e})),G(n),J(n)}}(e.target.checked,t.key)}}):t.isFixed?void 0:Object(oa.jsx)(Qo.a,{value:e,min:0,onChange:function(e){return function(e,t,n){var a=Object(C.a)(Q),i=a.findIndex(function(e){return t===e.key});if(i>-1){var c=a[i];a.splice(i,1,Object(d.a)(Object(d.a)({},c),{},Object(T.a)({},n,e))),G(a),J(a)}}(e,t.key,"input")}})}},{title:"One-way",dataIndex:"oneWay",key:"oneWay"},{title:"Two-way",dataIndex:"twoWay",key:"twoWay"}],Z=function(){var e=Q.find(function(e){return"7"===e.key}),t=!!e&&e.input,n=t?Y.overnightFee.oneWay:1,a=(Q.reduce(function(e,t){return e+t.oneWay},0)-(t?n:0))*n,i=(Q.reduce(function(e,t){return e+t.twoWay},0)-(t?n:0))*n,c=a*Y.taxRate,o=i*Y.taxRate,l=a+c,s=i+o,r=l*I/100,d=s*I/100;return{beforeTaxOneWay:a,beforeTaxTwoWay:i,taxOneWay:c,taxTwoWay:o,afterTaxOneWay:l,afterTaxTwoWay:s,discountAmountOneWay:r,discountAmountTwoWay:d,finalOneWay:l-r,finalTwoWay:s-d}}(),X=Z.beforeTaxOneWay,ee=Z.beforeTaxTwoWay,te=Z.taxOneWay,ne=Z.taxTwoWay,ae=Z.afterTaxOneWay,ie=Z.afterTaxTwoWay,ce=Z.discountAmountOneWay,oe=Z.discountAmountTwoWay,le=Z.finalOneWay,se=Z.finalTwoWay;return Object(oa.jsxs)($n.a,{title:"Quote a client",visible:l,onCancel:function(){r(!1),t&&t()},width:"700px",className:"beam-modal",footer:[],destroyOnClose:!0,children:[Object(oa.jsxs)("div",{className:"mb-3 d-flex flex-column align-items-start",children:[Object(oa.jsx)("div",{className:"ant-col",children:Object(oa.jsx)("label",{children:"Base Location"})}),Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",value:null===F||void 0===F?void 0:F.key,placeholder:"Select base location",onChange:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var a,i,c,o,l,s;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return a=null===R||void 0===R?void 0:R.find(function(e){return(null===e||void 0===e?void 0:e.key)===t}),i=n.pickupLocation,c=n.dropoffLocation,e.n=1,W(i,c);case 1:return o=e.v,e.n=2,W({value:null===a||void 0===a?void 0:a.address},i);case 2:l=e.v,B(a),(s=Object(C.a)(Q))[1].input=(((null===o||void 0===o?void 0:o.distance)||0)+((null===l||void 0===l?void 0:l.distance)||0))/1e3,G(s);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===R||void 0===R?void 0:R.map(function(e,t){return Object(oa.jsx)(Gn.a.Option,{value:null===e||void 0===e?void 0:e.key,children:null===e||void 0===e?void 0:e.name})})})]}),Object(oa.jsxs)("div",{className:"mb-3 d-flex flex-column align-items-start",children:[Object(oa.jsx)("div",{className:"ant-col",children:Object(oa.jsx)("label",{children:"Discount (%)"})}),Object(oa.jsx)(Qo.a,{className:"w-full beam-input",style:{justifyContent:"flex-start"},value:I,placeholder:"Enter discount percentage",min:0,max:100,formatter:function(e){return"".concat(e,"%")},parser:function(e){var t=Number((e||"").toString().replace("%",""));return isNaN(t)?0:t},onChange:function(e){return S(e||0)}})]}),Object(oa.jsx)(Xi.a,{dataSource:Q,columns:K,pagination:!1,summary:function(){return Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsxs)(Xi.a.Summary.Row,{children:[Object(oa.jsx)(Xi.a.Summary.Cell,{index:0}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:1,children:"Total (before tax)"}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:2,children:X.toFixed(2)}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:3,children:ee.toFixed(2)})]}),Object(oa.jsxs)(Xi.a.Summary.Row,{children:[Object(oa.jsx)(Xi.a.Summary.Cell,{index:0}),Object(oa.jsxs)(Xi.a.Summary.Cell,{index:1,children:["HST (",100*(null===Y||void 0===Y?void 0:Y.taxRate),"%)"]}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:2,children:te.toFixed(2)}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:3,children:ne.toFixed(2)})]}),Object(oa.jsxs)(Xi.a.Summary.Row,{children:[Object(oa.jsx)(Xi.a.Summary.Cell,{index:0}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:1,children:"Total (after tax)"}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:2,children:ae.toFixed(2)}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:3,children:ie.toFixed(2)})]}),I>0&&Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsxs)(Xi.a.Summary.Row,{children:[Object(oa.jsx)(Xi.a.Summary.Cell,{index:0}),Object(oa.jsxs)(Xi.a.Summary.Cell,{index:1,children:["Discount (",I,"%)"]}),Object(oa.jsxs)(Xi.a.Summary.Cell,{index:2,children:["-",ce.toFixed(2)]}),Object(oa.jsxs)(Xi.a.Summary.Cell,{index:3,children:["-",oe.toFixed(2)]})]}),Object(oa.jsxs)(Xi.a.Summary.Row,{children:[Object(oa.jsx)(Xi.a.Summary.Cell,{index:0}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:1,children:Object(oa.jsx)("strong",{children:"Final Total"})}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:2,children:Object(oa.jsx)("strong",{children:le.toFixed(2)})}),Object(oa.jsx)(Xi.a.Summary.Cell,{index:3,children:Object(oa.jsx)("strong",{children:se.toFixed(2)})})]})]})]})}}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-4",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){i&&i({afterTaxOneWay:le||ae,afterTaxTwoWay:se||ie})},children:"Apply"})})})]})};Dc.d.register(Dc.a,Dc.j,Dc.e);var Ko=function(e){var t=e.socket,n=(e.params,e.componentUuid,e.onClose),c=Object(s.c)(function(e){return e.auth}),o=(c.selectedPage,c.encrypted_token),l=c.projects,r=(c.adminUserRoles,Object(s.b)(),Object(a.useState)([])),d=Object(u.a)(r,2),v=(d[0],d[1],Object(a.useState)([])),b=Object(u.a)(v,2);b[0],b[1];Object(a.useState)(!1);var j=Object(a.useState)(!1),p=Object(u.a)(j,2);p[0],p[1];Object(a.useState)(!1);Mn().getUserRequestPayload,Object(a.useRef)();var O=Object(a.useState)(void 0),f=Object(u.a)(O,2),h=(f[0],f[1],Object(a.useRef)(!0)),g=(Mn().updateUserRequestPayloadV2,Object(a.useState)(!0)),x=Object(u.a)(g,2),y=x[0],I=(x[1],Object(a.useState)("")),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(a.useState)(""),C=Object(u.a)(T,2),w=(C[0],C[1]),E=Object(a.useState)(!1),R=Object(u.a)(E,2),P=R[0],D=R[1],A=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return D(!0),e.n=1,M({name:N});case 1:k(""),t.publishToEvent(m.PublishPageTopics,_t(null===o||void 0===o?void 0:o.connectionId),Dn({userId:null===o||void 0===o?void 0:o.userId,cudbServiceId:(null===o||void 0===o?void 0:o.cudbServiceId)||(null===o||void 0===o?void 0:o.serviceId)})),n(!0),D(!1);case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,a){var i,c=n.name,s=[];s.push({op:"add",path:"/info",value:{type:"page:folder",name:c,page:{folder:{projectComponents:{},assignedUsers:{}}}}}),s.push({op:"replace",path:"/partitions",value:["org:".concat(null===l||void 0===l?void 0:l.userServiceId)]}),console.log("update user data",s),t.publishToEvent(m.PublishPageTopics,(i=null===o||void 0===o?void 0:o.connectionId,"".concat("beamdevlive","/connection/").concat(i,"/service/bds/createQuery")),Dn({changes:s})),t.subscribeToEvent(m.SubscribePageTopics,In(null===o||void 0===o?void 0:o.connectionId),function(t){console.log("response",t),e(!0)})}))},e)}));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)(function(){return h.current=!0,function(){h.current=!1}},[]),Object(a.useEffect)(function(){null!==l&&void 0!==l&&l.adminUserId},[l]),Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)($n.a,{title:"Add New Account",visible:y,onCancel:function(){return n(!1)},okButtonProps:{disabled:!N.trim()},className:"beam-modal",footer:[],children:Object(oa.jsxs)(ei.a,{layout:"vertical",className:"auth-form",onFinish:A,children:[Object(oa.jsx)(ei.a.Item,{label:"Name",required:!0,children:Object(oa.jsx)(Wn.a,{value:N,onChange:function(e){return k(e.target.value)},placeholder:"Enter name"})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:P,type:"primary",htmlType:"submit",onClick:function(){return w("")},children:"Save"})})})})]})})})},Zo=["value","onChange"],Xo=Wn.a.TextArea,el=Gn.a.Option;tc.a.extend(Yo.a);var tl=function(e){var t=e.value,n=void 0===t?void 0:t,i=e.onChange,c=Object(Ka.a)(e,Zo),o=Object(a.useRef)(null),l=Object(a.useState)(!1),s=Object(u.a)(l,2),r=s[0],v=s[1],b=n?H.a.isMoment(n)?n:H()(n):null;return Object(a.useEffect)(function(){var e;if(r){var t=null===(e=o.current)||void 0===e?void 0:e.querySelector("input");if(t){var n=function(){var e=t.value.replace(/[^\d]/g,"");if(8===e.length){var n="".concat(e.slice(0,4),"-").concat(e.slice(4,6),"-").concat(e.slice(6,8));if(H()(n,"YYYY-MM-DD",!0).isValid()){var a=H()(n,"YYYY-MM-DD");null===i||void 0===i||i(a.format("YYYY-MM-DD"))}}};return t.addEventListener("keyup",n),function(){t.removeEventListener("keyup",n)}}}},[r,i]),Object(oa.jsx)("div",{ref:o,children:Object(oa.jsx)(Jn.a,Object(d.a)(Object(d.a)({},c),{},{value:b,autoComplete:"on",inputReadOnly:!1,format:"YYYY-MM-DD",onChange:function(e){return null===i||void 0===i?void 0:i(e)},onOpenChange:v,style:{width:"100%"}}))})},nl=function(e){var t=Object(a.useRef)(null),n=Object(a.useState)(!1),i=Object(u.a)(n,2),c=i[0],o=i[1];return Object(a.useEffect)(function(){if(c&&t.current){var n=t.current.querySelector("input");if(n){var a=function(t){var n=t.target.value.replace(/[^\d]/g,"");if(3===n.length&&"1"!==n[0]&&"2"!==n[0]&&"0"!==n[0]&&(n="0".concat(n)),4===n.length){var a,i=n.slice(0,2),c=n.slice(2,4),o="".concat(i,":").concat(c),l=tc()(o,"HH:mm",!0);if(l.isValid())null===(a=e.onChange)||void 0===a||a.call(e,l)}};return n.addEventListener("input",a),function(){n.removeEventListener("input",a)}}}},[c,e.onChange]),Object(oa.jsx)("div",{ref:t,children:Object(oa.jsx)(Zn.a,Object(d.a)(Object(d.a)({},e),{},{format:"HH:mm",inputReadOnly:!1,allowClear:!0,onOpenChange:function(e){return o(e)}}))})},al=function(e){var t=e.value,n=void 0===t?void 0:t,a=e.onChange,i=[{id:"O/W",name:"One way"},{id:"C/R",name:"Call return"},{id:"W/R",name:"Wait return"},{id:"R/E",name:"Running Errands"}];return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",value:n,placeholder:"Select service type",onChange:function(e){a(e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===i||void 0===i?void 0:i.map(function(e,t){return Object(oa.jsx)(Gn.a.Option,{value:null===e||void 0===e?void 0:e.id,children:null===e||void 0===e?void 0:e.name})})})},il=function(e){var t=e.value,n=void 0===t?void 0:t,a=e.onChange,i=[{id:"Wheelchair Transfer",name:"Wheelchair transfer"},{id:"Electric Wheelchair Transfer",name:"Electric Wheelchair Transfer"},{id:"Stretcher Transfer",name:"Stretcher transfer"},{id:"Broda Transfer",name:"Broda transfer"}];return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select transfer type",value:n,onChange:function(e){a(e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===i||void 0===i?void 0:i.map(function(e,t){return Object(oa.jsx)(Gn.a.Option,{value:null===e||void 0===e?void 0:e.id,children:null===e||void 0===e?void 0:e.name})})})},cl=function(e){var t=e.value,n=void 0===t?[]:t,a=e.onChange;return Object(oa.jsx)(Gn.a,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Select Equipment",value:n,onChange:a,options:[{label:"Patient has Walker",value:"Has Walker"},{label:"Patient has Wheelchair",value:"Has Wheelchair"},{label:"BRING Wheelchair",value:"Bring Wheelchair"},{label:"BRING Broda",value:"bringBroda"},{label:"BRING Stair Chair",value:"Bring Stair Chair"},{label:"BRING Medical Step",value:"Bring Medical Step"}]})},ol=function(e){var t=e.value,n=void 0===t?void 0:t,a=e.onChange;return Object(oa.jsx)(Gn.a,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Select Diagnoses, precautions, notes",value:n,onChange:a,options:[{label:"Short-term memory loss",value:"shortTermMemoryLoss"},{label:"Cognitive decline",value:"cognitiveDecline"},{label:"MRSA (colonized, no wounds). Universal precautions and vehicle decon req'd.",value:"mrsa"},{label:"Contact Precautions",value:"contactPrecautions"},{label:"Airborne Precautions",value:"airbornePrecautions"},{label:"Droplet Precautions",value:"dropletPrecautions"},{label:"COVID+ Precautions, Universal precautions, PPE and N-95 mask required, Decon vehicle after transfer",value:"covidPrecautions"},{label:"Other",value:"other"}]})},ll=function(e){var t=e.value,n=void 0===t?void 0:t,a=e.onChange;return Object(oa.jsx)(Gn.a,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Select Payment Options",value:n,onChange:a,options:[{label:"Private - Email",value:"privateEmail"},{label:"Private - Credit Card (keep on file)",value:"creditCardOnFile"},{label:"Private - Credit Card (one time only)",value:"creditCardOneTime"},{label:"Private - Snail Mail",value:"snailMail"},{label:"Institutional",value:"institutional"},{label:"ODSP",value:"odsp"},{label:"Veteran Affairs",value:"veteranAffairs"},{label:"Other",value:"other"}]})},sl=function(e){var t=e.value,n=void 0===t?void 0:t,a=e.onChange,i=[{id:"kingston",name:"ODSP Kingston"},{id:"brockville",name:"ODSP Brockville"},{id:"belleville",name:"ODSP Belleville"},{id:"SmithFalls",name:"ODSP Smith Falls"}];return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select city of ODSP",onChange:a,value:n,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===i||void 0===i?void 0:i.map(function(e,t){return Object(oa.jsx)(Gn.a.Option,{value:null===e||void 0===e?void 0:e.id,children:null===e||void 0===e?void 0:e.name})})})},rl=Array.from({length:15},function(e,t){return t+1}),dl=function(e){var t=e.socket,n=e.nine11Form,c=(e.ridePageId,e.pickup),o=void 0===c||c,l=Object(a.useState)(),r=Object(u.a)(l,2),v=r[0],b=r[1],j=Object(a.useState)(!1),m=Object(u.a)(j,2),p=m[0],O=m[1],f=Object(a.useState)(),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)([]),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)([]),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(s.b)(),R=Object(s.c)(function(e){return e.auth}),P=R.projects,D=R.accounts,A=R.adminUserRoles,M=R.encrypted_token,L=function(e){E({type:Ae,payload:e})},U=function(e){return new Promise(function(t){var n={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===P||void 0===P?void 0:P.userServiceId),"'}@partitions:{type\\:location}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status",name:"$.info.fullName"}},filter:{expression:"exists(@name) && contains(@name, '".concat(null===e||void 0===e?void 0:e.toLowerCase(),"')")}};E(tt({requestData:n,callback:function(e){console.log("response here",e),t(null===e||void 0===e?void 0:e.map(function(e){return Object(d.a)(Object(d.a)({key:null===e||void 0===e?void 0:e.objectId},null===e||void 0===e?void 0:e.info),{},{action:e})}))}}))})},q=function(e){var t={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===M||void 0===M?void 0:M.userId,"}@pageType:{event}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{profile:"$..profile",ride:"$.persistent.static.ride",type:"$..persistent.static.metadata.type",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",rideType:"$..profile.type",phone:"$..profile.studentPhone",patientFullName:"$..profile.patientFullName",pickupLocationFullName:"$..profile.pickupLocationFullName",dropoffLocationFullName:"$..profile.dropoffLocationFullName"}},filter:{expression:e.join("&&")},sortBy:{properties:[{field:"@updatedAt",order:"DESC"}],max:1e3},result:{pagination:{offset:0,limit:1}}};return new Promise(function(e){E(tt({requestData:t,callback:function(t){console.log("resppnse",t);var n=[];null===t||void 0===t||t.map(function(e,t){var a,i,c,o,l,s,r,u,v,b,j,m,p,O,f,h=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),g={};(Object.keys(h).map(function(e){"string"===typeof h[e]&&(g[e]=h[e])}),null===(a=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===a||a.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"succeeded"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(O=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}),O)||(null===(f=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===f||f.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"requires_capture"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(O=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}));n.push(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",page:Object(d.a)(Object(d.a)({},e),{},{profile:h})},g),{},{address:null!==g&&void 0!==g&&g.address&&""!==(null===g||void 0===g?void 0:g.adress)?null===g||void 0===g?void 0:g.address:null===h||void 0===h||null===(i=h.pickupLocation)||void 0===i||null===(c=i.attributes)||void 0===c?void 0:c.address,dropoffAddress:null!==g&&void 0!==g&&g.dropoffAddress&&""!==(null===g||void 0===g?void 0:g.dropoffAddress)?null===g||void 0===g?void 0:g.dropoffAddress:null===h||void 0===h||null===(o=h.dropoffLocation)||void 0===o||null===(l=o.attributes)||void 0===l?void 0:l.address,invited:"",driverName:null===h||void 0===h||null===(s=h.primaryResponder)||void 0===s?void 0:s.name,driverId:null===h||void 0===h||null===(r=h.primaryResponder)||void 0===r||null===(u=r.id)||void 0===u?void 0:u.toString(),vehicleName:null===h||void 0===h||null===(v=h.vehicle)||void 0===v||null===(b=v.obj)||void 0===b?void 0:b.name,requestedAt:new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),description:(null===h||void 0===h||null===(j=h.customMessages)||void 0===j||null===(m=j[0])||void 0===m||null===(p=m.attributes)||void 0===p?void 0:p.body)||"N/A"}))}),console.log("source data",n),e(n)}}))})},F=ei.a.useWatch("weight",n),B=ei.a.useWatch("weightUnit",n);return Object(a.useEffect)(function(){if(F&&B){var e="kg"===B?2.20462*F:F;n.setFieldsValue({bariatric:e>250})}},[F,B,n]),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("div",{className:"fixed-fields-container",style:{position:"sticky",top:0,backgroundColor:"#fff",zIndex:10,padding:"16px 0",borderBottom:"1px solid #f0f0f0",marginBottom:"16px"},children:Object(oa.jsxs)(Yn.a,{gutter:16,children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(ei.a.Item,{name:"patientFirstName",label:"Patient first name",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(_o.a,{placeholder:"Enter patient first name",filterOption:!1,onSearch:i.a.useRef(function(){var e=null;return function(t){e&&clearTimeout(e),e=setTimeout(Object(_n.a)(Object(Bn.a)().m(function e(){var n;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,q(["exists(@patientFullName) && contains(@patientFullName, '".concat(null===t||void 0===t?void 0:t.toLowerCase(),"')")]);case 1:n=e.v,console.log("data",n),N(n.map(function(e){return{value:e.patientFirstName,label:"".concat(e.patientFirstName," ").concat(e.patientLastName),patient:e}}));case 2:return e.a(2)}},e)})),500)}}()).current,onSelect:function(e,t){var n;t.patient&&E({type:"SET_SELECTED_PAGE",payload:{page:null===(n=t.patient)||void 0===n?void 0:n.page,ignorePage:!0}})},options:S||[]})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(ei.a.Item,{name:"patientLastName",label:"Patient last name",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter patient last name",autoComplete:"on"})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(ei.a.Item,{name:"instructions",label:"Dispatch instructions",children:Object(oa.jsx)(Xo,{autoSize:{minRows:2,maxRows:4},placeholder:"Enter instructions"})})})]})}),Object(oa.jsx)("div",{className:"scrollable-form-content",style:{paddingTop:"0px"},children:Object(oa.jsxs)(Yn.a,{gutter:16,children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsxs)("div",{style:{paddingRight:"8px"},children:[Object(oa.jsx)("h4",{style:{marginBottom:"16px",color:"#508AFA"},children:"Patient Information"}),Object(oa.jsx)(ei.a.Item,{name:"patientPhoneNumber",label:"Patient phone number",children:Object(oa.jsx)(Fi.a,{placeholder:"Enter phone number",defaultCountry:"CA",onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{name:"patientDateOfBirth",label:"Patient's DOB (YYYY-MM-DD)",className:"mt-3",children:Object(oa.jsx)(tl,{onChange:function(e){},placeholder:"Enter DOB"})}),Object(oa.jsx)(ei.a.Item,{name:"patientHospitalId",label:"Patient's Hospital ID# (QHC)",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter patient's hospital ID#",autoComplete:"on"})}),Object(oa.jsx)(ei.a.Item,{name:"MTNumber",label:"MT/PTAC Number",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter MT/PTAC number",autoComplete:"on"})}),Object(oa.jsxs)(Yn.a,{gutter:16,children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(ei.a.Item,{name:"weight",label:"Weight",className:"mt-3",children:Object(oa.jsx)(la,{placeholder:"Enter weight",onChange:function(e){}})})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(ei.a.Item,{name:"weightUnit",label:"Unit",initialValue:"kg",className:"mt-3",children:Object(oa.jsxs)(Gn.a,{children:[Object(oa.jsx)(el,{value:"kg",children:"kg"}),Object(oa.jsx)(el,{value:"lbs",children:"lbs"})]})})})]})]})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsxs)("div",{style:{paddingRight:"8px"},children:[Object(oa.jsx)(ei.a.Item,{name:"DNRform",valuePropName:"checked",label:"DNR Form",className:"mt-3",children:Object(oa.jsx)(Xn.a,{children:"Ask nurse for DNR form"})}),Object(oa.jsx)(ei.a.Item,{name:"equipmentNeeded",label:"Equipment",className:"mt-3",children:Object(oa.jsx)(cl,{onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{label:"Oxygen (liter)",name:"oxygen",className:"mt-3",children:Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select oxygen level",onChange:function(e){},children:null===rl||void 0===rl?void 0:rl.map(function(e,t){return Object(oa.jsx)(Gn.a.Option,{value:null===e||void 0===e?void 0:e.toString(),children:e})})})}),Object(oa.jsx)(ei.a.Item,{name:"oxygenSupplied",label:"Oxygen supplied",className:"mt-3",children:Object(oa.jsxs)(yi.a.Group,{children:[Object(oa.jsx)(yi.a,{value:"patient",children:"Patient supplied oxygen"}),Object(oa.jsx)(yi.a,{value:"hulpr",children:"Hulpr supplied oxygen"})]})})]})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsxs)("div",{style:{paddingRight:"8px"},children:[Object(oa.jsx)(ei.a.Item,{name:"diagnoses",label:"Diagnoses, precautions, notes",className:"mt-3",children:Object(oa.jsx)(ol,{onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{name:"otherDiagnoses",label:"Other (Please specify)",className:"mt-3",children:Object(oa.jsx)(Xo,{rows:4,placeholder:"Enter other diagnoses"})}),Object(oa.jsx)(ei.a.Item,{name:"escorts",label:"Escorts/ passengers",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter escorts/ passengers"})}),Object(oa.jsx)(ei.a.Item,{label:"Has the patient used our service before?",name:"usedServiceBefore",className:"mt-3",children:Object(oa.jsxs)(yi.a.Group,{children:[Object(oa.jsx)(yi.a,{value:"yes",children:"Yes"}),Object(oa.jsx)(yi.a,{value:"no",children:"No"}),Object(oa.jsx)(yi.a,{value:"hospitalContractCall",children:"Hospital Contract Call"})]})})]})})]})}),Object(oa.jsx)("div",{className:"scrollable-form-content",style:{paddingTop:"26px"},children:Object(oa.jsxs)(Yn.a,{gutter:16,children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsxs)("div",{style:{paddingRight:"8px"},children:[Object(oa.jsx)("h4",{style:{marginBottom:"16px",color:"#508AFA"},children:"Service & Location Details"}),Object(oa.jsx)(ei.a.Item,{name:"serviceType",label:"Service type",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(al,{onChange:function(e){x(e)}})}),Object(oa.jsx)(ei.a.Item,{name:"transferType",label:"Transfer type",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(il,{onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{name:"pickupLocationName",label:"Pickup location name",className:"mt-3",children:Object(oa.jsx)(_o.a,{placeholder:"Enter pickup location name",filterOption:!1,onSearch:i.a.useRef(function(){var e=null;return function(t){e&&clearTimeout(e),e=setTimeout(Object(_n.a)(Object(Bn.a)().m(function e(){var n;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,U(t);case 1:n=e.v,w(n.map(function(e){return{value:e.name,label:e.name,location:e.location}}));case 2:return e.a(2)}},e)})),500)}}()).current,onSelect:function(e,t){t.location&&n.setFieldsValue({pickupLocation:t.location,pickupLocationName:e})},options:C||[]})}),Object(oa.jsx)(ei.a.Item,{label:"Pickup address",name:"pickupLocation",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(ai,{placeholder:"Enter pickup address",onChange:function(e){L({pickupLocation:e})}})}),Object(oa.jsx)(ei.a.Item,{name:"pickupDoorCode",label:"Pickup door code",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter pickup door code",autoComplete:"off"})}),Object(oa.jsx)(ei.a.Item,{name:"pickupEntranceUnitRoom",label:"Pickup entrance, unit, room #",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter pickup entrance, unit, room #",autoComplete:"off"})}),Object(oa.jsx)(ei.a.Item,{name:"pickupInstructions",label:"Pickup Instructions",className:"mt-3",children:Object(oa.jsx)(Xo,{rows:4,placeholder:"Enter pickup instructions"})})]})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsxs)("div",{style:{paddingRight:"8px"},children:[Object(oa.jsx)(ei.a.Item,{name:"dropoffLocationName",label:"Dropoff location name",className:"mt-3",children:Object(oa.jsx)(_o.a,{placeholder:"Enter dropoff location name",filterOption:!1,onSearch:i.a.useRef(function(){var e=null;return function(t){e&&clearTimeout(e),e=setTimeout(Object(_n.a)(Object(Bn.a)().m(function e(){var n;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,U(t);case 1:n=e.v,w(n.map(function(e){return{value:e.name,label:e.name,location:e.location}}));case 2:return e.a(2)}},e)})),500)}}()).current,onSelect:function(e,t){t.location&&n.setFieldsValue({dropoffLocation:t.location,dropoffLocationName:e})},options:C||[]})}),Object(oa.jsx)(ei.a.Item,{label:"Dropoff address",name:"dropoffLocation",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(ai,{placeholder:"Enter dropoff address",onChange:function(e){L({dropoffLocation:e})}})}),Object(oa.jsx)(ei.a.Item,{name:"dropoffDoorCode",label:"Dropoff door code",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter dropoff door code",autoComplete:"off"})}),Object(oa.jsx)(ei.a.Item,{name:"dropoffEntranceUnitRoom",label:"Dropoff entrance, unit, room #",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter dropoff entrance, unit, room #",autoComplete:"off"})}),Object(oa.jsx)(ei.a.Item,{name:"dropoffInstructions",label:"Dropoff Instructions",className:"mt-3",children:Object(oa.jsx)(Xo,{rows:4,placeholder:"Enter dropoff instructions"})})]})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsxs)("div",{style:{paddingRight:"8px"},children:[o&&Object(oa.jsx)(ei.a.Item,{name:"pickupDate",label:"Pickup date",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(tl,{onChange:function(e){},disabledDate:function(e){return e&&e<tc()().startOf("day")},placeholder:"Enter pickup date"})}),Object(oa.jsx)(ei.a.Item,{name:"pickupTime",label:"Pickup time",className:"mt-3",children:Object(oa.jsx)(nl,{format:"HH:mm",placeholder:"Enter pickup time",autoComplete:"off"})}),Object(oa.jsx)(ei.a.Item,{name:"appointmentTime",label:"Appointment time",className:"mt-3",children:Object(oa.jsx)(nl,{format:"HH:mm",placeholder:"Enter appointment time",autoComplete:"off"})}),"O/W"!==g&&Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{name:"waitTime",label:"Wait time (mins)",className:"mt-3",children:Object(oa.jsx)(la,{onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{name:"returnPickupTime",label:"Return pickup time",className:"mt-3",children:Object(oa.jsx)(nl,{format:"HH:mm",placeholder:"Enter return pickup time",autoComplete:"off"})})]})]})})]})}),Object(oa.jsx)("div",{className:"scrollable-form-content",style:{paddingTop:"26px"},children:Object(oa.jsxs)(Yn.a,{gutter:16,children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsxs)("div",{style:{paddingRight:"8px"},children:[Object(oa.jsx)("h4",{style:{marginBottom:"16px",color:"#508AFA"},children:"Billing & Assignment"}),Object(oa.jsxs)(Yn.a,{gutter:16,children:[Object(oa.jsx)(Hn.a,{span:21,children:Object(oa.jsx)(ei.a.Item,{label:"Billing institute",name:"billingInstitute",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select account",onChange:function(e){},children:(null!==D&&void 0!==D?D:[]).slice().sort(function(e,t){var n,a,i,c,o=(null===(n=e.info)||void 0===n||null===(a=n.name)||void 0===a?void 0:a.toLowerCase())||"",l=(null===(i=t.info)||void 0===i||null===(c=i.name)||void 0===c?void 0:c.toLowerCase())||"";return o<l?-1:o>l?1:0}).map(function(e,t){var n;return Object(oa.jsx)(Gn.a.Option,{value:null===(n=e.objectId)||void 0===n?void 0:n.toString(),children:e.info.name},e.objectId)})})})}),Object(oa.jsx)(Hn.a,{span:3,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2 w-100",style:{marginTop:30},onClick:function(){O(!0)},children:"Add"})})]}),Object(oa.jsx)(ei.a.Item,{label:"Billing email",name:"billingEmail",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter email",autoComplete:"email",onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{label:"Billing phone number",name:"billingPhoneNumber",className:"mt-3",children:Object(oa.jsx)(Fi.a,{placeholder:"Enter billing phone number",defaultCountry:"CA",onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{name:"billingType",label:"Billing Type",className:"mt-3",children:Object(oa.jsx)(ll,{onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{name:"otherBilling",label:"Other (Please specify)",className:"mt-3",children:Object(oa.jsx)(Xo,{rows:4,placeholder:"Enter other billing"})}),Object(oa.jsx)(ei.a.Item,{name:"insitutionIdForBilling",label:"Institution ID for Billing",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter institution ID for billing"})}),Object(oa.jsx)(ei.a.Item,{name:"pricingType",label:"Pricing type",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(Wo,{placeholder:"Select pricing type",onChange:function(e){},socket:t})}),Object(oa.jsxs)(Yn.a,{gutter:16,children:[Object(oa.jsx)(Hn.a,{span:21,children:Object(oa.jsx)(ei.a.Item,{label:"Quoted price",name:"quotedPrice",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter price",autoComplete:"off"})})}),Object(oa.jsx)(Hn.a,{span:3,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2 w-100",style:{marginTop:45},onClick:function(){var e=n.getFieldsValue();b(e)},children:"Quote"})})]})]})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsxs)("div",{style:{paddingRight:"8px"},children:[Object(oa.jsxs)(Yn.a,{gutter:16,children:[Object(oa.jsx)(Hn.a,{span:20,children:Object(oa.jsx)(ei.a.Item,{name:"confirmationNumber",label:"Confirmation #",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter confirmation #"})})}),Object(oa.jsx)(Hn.a,{span:4,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2 w-100",style:{marginTop:45},onClick:function(){var e=Math.floor(1e6*Math.random()),t="HU".concat(e.toString().padStart(6,"0"));n.setFieldsValue({confirmationNumber:t})},children:"Generate"})})]}),Object(oa.jsx)(ei.a.Item,{name:"cityOdsp",label:"City of ODSP",className:"mt-3",children:Object(oa.jsx)(sl,{onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{name:"bookingClerk",label:"Booking Clerk Name",className:"mt-3",children:Object(oa.jsx)(Xo,{rows:4,placeholder:"Enter booking clerk name"})}),Object(oa.jsx)(ei.a.Item,{name:"requestedBy",label:"Requested by name & ext. (QHC)",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter requested by name"})}),Object(oa.jsx)(ei.a.Item,{name:"careHomeName",label:"Care home name",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter care home name"})}),Object(oa.jsx)(ei.a.Item,{name:"primaryHomeAddress",label:"Primary (Home) address",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter primary home name"})}),Object(oa.jsx)(ei.a.Item,{label:"Additional contact",name:"additionalContact",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter additional contact information"})}),Object(oa.jsx)(ei.a.Item,{label:"Support worker / Case worker contact",name:"supportWorkerContact",className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter support worker contact information"})})]})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsxs)("div",{style:{paddingRight:"8px"},children:[Object(oa.jsx)(ei.a.Item,{label:"Vehicle",name:"vehicle",className:"mt-3",children:Object(oa.jsx)(zc,{placeholder:"Select vehicle",vehicleId:!0,onChange:function(e){},socket:t})}),A&&A.length>0&&Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{name:"primaryResponder",label:"Primary Responder",className:"mt-3",children:Object(oa.jsx)(fi,{placeholder:"Select primary responder",adminRoles:A,onChange:function(e){},multiple:!1})}),Object(oa.jsx)(ei.a.Item,{name:"secondaryResponder",label:"Secondary Responders",className:"mt-3",children:Object(oa.jsx)(fi,{placeholder:"Select secondary responders",adminRoles:A,onChange:function(e){},multiple:!0})})]}),Object(oa.jsx)(ei.a.Item,{name:"equipment",label:"Equipment",className:"mt-3",children:Object(oa.jsx)(zo,{placeholder:"Select equipment",onChange:function(e){},socket:t})}),Object(oa.jsx)(ei.a.Item,{name:"sharePassengerLink",valuePropName:"checked",className:"mt-3",children:Object(oa.jsx)(Xn.a,{children:"Do you want to share link with patient?"})})]})})]})}),p&&Object(oa.jsx)(Ko,{onClose:function(e){O(!1)},socket:t}),void 0!==v&&Object(oa.jsx)(Jo,{onClose:function(){b(void 0)},onApply:function(e){var t,a,i=n.getFieldValue("serviceType");"O/W"===i&&n.setFieldsValue({quotedPrice:null===e||void 0===e||null===(t=e.afterTaxOneWay)||void 0===t?void 0:t.toFixed(2)}),"C/R"!==i&&"W/R"!==i||n.setFieldsValue({quotedPrice:null===e||void 0===e||null===(a=e.afterTaxTwoWay)||void 0===a?void 0:a.toFixed(2)}),b(void 0)},values:v,socket:t})]})},ul=(Wn.a.TextArea,function(e){var t=e.onClose,n=e.socket,i=Object(a.useState)(!0),c=Object(u.a)(i,2),o=c[0],l=c[1],r=Object(a.useState)(""),d=Object(u.a)(r,2),v=(d[0],d[1],ei.a.useForm()),b=Object(u.a)(v,1)[0],j=Object(a.useState)(""),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)(!1),g=Object(u.a)(h,2),x=g[0],y=(g[1],Object(a.useState)("email")),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(s.c)(function(e){return e.auth}),T=k.encrypted_token,C=k.projects,w=(Object(s.b)(),function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(a){var i,c,o,s;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(i=a.email,c=a.phone,o=a.nickname,f(""),i||c){e.n=1;break}return f("Please enter email or phone number"),e.a(2);case 1:s=[],i&&s.push({email:i}),c&&s.push({phone:c}),n.publishToEvent(m.PublishPageTopics,Zt(null===T||void 0===T?void 0:T.connectionId),Dn({userId:null===T||void 0===T?void 0:T.userId,notificationChannels:{email:i,phone:c},nickname:o,cudbServiceId:null===C||void 0===C?void 0:C.userServiceId})),l(!1),t&&t(),Lt("Link shared successfully","success","TOP_CENTER",1e3);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());return Object(oa.jsx)($n.a,{title:"Share dispatch",visible:o,onCancel:function(){l(!1),t&&t()},width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:b,onFinish:w,requiredMark:!1,children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{onClick:function(){N("email")},className:"beam-btn ".concat("email"===S?"green-btn cover":""),children:"Email"})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{onClick:function(){N("phone")},className:"beam-btn ".concat("phone"===S?"green-btn cover":""),children:"Phone"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-4 mb-4",children:Object(oa.jsxs)(Hn.a,{span:24,children:["email"===S&&Object(oa.jsx)(ei.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid Email!"},{required:!0,message:"**Required field"}],children:Object(oa.jsx)(Wn.a,{type:"email",placeholder:"Email"})}),"phone"===S&&Object(oa.jsx)(ei.a.Item,{name:"phone",rules:[{required:!0,message:"**Required field"}],children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:"Phone number (include +)"})}),O&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:O})})]})}),Object(oa.jsx)(Yn.a,{className:"action-grp",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:x,type:"primary",htmlType:"submit",onClick:function(){return f("")},children:"Invite"})})})})]})})}),vl=n(178),bl=n(539),jl=n(1027),ml=n(1028),pl=n(0),Ol=Gn.a.Option,fl=function(e){var t,n,i=e.value,c=e.onChange,o=e.rowIndex,l=e.allProjects,r=Object(a.useState)([]),v=Object(u.a)(r,2),b=v[0],j=v[1],m=Object(a.useState)([]),p=Object(u.a)(m,2),O=(p[0],p[1]),f=Object(s.c)(function(e){return e.auth}).projects;return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select task",value:null===i||void 0===i||null===(t=i.tasks)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.id,onChange:function(e){var t=b.find(function(t){return t.id===e});c({type:"task-picker",tasks:[t]})},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},onFocus:function(){var e,t,n,a,i,c=(null===f||void 0===f||null===(e=f.tasks)||void 0===e||null===(t=e[0])||void 0===t?void 0:t[0])||{},s=null===f||void 0===f?void 0:f.projects.find(function(e){var t,n;return e.id===(null===l||void 0===l||null===(t=l.current)||void 0===t||null===(n=t[o])||void 0===n?void 0:n.project)}),r=null===(n=Object.keys(c))||void 0===n?void 0:n.find(function(e){return(null===s||void 0===s?void 0:s.taskId)===e}),u=null!==(a=null===c||void 0===c||null===(i=c[r])||void 0===i?void 0:i.subTasks)&&void 0!==a?a:{};j(Object.keys(u).map(function(e){return Object(d.a)({id:e},u[e])})),O([])},children:null===b||void 0===b?void 0:b.map(function(e,t){return Object(oa.jsx)(Ol,{value:e.id,children:e.name})})})};Object(pl.hb)("Mgo+DSMBaFt/QHRqVVhkVFpFdEBBXHxAd1p/VWJYdVt5flBPcDwsT3RfQF5jSn5bdkNhX3xbeH1UQA==;Mgo+DSMBPh8sVXJ0S0J+XE9AflRDX3xKf0x/TGpQb19xflBPallYVBYiSV9jS31TdUVrWXlcdndQT2FZVw==;ORg4AjUWIQA/Gnt2VVhkQlFacldJXGFWfVJpTGpQdk5xdV9DaVZUTWY/P1ZhSXxQdkZjUX9YcnJWQ2lfVEI=;MTI3OTc4NUAzMjMwMmUzNDJlMzBFYkNEeXZCNEppU3FkZkZNYks1V0loTzlaajdjLyttcStERE1Sc0VERlhzPQ==;MTI3OTc4NkAzMjMwMmUzNDJlMzBIdW4xM1NDVm5tcTB1Q2tEdk9NNkVsallXeE9mYU5xWTZXU2lwYkJzMjRzPQ==;NRAiBiAaIQQuGjN/V0Z+WE9EaFtKVmJLYVB3WmpQdldgdVRMZVVbQX9PIiBoS35RdUVgWXdednZTRWZcUkJw;MTI3OTc4OEAzMjMwMmUzNDJlMzBFRGJlZVhDZjJmRE1mYWNsRXZsTkQxeGNlOUtJOWFzU0RORVVhMHJzdFp3PQ==;MTI3OTc4OUAzMjMwMmUzNDJlMzBqNUw3TXlZWUhrTS9VenErVW1qbWgxUjg1R04rSEtYcTgveTRRT3Uvdkw4PQ==;Mgo+DSMBMAY9C3t2VVhkQlFacldJXGFWfVJpTGpQdk5xdV9DaVZUTWY/P1ZhSXxQdkZjUX9YcnJWQGFeVEI=;MTI3OTc5MUAzMjMwMmUzNDJlMzBIL3I3R0FkZU0vbG96eXRFbmhXeTRpZEdiblhEMFdMYi82R1RrUEZxTXFFPQ==;MTI3OTc5MkAzMjMwMmUzNDJlMzBZTlo1YlRXUXBLWnNYYjBaZGtTS2NicTQzbURmSCtybGFlS1psSU85emlRPQ==;MTI3OTc5M0AzMjMwMmUzNDJlMzBFRGJlZVhDZjJmRE1mYWNsRXZsTkQxeGNlOUtJOWFzU0RORVVhMHJzdFp3PQ==");var hl,gl=Gn.a.Option,xl=function(e){e.onClose;var t=e.adminRoles,n=e.accounts,i=(e.onSubmitHandler,e.socket),c=Object(a.useRef)(),o=Object(a.useRef)(!1),r=(Object(l.g)().search,Object(l.f)(),Object(s.c)(function(e){return e.auth.projects},function(e,t){return JSON.stringify(e)===JSON.stringify(t)})),d=Object(a.useRef)({}),u=["passengerName","passengerPhoneNumber","passengerEmail","emergencyContactNumber","account","pickupLocation","pickupFacilityName","pickupRoomNumber","dropoffLocation","dropoffFacilityName","dropoffRoomNumber","dispatch","dropoffDate","dropoffTime","pickupWaitTime","rideType","vehicleType","vehicle","numberOfPeople","instructions","medicalCondition","transportNeeds","currentMedications","mobilityStatus","levelOfCare","additionalEquipment","isAccompanied"],v=function(e){var t,n;return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select project",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.project,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].project=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===r||void 0===r||null===(n=r.projects)||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(gl,{value:e.id,children:e.name})})})},b=function(e){var t;return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select account",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.account,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].account=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===n||void 0===n?void 0:n.map(function(e,t){var n;return Object(oa.jsx)(Gn.a.Option,{value:null===(n=e.objectId)||void 0===n?void 0:n.toString(),children:e.info.name})})})},j=function(e){var t;return Object(oa.jsx)(Wc,{placeholder:"Select vehicle type",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.vehicleType,onChange:function(t){var n;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].vehicleType=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.value)||void 0===n?void 0:n.toString()},null===e||void 0===e?void 0:e.address)},socket:i})},m=function(e){var t,n;return Object(oa.jsx)(zc,{placeholder:"Select vehicle",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.vehicle,onChange:function(t){var n;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].vehicle=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.value)||void 0===n?void 0:n.toString()},null===e||void 0===e?void 0:e.address)},vehicleType:null===(n=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===n?void 0:n.vehicleType,socket:i})},p=function(e){var t;console.log("schedule select",e);var n=[{id:"immediate",name:"Immediate"},{id:"schedule",name:"Schedule"}];return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select dispatch type",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.dispatchType,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].dispatchType=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===n||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(gl,{value:e.id,children:e.name})})})},O=function(e){var t;return Object(oa.jsx)(fl,{placeholder:"Select task",rowIndex:null===e||void 0===e?void 0:e.rowIndex,allProjects:d,value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.task,onChange:function(t){var n,a;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].task=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.task)||void 0===n||null===(a=n.id)||void 0===a?void 0:a.toString()},null===e||void 0===e?void 0:e.address)}})},f=function(e){var t;return Object(oa.jsx)("div",{className:"datetime-item",children:Object(oa.jsx)(di,{placeholder:"Select date",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.date,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].date=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)}})})},h=function(e){var t;return Object(oa.jsx)(gi,{name:"Select time",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.time,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].time=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)}})},g=function(e){var t;return Object(oa.jsx)(ai,{placeholder:"Select location",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t[null===e||void 0===e?void 0:e.locationType],onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex][null===e||void 0===e?void 0:e.locationType]=t}})},x=function(e){var n;return Object(oa.jsx)(fi,{placeholder:"Select responder",adminRoles:t,value:null===(n=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===n?void 0:n.responder,onChange:function(t){var n,a,i;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].responder=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.responders)||void 0===n||null===(a=n[0])||void 0===a||null===(i=a.id)||void 0===i?void 0:i.toString()},null===e||void 0===e?void 0:e.address)}})},y=function(e){var t;return Object(oa.jsx)(ji,{placeholder:"Select location",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.location,onChange:function(t){var n,a,i,c,o,l,s;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].location=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.asset)||void 0===n?void 0:n.name},null===e||void 0===e?void 0:e.address),null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(a=t.asset)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c[1]},Object(bl.b)(null===e||void 0===e?void 0:e.rowIndex,1)),null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(o=t.asset)||void 0===o||null===(l=o.location)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s[0]},Object(bl.b)(null===e||void 0===e?void 0:e.rowIndex,2))}})},I=function(){var e=[];return u.forEach(function(t){e.push({label:t,type:t})}),e};return Object(oa.jsx)("div",{className:"control-pane",children:Object(oa.jsx)("div",{className:"control-section spreadsheet-control",style:{height:"calc(100vh - 110px)"},children:Object(oa.jsx)(jl.a,{height:"100%",allowDelete:!1,allowOpen:!0,openUrl:"https://ej2services.syncfusion.com/production/web-services/api/spreadsheet/open",openComplete:function(){for(var e=c.current.sheets,t=function(){c.current.sheets[n].name,Object(bl.c)([0,0,e[n].usedRange.rowIndex,e[n].usedRange.colIndex]);var t=I(),a=[];t.map(function(e,t){"project"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return v({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"dispatch"===(null===e||void 0===e?void 0:e.type)||"dispatch"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return p({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"account"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return b({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"vehicleType"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return j({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"vehicle"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return m({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"responder"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return x({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"fixed-asset"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return y({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"task-picker"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return O({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"date"===(null===e||void 0===e?void 0:e.type)||"dropoffDate"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return f({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"time"===(null===e||void 0===e?void 0:e.type)||"dropoffTime"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){c.current.updateRange({template:function(){return h({address:Object(bl.b)(e+1,t),spreadsheet:c,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"pickupLocation"!==(null===e||void 0===e?void 0:e.type)&&"dropoffLocation"!==(null===e||void 0===e?void 0:e.type)||a.map(function(n){c.current.updateRange({template:function(){return g({address:Object(bl.b)(n+1,t),spreadsheet:c,rowIndex:n+1,locationType:null===e||void 0===e?void 0:e.type})},address:Object(bl.b)(n+1,t)})})}),setTimeout(function(){c.current.setRowsHeight(50),c.current.setColumnsWidth(150),o.current||(c.current.addFileMenuItems([{text:"Insert row",iconCss:"e-icons e-plus"}],"Open"),o.current=!0)},100)},n=0;n<e.length;n++)t()},allowSave:!0,saveUrl:"https://ej2services.syncfusion.com/production/web-services/api/spreadsheet/save",ref:function(e){c.current=e},created:function(){hl&&clearTimeout(hl),hl=setTimeout(function(){c.current.addFileMenuItems([{text:"Submit",iconCss:"e-icons e-save-2"}],"Open")},1e3)},fileMenuItemSelect:function(e){switch(e.item.text){case"Insert row":var t=I(),n=c.current.sheets[0].usedRange.rowIndex;c.current.insertRow(n),t.map(function(e,t){"project"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return v({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"dispatch"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return p({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"account"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return b({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"vehicleType"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return j({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"vehicle"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return m({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"responder"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return x({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"fixed-asset"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return y({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"task-picker"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return O({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"date"===(null===e||void 0===e?void 0:e.type)||"dropoffDate"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return f({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"time"===(null===e||void 0===e?void 0:e.type)||"dropoffTime"===(null===e||void 0===e?void 0:e.type)?c.current.updateRange({template:function(){return h({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n})},address:Object(bl.b)(n,t)}):"pickupLocation"!==(null===e||void 0===e?void 0:e.type)&&"dropoffLocation"!==(null===e||void 0===e?void 0:e.type)||c.current.updateRange({template:function(){return g({address:Object(bl.b)(n,t),spreadsheet:c,rowIndex:n,locationType:null===e||void 0===e?void 0:e.type})},address:Object(bl.b)(n,t)})}),setTimeout(function(){c.current.setRowsHeight(53),c.current.setColumnsWidth(150)},100);break;case"Submit":c.current.saveAsJson().then(function(e){var t,n,a,i,c,o=[];console.log("save",e,d);var l=null!==(t=null===e||void 0===e||null===(n=e.jsonObject)||void 0===n||null===(a=n.Workbook)||void 0===a||null===(i=a.sheets)||void 0===i||null===(c=i[0])||void 0===c?void 0:c.rows)&&void 0!==t?t:[],s=I();console.log("selected value current",d.current),Object.keys(d.current).map(function(e){var t,n=null===l||void 0===l||null===(t=l[e])||void 0===t?void 0:t.cells,a={};s.map(function(t,i){var c,o,l;if(a[t.label]=null===n||void 0===n||null===(c=n[i])||void 0===c?void 0:c.value,"project"===t.type)a[t.label]=null===(o=d.current)||void 0===o||null===(l=o[e])||void 0===l?void 0:l.project;else if("fixed-asset"===t.type){var s,r;a[t.label]=null===(s=d.current)||void 0===s||null===(r=s[e])||void 0===r?void 0:r.location}else if("responder"===t.type){var u,v;a[t.label]=null===(u=d.current)||void 0===u||null===(v=u[e])||void 0===v?void 0:v.responder}else if("task-picker"===t.type){var b,j;a[t.label]=null===(b=d.current)||void 0===b||null===(j=b[e])||void 0===j?void 0:j.task}else if("date"===t.type){var m,p;a[t.label]=null===(m=d.current)||void 0===m||null===(p=m[e])||void 0===p?void 0:p.date}else if("time"===t.type){var O,f;a[t.label]=null===(O=d.current)||void 0===O||null===(f=O[e])||void 0===f?void 0:f.time}else if("account"===t.type){var h,g;a[t.label]=null===(h=d.current)||void 0===h||null===(g=h[e])||void 0===g?void 0:g.account}else if("vehicleType"===t.type){var x,y;a[t.label]=null===(x=d.current)||void 0===x||null===(y=x[e])||void 0===y?void 0:y.vehicleType}else if("vehicle"===t.type){var I,S;a[t.label]=null===(I=d.current)||void 0===I||null===(S=I[e])||void 0===S?void 0:S.vehicle}else if("pickupLocation"===t.type||"dropoffLocation"===t.type){var N,k;a[t.label]=null===(N=d.current)||void 0===N||null===(k=N[e])||void 0===k?void 0:k[t.type]}else if("dispatch"===t.type){var T,C,w,E,R,P;a.dispatch={value:null===(T=d.current)||void 0===T||null===(C=T[e])||void 0===C?void 0:C.dispatchType,type:"dispatchType",date:null===(w=d.current)||void 0===w||null===(E=w[e])||void 0===E?void 0:E.date,time:null===(R=d.current)||void 0===R||null===(P=R[e])||void 0===P?void 0:P.time}}}),delete a.dropoffDate,delete a.dropoffTime,o.push(a)}),o.map(function(t){return console.log("obj here",t),e})})}},children:Object(oa.jsx)(ml.b,{children:Object(oa.jsx)(ml.a,{name:"Event form",rowCount:40,colCount:30,showGridLines:!0})})})})})},yl=(Gn.a.Option,function(e){var t=e.onClose,n=e.adminRoles,i=e.onSubmitHandler,c=e.accounts,o=e.socket,r=Object(a.useState)(!0),d=Object(u.a)(r,2),v=d[0],b=d[1],j=Object(a.useState)(!1),m=Object(u.a)(j,2),p=(m[0],m[1]),O=Object(a.useState)(),f=Object(u.a)(O,2),h=f[0],g=(f[1],Object(a.useState)()),x=Object(u.a)(g,2),y=(x[0],x[1],Object(s.c)(function(e){return e.auth})),I=y.projects,S=y.csvToSend,N=(Object(s.c)(function(e){return e.auth}).userBds,Object(a.useState)()),k=Object(u.a)(N,2),T=k[0],C=(k[1],Object(l.g)().search),w=Object(s.b)();return Object(a.useEffect)(function(){p(!1)},[S]),Object(oa.jsx)($n.a,{title:"Bulk creator",visible:v,onOk:function(){var e=new URLSearchParams(C).get("userId"),t={};null===I||void 0===I||I.sections.forEach(function(e){return e.Rows.forEach(function(e){e.Cols.forEach(function(e){"location"===(null===e||void 0===e?void 0:e.type)||null!==e&&void 0!==e&&e.type.includes("location")?(t["".concat(null===e||void 0===e?void 0:e.name,"-lat")]="",t["".concat(null===e||void 0===e?void 0:e.name,"-long")]=""):t[null===e||void 0===e?void 0:e.name]=""})})});var n=new FormData;n.append("file",h),n.append("projectId",JSON.stringify(T)),n.append("dispatcherUserId",JSON.stringify(e)),n.append("isExecute",JSON.stringify(!0)),n.append("adminUser",JSON.stringify({cudbServiceId:null===I||void 0===I?void 0:I.userServiceId})),n.append("basicFieldsName",JSON.stringify({title:"","location-lat":"","location-long":""})),n.append("extendedFieldsName",JSON.stringify(t)),w(Ie({form:n})),p(!0)},onCancel:function(){b(!1),t&&t()},width:"100%",className:"beam-modal analytics-summary-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsx)(xl,{adminRoles:n,onSubmitHandler:i,accounts:c,socket:o})})});gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us"),tc.a.extend(Yo.a);Wn.a.TextArea,Gn.a.Option;var Il=function(e){var t,n,i,c,o,r,v,b=e.socket,j=e.params,p=e.fullScreen,O=e.scale,f=(e.componentUuids,e.toggleDispatch),h=ei.a.useForm(),g=Object(u.a)(h,1)[0],x=Object(a.useState)(""),y=Object(u.a)(x,2),I=y[0],S=y[1],N=j.screens,k=j.setScreens,T=Object(l.g)().search,C=Object(l.f)(),w=Object(s.c)(function(e){return e.auth}),E=w.projects,R=w.accounts,P=(w.adminUserRoles,Object(s.b)()),D=Object(s.c)(function(e){return e.auth}),A=(D.selectedResponders,D.submitted),M=D.page,L=D.encrypted_token,U=D.selectedPickup,q=(D.standLocations,D.selectedPage),F=Object(a.useState)(!1),B=Object(u.a)(F,2),_=B[0],Y=B[1],V=Object(a.useState)(!1),Q=Object(u.a)(V,2),G=(Q[0],Q[1]),J=Object(a.useState)(void 0),K=Object(u.a)(J,2),Z=K[0],ee=K[1],te=Object(a.useState)(void 0),ne=Object(u.a)(te,2),ae=ne[0],ie=ne[1],ce=(Mn().getUserRequestPayload,Object(a.useRef)(W())),oe=Object(a.useState)(),le=Object(u.a)(oe,2),se=(le[0],le[1]),re=Object(a.useState)(),de=Object(u.a)(re,2),ue=(de[0],de[1]),ve=Object(a.useState)(),be=Object(u.a)(ve,2),je=(be[0],be[1],Object(a.useState)()),me=Object(u.a)(je,2),pe=(me[0],me[1],Object(a.useState)(void 0)),Oe=Object(u.a)(pe,2),fe=Oe[0],he=Oe[1],ge=Object(a.useState)(void 0),xe=Object(u.a)(ge,2),ye=xe[0],Ie=xe[1],Se=Object(a.useState)(void 0),Ne=Object(u.a)(Se,2),ke=Ne[0],Te=Ne[1],Ce=Object(a.useState)(!1),we=Object(u.a)(Ce,2),Ee=we[0],Re=we[1],Pe=Object(a.useState)(),Me=Object(u.a)(Pe,2),Le=(Me[0],Me[1]),Fe=Object(a.useState)(!1),Be=Object(u.a)(Fe,2),_e=Be[0],$e=Be[1],Ye=Object(a.useRef)(!0),He=Object(a.useState)(!1),We=Object(u.a)(He,2),Ve=(We[0],We[1]),ze=Object(a.useRef)({pickup:void 0,dropoff:void 0}),Qe=Object(a.useState)(!1),Ge=Object(u.a)(Qe,2),Je=Ge[0],Ke=Ge[1],Ze=Object(a.useState)(!1),Xe=Object(u.a)(Ze,2),et=Xe[0],nt=Xe[1],at=Object(a.useState)(!1),it=Object(u.a)(at,2),ct=it[0],ot=it[1],lt=Object(a.useState)(!1),st=Object(u.a)(lt,2),rt=st[0],dt=st[1],ut=function(e){return new Promise(function(t){var n={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===E||void 0===E?void 0:E.userServiceId),"'}@partitions:{type\\:location}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status",name:"$.info.fullName"}},filter:{expression:"exists(@name) && contains(@name, '".concat(null===e||void 0===e?void 0:e.toLowerCase(),"')")}};P(tt({requestData:n,callback:function(e){console.log("response here",e),t(null===e||void 0===e?void 0:e.map(function(e){return Object(d.a)(Object(d.a)({key:null===e||void 0===e?void 0:e.objectId},null===e||void 0===e?void 0:e.info),{},{action:e})}))}}))})},vt=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:console.log("values",t),a={name:t.name,fullName:null===(n=t.name)||void 0===n?void 0:n.toLowerCase(),location:t.location,address:t.location.label},G(!0),i=[{op:"add",path:"/partitions",value:["org:".concat((null===L||void 0===L?void 0:L.cudbServiceId)||(null===L||void 0===L?void 0:L.serviceId)),"type:location"]},{op:"add",path:"/createdAt",value:(new Date).getTime()},{op:"add",path:"/info",value:a}],console.log("custom changes",i),b.publishToEvent(m.PublishPageTopics,rn(null===L||void 0===L?void 0:L.connectionId),Dn({changes:i}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),bt=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,o,l,s,r,u,v,j,p,O,f,h,g,x,y,I,N,k,T,C,w,P,D,A,M,U,F,B,_,W,V,z,Q,G,J,K,ee,te,ne,ae,ie,ce,oe,le,se,re,de,ue,ve,be,je,me,pe,Oe,fe,he,ge,xe,ye,Ie,Se,Ne,ke,Te,Ce,we,Ee,Re,Pe,De,Ae,Me,Le,Ue,qe,Fe,Be,_e,$e,He,We,Ve,ze,Qe,Ge,Je,Ke,Ze,Xe;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("values here",t),J=null===L||void 0===L?void 0:L.userId,K=Z,ee=null===L||void 0===L?void 0:L.connectionId,t[void 0]&&(t=t[void 0]),t.pickupLocation.type="temp-location",t.dropoffLocation&&(t.dropoffLocation.type="temp-location"),te={},Object.keys(t).map(function(e){var n=X(e,e,t[e],[],{});Array.isArray(n)?null===n||void 0===n||n.map(function(e){$.a.merge(te,e)}):$.a.merge(te,n)}),S(void 0),Y(!0),ne=null===R||void 0===R?void 0:R.find(function(e){var t;return(null===e||void 0===e||null===(t=e.objectId)||void 0===t?void 0:t.toString())===(null===te||void 0===te?void 0:te.billingInstitute)}),ae=null===(n=Object.values((null===ne||void 0===ne||null===(a=ne.info)||void 0===a||null===(i=a.page)||void 0===i||null===(c=i.folder)||void 0===c?void 0:c.projectComponents)||{}))||void 0===n?void 0:n.find(function(e){var t;return"onMove"===(null===e||void 0===e||null===(t=e.components)||void 0===t?void 0:t[0])}),console.log("project here",ae),ie=Object(d.a)(Object(d.a)({},te),{},{billingInstituteName:null===ne||void 0===ne||null===(o=ne.info)||void 0===o?void 0:o.name,project:{id:null===ae||void 0===ae?void 0:ae.projectId,type:"project"},sharePassengerLink:t.sharePassengerLink,pricingType:null===(l=t)||void 0===l||null===(s=l.pricingType)||void 0===s||null===(r=s.value)||void 0===r?void 0:r.name,equipmentType:null===(u=t)||void 0===u||null===(v=u.equipment)||void 0===v||null===(j=v.categories)||void 0===j?void 0:j.toString(),equipment:null===(p=t)||void 0===p||null===(O=p.equipment)||void 0===O||null===(f=O.subCategories)||void 0===f?void 0:f.toString()}),ce=[],null!==ie&&void 0!==ie&&null!==(h=ie.primaryResponder)&&void 0!==h&&h.id&&ce.push({id:null===ie||void 0===ie||null===(oe=ie.primaryResponder)||void 0===oe?void 0:oe.id,beamId:null===ie||void 0===ie||null===(le=ie.primaryResponder)||void 0===le?void 0:le.beamId,permission:"edit"}),(null===ie||void 0===ie||null===(g=ie.secondaryResponder)||void 0===g||null===(x=g.responders)||void 0===x?void 0:x.length)>0&&(null===ie||void 0===ie||null===(se=ie.secondaryResponder)||void 0===se||null===(re=se.responders)||void 0===re||re.map(function(e){ce.push({id:null===e||void 0===e?void 0:e.id,beamId:null===e||void 0===e?void 0:e.beamId,permission:"write"})})),de=[],console.log("sorted attributes",ie),ue=Object(d.a)(Object(d.a)({},ie),{},{returnPickupTime:void 0}),ve=new Date(null===ue||void 0===ue?void 0:ue.pickupDate),(be=null!==ue&&void 0!==ue&&ue.pickupTime?new Date(null===ue||void 0===ue?void 0:ue.pickupTime):void 0)&&(ve.setHours(be.getHours()),ve.setMinutes(be.getMinutes())),"no"!==(null===(y=t)||void 0===y?void 0:y.usedServiceBefore)||Ye.current||(Ie="",Ie=null!==(je=t)&&void 0!==je&&null!==(me=je.billingType)&&void 0!==me&&me.includes("privateEmail")||null!==(pe=t)&&void 0!==pe&&null!==(Oe=pe.billingType)&&void 0!==Oe&&Oe.includes("creditCardOnFile")||null!==(fe=t)&&void 0!==fe&&null!==(he=fe.billingType)&&void 0!==he&&he.includes("creditCardOneTime")||null!==(ge=t)&&void 0!==ge&&null!==(xe=ge.billingType)&&void 0!==xe&&xe.includes("snailMail")?null===(Se=t)||void 0===Se?void 0:Se.billingEmail:"accounts@hulpr.ca",Ne={DisplayName:"".concat(t.patientFirstName," ").concat(t.patientLastName),GivenName:t.patientFirstName,FamilyName:t.patientLastName,CompanyName:t.insitutionIdForBilling,PrimaryPhone:{FreeFormNumber:t.billingPhoneNumber},PrimaryEmailAddr:{Address:Ie},BillAddr:{Line1:"".concat(t.careHomeName,", ").concat(t.primaryHomeAddress)},Notes:"Billing Type: ".concat(t.billingType.join(", "),", Additional Contact: ").concat(t.additionalContact,", Support Worker Contact: ").concat(t.supportWorkerContact,", City of ODSP: ").concat(t.cityOdsp,", ").concat("accounts@hulpr.ca"===Ie?"Billing Email: ".concat(null===(ye=t)||void 0===ye?void 0:ye.billingEmail):"")},ue.quickBooksCustomer=Ne),ke=ve.getTime(),ue.pickupDate=null===(I=H()(ke))||void 0===I?void 0:I.format("MMM D YYYY"),ue.pickupTime=null!==ue&&void 0!==ue&&ue.pickupTime?null===(N=H()(ke))||void 0===N?void 0:N.format("HH:mm"):"Unknown Time",ue.appointmentTime=null===(k=H()(null===ue||void 0===ue?void 0:ue.appointmentTime))||void 0===k?void 0:k.format("HH:mm"),null!==ue&&void 0!==ue&&ue.patientDateOfBirth&&(ue.patientDateOfBirth=null===(Te=H()(null===ue||void 0===ue?void 0:ue.patientDateOfBirth))||void 0===Te?void 0:Te.format("MM/DD/YYYY")),de.push({userId:J,attributes:Object(d.a)(Object(d.a)({},ue),{},{pickupAddress:null===ue||void 0===ue||null===(T=ue.pickupLocation)||void 0===T||null===(C=T.attributes)||void 0===C?void 0:C.address,dropoffAddress:null===ue||void 0===ue||null===(w=ue.dropoffLocation)||void 0===w||null===(P=w.attributes)||void 0===P?void 0:P.address,patientFullName:"".concat(null===ue||void 0===ue||null===(D=ue.patientFirstName)||void 0===D?void 0:D.toLowerCase()," ").concat(null===ue||void 0===ue||null===(A=ue.patientLastName)||void 0===A?void 0:A.toLowerCase()),pickupLocationFullName:null===ue||void 0===ue||null===(M=ue.pickupLocationName)||void 0===M?void 0:M.toLowerCase(),dropoffLocationFullName:null===ue||void 0===ue||null===(U=ue.dropoffLocationName)||void 0===U?void 0:U.toLowerCase()}),responders:ce,submitted:!0,connectionId:ee,unstructuredAttributes:Object(d.a)(Object(d.a)({},t),{},{returnPickupTime:void 0}),pageId:Ye.current?K:void 0,title:"".concat(null===ue||void 0===ue?void 0:ue.patientFirstName).concat(null!==ue&&void 0!==ue&&ue.patientLastName&&""!==(null===ue||void 0===ue?void 0:ue.patientLastName)?" "+(null===ue||void 0===ue?void 0:ue.patientLastName):"",", ").concat(H()(ke).format("MMM D hh:mm A")),createdAt:ke||(new Date).getTime(),cudbServiceId:null===E||void 0===E?void 0:E.userServiceId}),Ce=!1,console.log("selectedPage",q),!K||"O/W"!=(null===q||void 0===q||null===(F=q.page)||void 0===F||null===(B=F.profile)||void 0===B||null===(_=B.unstructuredAttributes)||void 0===_?void 0:_.serviceType)&&"W/R"!=(null===q||void 0===q||null===(W=q.page)||void 0===W||null===(V=W.profile)||void 0===V||null===(z=V.unstructuredAttributes)||void 0===z?void 0:z.serviceType)||"C/R"!==(null===ie||void 0===ie?void 0:ie.serviceType)||(Ce=!0),("C/R"===(null===ie||void 0===ie?void 0:ie.serviceType)&&!K||Ce)&&(Fe=Object(d.a)(Object(d.a)({},ie),{},{pickupLocationName:ie.dropoffLocationName,pickupLocation:ie.dropoffLocation,pickupDoorCode:ie.dropoffDoorCode,pickupEntranceUnitRoom:ie.dropoffEntranceUnitRoom,dropoffLocationName:ie.pickupLocationName,dropoffLocation:ie.pickupLocation,dropoffDoorCode:ie.pickupDoorCode,dropoffEntranceUnitRoom:ie.pickupEntranceUnitRoom,pickupTime:ie.returnPickupTime,pickupInstructions:ie.dropoffInstructions,dropoffInstructions:ie.pickupInstructions,returnPickupTime:void 0,appointmentTime:void 0}),Be=Object(d.a)(Object(d.a)({},t),{},{pickupLocationName:t.dropoffLocationName,pickupLocation:t.dropoffLocation,pickupDoorCode:t.dropoffDoorCode,pickupEntranceUnitRoom:t.dropoffEntranceUnitRoom,dropoffLocationName:t.pickupLocationName,dropoffLocation:t.pickupLocation,dropoffDoorCode:t.pickupDoorCode,dropoffEntranceUnitRoom:t.pickupEntranceUnitRoom,pickupTime:t.returnPickupTime,pickupInstructions:t.dropoffInstructions,dropoffInstructions:t.pickupInstructions,returnPickupTime:void 0,appointmentTime:void 0}),_e=new Date(null===Fe||void 0===Fe?void 0:Fe.pickupDate),Fe.pickupTime&&($e=new Date(null===Fe||void 0===Fe?void 0:Fe.pickupTime),_e.setHours($e.getHours()),_e.setMinutes($e.getMinutes())),He=_e.getTime(),Fe.pickupDate=null===(we=H()(He))||void 0===we?void 0:we.format("MMM D YYYY"),Fe.pickupTime=Fe.pickupTime?null===(Ee=H()(He))||void 0===Ee?void 0:Ee.format("HH:mm"):"Unknown Time",null!==Fe&&void 0!==Fe&&Fe.patientDateOfBirth&&(Fe.patientDateOfBirth=null===(We=H()(null===Fe||void 0===Fe?void 0:Fe.patientDateOfBirth))||void 0===We?void 0:We.format("MM/DD/YYYY")),de.push({userId:J,attributes:Object(d.a)(Object(d.a)({},Fe),{},{pickupAddress:null===Fe||void 0===Fe||null===(Re=Fe.pickupLocation)||void 0===Re||null===(Pe=Re.attributes)||void 0===Pe?void 0:Pe.address,dropoffAddress:null===Fe||void 0===Fe||null===(De=Fe.dropoffLocation)||void 0===De||null===(Ae=De.attributes)||void 0===Ae?void 0:Ae.address,patientFullName:"".concat(null===Fe||void 0===Fe||null===(Me=Fe.patientFirstName)||void 0===Me?void 0:Me.toLowerCase()," ").concat(null===Fe||void 0===Fe||null===(Le=Fe.patientLastName)||void 0===Le?void 0:Le.toLowerCase()),pickupLocationFullName:null===Fe||void 0===Fe||null===(Ue=Fe.pickupLocationName)||void 0===Ue?void 0:Ue.toLowerCase(),dropoffLocationFullName:null===Fe||void 0===Fe||null===(qe=Fe.dropoffLocationName)||void 0===qe?void 0:qe.toLowerCase()}),responders:ce,submitted:!0,connectionId:ee,unstructuredAttributes:Object(d.a)({},Be),title:"".concat(null===Fe||void 0===Fe?void 0:Fe.patientFirstName).concat(null!==Fe&&void 0!==Fe&&Fe.patientLastName&&""!==(null===Fe||void 0===Fe?void 0:Fe.patientLastName)?" "+(null===Fe||void 0===Fe?void 0:Fe.patientLastName):"",", ").concat(Fe.pickupTime?H()(He).format("MMM D hh:mm A"):"".concat(H()(He).format("MMM D")," N/A")),createdAt:He||(new Date).getTime(),cudbServiceId:null===E||void 0===E?void 0:E.userServiceId})),de.map(function(e){var t=[],n=e.attributes,a=n.pickupTime,i=n.returnPickupTime,c=n.pickupDate,o=n.serviceType,l=n.transferType,s=n.equipmentNeeded,r=n.patientFirstName,d=n.patientLastName,u=n.patientDateOfBirth,v=n.weight,j=n.weightUnit,p=n.height,O=n.oxygen,f=n.oxygenSupplied,h=n.pickupLocationName,g=n.pickupEntranceUnitRoom,x=n.pickupAddress,y=n.dropoffLocationName,I=n.dropoffEntranceUnitRoom,S=n.dropoffAddress,N=n.pickupInstructions,k=n.dropoffInstructions,T=n.diagnoses,C=n.instructions,w=n.pickupLocation,E=n.dropoffLocation,R=n.waitTime,P=function(e){return e.filter(Boolean).join(" - ")},D=[r||"",d||"",u?"(DOB ".concat(u):"",v?"Weight: ".concat(v," ").concat(j):"",p?"Height: ".concat(p," inches"):"",O?"Oxygen: ".concat(O,"L"):"",f?"supplied by: ".concat(f):""].filter(Boolean).join(", ").replace(/\(\s*,/,"(").replace(/,\s*\)/,")"),A=P([h,g,x,N&&""!==N?N:null]),M=P([y,I,S,k&&""!==k?k:null]),L=[a||"Unknown Time",c,o,l,s?"(".concat(s,")"):null,D?"Pickup: ".concat(D):null,A?"at ".concat(A):null,M?"Take to: ".concat(M):null,T?"Diagnosis: ".concat(T):null,C?"Instructions: ".concat(C):null].filter(Boolean);if(t.push({type:"text",attributes:{body:L.join(" - ")}}),"W/R"===o){var U=[i||"Unknown Time",c,o,l,s?"(".concat(s,")"):null,D?"Pickup: ".concat(D):null,M?"at ".concat(M):null,A?"Take to: ".concat(A):null].filter(Boolean);t.push({type:"text",attributes:{body:U.join(" - ")}})}if(ce&&ce.length>0){var q={type:"place",attributes:{body:"Pickup location",attributes:(null===w||void 0===w?void 0:w.attributes)||{},display:{type:"marker",color:"blue"},coordinates:(null===w||void 0===w?void 0:w.coordinates)||{}}},F={type:"place",attributes:{body:"Dropoff location",attributes:(null===E||void 0===E?void 0:E.attributes)||{},display:{type:"marker",color:"blue"},coordinates:(null===E||void 0===E?void 0:E.coordinates)||{}}};t.push({type:"rsvp",attributes:{body:"Accept job?",type:"yes-no",options:{option1:"Yes",option2:"No"},rsvpTitle:"Accept job?",callback:{topic:"".concat("beamdevlive","/connection/").concat(ee,"/service/hpd-dps/rsvpReplyEvent"),data:{type:"cancelPage",pickupLocation:q,dropoffLocation:F,serviceType:o,waitTime:R}}}})}e.customMessages=t,e.attributes.customMessages=t,console.log("request",e),b.publishToEvent(m.PublishPageTopics,Wt(ee),Dn(e))}),null===(Q=t)||void 0===Q||!Q.pickupLocationName){e.n=2;break}return e.n=1,ut(null===(Ve=t)||void 0===Ve?void 0:Ve.pickupLocationName);case 1:if(ze=e.v,console.log("pickup location",ze),0!==(null===ze||void 0===ze?void 0:ze.length)){e.n=2;break}return e.n=2,vt({name:null===(Qe=t)||void 0===Qe?void 0:Qe.pickupLocationName,location:null===(Ge=t)||void 0===Ge?void 0:Ge.pickupLocation});case 2:if(null===(G=t)||void 0===G||!G.dropoffLocationName){e.n=4;break}return e.n=3,ut(null===(Je=t)||void 0===Je?void 0:Je.dropoffLocationName);case 3:if(Ke=e.v,console.log("dropoff location",Ke),0!==(null===Ke||void 0===Ke?void 0:Ke.length)){e.n=4;break}return e.n=4,vt({name:null===(Ze=t)||void 0===Ze?void 0:Ze.dropoffLocationName,location:null===(Xe=t)||void 0===Xe?void 0:Xe.dropoffLocation});case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){null!==q&&void 0!==q&&q.page&&function(e){var t,n,a,i,c,o,l,s,r;console.log("selected page",e),!0!==rt?(console.log("selected page",e),jt(Object(d.a)(Object(d.a)({},null===e||void 0===e?void 0:e.page),{},{persistent:{static:{profile:null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.profile}}})),null!==e&&void 0!==e&&e.ignorePage?(ee(void 0),ie(void 0)):(ee(null===e||void 0===e||null===(n=e.page)||void 0===n||null===(a=n.pageId)||void 0===a?void 0:a.toString()),ie((null===e||void 0===e||null===(i=e.page)||void 0===i?void 0:i.status)||(null===e||void 0===e||null===(c=e.page)||void 0===c||null===(o=c.nonpersistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.status)||void 0===r?void 0:r.name)))):Ie({visible:!0,onConfirm:function(){var t,n,a,i,c,o,l,s,r;Ie(void 0),dt(!1),console.log("selected page",e),jt(Object(d.a)(Object(d.a)({},null===e||void 0===e?void 0:e.page),{},{persistent:{static:{profile:null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.profile}}})),null!==e&&void 0!==e&&e.ignorePage?(ee(void 0),ie(void 0)):(ee(null===e||void 0===e||null===(n=e.page)||void 0===n||null===(a=n.pageId)||void 0===a?void 0:a.toString()),ie((null===e||void 0===e||null===(i=e.page)||void 0===i?void 0:i.status)||(null===e||void 0===e||null===(c=e.page)||void 0===c||null===(o=c.nonpersistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.status)||void 0===r?void 0:r.name)))},onCancel:function(){Ie(void 0)},message:"Are you sure you want to override changes?"})}(q)},[q]);Object(a.useEffect)(function(){if(U){var e,t;console.log("set pickup",U);var n={type:"incident-location",label:null===(e=U.location.attributes)||void 0===e?void 0:e.address,value:{description:null===U||void 0===U||null===(t=U.location.attributes)||void 0===t?void 0:t.address,place_id:"",coordinates:null===U||void 0===U?void 0:U.location.coordinates}};g.setFieldsValue({pickupLocation:n}),n&&(mt({pickupLocation:n}),P({type:Ue,payload:void 0}),P({type:qe,payload:[]}))}},[U]);var jt=function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m,p,O,f,h,x,y,I,S,N,k,T;(g.resetFields(),P({type:De,payload:!1}),null!==e&&void 0!==e&&null!==(t=e.persistent)&&void 0!==t&&null!==(n=t.static)&&void 0!==n&&null!==(a=n.profile)&&void 0!==a&&null!==(i=a.unstructuredAttributes)&&void 0!==i&&i.pickupLocation)&&mt({pickupLocation:null===e||void 0===e||null===(h=e.persistent)||void 0===h||null===(x=h.static)||void 0===x||null===(y=x.profile)||void 0===y||null===(I=y.unstructuredAttributes)||void 0===I?void 0:I.pickupLocation});null!==e&&void 0!==e&&null!==(c=e.persistent)&&void 0!==c&&null!==(o=c.static)&&void 0!==o&&null!==(l=o.profile)&&void 0!==l&&null!==(s=l.unstructuredAttributes)&&void 0!==s&&s.dropoffLocation&&mt({dropoffLocation:null===e||void 0===e||null===(S=e.persistent)||void 0===S||null===(N=S.static)||void 0===N||null===(k=N.profile)||void 0===k||null===(T=k.unstructuredAttributes)||void 0===T?void 0:T.dropoffLocation});var C=(null===e||void 0===e||null===(r=e.persistent)||void 0===r||null===(u=r.static)||void 0===u||null===(v=u.profile)||void 0===v?void 0:v.unstructuredAttributes)||{},w=C.appointmentTime,E=C.pickupDate,R=C.pickupTime,D=C.returnPickupTime,A=C.patientDateOfBirth,M=C.vehicle,L=C.pricingType;g.setFieldsValue(Object(d.a)(Object(d.a)({},null!==(b=null===e||void 0===e||null===(j=e.persistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.profile)||void 0===p?void 0:p.unstructuredAttributes)&&void 0!==b?b:{}),{},{pickupDate:E?H()(E):void 0,pickupTime:R?H()(R):void 0,returnPickupTime:D?H()(D):void 0,appointmentTime:w?H()(w):void 0,patientDateOfBirth:A?H()(A):void 0,vehicle:M?Object(d.a)(Object(d.a)({},M),{},{valueName:null===M||void 0===M||null===(O=M.obj)||void 0===O?void 0:O.name}):void 0,pricingType:L?Object(d.a)(Object(d.a)({},L),{},{valueName:null===L||void 0===L||null===(f=L.value)||void 0===f?void 0:f.name}):void 0},null!==q&&void 0!==q&&q.ignorePage?{appointmentTime:void 0,pickupDate:void 0,pickupTime:void 0,returnPickupTime:void 0,confirmationNumber:void 0}:{}))};Object(a.useEffect)(function(){M&&jt(M)},[JSON.stringify(null!==(t=null===M||void 0===M||null===(n=M.persistent)||void 0===n||null===(i=n.static)||void 0===i?void 0:i.profile)&&void 0!==t?t:{})]),Object(a.useEffect)(function(){if(A)if(A.status)Y(!1),ee(void 0),Lt("Event page submitted successfully","success","TOP_CENTER",1e3),pt(),P({type:De,payload:!1}),setTimeout(function(){f()},500);else if(!1===A.status){var e;Y(!1),Lt((null===A||void 0===A||null===(e=A.data)||void 0===e?void 0:e.details)||"Request failed","error","TOP_CENTER",3e3),P({type:"SET_ONLY_SUBMITTED",payload:!1})}},[P,C,g,N,T,_,k,A]);Object(a.useEffect)(function(){if(null!==E&&void 0!==E&&E.adminUserId){var e=null===L||void 0===L?void 0:L.connectionId,t=null===L||void 0===L?void 0:L.userId;b.subscribeToEvent(m.SubscribePageTopics,yn(e)),b.subscribeToEvent(m.SubscribePageTopics,bn(e,null===E||void 0===E?void 0:E.userServiceId)),b.subscribeToEvent(m.SubscribePageTopics,En(t),function(e){console.log("response",e),he(null===e||void 0===e?void 0:e.data)}),nt(!0)}},[E]),Object(a.useEffect)(function(){et&&(console.log("loaded true",et),function(){var e=null===L||void 0===L?void 0:L.connectionId,t={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===E||void 0===E?void 0:E.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",firstName:"$..profile.firstName"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@firstName)"},anyStatus:!1};b.publishToEvent(m.PublishPageTopics,xn(e),Dn(t,ce.current))}(),b.publishToEvent(m.PublishPageTopics,Nn(null===L||void 0===L?void 0:L.connectionId),Dn({userId:null===L||void 0===L?void 0:L.userId,cudbServiceId:null===E||void 0===E?void 0:E.userServiceId})))},[et]),Object(a.useEffect)(function(){if(L){var e=new URLSearchParams(T),t=(e.get("token"),e.get("setup_intent_client_secret"),localStorage.getItem("form"));if(t){var n,a;console.log("re submit here");var i=JSON.parse(t);console.log("form here",i);var c=i||{},o=c.appointmentTime,l=c.pickupDate,s=c.pickupTime,r=c.returnPickupTime,u=c.patientDateOfBirth,v=c.vehicle,j=c.pricingType,p=c.serviceType;p&&ue(p),g.setFieldsValue(Object(d.a)(Object(d.a)({},null!==i&&void 0!==i?i:{}),{},{pickupDate:l?H()(l):void 0,pickupTime:s?H()(s):void 0,returnPickupTime:r?H()(r):void 0,appointmentTime:o?H()(o):void 0,patientDateOfBirth:u?H()(u):void 0,vehicle:v?Object(d.a)(Object(d.a)({},v),{},{valueName:null===v||void 0===v||null===(n=v.obj)||void 0===n?void 0:n.name}):void 0,pricingType:j?Object(d.a)(Object(d.a)({},j),{},{valueName:null===j||void 0===j||null===(a=j.value)||void 0===a?void 0:a.name}):void 0}))}b.subscribeToEvent(m.SubscribePageTopics,Bt(null===L||void 0===L?void 0:L.connectionId)),b.subscribeToEvent(m.SubscribePageTopics,$t(null===L||void 0===L?void 0:L.connectionId)),b.subscribeToEvent(m.SubscribePageTopics,vn(null===L||void 0===L?void 0:L.connectionId)),b.subscribeToEvent(m.SubscribePageTopics,Ht(null===L||void 0===L?void 0:L.connectionId)),b.subscribeToEvent(m.SubscribePageTopics,fn(null===L||void 0===L?void 0:L.userId),function(e){var t,n,a;jt(Object(d.a)(Object(d.a)({},null===e||void 0===e?void 0:e.page),{},{persistent:{static:{profile:null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.profile}}})),ee(null===e||void 0===e||null===(n=e.page)||void 0===n||null===(a=n.pageId)||void 0===a?void 0:a.toString())}),b.subscribeToEvent(m.SubscribePageTopics,nn(null===L||void 0===L?void 0:L.connectionId),function(e){Lt("Request cancelled successfully","success","TOP_CENTER",1e3),P({type:De,payload:!1}),pt()}),b.subscribeToEvent(m.SubscribePageTopics,an(null===L||void 0===L?void 0:L.connectionId)),b.publishToEvent(m.PublishPageTopics,_t(null===L||void 0===L?void 0:L.connectionId),Dn({userId:null===L||void 0===L?void 0:L.userId,cudbServiceId:(null===L||void 0===L?void 0:L.cudbServiceId)||(null===L||void 0===L?void 0:L.serviceId)})),null!==L&&void 0!==L&&L.pageId&&b.publishToEvent(m.PublishPageTopics,cn(null===L||void 0===L?void 0:L.connectionId),Dn({objectId:null===L||void 0===L?void 0:L.pageId,paths:["$"],returnPaths:["$"]},null===L||void 0===L?void 0:L.pageId)),Ve(void 0!==(null===L||void 0===L?void 0:L.cudbServiceId))}},[L]);var mt=function(e){P({type:Ae,payload:e})},pt=function(){setTimeout(function(){var e=new URLSearchParams(T);e.delete("pageId"),e.delete("sessionId"),C.replace({search:e.toString()}),localStorage.removeItem("form"),localStorage.removeItem("formValues"),localStorage.removeItem("active"),P({type:De,payload:!1}),P({type:"SET_SELECTED_PAGE",payload:{page:void 0}}),g.resetFields(),g.setFieldsValue({dispatch:{type:"dispatchType",value:"immediate"},rideType:{type:"rideType",value:"O/W"},fareType:{type:"fareType",value:"variable"},payType:{type:"payType",value:"meter"},numberOfStaff:1}),se(void 0),ee(void 0),Ke(!1),Le(void 0),dt(!1),ze.current=void 0})};return Object(oa.jsxs)("div",{className:"main-column ride-dispatch-panel mr-4",style:O?{height:"auto"}:{},children:[Object(oa.jsx)("div",{className:"main-content",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",initialValues:{dispatch:{type:"dispatchType",value:"immediate"},rideType:{type:"rideType",value:"O/W"},fareType:{type:"fareType",value:"variable"},payType:{type:"payType",value:"meter"},numberOfStaff:1},id:"register-form",layout:"vertical",form:g,onFinish:bt,onFinishFailed:function(e){var t=e.errorFields;if(t.length>0){var n=t[0],a=n.name.join("_"),i="register-form_".concat(a),c=document.getElementById(i);if(!c){var o=document.querySelector('label[for="'.concat(i,'"]'));o&&(c=o.closest(".ant-form-item"))}c||(c=document.querySelector(".ant-form-item-has-error")),console.log("error element",n,c),c&&c.scrollIntoView({behavior:"smooth",block:"center"})}},requiredMark:!1,onValuesChange:function(e,t){localStorage.setItem("form",JSON.stringify(t)),dt(!0)},style:p?{}:{height:"48vh"},children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h3",{className:"ml-3",children:Z&&M?"".concat(null===M||void 0===M||null===(c=M.persistent)||void 0===c||null===(o=c.static)||void 0===o||null===(r=o.metatdata)||void 0===r?void 0:r.title):"Medical transportation"})}),Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon",onClick:function(){!0!==rt?(f(),P({type:"SET_SELECTED_PAGE",payload:{page:void 0}})):Ie({visible:!0,onConfirm:function(){pt(),setTimeout(function(){f()},500)},onCancel:function(){Ie(void 0)},message:"Are you sure you want to override changes?"})}})]}),Object(oa.jsx)("div",{className:"main-cards",style:{maxHeight:O?"calc(100vh)":"calc(100vh - 200px)"},children:Object(oa.jsx)(dl,{socket:b,nine11Form:g,ridePageId:Z})}),I&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:I})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:Z?8:12,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full w-full",onClick:function(){Ie({visible:!0,onConfirm:function(){pt(),Ie(void 0)},onCancel:function(){Ie(void 0)},message:"Are you sure you want to override changes?"})},children:"Clear"})}),Z&&Object(oa.jsx)(Hn.a,{span:8,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full w-full",onClick:function(){$e(!0)},disabled:"black"===ae,children:"Cancel"})}),Object(oa.jsx)(Hn.a,{span:Z?8:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:_,disabled:Je||"green"===ae,onClick:function(){Ye.current=!0},children:Z?"Save Edits":"Book Ride"})})]})]})}),_e&&Object(oa.jsx)(Fo,{onClose:function(){$e(void 0)},handleConfirm:function(){b.publishToEvent(m.PublishPageTopics,Jt(null===L||void 0===L?void 0:L.connectionId),Dn({pageId:Z,userId:null===L||void 0===L?void 0:L.userId,cudbServiceId:null===E||void 0===E?void 0:E.userServiceId,dispatcher:!0})),$e(void 0)},message:"Are you sure you want to cancel request?"}),(null===ke||void 0===ke?void 0:ke.phone)&&Object(oa.jsx)(Bo,{socket:b,phone:null===ke||void 0===ke?void 0:ke.phone,onClose:function(){Te(void 0)}}),Ee&&Object(oa.jsx)(ul,{onClose:function(){Re(!1)},socket:b}),(null===fe||void 0===fe?void 0:fe.reservation)&&Object(oa.jsx)(Fo,{onClose:function(){he(void 0)},handleConfirm:function(){var e;!function(e,t){var n={select:{index:{searchIndex:"".concat("beamdevlive",":custom:id"),searchQuery:"@partitions:{'org\\:".concat(z(null===E||void 0===E?void 0:E.userServiceId),"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",email:"$..email",phone:"$..phone",objectId:"$.objectId"}},filter:{expression:"(exists(@email) && @email=='".concat(e,"') || (exists(@phone) && @phone=='").concat(t,"')")}};P(tt({requestData:n,callback:function(e){var t,n=null===e||void 0===e?void 0:e[0];n&&null!==n&&void 0!==n&&null!==(t=n.info)&&void 0!==t&&t.blockedAt?Ke(!0):Ke(!1)}}))}(void 0,null===fe||void 0===fe||null===(e=fe.reservation)||void 0===e?void 0:e.phoneNumber),he(void 0)},message:"Incoming call: ".concat(null===fe||void 0===fe||null===(v=fe.reservation)||void 0===v?void 0:v.phoneNumber)}),(null===ye||void 0===ye?void 0:ye.visible)&&Object(oa.jsx)(Fo,{onClose:function(){null===ye||void 0===ye||ye.onCancel()},handleConfirm:function(){null===ye||void 0===ye||ye.onConfirm()},message:null===ye||void 0===ye?void 0:ye.message}),ct&&Object(oa.jsx)(yl,{onClose:function(){ot(!1)},onSubmitHandler:bt,socket:b,accounts:R})]})},Sl=n(92),Nl=Object(da.compose)(Object(da.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M&v=3.exp&libraries=geometry,drawing,places",loadingElement:Object(oa.jsx)("div",{style:{height:"100%"}}),containerElement:Object(oa.jsx)("div",{style:{height:"100%"}}),mapElement:Object(oa.jsx)("div",{style:{height:"100%"}})}),Object(da.withStateHandlers)(function(){return{isOpen:!1,activeMarker:null,directions:null,selectDirectionPin:null,drawingMode:null,activeInfo:null}},{onToggleOpen:function(e){var t=e.isOpen;return function(e){return{isOpen:!t,activeMarker:e}}},showDirection:function(){return function(e){return{directions:e}}},setDrawingMode:function(){return function(e){return{drawingMode:e}}},setSelectDirectionPin:function(){return function(e){return{selectDirectionPin:e}}},setActiveInfo:function(){return function(e){return{activeInfo:e}}}}),ua.withScriptjs,ua.withGoogleMap)(function(e){e.isOpen,e.active,e.setActive;var t,n,i,c=e.markers,o=e.assetMarkers,l=e.currentMarkers,r=e.currentLocation,d=e.getPlaces,u=e.setActiveInfo,v=e.activeInfo,b=e.showDirection,j=e.directions,m=e.polygon,p=e.circle,O=e.stands,f=Object(a.useRef)(null),h=Object(a.useRef)(!1),g=Object(s.c)(function(e){return e.auth}),x=g.selectedResponders,y=g.selectedAssets,I=Object(s.b)();Object(a.useEffect)(function(){x&&x.length>0&&console.log("update component")},[x]);var S=function(){i&&clearTimeout(i),i=setTimeout(function(){if(f.current){var e=f.current.getBounds();if(e){var t=e.getNorthEast(),n=e.getSouthWest();d({center:f.current.getCenter(),bounds:{minLat:n.lat(),maxLat:t.lat(),minLon:n.lng(),maxLon:t.lng()}})}}},500)};Object(a.useEffect)(function(){var e,t;!function(){var e=new google.maps.LatLngBounds;c.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),o.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),l.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),O.forEach(function(t){var n,a;e.extend({lat:null===(n=t.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=t.location.coordinates)||void 0===a?void 0:a.long})}),e.isEmpty()||f.current.fitBounds(e)}(),l&&2===l.length?(h.current=!0,e=l[0],t=l[1],(new google.maps.DirectionsService).route({origin:new google.maps.LatLng(e.lat,e.lng),destination:new google.maps.LatLng(t.lat,t.lng),travelMode:google.maps.TravelMode.DRIVING},function(e,t){t===google.maps.DirectionsStatus.OK?h.current&&b(e):console.error("error fetching directions ".concat(e))})):(h.current=!1,b(void 0))},[c,l,o,O]);return Object(oa.jsxs)(ua.GoogleMap,{defaultZoom:14,options:{maxZoom:19,styles:[{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]}]},center:r,onZoomChanged:function(){S()},onCenterChanged:function(){S()},onTilesLoaded:function(){f.current&&r&&S()},ref:f,children:[m&&Object(oa.jsx)(ua.Polygon,{path:m.paths,editable:!1,options:{strokeColor:"#FF0000",fillColor:"#FF0000"},onClick:function(e){}}),p&&Object(oa.jsx)(ua.Circle,{center:{lat:null===(t=p.location.coordinates)||void 0===t?void 0:t[1],lng:null===(n=p.location.coordinates)||void 0===n?void 0:n[0]},radius:p.radius,options:{strokeColor:"FF0000",fillColor:"FF0000"},onClick:function(e){}}),null===O||void 0===O?void 0:O.map(function(e,t){var n,a;return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-green.svg",scaledSize:new google.maps.Size(22,34)},position:{lat:null===(n=e.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=e.location.coordinates)||void 0===a?void 0:a.long},onClick:function(){I({type:Ee,payload:e})}},t)}),c.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/car-".concat(-1===x.findIndex(function(t){return t.id===e.id})?e.status:"blue",".svg"),scaledSize:new google.maps.Size(60,60)},position:{lat:e.lat,lng:e.lng},onClick:function(){"green"===(null===e||void 0===e?void 0:e.status)&&I({type:Ce,payload:e})},label:e.title},t)}),o.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===y.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){I({type:we,payload:e})},label:e.title},t)}),l.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===x.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){u(t)},children:v===t&&Object(oa.jsx)(ua.InfoWindow,{onCloseClick:function(){u(null)},children:Object(oa.jsx)("div",{children:Object(oa.jsx)("div",{children:e.title})})})},t)}),Object(oa.jsx)(ua.Marker,{position:r,icon:{url:"/images/map-plain-icon-blue.svg",scaledSize:new google.maps.Size(22,34)},onClick:function(){}}),j&&Object(oa.jsx)(ua.DirectionsRenderer,{directions:j,options:{markerOptions:{opacity:1},panel:document.getElementById("direction-panel")}})]})}),kl={lat:29.95106579999999,lng:-90.0715323};var Tl,Cl=function(e){var t=e.socket,n=e.params,i=(n.screens,n.setScreens,Object(a.useState)()),c=Object(u.a)(i,2),o=(c[0],c[1],Object(a.useState)()),r=Object(u.a)(o,2),v=r[0],b=r[1],j=Object(a.useState)(!0),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)(!0),g=Object(u.a)(h,2),x=g[0],y=(g[1],Object(a.useState)([])),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)([]),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(a.useState)([]),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(!1),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useReducer)(function(e){return e+1},0),F=Object(u.a)(q,2),B=(F[0],F[1],Object(s.c)(function(e){return e.auth})),_=B.responders,$=B.vehicles,Y=(B.incidentLocation,B.project),H=B.otherLocations,W=B.assets,V=B.geofenceLocation,z=B.standLocations,Q=B.encrypted_token,G=B.projects,J=Object(l.g)().search,K=Object(a.useState)(),Z=Object(u.a)(K,2),X=Z[0],ee=Z[1],te=(Object(s.b)(),function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],i=t[1];Object(a.useEffect)(function(){i(!0)},[])}(),{createPlaceMarker:function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m=arguments.length>1&&void 0!==arguments[1]&&arguments[1],p=arguments.length>2?arguments[2]:void 0;null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.geoJson)||void 0===n||null===(a=n.features)||void 0===a||a.map(function(e){(null===e||void 0===e?void 0:e.geometry.coordinates.length)>0&&(j=e.geometry)});var O=(null===(i=e.beamIds)||void 0===i?void 0:i[0])||"".concat(e.profile.firstName,".").concat(e.profile.lastName);return null===p||void 0===p||p.map(function(t){t.id===e.id&&(O=t.name)}),Object(d.a)(Object(d.a)({},e),{},{lat:null===(c=j)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o[1],lng:null===(l=j)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s[0],title:O,color:"orange",paths:{lat:null===(r=j)||void 0===r||null===(u=r.coordinates)||void 0===u?void 0:u[1],lng:null===(v=j)||void 0===v||null===(b=v.coordinates)||void 0===b?void 0:b[0]},type:"marker",filter:"viewOnly",fitBounds:m})},createCurrentMarker:function(e){var t,n,a,i,c,o,l,s;return console.log("render point here",e),Object(d.a)(Object(d.a)({},e),{},{lat:null===e||void 0===e||null===(t=e.value)||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.lat,lng:null===e||void 0===e||null===(a=e.value)||void 0===a||null===(i=a.coordinates)||void 0===i?void 0:i.long,title:null===e||void 0===e?void 0:e.label,color:"blue",paths:{lat:null===e||void 0===e||null===(c=e.value)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o.lat,lng:null===e||void 0===e||null===(l=e.value)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s.long},type:"marker"})},createAssetMarker:function(e){var t,n,a,i,c,o,l,s,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"fixedAsset"===(null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.type)?s=null===e||void 0===e?void 0:e.asset:"poi"===(null===e||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)&&(s=null===e||void 0===e?void 0:e.poi);var u=s.location;return Object(d.a)(Object(d.a)({},s),{},{id:e.id,assetType:null===e||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.type,lat:null===u||void 0===u||null===(i=u.coordinates)||void 0===i?void 0:i.lat,lng:null===u||void 0===u||null===(c=u.coordinates)||void 0===c?void 0:c.long,title:u.attributes.title,color:"orange",paths:{lat:null===u||void 0===u||null===(o=u.coordinates)||void 0===o?void 0:o.lat,lng:null===u||void 0===u||null===(l=u.coordinates)||void 0===l?void 0:l.long},type:"marker",filter:"viewOnly",fitBounds:r})}}),ne=te.createPlaceMarker,ae=te.createCurrentMarker,ie=te.createAssetMarker,ce=Object(a.useState)(!1),oe=Object(u.a)(ce,2),le=oe[0],se=oe[1],re=Object(a.useState)(void 0),de=Object(u.a)(re,2),ue=de[0],ve=de[1],be=Object(a.useState)(void 0),je=Object(u.a)(be,2),me=je[0],pe=je[1],Oe=Object(a.useState)([]),fe=Object(u.a)(Oe,2),he=fe[0],ge=fe[1];Object(a.useEffect)(function(){var e=new URLSearchParams(J),t=e.get("lat"),n=e.get("lng");t&&n?b({lat:parseFloat(t),lng:parseFloat(n),current:!0}):xe()},[J]),Object(a.useEffect)(function(){if(H){console.log("other locations",H);var e=Object.keys(H).map(function(e){return ae(H[e])});D(e)}},[H]),Object(a.useEffect)(function(){if(V)if(console.log("geofence location",V),"Polygon"===(null===V||void 0===V?void 0:V.location.type)){var e=null===V||void 0===V?void 0:V.location.coordinates.map(function(e){return{lat:null===e||void 0===e?void 0:e[1],lng:null===e||void 0===e?void 0:e[0]}});ve({paths:e})}else pe(V);else ve(void 0),pe(void 0)},[V]),Object(a.useEffect)(function(){z&&(console.log("stand locations",z),ge(z))},[z]);Object(a.useEffect)(function(){if(Y&&X)X.latLong,X.height,X.width},[Y]),Object(a.useEffect)(function(){if(se(!1),_){var e=_.map(function(e){return ne(e,!1,$)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),console.log("markers here",e),N(e)}},[_]),Object(a.useEffect)(function(){if(se(!1),W&&W.length>0){console.log("assets here",W);var e=W.map(function(e){return ie(e)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),w(e)}},[W]);var xe=function(){v&&null!==v&&void 0!==v&&v.current?b(Object(d.a)({},v)):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,n,a,i,c;b({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,lng:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude,current:!0}),gc.a.fromLatLng(null===e||void 0===e||null===(a=e.coords)||void 0===a||null===(i=a.latitude)||void 0===i?void 0:i.toString(),null===(c=e.coords.longitude)||void 0===c?void 0:c.toString()).then(function(e){for(var t=0,n=e.results[0].address_components.length;t<n;t++){var a=e.results[0].address_components[t];a.types.indexOf("administrative_area_level_1")>=0&&a.short_name,a.types.indexOf("country")>=0&&a.short_name}},function(e){console.error(e),b(kl)})},function(e){console.error(e),b(kl)}):(alert("Geolocation is not supported by this browser."),b(kl))},ye=function(e,t,n,a){var i=Ie(n-e),c=Ie(a-t),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(Ie(e))*Math.cos(Ie(n))*Math.sin(c/2)*Math.sin(c/2);return 1e3*(6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))))},Ie=function(e){return e*(Math.PI/180)};return Object(oa.jsx)("div",{className:"main-column map-panel mr-4",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsx)("div",{className:"search-bar mt-3",children:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)("div",{className:"g-map-search-input",children:Object(oa.jsx)(Ii.a,{autocompletionRequest:{},selectProps:{onChange:function(e){e&&function(e){Object(Ii.b)(e.place_id).then(function(e){e[0].geometry&&b({lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),current:!1})}).catch(function(e){return console.error(e)})}(e.value)},isClearable:!0,placeholder:"Search map",styles:{input:function(e){return Object(d.a)(Object(d.a)({},e),{},{fontFamily:"Nunito-Regular"})}}},apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"})}),Object(oa.jsx)(Sl.a,{overlay:"My location",children:Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/location-icon.svg",onClick:xe})})}),Object(oa.jsx)(Sl.a,{overlay:"Reset map",children:Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/reload-icon.svg",onClick:function(){f(!1),U(!1),N([]),w([]),xe()}})})}),Object(oa.jsx)(Sl.a,{overlay:"Search responders",children:Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",onClick:function(){var e;if(!le&&X){var n=X.latLong;X.height,X.width;e=n,se(!0),t.publishToEvent(m.PublishPageTopics,Yt(null===Q||void 0===Q?void 0:Q.connectionId),Dn({userId:null===Q||void 0===Q?void 0:Q.userId,projectId:Y,cudbServiceId:null===G||void 0===G?void 0:G.userServiceId,latLng:e,height:3e5,width:3e5}))}},children:le?Object(oa.jsx)(Ic.a,{type:"TailSpin",color:"#95a8c8",height:20,width:20}):Object(oa.jsx)(fa.a,{src:"/images/car.svg",className:"car-icon"})})})]})}),Object(oa.jsx)("div",{className:"main-cards",children:Object(oa.jsxs)(Yn.a,{className:"map-container-layout",children:[Object(oa.jsx)(Hn.a,{md:L?6:0,children:Object(oa.jsx)("div",{id:"direction-panel"})}),Object(oa.jsx)(Hn.a,{md:L?18:24,children:x&&Object(oa.jsx)(Nl,{currentLocation:v,markers:S,assetMarkers:C,currentMarkers:P,polygon:ue,circle:me,stands:he,active:O,setActive:f,getPlaces:function(e){var t=e.bounds,n=e.center,a=ye(t.minLat,t.maxLon,t.maxLat,t.maxLon),i=ye(t.minLat,t.maxLon,t.minLat,t.minLon),c={lat:n.lat(),long:n.lng()};ee({latLong:c,height:a,width:i})}})})]})})]})})},wl=n(1063),El=n(1064),Rl=n(196),Pl=n(142),Dl=function(e){var t=e.inputArray,n=e.visible,i=(e.onSave,e.onCancel),c=e.socket,o=e.defaultIndex,l=void 0===o?0:o,r=Object(a.useState)(),d=Object(u.a)(r,2),v=d[0],b=d[1],j=Object(a.useState)(!1),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)(Object(C.a)(t)),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(a.useState)(),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(s.c)(function(e){return e.auth}).encrypted_token;Object(a.useEffect)(function(){console.log("input array",t),null===t||void 0===t||t.map(function(e,t){var n,a,i,c,o,s;(null===e||void 0===e?void 0:e.key)===l&&(b(t),k(null===e||void 0===e||null===(n=e.action)||void 0===n||null===(a=n.page)||void 0===a||null===(i=a.profile)||void 0===i||null===(c=i.customMessages)||void 0===c||null===(o=c[0])||void 0===o||null===(s=o.attributes)||void 0===s?void 0:s.body))}),console.log("pageId",l),c.subscribeToEvent(m.SubscribePageTopics,on(null===T||void 0===T?void 0:T.connectionId),function(e){f(!1),Lt("Custom message saved successfully","success","TOP_CENTER",1e3)})},[]);return Object(oa.jsxs)($n.a,{title:"Edit Notification Message",className:"beam-modal",visible:n,onCancel:i,children:[Object(oa.jsx)("div",{style:{marginBottom:16},children:Object(oa.jsx)(Wn.a.TextArea,{value:N,onChange:function(e){k(e.target.value)},rows:4,autoSize:{minRows:4},placeholder:"Edit custom message"})}),Object(oa.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(oa.jsx)(Vn.a,{icon:Object(oa.jsx)(Rl.a,{}),onClick:function(){if(v>0){var e,t,n,a,i,c,o,l=v-1;b(l),k((null===(e=x[l])||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.profile)||void 0===a||null===(i=a.customMessages)||void 0===i||null===(c=i[0])||void 0===c||null===(o=c.attributes)||void 0===o?void 0:o.body)||"")}},disabled:0===v,className:"beam-btn yellow-btn bordered",children:"Previous"}),Object(oa.jsx)(Vn.a,{icon:Object(oa.jsx)(Pl.a,{}),onClick:function(){if(v<x.length-1){var e,t,n,a,i,c,o,l=v+1;b(l),k((null===(e=x[l])||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.profile)||void 0===a||null===(i=a.customMessages)||void 0===i||null===(c=i[0])||void 0===c||null===(o=c.attributes)||void 0===o?void 0:o.body)||"")}},disabled:v===x.length-1,className:"beam-btn yellow-btn bordered",children:"Next"})]}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:12,xs:24,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:i,children:"Cancel"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",xs:24,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){!function(){var e=Object(C.a)(x);e[v].action.page.profile.customMessages[0].attributes.body=N,y(e),f(!0),c.publishToEvent(m.PublishPageTopics,ln(null===T||void 0===T?void 0:T.connectionId),Dn({objectId:e[v].key.toString(),changes:[{op:"replace",path:"$..profile.customMessages[0]..body",value:N}]}))}()},loading:O,children:"Save"})})]})]})},Al=n(149),Ml=n(246),Ll=n(308),Ul=n.n(Ll),ql=n(528),Fl=(n(965),["onResize","width"]);Dc.d.register(Dc.a,Dc.e);var Bl=Jn.a.RangePicker,_l=Gn.a.Option,$l=function(e){return e.Assigned="assigned",e.Started="started",e.Completed="completed",e.Escalated="escalated",e.Cancelled="cancelled",e.Processed="processed",e.Accepted="accepted",e}({}),Yl={green:$l.Completed,amber:$l.Assigned,red:$l.Escalated,blue:$l.Started,black:$l.Cancelled,gray:$l.Processed,aqua:$l.Accepted},Hl={green:"#40CC52",amber:"#FBAE16",red:"#FF5F25",blue:"#508AFA",purple:"#463BBD",gray:"#91A5C6",black:"#000000",brown:"#964B00",aqua:"#00FFFF"},Wl="visibleKeys",Vl=function(e){var t=e.allColumns,n=(e.status,e.visibleKeys),i=e.setVisibleKeys,c=Object(a.useState)(!1),o=Object(u.a)(c,2),l=o[0],s=o[1];Object(a.useEffect)(function(){var e=localStorage.getItem(Wl);console.log("savedKeys",e),i(e?JSON.parse(e):t.map(function(e){return e.key}))},[t]),Object(a.useEffect)(function(){n.length>0&&localStorage.setItem(Wl,JSON.stringify(n))},[n]);var r=Object(oa.jsxs)("div",{style:{padding:10,backgroundColor:"white"},onClick:function(e){return e.stopPropagation()},children:[Object(oa.jsx)(Xn.a.Group,{value:n,onChange:function(e){return i(e)},children:t.map(function(e){return Object(oa.jsx)("div",{style:{marginBottom:8},children:Object(oa.jsx)(Xn.a,{value:e.key,children:e.title})},e.key)})}),Object(oa.jsx)("div",{style:{marginTop:10,textAlign:"right"},children:Object(oa.jsx)(Vn.a,{size:"small",onClick:function(){localStorage.removeItem(Wl),i(t.map(function(e){return e.key}))},children:"Reset"})})]});return Object(oa.jsx)(ni.a,{overlay:r,trigger:["click"],visible:l,onVisibleChange:function(e){return s(e)},children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",children:Object(oa.jsx)(wl.a,{})})})},zl=function(e){var t=e.onResize,n=e.width,a=Object(Ka.a)(e,Fl);return n?Object(oa.jsx)(ql.Resizable,{width:n,height:0,handle:Object(oa.jsx)("div",{className:"resizable-handle",onClick:function(e){return e.stopPropagation()}}),onResize:t,draggableOpts:{enableUserSelectHack:!1},children:Object(oa.jsx)("th",Object(d.a)({},a))}):Object(oa.jsx)("th",Object(d.a)({},a))},Ql=function(e){var t=e.value,n=e.onChange,i=Object(a.useState)(t),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)(null),r=Object(u.a)(s,2),d=r[0],v=r[1],b=Object(a.useState)(null),j=Object(u.a)(b,2),m=j[0],p=j[1];Object(a.useEffect)(function(){t&&l(t)},[t]);var O=function(e,t,a){n&&n({startTimestamp:e,endTimestamp:t,selected:a})};return Object(oa.jsxs)("div",{className:"w-100",children:[Object(oa.jsxs)(Gn.a,{style:{width:200},placeholder:"Select time range",className:"w-100",value:o,onChange:function(e){var t,n=H()(),a=n.valueOf();switch("customRange"!==e&&v(null),"specificDate"!==e&&p(null),e){case"last24hours":t=void 0;break;case"last3days":t=n.subtract(3,"days").valueOf();break;case"last1week":t=n.subtract(7,"days").valueOf();break;case"last1month":t=n.subtract(1,"month").valueOf();break;case"customRange":d?(t=d[0],a=d[1]):console.warn("Select a custom range from the date picker.");break;case"specificDate":if(m)t=H()(m).startOf("day").valueOf(),a=H()(m).endOf("day").valueOf();else console.warn("Select a specific date.");break;default:return void console.warn("Invalid selection")}l(e),O(t,a,e)},children:[Object(oa.jsx)(_l,{value:"last24hours",children:"Last 1 Day and Upcoming"}),Object(oa.jsx)(_l,{value:"last3days",children:"Last 3 Days"}),Object(oa.jsx)(_l,{value:"last1week",children:"Last 1 Week"}),Object(oa.jsx)(_l,{value:"last1month",children:"Last 1 Month"}),Object(oa.jsx)(_l,{value:"specificDate",children:"Specific Date"}),Object(oa.jsx)(_l,{value:"customRange",children:"Custom Range"})]}),"customRange"===o&&Object(oa.jsx)(Bl,{style:{marginTop:16},onChange:function(e){if(e){var t=e[0].valueOf(),n=e[1].valueOf();v([t,n]),O(t,n,"customRange")}else v(null)},format:"YYYY-MM-DD",disabledTime:function(){return{}},showTime:!1}),"specificDate"===o&&Object(oa.jsx)(Jn.a,{style:{marginTop:16},onChange:function(e){if(e){p(e);var t=H()(e).startOf("day").valueOf(),n=H()(e).endOf("day").valueOf();O(t,n,"specificDate")}else p(null)},format:"YYYY-MM-DD"})]})},Gl=function(e){var t=e.socket,n=e.filter,c=e.selected,o=e.componentUuid,l=e.toggleMap,r=e.toggleDispatch,v=Object(s.c)(function(e){return e.auth}),b=v.userRequests,j=v.projects,p=v.selectedPage,O=v.encrypted_token,f=v.searchByPhone,h=v.adminUserRoles,g=v.accounts,x=Object(s.b)(),y=Object(a.useState)("project"),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)("state"),w=Object(u.a)(k,2),E=w[0],R=w[1],P=Object(a.useState)(!1),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Object(a.useState)(void 0),U=Object(u.a)(L,2),q=U[0],F=U[1],B=Object(a.useState)(void 0),_=Object(u.a)(B,2),$=_[0],Y=_[1],V=Object(a.useState)(!1),Q=Object(u.a)(V,2),G=Q[0],J=Q[1],K=Object(a.useState)(!1),Z=Object(u.a)(K,2),X=Z[0],ee=Z[1],te=Object(a.useState)(!1),ne=Object(u.a)(te,2),ae=ne[0],ie=ne[1],oe=Object(a.useState)([]),le=Object(u.a)(oe,2),se=le[0],re=le[1],de=Object(a.useState)([]),ue=Object(u.a)(de,2),ve=ue[0],be=ue[1],je=Object(a.useState)([]),me=Object(u.a)(je,2),pe=(me[0],me[1]),Oe=Object(a.useState)([]),fe=Object(u.a)(Oe,2),he=(fe[0],fe[1]),ge=Object(a.useRef)(W()),xe=Object(a.useRef)(void 0),ye=Object(a.useRef)(void 0),Ie=Object(a.useRef)(0),Se=Object(a.useRef)(void 0),Ne=Object(a.useRef)(!1),ke=Object(a.useRef)(void 0),Te=Object(a.useRef)(void 0),Ce=Object(a.useRef)([]),we=Object(a.useRef)([]),Ee=Object(a.useState)(),Re=Object(u.a)(Ee,2),Pe=Re[0],De=Re[1],Ae=Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0}),Me=Object(u.a)(Ae,2),Le=Me[0],Ue=Me[1],qe=Object(a.useState)(0),Fe=Object(u.a)(qe,2),Be=Fe[0],_e=Fe[1],$e=Object(a.useState)([]),Ye=Object(u.a)($e,2),He=Ye[0],We=Ye[1],Ve=Object(a.useRef)(void 0),ze=Object(a.useRef)(void 0),Qe=Object(a.useState)([]),Ge=Object(u.a)(Qe,2),Je=Ge[0],Ke=Ge[1],Ze=Object(a.useState)(!1),Xe=Object(u.a)(Ze,2),et=Xe[0],nt=Xe[1],at=Object(a.useState)(!1),it=Object(u.a)(at,2),ct=(it[0],it[1],Object(a.useState)([])),ot=Object(u.a)(ct,2),lt=(ot[0],ot[1]),st=Object(a.useState)(void 0),rt=Object(u.a)(st,2),dt=rt[0],ut=rt[1],vt=Object(a.useRef)({project:void 0,user:void 0,area:void 0,time:void 0,name:void 0}),bt=Object(a.useRef)({status:void 0,time:void 0,phone:void 0}),jt=Object(a.useRef)({}),mt=Object(a.useRef)(),pt=Object(a.useRef)([]),Ot=Object(a.useState)(void 0),ft=Object(u.a)(Ot,2),ht=ft[0],gt=ft[1],xt=Object(a.useState)(["First string","Second string","Third string"]),yt=Object(u.a)(xt,2),It=(yt[0],yt[1]),St=Object(a.useState)(""),Nt=Object(u.a)(St,2),kt=Nt[0],Tt=Nt[1],Ct=Object(a.useState)(""),wt=Object(u.a)(Ct,2),Et=wt[0],Rt=wt[1],Pt=Object(a.useState)("last24hours"),Dt=Object(u.a)(Pt,2),At=Dt[0],Mt=Dt[1],Lt=Object(a.useCallback)(Object(Ac.a)(2e3,function(){console.log("debounce"),Wt()},{atBegin:!0}),[]),Ut=Object(a.useCallback)(function(e){var t,n,a;null!==(t=jt.current)&&void 0!==t&&t[e]||(jt.current[e]=Object(Ac.a)(2e3,function(e){console.log("search page here",e),Ht(e)},{atBegin:!1})),null===(n=jt.current)||void 0===n||null===(a=n[e])||void 0===a||a.call(n,e)},[]),qt=function(e){bt.current.status=e?"@rideStatus:{".concat(Yl[e],"}"):void 0,bt.current.phone=void 0,J(!0),Se.current=e,ut(e),Gt()},Ft=function(e){vt.current.name=e&&""!==e?"exists(@patientPhoneNumber) && contains(@patientPhoneNumber, '".concat(e,"')"):void 0,J(!0),Gt()};Object(a.useEffect)(function(){f&&Ft(null===f||void 0===f?void 0:f.phone)},[f]);var Bt=function(e){if(S!==e&&null!==j&&void 0!==j&&j.projects&&h){F(void 0),re([]);switch(e){case"project":var t=[];null===g||void 0===g||g.map(function(e){t.push({label:e.info.name,value:null===e||void 0===e?void 0:e.objectId})}),re(t);break;case"vehicle":var n,a=[];null===j||void 0===j||null===(n=j.projects)||void 0===n||n.filter(function(e){return"vehicle"===(null===e||void 0===e?void 0:e.type)}).map(function(e){a.push({label:e.name,value:e.id})}),re(a);break;case"manager":$t(h,"manager");break;case"dispatcher":$t(h,"dispatcher");break;case"responder":$t(h,"responder")}N(e)}},_t=function(e){E!==e&&(Y(void 0),be([]),Yt(e),R(e))},$t=function(e,n){var a;switch(n){case"dispatcher":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1===e.permissions.indexOf("admin")});break;case"responder":a=e.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")});break;case"manager":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")})}var i=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),c={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===j||void 0===j?void 0:j.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(i.join("||"),")")},anyStatus:!1};t.publishToEvent(m.PublishPageTopics,xn(null===O||void 0===O?void 0:O.connectionId),Dn(c,"".concat(ge.current,":").concat(n))),M(!0)},Yt=function(e){ee(!0);var t={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===O||void 0===O?void 0:O.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(T.a)({},e,"$.persistent.static.profile.".concat(e))},groupBy:{properties:["@".concat(e)],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:""}};x(tt({requestData:t,callback:function(e){ee(!1);var t=[];null===e||void 0===e||e.map(function(e){e[Object.keys(e)[0]]&&t.push({label:e[Object.keys(e)[0]],value:e[Object.keys(e)[0]]})}),be(t)}}))},Ht=function(e){var t;if("string"===typeof e){var n={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===(t=mt.current)||void 0===t?void 0:t.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},list:{objectIds:[e]},load:{persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId"}},filter:{expression:""}};x(tt({requestData:n,callback:function(e){De(null===e||void 0===e?void 0:e[0])}}))}},Wt=function(){var e,t=[],n="";if(bt.current.time)n+=bt.current.time;else{var a=new Date;a.setHours(0),a.setMinutes(1),n+="@createdAt:[".concat(a.getTime(),",+inf]")}vt.current&&Object.keys(vt.current).map(function(e){var n,a;null!==(n=vt.current)&&void 0!==n&&n[e]&&t.push(null===(a=vt.current)||void 0===a?void 0:a[e])});var i={};pt.current&&pt.current.map(function(e){i[e.key]=e.value});var c={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{'".concat(null===mt||void 0===mt||null===(e=mt.current)||void 0===e?void 0:e.userId,"'}").concat(Ne.current?"":"(-@rideType:{hail})","@pageType:{event}").concat(n),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",rideType:"$..profile.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",status:"$.nonpersistent.static.live.status.name",vehicleProjectId:"$..profile.vehicle..projectId",patientFullName:"$..profile.patientFullName",patientPhoneNumber:"$..profile.patientPhoneNumber",accountId:"$..profile.billingInstitute"},E,"$..profile.".concat(E)),i)},groupBy:{properties:["@status"],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:t.join("&&")}};x(tt({requestData:c,callback:function(e){var t=0,n={amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0};e.map(function(e){n[e.status]=e.count,t+=e.count}),Ue(Object(d.a)({all:t,live:t},n))}}))};Object(a.useEffect)(function(){Le&&_e(Be+1)},[JSON.stringify(Le)]),Object(a.useEffect)(function(){if(Pe){var e,t,n,a,i,c,o,l,s,r,u,v,b,m,p,O,f,h,g,x,y,I,S,N,k,T,w,E,R,P,D,A,M,L,U,q,F,B,_,$,Y,W,V,z,Q,G,J,K,Z=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===Pe||void 0===Pe||null===(e=Pe.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.profile)||{}),(null===Pe||void 0===Pe||null===(n=Pe.persistent)||void 0===n||null===(a=n.static)||void 0===a?void 0:a.dashboard)||{}),(null===Pe||void 0===Pe||null===(i=Pe.persistent)||void 0===i||null===(c=i.static)||void 0===c?void 0:c.ride)||{}),(null===Pe||void 0===Pe||null===(o=Pe.persistent)||void 0===o||null===(l=o.dynamic)||void 0===l?void 0:l.ride)||{}),X=null===Pe||void 0===Pe||null===(s=Pe.nonpersistent)||void 0===s||null===(r=s.static)||void 0===r||null===(u=r.live)||void 0===u||null===(v=u.status)||void 0===v?void 0:v.name,ee=null===Pe||void 0===Pe||null===(b=Pe.persistent)||void 0===b||null===(m=b.static)||void 0===m||null===(p=m.profile)||void 0===p?void 0:p.type,te=null===Pe||void 0===Pe||null===(O=Pe.persistent)||void 0===O||null===(f=O.static)||void 0===f||null===(h=f.metadata)||void 0===h?void 0:h.type;if(!Ne.current&&"hail"===ee||"event"!==te)return;var ne=Object(C.a)(He),ae=ne.findIndex(function(e){return e.key===Pe.pageId});if(Lt(),Se.current&&Se.current!==X)return void(-1!==ae&&(ne.splice(ae,1),We(ne),Ve.current=ne));var ie={};Object.keys(Z).map(function(e){"string"===typeof Z[e]&&(ie[e]=Z[e])});var ce,oe,le,se,re,de=(null===(g=ze.current)||void 0===g||null===(x=g.find(function(e){var t,n,a;return e.id===(null===Pe||void 0===Pe||null===(t=Pe.nonpersistent)||void 0===t||null===(n=t.dynamic)||void 0===n||null===(a=n.ride)||void 0===a?void 0:a.dispatchRequestBy)}))||void 0===x?void 0:x.beamId)||"",ue=(null===(y=ze.current)||void 0===y||null===(I=y.find(function(e){var t,n,a,i;return e.id===(null===(t=Object.keys((null===Pe||void 0===Pe||null===(n=Pe.nonpersistent)||void 0===n||null===(a=n.dynamic)||void 0===a||null===(i=a.ride)||void 0===i?void 0:i.manualUsers)||{}))||void 0===t?void 0:t[0])||""}))||void 0===I?void 0:I.beamId)||"";if(null===(S=Object.keys((null===Pe||void 0===Pe||null===(N=Pe.persistent)||void 0===N||null===(k=N.static)||void 0===k||null===(T=k.payment)||void 0===T?void 0:T.stripe)||{}))||void 0===S||S.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Pe||void 0===Pe||null===(t=Pe.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"succeeded"===(null===Pe||void 0===Pe||null===(o=Pe.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(ce=null===Pe||void 0===Pe||null===(u=Pe.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])}),!ce)null===(oe=Object.keys((null===Pe||void 0===Pe||null===(le=Pe.persistent)||void 0===le||null===(se=le.static)||void 0===se||null===(re=se.payment)||void 0===re?void 0:re.stripe)||{}))||void 0===oe||oe.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Pe||void 0===Pe||null===(t=Pe.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"requires_capture"===(null===Pe||void 0===Pe||null===(o=Pe.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(ce=null===Pe||void 0===Pe||null===(u=Pe.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])});var ve,be,je=Object(d.a)(Object(d.a)({key:Pe.pageId,pageStatus:null===Pe||void 0===Pe||null===(w=Pe.nonpersistent)||void 0===w||null===(E=w.static)||void 0===E||null===(R=E.live)||void 0===R||null===(P=R.status)||void 0===P?void 0:P.name,requestedBy:de,requestedAt:new Date(null===Pe||void 0===Pe||null===(D=Pe.persistent)||void 0===D||null===(A=D.static)||void 0===A||null===(M=A.metadata)||void 0===M?void 0:M.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:ue,name:null===Pe||void 0===Pe||null===(L=Pe.persistent)||void 0===L||null===(U=L.static)||void 0===U||null===(q=U.metadata)||void 0===q?void 0:q.title,action:{pageId:Pe.pageId,page:Object(d.a)(Object(d.a)({},Pe),{},{profile:Z}),summary:ie.summary,cudbServiceId:null===j||void 0===j?void 0:j.userServiceId,stripe:ce}},ie),{},{address:null!==ie&&void 0!==ie&&ie.address&&""!==(null===ie||void 0===ie?void 0:ie.adress)?null===ie||void 0===ie?void 0:ie.address:null===Z||void 0===Z||null===(F=Z.pickupLocation)||void 0===F||null===(B=F.attributes)||void 0===B?void 0:B.address,dropoffAddress:null!==ie&&void 0!==ie&&ie.dropoffAddress&&""!==(null===ie||void 0===ie?void 0:ie.dropoffAddress)?null===ie||void 0===ie?void 0:ie.dropoffAddress:null===Z||void 0===Z||null===(_=Z.dropoffLocation)||void 0===_||null===($=_.attributes)||void 0===$?void 0:$.address,driverName:null===Z||void 0===Z||null===(Y=Z.primaryResponder)||void 0===Y?void 0:Y.name,driverId:null===Z||void 0===Z||null===(W=Z.primaryResponder)||void 0===W||null===(V=W.id)||void 0===V?void 0:V.toString(),vehicleName:null===Z||void 0===Z||null===(z=Z.vehicle)||void 0===z||null===(Q=z.obj)||void 0===Q?void 0:Q.name,description:(null===Z||void 0===Z||null===(G=Z.customMessages)||void 0===G||null===(J=G[0])||void 0===J||null===(K=J.attributes)||void 0===K?void 0:K.body)||"N/A"});if(-1!==ae)ne[ae]=Object(d.a)(Object(d.a)({},je),{},{invited:null===Ve||void 0===Ve||null===(ve=Ve.current)||void 0===ve||null===(be=ve[ae])||void 0===be?void 0:be.invited});else ne.unshift(je);he(null===ne||void 0===ne?void 0:ne.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;return{lat:null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(i=a.static)||void 0===i||null===(c=i.live)||void 0===c||null===(o=c.location)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l.lat,lng:null===e||void 0===e||null===(s=e.action)||void 0===s||null===(r=s.page)||void 0===r||null===(d=r.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.location)||void 0===b?void 0:b.coordinates.long,title:null===e||void 0===e||null===(j=e.action)||void 0===j||null===(m=j.page)||void 0===m||null===(p=m.persistent)||void 0===p||null===(O=p.static)||void 0===O||null===(f=O.metadata)||void 0===f?void 0:f.title}}));var me=Te.current?H()(Te.current).format("YYYY-MM-DD"):void 0,pe=me?[].concat(Object(C.a)(ne.filter(function(e){return!e.driverId}).map(function(e,t){return Object(d.a)({key:"unassigned-task-".concat(t),driverId:"",driverName:"",isShift:!1},e)})),Object(C.a)(we.current.flatMap(function(e){var t,n=ne.filter(function(t){return t.driverId===e.id});if(0===n.length)return[];var a={key:"".concat(e.id,"-shift"),driverId:e.id,driverName:e.fullName,isShift:!0,timeSlots:(null===(t=Ce.current.find(function(e){return e.key===me}))||void 0===t?void 0:t[e.id])||[]},i=n.map(function(t,n){return Object(d.a)({key:"".concat(e.id,"-task-").concat(n),isShift:!1},t)});return[a].concat(Object(C.a)(i))})),Object(C.a)(we.current.filter(function(e){return 0===ne.filter(function(t){return t.driverId===e.id}).length}).map(function(e){var t;return{key:"".concat(e.id,"-shift"),driverId:e.id,driverName:e.fullName,isShift:!0,timeSlots:(null===(t=Ce.current.find(function(e){return e.key===me}))||void 0===t?void 0:t[e.id])||[]}}))):ne;We(pe),Ve.current=pe}},[Pe]);var Vt=[{label:"Pending",color:"purple"},{label:"Assigned",color:"amber"},{label:"Accepted",color:"aqua"},{label:"Started",color:"blue"},{label:"Escalated",color:"red"},{label:"Completed",color:"green"},{label:"Cancelled",color:"black"}],zt=function(e){var t=Al.a.json_to_sheet(He),n=Al.a.book_new();Al.a.book_append_sheet(n,t,"Data"),Al.b(n,"table_data.".concat(e))},Qt=function(e){var t={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===j||void 0===j?void 0:j.userServiceId),"'}@partitions:{type\\:shift}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status",startTimestamp:"$..startTimestamp",endTimestamp:"$..endTimestamp"}},filter:{expression:"exists(@startTimestamp) && exists(@endTimestamp) && @startTimestamp < ".concat(e," && @endTimestamp > ").concat(e)}};x(tt({requestData:t,callback:function(t){var n,a;console.log(" shift response here",t),Ce.current=null===t||void 0===t||null===(n=t[0])||void 0===n||null===(a=n.info)||void 0===a?void 0:a.shift,Te.current=e,Gt()}}))},Gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=[],a="",i="";if("advance"===c)Se.current="brown",n.push("exists(@status) && @status === 'brown'");else if("dispatch"===c)Se.current="purple",n.push("exists(@status) && @status === 'purple'");else if(vt.current)if(Object.keys(vt.current).map(function(e){var t,a;null!==(t=vt.current)&&void 0!==t&&t[e]&&n.push(null===(a=vt.current)||void 0===a?void 0:a[e])}),bt.current.time||bt.current.phone)bt.current.time&&(a+=bt.current.time);else{var o=new Date;o.setHours(0),o.setMinutes(1),a+="@createdAt:[".concat(o.getTime(),",+inf]")}bt.current.status&&n.push("exists(@status) && @status === '".concat(Se.current,"'")),bt.current.phone&&(i=bt.current.phone);var l={};pt.current&&pt.current.map(function(e){l[e.key]=e.value}),Ie.current=e;var s={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===O||void 0===O?void 0:O.userId,"}").concat(Ne.current?"":"(-@rideType:{hail})","@pageType:{event}").concat(a).concat("").concat(i),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",ride:"$.persistent.static.ride",type:"$..persistent.static.metadata.type",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",rideType:"$..profile.type",phone:"$..profile.studentPhone",patientFullName:"$..profile.patientFullName",patientPhoneNumber:"$..profile.patientPhoneNumber",vehicleProjectId:"$..profile.vehicle..projectId",accountId:"$..profile.billingInstitute"},E,"$..profile.".concat(E)),l)},filter:{expression:n.join("&&")},sortBy:{properties:["advance"===c?{field:"@createdAt",order:"ASC"}:{field:"@updatedAt",order:"DESC"}],max:1e3},result:bt.current.phone?{pagination:{offset:e,limit:50}}:{}};x(tt({requestData:s,callback:function(n){console.log("resppnse",n),pe(n),Ie.current=Ie.current+30;var a=e>0?Object(C.a)(He):[],i=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",width:100,render:function(e,n){var a=Object(oa.jsx)(ti.a,{onClick:function(e){var a=e.key;!function(e,n){var a,i=(null===(a=Vt.find(function(e){return e.label===n}))||void 0===a?void 0:a.color)||"gray",c=[{op:"replace",path:"/nonpersistent/static/live/status",value:{name:i,color:Hl[i]}}];ke.current=null===e||void 0===e?void 0:e.toString(),t.publishToEvent(m.PublishPageTopics,ln(null===O||void 0===O?void 0:O.connectionId),Dn({objectId:e.toString(),changes:c}))}(n.key,a)},items:Vt.map(function(e){return{label:e.label,key:e.label}})});return n.isShift?Object(oa.jsx)("div",{}):Object(oa.jsx)(ni.a,{overlay:a,trigger:["click"],children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})})}},{title:"Action",key:"action",dataIndex:"action",width:100,render:function(e,t){return t.isShift?Object(oa.jsx)("div",{}):Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:null!==e&&void 0!==e&&e.summary?6:12,children:Object(oa.jsx)(Sl.a,{overlay:"Go to page chat",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){var t;t=null===e||void 0===e?void 0:e.pageId,x(ce({data:{payload:JSON.stringify({userId:null===O||void 0===O?void 0:O.userId,connectionId:null===O||void 0===O?void 0:O.connectionId,cudbServiceId:null===j||void 0===j?void 0:j.userServiceId})},callback:function(e){window.open("".concat("https://live.staging.beam.live","/auth/login?token=").concat(e.encryptedPayload,"&redirect=page/").concat(t))}}))},children:Object(oa.jsx)(Zc.a,{})})})}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:null!==e&&void 0!==e&&e.summary?6:12,children:Object(oa.jsx)(Sl.a,{overlay:"Copy job",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){var e;navigator.clipboard.writeText(null!==(e=t.description)&&void 0!==e?e:"")},children:Object(oa.jsx)(Xc.a,{})})})})}),(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){var t;window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(null===O||void 0===O?void 0:O.connectionId,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:Object(oa.jsx)(Ec.a,{})})})]})}},{title:"Instructions",key:"instructions",dataIndex:"instructions",width:100},{title:"Driver",key:"driverNameFull",dataIndex:"driverNameFull",width:100,sorter:function(e,t){var n;return null===(n=e.driverName)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.driverName)}},{title:"Shift",dataIndex:"shift",key:"shift",width:100,render:function(e,t){return t.isShift?Object(oa.jsx)("p",{style:{color:"#000",fontFamily:"Nunito-Bold"},children:t.timeSlots&&t.timeSlots.length>0?t.timeSlots.map(function(e){var t,n,a,i,c,o;return Array.isArray(null===e||void 0===e?void 0:e.time)?"".concat(null===e||void 0===e||null===(t=e.time)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.split(" ")[1],"-").concat(null===e||void 0===e||null===(a=e.time)||void 0===a||null===(i=a[1])||void 0===i?void 0:i.split(" ")[1]).concat(null!==e&&void 0!==e&&null!==(c=e.time)&&void 0!==c&&c[1]&&null!==e&&void 0!==e&&null!==(o=e.time)&&void 0!==o&&o[0]&&tc()(e.time[1]).isAfter(tc()(e.time[0]),"day")?" (next day)":""," ").concat(null===e||void 0===e?void 0:e.shiftType," ").concat(null===e||void 0===e?void 0:e.locationType):e}).join(", "):"No shift assigned"}):Object(oa.jsx)("div",{})}},{title:"Vehicle",key:"vehicleName",dataIndex:"vehicleName",width:100,sorter:function(e,t){var n;return null===(n=e.vehicleName)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.vehicleName)}},{title:"Time",key:"pickupTime",dataIndex:"pickupTime",width:100,sorter:function(e,t){var n;return null===(n=e.pickupTime)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.pickupTime)}},{title:"Date",key:"pickupDate",dataIndex:"pickupDate",width:100,sorter:function(e,t){return e.createdAt-t.createdAt}},{title:"Transfer Type",key:"transferType",dataIndex:"transferType",width:100,sorter:function(e,t){var n;return null===(n=e.transferType)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.transferType)}},{title:"Equipment",key:"equipmentNeeded",dataIndex:"equipmentNeeded",width:100},{title:"Description",key:"description",dataIndex:"description",width:400}];null===n||void 0===n||n.map(function(e,t){var n,i,c,o,l,s,r,u,v,b,m,p,O,f,h,g,x,y,I,S,N,k=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),T={};Object.keys(k).map(function(e){"string"===typeof k[e]&&(T[e]=k[e])});var C,w,E=ze.current||JSON.parse(localStorage.getItem("rideUsers")||"[]"),R=(null===E||void 0===E||null===(n=E.find(function(t){var n;return t.id===(null===e||void 0===e||null===(n=e.requestedBy)||void 0===n?void 0:n.toString())}))||void 0===n?void 0:n.beamId)||"",P=(null===E||void 0===E||null===(i=E.find(function(t){var n;return t.id===(null===(n=Object.keys((null===e||void 0===e?void 0:e.manualUsers)||{}))||void 0===n?void 0:n[0])||""}))||void 0===i?void 0:i.beamId)||"";(null===(c=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===c||c.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"succeeded"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(C=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}),C)||(null===(w=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===w||w.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"requires_capture"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(C=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}));a.push(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:k}),summary:T.summary,cudbServiceId:null===j||void 0===j?void 0:j.userServiceId,stripe:C}},T),{},{address:null!==T&&void 0!==T&&T.address&&""!==(null===T||void 0===T?void 0:T.adress)?null===T||void 0===T?void 0:T.address:null===k||void 0===k||null===(o=k.pickupLocation)||void 0===o||null===(l=o.attributes)||void 0===l?void 0:l.address,dropoffAddress:null!==T&&void 0!==T&&T.dropoffAddress&&""!==(null===T||void 0===T?void 0:T.dropoffAddress)?null===T||void 0===T?void 0:T.dropoffAddress:null===k||void 0===k||null===(s=k.dropoffLocation)||void 0===s||null===(r=s.attributes)||void 0===r?void 0:r.address,invited:"",createdAt:null===e||void 0===e?void 0:e.createdAt,driverName:null===k||void 0===k||null===(u=k.primaryResponder)||void 0===u?void 0:u.name,driverNameFull:"".concat((null===k||void 0===k||null===(v=k.primaryResponder)||void 0===v?void 0:v.name)||"").concat((null===k||void 0===k||null===(b=k.secondaryResponder)||void 0===b||null===(m=b.responders)||void 0===m?void 0:m.length)>0?",":""," ").concat((null===k||void 0===k||null===(p=k.secondaryResponder)||void 0===p||null===(O=p.responders)||void 0===O||null===(f=O.map(function(e){return"".concat(e.firstName," ").concat(e.lastName)}))||void 0===f?void 0:f.join(", "))||""),driverId:null===k||void 0===k||null===(h=k.primaryResponder)||void 0===h||null===(g=h.id)||void 0===g?void 0:g.toString(),vehicleName:null===k||void 0===k||null===(x=k.vehicle)||void 0===x||null===(y=x.obj)||void 0===y?void 0:y.name,requestedBy:R,requestedAt:new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),description:(null===k||void 0===k||null===(I=k.customMessages)||void 0===I||null===(S=I[0])||void 0===S||null===(N=S.attributes)||void 0===N?void 0:N.body)||"N/A",assigned:P}))}),console.log("source data",a),a.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===i.findIndex(function(t){return t.key===e})&&t[e]})}),Ke(i);var c=Te.current?H()(Te.current).format("YYYY-MM-DD"):void 0,o=c?[].concat(Object(C.a)(a.filter(function(e){return!e.driverId}).map(function(e,t){return Object(d.a)({key:"unassigned-task-".concat(t),driverId:"",driverName:"",isShift:!1},e)})),Object(C.a)(we.current.flatMap(function(e){var t,n,i=a.filter(function(t){return t.driverId===e.id});if(0===i.length)return[];var o={key:"".concat(e.id,"-shift"),driverId:e.id,driverName:e.fullName,isShift:!0,timeSlots:(null===(t=Ce.current)||void 0===t||null===(n=t.find(function(e){return e.key===c}))||void 0===n?void 0:n[e.id])||[]},l=i.map(function(t,n){return Object(d.a)({key:"".concat(e.id,"-task-").concat(n),isShift:!1},t)});return[o].concat(Object(C.a)(l))})),Object(C.a)(we.current.filter(function(e){return 0===a.filter(function(t){return t.driverId===e.id}).length}).map(function(e){var t,n;return{key:"".concat(e.id,"-shift"),driverId:e.id,driverName:e.fullName,isShift:!0,timeSlots:(null===(t=Ce.current)||void 0===t||null===(n=t.find(function(e){return e.key===c}))||void 0===n?void 0:n[e.id])||[]}}))):a;console.log("detail data",o),We(o),Ve.current=o,he(null===n||void 0===n?void 0:n.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),J(!1),M(!1),ee(!1),ie(!1)}})),Lt()};Object(a.useEffect)(function(){O&&(mt.current=O,t.subscribeToEvent(m.SubscribePageTopics,Rn(null===O||void 0===O?void 0:O.userId),function(e){Ut(null===e||void 0===e?void 0:e.data)},o),M(!0),Gt(),function(){var e="@serviceId:{'".concat(z(null===j||void 0===j?void 0:j.userServiceId),"'}"),t=h.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")});console.log("selected user roles",t);var n=t.map(function(e){return"@roleId === '".concat(e._id,"'")}),a={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:e,searchOptions:"TIMEOUT 5000"},list:{objectIds:void 0},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(n.join("||"),")")},anyStatus:!1};x(tt({requestData:a,callback:function(e){var t=[];null===e||void 0===e||e.map(function(e,n){var a,i,c,o;t.push({id:e.id.toString(),fullName:"".concat(null===e||void 0===e||null===(a=e.live)||void 0===a||null===(i=a.profile)||void 0===i?void 0:i.firstName," ").concat(null===e||void 0===e||null===(c=e.live)||void 0===c||null===(o=c.profile)||void 0===o?void 0:o.lastName)})}),t=t.sort(function(e,t){return e.fullName.localeCompare(t.fullName)}),we.current=t}}))}(),Yt("state"),lt(JSON.parse(localStorage.getItem("tableHideList"))||[]),t.subscribeToEvent(m.SubscribePageTopics,on(null===O||void 0===O?void 0:O.connectionId),function(e){ke.current&&Ht(ke.current)}))},[O]),Object(a.useEffect)(function(){if(g&&g.length>0){var e=[];null===g||void 0===g||g.map(function(t){e.push({label:t.info.name,value:null===t||void 0===t?void 0:t.objectId})}),re(e)}},[g]),Object(a.useEffect)(function(){j&&null!==j&&void 0!==j&&j.adminUserId&&(t.subscribeToEvent(m.SubscribePageTopics,bn(null===O||void 0===O?void 0:O.connectionId,null===j||void 0===j?void 0:j.userServiceId)),t.subscribeToEvent(m.SubscribePageTopics,yn(null===O||void 0===O?void 0:O.connectionId)))},[j]),Object(a.useEffect)(function(){if(b&&t.client){var e,n;if(!ze.current&&null!==b&&void 0!==b&&b[null===(e=Object.keys(b))||void 0===e?void 0:e[0]])ze.current=null===b||void 0===b?void 0:b[null===(n=Object.keys(b))||void 0===n?void 0:n[0]],localStorage.setItem("rideUsers",JSON.stringify(ze.current));if(null!==b&&void 0!==b&&b["".concat(ge.current,":").concat(S)]){var a;M(!1);var i=[];null===b||void 0===b||null===(a=b["".concat(ge.current,":").concat(S)])||void 0===a||a.map(function(e){i.push({label:"".concat(e.fullName,": ").concat(e.email),value:e.id})}),re(i)}}},[b,t.client]);var Jt=function(e){var t=Object(a.useState)([]),n=Object(u.a)(t,2),i=n[0],c=n[1],o=Object(a.useState)([]),l=Object(u.a)(o,2),s=l[0],r=l[1];Object(a.useEffect)(function(){if((null===e||void 0===e?void 0:e.length)>0){var t=e.map(function(e){return Object(d.a)(Object(d.a)({},e),{},{width:e.width||150})});c(t)}},[e]),Object(a.useEffect)(function(){console.log("columns",i)},[i]);var v=Object(a.useCallback)(function(e){return function(t,n){var a=n.size;console.log("Resizing column [".concat(e,"] ->"),a.width),c(function(t){return t.map(function(t){return t.key===e?Object(d.a)(Object(d.a)({},t),{},{width:a.width}):t})})}},[]);return{columns:i.filter(function(e){return s.includes(e.key)}).map(function(e){return Object(d.a)(Object(d.a)({},e),{},{onHeaderCell:function(t){return{width:t.width,onResize:v(e.key)}}})}),allColumns:i,visibleKeys:s,setVisibleKeys:r,ResizableTitle:zl}}(Je),Kt=Jt.columns,Zt=(Jt.allColumns,Jt.visibleKeys),Xt=Jt.setVisibleKeys,en=Jt.ResizableTitle;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{gutter:30,className:"mb-2",style:et?{}:{display:"none"},children:[Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{gutter:16,className:"d-flex px-1 flex-wrap",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){Bt("project")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("project"===S?"green-btn cover":""),children:"Institute"})}),Object(oa.jsx)("div",{onClick:function(){Bt("vehicle")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("vehicle"===S?"green-btn cover":""),children:"Vehicle"})}),Object(oa.jsx)("div",{onClick:function(){Bt("dispatcher")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("dispatcher"===S?"green-btn cover":""),children:"Dispatcher"})}),Object(oa.jsx)("div",{onClick:function(){Bt("responder")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("responder"===S?"green-btn cover":""),children:"Driver"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:A,value:q,allowClear:!0,showSearch:!0,filterOption:function(e,t){var n;return null===(n=t.label)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},options:se,onChange:function(e){!function(e){switch(F(e),S){case"project":vt.current.project=e?"exists(@accountId) && @accountId === '".concat(e,"'"):void 0,vt.current.user=void 0,M(!0);break;case"vehicle":vt.current.project=e?"exists(@vehicleProjectId) && @vehicleProjectId === '".concat(e,"'"):void 0,vt.current.user=void 0,M(!0);break;case"responder":case"dispatcher":pt.current=[{key:"user",value:"$.persistent.static.metadata.members.users.".concat(e)}],vt.current.user=e?"exists(@user)":void 0,vt.current.project=void 0,M(!0)}Gt()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex px-2 flex-wrap mt-4",children:Object(oa.jsx)(Hn.a,{sm:24,md:4,children:Object(oa.jsx)("h5",{className:"mb-0",children:"Search"})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Fi.a,{placeholder:"Phone number",defaultCountry:"CA",allowClear:!0,value:kt,onChange:function(e){console.log("phone",e),Tt(e),e&&Object(Fi.b)(e)&&(Tl&&clearTimeout(Tl),Tl=setTimeout(function(){Ft(e)},700))}})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Wn.a,{placeholder:"Patient Name",value:Et,onChange:function(e){var t=e.target.value;Rt(t),Tl&&clearTimeout(Tl),Tl=setTimeout(function(){!function(e){vt.current.name=e&&""!==e?"exists(@patientFullName) && contains(@patientFullName, '".concat(e,"')"):void 0,J(!0),Gt()}(t)},700)}})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{className:"d-flex flex-wrap",id:"filters",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){_t("state")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("state"===E?"green-btn cover":""),children:"Province"})}),Object(oa.jsx)("div",{onClick:function(){_t("city")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("city"===E?"green-btn cover":""),children:"City"})}),Object(oa.jsx)("div",{onClick:function(){_t("county")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("county"===E?"green-btn cover":""),children:"Municipality"})}),Object(oa.jsx)("div",{onClick:function(){_t("zip")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("zip"===E?"green-btn cover":""),children:"Postal Code"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{xs:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:X,allowClear:!0,options:ve,value:$,onChange:function(e){!function(e){Y(e),vt.current.time=e?"exists(@".concat(E,") && @").concat(E," === '").concat(e,"'"):void 0,ee(!0),Gt()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex flex-wrap mt-3 mx-0",children:Object(oa.jsx)(Ql,{onChange:function(e){console.log("value here",e),Mt(e.selected),function(e){if(xe.current=e.startTimestamp,ye.current=e.endTimestamp,xe.current&&ye.current){var t=new Date(xe.current);t.setHours(0),t.setMinutes(1);var n=new Date(ye.current);n.setHours(23),n.setMinutes(59),bt.current.time="@createdAt:[".concat(t.getTime(),",+inf]@createdAt:[-inf, ").concat(n.getTime(),"]"),ee(!0),"specificDate"===e.selected?Qt(e.startTimestamp):(Te.current=void 0,Gt())}else xe.current||ye.current||(bt.current.time="",ee(!0),Te.current=void 0,Gt())}(e)},value:At})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select Hour(s)",disabled:!0})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:4,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsx)("p",{className:"mb-2 text-center",children:"Export to"}),Object(oa.jsxs)("div",{className:"d-flex flex-row flex-md-column justify-content-center",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",onClick:function(){return zt("csv")},children:Object(oa.jsx)(fa.a,{src:"/images/export-csv.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",onClick:function(){return zt("xlsx")},children:Object(oa.jsx)(fa.a,{src:"/images/export-xls.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",onClick:function(){var e=new Ml.default,t=Je.map(function(e){return e.title}),n=He.map(function(e){return Je.map(function(t){return e[t.dataIndex]})});Ul()(e,{head:[t],body:n}),e.save("table_data.pdf")},children:Object(oa.jsx)(fa.a,{src:"/images/export-pdf.svg"})})})]})]})})]}),n&&Object(oa.jsxs)(Yn.a,{className:"d-flex mb-2",children:[Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat(void 0===dt?"status-selected":""),onClick:function(){qt(void 0)},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"All"}),Object(oa.jsx)("h4",{children:Le.live})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("purple"===dt?"status-selected":""),onClick:function(){qt("purple")},children:Object(oa.jsxs)("div",{className:"purple",children:[Object(oa.jsx)("span",{children:"Pending"}),Object(oa.jsx)("h4",{children:Le.purple})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("amber"===dt?"status-selected":""),onClick:function(){qt("amber")},children:Object(oa.jsxs)("div",{className:"amber",children:[Object(oa.jsx)("span",{children:"Assigned"}),Object(oa.jsx)("h4",{children:Le.amber})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("aqua"===dt?"status-selected":""),onClick:function(){qt("aqua")},children:Object(oa.jsxs)("div",{className:"aqua",children:[Object(oa.jsx)("span",{children:"Accepted"}),Object(oa.jsx)("h4",{children:Le.aqua})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("blue"===dt?"status-selected":""),onClick:function(){qt("blue")},children:Object(oa.jsxs)("div",{className:"blue",children:[Object(oa.jsx)("span",{children:"Started"}),Object(oa.jsx)("h4",{children:Le.blue})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("red"===dt?"status-selected":""),onClick:function(){qt("red")},children:Object(oa.jsxs)("div",{className:"red",children:[Object(oa.jsx)("span",{children:"Escalated"}),Object(oa.jsx)("h4",{children:Le.red})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("green"===dt?"status-selected":""),onClick:function(){qt("green")},children:Object(oa.jsxs)("div",{className:"green",children:[Object(oa.jsx)("span",{children:"Completed"}),Object(oa.jsx)("h4",{children:Le.green})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("black"===dt?"status-selected":""),onClick:function(){qt("black")},children:Object(oa.jsxs)("div",{className:"black",children:[Object(oa.jsx)("span",{children:"Cancelled"}),Object(oa.jsx)("h4",{children:Le.black})]})}),Object(oa.jsx)(Sl.a,{overlay:"Dispatch Form",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0px 10px 0"},onClick:function(){r()},children:Object(oa.jsx)(fa.a,{src:"/images/desktop-icon.svg"})})}),Object(oa.jsx)(Sl.a,{overlay:"Toggle map",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0px 10px 0"},onClick:function(){l()},children:Object(oa.jsx)(fa.a,{src:"/images/map.svg"})})}),Object(oa.jsx)(Sl.a,{overlay:"Filter jobs",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0 10px 0"},onClick:function(){nt(!et)},children:Object(oa.jsx)(Rc.a,{})})}),Object(oa.jsx)(Sl.a,{overlay:"Refresh table",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0px 10px 0"},loading:A||G,onClick:function(){M(!0),Gt()},children:!A&&!G&&Object(oa.jsx)(El.a,{})})}),Object(oa.jsx)(Sl.a,{overlay:"Reset filter",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0px 10px 0",padding:"0 12px "},loading:ae,onClick:function(){vt.current={project:void 0,user:void 0,area:void 0,time:void 0,name:void 0},bt.current={status:void 0,time:void 0,phone:void 0},N("project"),R("state"),F(void 0),Y(void 0),ut(void 0),Se.current=void 0,ie(!0),Tt(""),Rt(""),Mt("last24hours"),Te.current=void 0,Gt()},children:!ae&&Object(oa.jsx)(fa.a,{src:"/images/reload-icon.svg"})})}),Object(oa.jsx)(Sl.a,{overlay:"Show/hide columns",children:Object(oa.jsx)(Vl,{allColumns:Je,visibleKeys:Zt,setVisibleKeys:Xt})})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid"},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,children:Object(oa.jsx)(Xi.a,{dataSource:He,className:(null===He||void 0===He?void 0:He.length)>0?"":"table-empty",onRow:function(e){return{onDoubleClick:function(){var t;x({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e||null===(t=e.action)||void 0===t?void 0:t.page}}),r()},onClick:function(){}}},columns:Kt,components:{header:{cell:en}},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)!==(null===p||void 0===p||null===(n=p.page)||void 0===n?void 0:n.pageId)||null!==p&&void 0!==p&&p.ignorePage?"medical-".concat(e.pageStatus,"-row"):"row-selected"},pagination:!1,scroll:(null===He||void 0===He?void 0:He.length)>0?{y:1e3,x:"max-content"}:{}})})}),void 0!==ht&&Object(oa.jsx)(Dl,{inputArray:He,visible:void 0!==ht,onSave:function(e){console.log("Updated Array:",e),It(e),gt(void 0)},onCancel:function(){return gt(void 0)},defaultIndex:ht,socket:t})]})},Jl=n(226),Kl=n(543),Zl=n(326),Xl=n(1065),es=n(1066),ts=n(545),ns=function(e){var t=e.socket,n=e.userId,i=Object(a.useState)(!1),c=Object(u.a)(i,2),o=c[0],l=c[1],r=Object(a.useState)(!1),d=Object(u.a)(r,2),v=d[0],b=d[1],j=Object(a.useState)(null),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)(null),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(a.useState)(null),S=Object(u.a)(I,2),N=(S[0],S[1]),k=Object(a.useState)(null),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(a.useState)(0),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(0),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(!1),F=Object(u.a)(q,2),B=F[0],_=F[1],$=ei.a.useForm(),Y=Object(u.a)($,1)[0],W=Object(s.c)(function(e){return e.auth}).encrypted_token,V=Object(a.useState)(void 0),Q=Object(u.a)(V,2),G=Q[0],J=Q[1],K=Object(s.b)(),Z=function(e){var t={select:{index:{searchIndex:"".concat("beamdevlive",":custom:id"),searchQuery:"@partitions:{'org\\:".concat(z((null===W||void 0===W?void 0:W.cudbServiceId)||(null===W||void 0===W?void 0:W.serviceId)),"'}@partitions:{user\\:").concat(n,"}@partitions:{type\\:timesheet}@partitions:{date\\:").concat(e,"}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId"}},filter:{expression:""}};K(tt({requestData:t,callback:function(e){var t,n;J(null===e||void 0===e||null===(t=e[0])||void 0===t?void 0:t.objectId);var a=null===e||void 0===e||null===(n=e[0])||void 0===n?void 0:n.info;if(a&&a.startTime){var i,c=H()(),o=H()(a.startTime),s=a.endTime?H()(a.endTime):void 0,r=a.pauseTime?H()(a.pauseTime):null,d=a.breakTimeInSeconds||0;i=r?r.diff(o,"seconds")-d:c.diff(o,"seconds")-d,f(o),w(s),D(i),y(r),b(!!r),U(d),l(a.isClockedIn)}}}))};Object(a.useEffect)(function(){Z(H()().format("YYYYMMDD")),t.subscribeToEvent(m.SubscribePageTopics,sn(null===W||void 0===W?void 0:W.connectionId),function(e){var t,n,a,i;console.log("response",null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.id),J(null===e||void 0===e||null===(a=e.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.id)}),t.subscribeToEvent(m.SubscribePageTopics,dn(null===W||void 0===W?void 0:W.connectionId),function(e){console.log("response",e),Z(H()().format("YYYYMMDD"))})},[]);var X=function(e){if(localStorage.setItem("clockIn",JSON.stringify(e)),G)t.publishToEvent(m.PublishPageTopics,un(null===W||void 0===W?void 0:W.connectionId),Dn({objectId:G,changes:[{op:"replace",path:"/info",value:e}]}));else{var a=[{op:"add",path:"/partitions",value:["org:".concat((null===W||void 0===W?void 0:W.cudbServiceId)||(null===W||void 0===W?void 0:W.serviceId)),"user:".concat(n),"type:timesheet","date:".concat(H()().format("YYYYMMDD"))]},{op:"add",path:"/createdAt",value:(new Date).getTime()},{op:"add",path:"/info",value:e}];console.log("custom changes",a),t.publishToEvent(m.PublishPageTopics,rn(null===W||void 0===W?void 0:W.connectionId),Dn({changes:a}))}};Object(a.useEffect)(function(){var e=null;return o&&!v&&(e=setInterval(function(){D(function(e){return e+1})},1e3)),function(){e&&clearInterval(e)}},[o,v]);return Object(oa.jsxs)("div",{className:"card-container",children:[Object(oa.jsxs)("div",{className:"custom-card",style:{backgroundColor:o?"#FF5F25":"#40CC52"},onClick:o?function(){var e=H()(),t=e.diff(O,"seconds")-L,n=Math.floor(t/60);l(!1),b(!1),w(e),X({isClockedIn:!1,startTime:null===O||void 0===O?void 0:O.toISOString(),endTime:e.toISOString(),breakTimeInSeconds:L,totalWorkedTimeInMinutes:n}),D(0),ts.b.success("Clocked Out! Total Worked Time: ".concat(n," minutes"))}:function(){var e=H()();l(!0),f(e),D(0),X({isClockedIn:!0,startTime:e.toISOString(),isPaused:!1}),ts.b.success("Clocked In!")},children:[Object(oa.jsx)("div",{className:"card-icon",children:Object(oa.jsx)(Zl.a,{style:{fontSize:"24px",color:"#fff"}})}),Object(oa.jsx)("div",{className:"card-title",children:o?"Clock Out (".concat(function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),a=e%60;return"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(a.toString().padStart(2,"0"))}(P),")"):"Clock In"})]}),o&&Object(oa.jsxs)("div",{className:"custom-card",style:{backgroundColor:"#FBAE16"},onClick:function(){var e=H()();if(v){var t=e.diff(x,"seconds"),n=L+t;N(e),U(n),X({isClockedIn:o,startTime:O,isPaused:!1,resumeTime:e.toISOString(),breakTimeInSeconds:n}),ts.b.success("Resumed!")}else y(e),X({isClockedIn:o,startTime:O,isPaused:!0,pauseTime:e.toISOString()}),ts.b.success("Paused!");b(function(e){return!e})},children:[Object(oa.jsx)("div",{className:"card-icon",children:v?Object(oa.jsx)(Xl.a,{style:{fontSize:"24px",color:"#fff"}}):Object(oa.jsx)(es.a,{style:{fontSize:"24px",color:"#fff"}})}),Object(oa.jsx)("div",{className:"card-title",children:v?"Resume":"Pause"})]}),Object(oa.jsxs)("div",{className:"custom-card",style:{backgroundColor:"#1890ff"},onClick:function(){var e;Y.setFieldsValue({startTime:O?H()(O):null,endTime:C?H()(C):null,breakTime:parseFloat(null===(e=L/60)||void 0===e?void 0:e.toFixed(2))}),_(!0)},children:[Object(oa.jsx)("div",{className:"card-icon",children:Object(oa.jsx)(wo.a,{style:{fontSize:"24px",color:"#fff"}})}),Object(oa.jsx)("div",{className:"card-title",children:"Edit Timesheet"})]}),Object(oa.jsx)($n.a,{title:"Edit Timesheet",className:"beam-modal",visible:B,onCancel:function(){return _(!1)},children:Object(oa.jsxs)(ei.a,{form:Y,layout:"vertical",children:[Object(oa.jsx)(ei.a.Item,{label:"Start Time",name:"startTime",rules:[{required:!0,message:"Please select a start time!"}],children:Object(oa.jsx)(Zn.a,{format:"HH:mm"})}),Object(oa.jsx)(ei.a.Item,{label:"End Time",name:"endTime",rules:[{required:!0,message:"Please select an end time!"}],className:"mt-3",children:Object(oa.jsx)(Zn.a,{format:"HH:mm"})}),Object(oa.jsx)(ei.a.Item,{label:"Break Time (Minutes)",name:"breakTime",rules:[{required:!0,message:"Please enter the break time in minutes!"}],className:"mt-3",children:Object(oa.jsx)(Wn.a,{type:"number",min:0})}),Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:12,xs:12,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:function(){return _(!1)},children:"Cancel"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",xs:12,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){Y.validateFields().then(function(e){var t=e.startTime,n=e.endTime,a=60*e.breakTime,i=H()(n).diff(H()(t),"seconds")-a,c=Math.floor(i/60);f(t),w(n),D(a),X({startTime:t.toISOString(),endTime:n.toISOString(),breakTimeInSeconds:a,totalWorkedTimeInMinutes:c}),_(!1),ts.b.success("Timesheet updated successfully! Total Worked Time: ".concat(c," minutes"))})},children:"Save"})})]})})]})})]})},as=function(e){var t=e.socket,n=e.userId,i=Object(a.useState)(!1),c=Object(u.a)(i,2),o=c[0],l=c[1],r=Object(a.useState)([]),v=Object(u.a)(r,2),b=v[0],j=v[1],p=ei.a.useForm(),O=Object(u.a)(p,1)[0],f=Object(s.c)(function(e){return e.auth}).encrypted_token,h=Object(s.b)(),g=[{title:"Start Date",dataIndex:"startDate",key:"startDate"},{title:"End Date",dataIndex:"endDate",key:"endDate"},{title:"Reason",dataIndex:"reason",key:"reason"},{title:"Status",dataIndex:"status",key:"status",render:function(e){var t="Accepted"===e?"green":"Rejected"===e?"red":"orange";return Object(oa.jsx)(Kn.a,{color:t,children:e})}}],x=function(){var e={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z((null===f||void 0===f?void 0:f.cudbServiceId)||(null===f||void 0===f?void 0:f.serviceId)),"'}@partitions:{user\\:").concat(n,"}@partitions:{type\\:timeoff}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId"}},filter:{expression:""}};h(tt({requestData:e,callback:function(e){console.log("response here",e),j(null===e||void 0===e?void 0:e.map(function(e){return Object(d.a)({key:null===e||void 0===e?void 0:e.objectId},null===e||void 0===e?void 0:e.info)}))}}))};Object(a.useEffect)(function(){t.subscribeToEvent(m.SubscribePageTopics,sn(null===f||void 0===f?void 0:f.connectionId),function(e){var t,n;console.log("response",null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.id),x()}),x()},[]);var y=function(){l(!1)};return Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Xi.a,{dataSource:b,columns:g,pagination:!1}),Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover",onClick:function(){l(!0)},style:{marginTop:16},children:"Apply timeoff"}),Object(oa.jsx)($n.a,{title:"Apply for timeoff",className:"beam-modal",visible:o,onCancel:y,children:Object(oa.jsxs)(ei.a,{form:O,layout:"vertical",children:[Object(oa.jsx)(ei.a.Item,{label:"Start Date",name:"startDate",rules:[{required:!0,message:"Please select the start date!"}],children:Object(oa.jsx)(Jn.a,{showTime:{use12Hours:!0,format:"hh:mm A"},format:"YYYY-MM-DD hh:mm A"})}),Object(oa.jsx)(ei.a.Item,{label:"End Date",name:"endDate",rules:[{required:!0,message:"Please select the end date!"}],className:"mt-3",children:Object(oa.jsx)(Jn.a,{showTime:{use12Hours:!0,format:"hh:mm A"},format:"YYYY-MM-DD hh:mm A"})}),Object(oa.jsx)(ei.a.Item,{label:"Reason for Leave",name:"reason",rules:[{required:!0,message:"Please provide a reason for leave!"}],className:"mt-3",children:Object(oa.jsx)(Wn.a.TextArea,{autoSize:{minRows:3,maxRows:6}})}),Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:12,xs:12,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:function(){return y()},children:"Cancel"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",xs:12,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){O.validateFields().then(function(e){var a={timestamp:(new Date).getTime(),startDate:e.startDate.format("YYYY-MM-DD hh:mm A"),endDate:e.endDate.format("YYYY-MM-DD hh:mm A"),reason:e.reason,status:"Pending"};O.resetFields(),l(!1);var i=[{op:"add",path:"/partitions",value:["org:".concat((null===f||void 0===f?void 0:f.cudbServiceId)||(null===f||void 0===f?void 0:f.serviceId)),"user:".concat(n),"type:timeoff","date:".concat(H()().format("YYYYMMDD"))]},{op:"add",path:"/createdAt",value:(new Date).getTime()},{op:"add",path:"/info",value:a}];console.log("custom changes",i),t.publishToEvent(m.PublishPageTopics,rn(null===f||void 0===f?void 0:f.connectionId),Dn({changes:i}))})},children:"Save"})})]})})]})})]})},is=(Jn.a.RangePicker,Zn.a.RangePicker,function(e){var t=e.data,n=e.columns,i=Object(a.useRef)(null),c=Object(a.useRef)(null),o=Object(a.useState)(0),l=Object(u.a)(o,2),s=l[0],r=l[1];return Object(a.useEffect)(function(){var e,t,n=null===(e=c.current)||void 0===e?void 0:e.querySelector("table");n&&r(n.scrollWidth);var a=i.current,o=null===(t=c.current)||void 0===t?void 0:t.querySelector(".ant-table-content");if(a&&o){var l=function(e,t){return function(){t.scrollLeft=e.scrollLeft}};return a.addEventListener("scroll",l(a,o)),o.addEventListener("scroll",l(o,a)),function(){a.removeEventListener("scroll",l(a,o)),o.removeEventListener("scroll",l(o,a))}}},[t]),Object(oa.jsxs)("div",{children:[Object(oa.jsx)("div",{ref:i,className:"custom-scrollbar",style:{overflowX:"auto",overflowY:"hidden",height:12,marginBottom:8},children:Object(oa.jsx)("div",{style:{width:s,height:1}})}),Object(oa.jsx)("div",{ref:c,children:Object(oa.jsx)(Xi.a,{columns:n,dataSource:t,pagination:!1,scroll:{x:"max-content"},style:{tableLayout:"auto",width:"max-content"}})})]})}),cs=function(e){var t=e.value,n=void 0===t?[]:t,i=e.onChange,c=void 0===i?function(e){}:i,o=e.startDate,l=e.endDate,r=e.drivers,v=e.userId,b=void 0===v?void 0:v,j=Object(a.useState)([]),m=Object(u.a)(j,2),p=m[0],O=m[1],f=Object(a.useState)(null),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)(!1),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)([]),w=Object(u.a)(k,2),E=w[0],R=w[1],P=Object(a.useState)(null),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Object(a.useState)([]),U=Object(u.a)(L,2),q=U[0],F=U[1],B=Object(s.c)(function(e){return e.auth}),_=(B.projects,B.encrypted_token),$=Object(a.useState)(!1),Y=Object(u.a)($,2),H=Y[0],W=Y[1],V=Object(s.b)(),z=Object(a.useState)(null),Q=Object(u.a)(z,2),G=Q[0],J=Q[1],K=Object(a.useState)(null),Z=Object(u.a)(K,2),X=Z[0],ee=Z[1],te=Object(a.useRef)(null);Object(a.useRef)(null);Object(a.useEffect)(function(){var e=te.current,t=document.querySelector(".ant-table-body");e&&t&&(e.onscroll=function(){t.scrollLeft=e.scrollLeft},t.onscroll=function(){e.scrollLeft=t.scrollLeft})},[]);var ne=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){var a=tc()(t).startOf("day").valueOf(),i=tc()(t).endOf("day").valueOf(),c={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===_||void 0===_?void 0:_.userId,"}(-@rideType:{hail})@pageType:{event}@createdAt:[").concat(a,",+inf]@createdAt:[-inf, ").concat(i,"]"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{pageId:"$.objectId",messages:"$..customMessages",createdAt:"$.createdAt",members:"$..members.users"}},filter:{expression:[].join("&&")},sortBy:{properties:[],max:1e3},result:{}};V(tt({requestData:c,callback:function(t){console.log("resppnse",t);var n=[];null===t||void 0===t||t.map(function(e){var t,a=null===e||void 0===e||null===(t=e.messages)||void 0===t?void 0:t.filter(function(e){return"text"===e.type});(null===a||void 0===a?void 0:a.length)>0&&a.map(function(t){Object.keys((null===e||void 0===e?void 0:e.members)||{}).map(function(e){var a;n.push({name:null===t||void 0===t||null===(a=t.attributes)||void 0===a?void 0:a.body,driverId:e.toString()})})})}),e(n)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return M(t),e.n=1,ne(t);case 1:n=e.v,F(n);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){n&&n.length>0?oe(n):ie(o,l)},[JSON.stringify(n)]);var ie=function(e,t){if(e&&t){for(var n=[],a=tc()(e),i=function(){var e={key:a.format("YYYY-MM-DD"),date:a.format("dddd, YYYY-MM-DD")};r.forEach(function(t){e[t.driverId]=[]}),n.push(e),a=a.add(1,"day")};a.isBefore(t)||a.isSame(t,"day");)i();O(le(n)),c&&c(le(n))}},ce=function(e,t){if(!b){x({key:e,column:t});var n=p.find(function(t){return t.key===e}),a=n&&n[t]?n[t].map(function(e){return Object(d.a)(Object(d.a)({},e),{},{time:Array.isArray(null===e||void 0===e?void 0:e.time)?e.time.map(function(e){return tc.a.isDayjs(e)?e:tc()(e)}):e.time})}):[];console.log("formatted",a),R(a),N(!0)}},oe=function(e){var t=e.map(function(e){var t=Object(d.a)({},e);return r.forEach(function(e){t.hasOwnProperty(e.driverId)||(t[e.driverId]=[])}),Object.keys(t).forEach(function(e){"key"===e||"date"===e||r.some(function(t){return t.driverId.toString()===e})||delete t[e]}),t});O(t),c&&c(le(t))},le=function(e){return e.map(function(e){var t=Object(d.a)({},e);return Object.keys(e).forEach(function(n){if(Array.isArray(e[n])){var a=e[n];t[n]=null===a||void 0===a?void 0:a.map(function(e){var t;return e.time=null===e||void 0===e||null===(t=e.time)||void 0===t?void 0:t.map(function(e){return"string"===typeof e?e:e.format("YYYY-MM-DD HH:mm")}),e})}}),t})},se=function(e,t){R(function(n){return n.map(function(n,a){return a===e?Object(d.a)(Object(d.a)({},n),t):n})})},re=Object(a.useMemo)(function(){var e=Object(C.a)(r).sort(function(e,t){return e.driverName.localeCompare(t.driverName)}).map(function(e){return{title:e.driverName,dataIndex:e.driverId,key:e.driverId,render:function(t,n){return console.log("ext",t),Object(oa.jsx)("div",{onClick:function(){return ce(n.key,e.driverId)},style:{cursor:"pointer"},children:t&&(null===t||void 0===t?void 0:t.length)>0?Object(oa.jsx)("p",{children:null===t||void 0===t?void 0:t.map(function(e,t){var n,a,i,c,o,l;return Array.isArray(null===e||void 0===e?void 0:e.time)?Object(oa.jsxs)("span",{style:{color:"#000",fontFamily:"Nunito-Bold"},children:["".concat(null===e||void 0===e||null===(n=e.time)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.split(" ")[1],"-").concat(null===e||void 0===e||null===(i=e.time)||void 0===i||null===(c=i[1])||void 0===c?void 0:c.split(" ")[1]).concat(null!==e&&void 0!==e&&null!==(o=e.time)&&void 0!==o&&o[1]&&null!==e&&void 0!==e&&null!==(l=e.time)&&void 0!==l&&l[0]&&tc()(e.time[1]).isAfter(tc()(e.time[0]),"day")?" (next day)":""," ").concat(null===e||void 0===e?void 0:e.shiftType," ").concat(null===e||void 0===e?void 0:e.locationType),Object(oa.jsx)("br",{})]},t):Object(oa.jsxs)("span",{style:{color:"#000",fontFamily:"Nunito-Bold"},children:[e,Object(oa.jsx)("br",{})]},t)})}):b?"N/A":"Click to add"})}}});return[{title:"Date",dataIndex:"date",key:"date",fixed:"left",render:function(e,t){return Object(oa.jsx)("div",{onClick:function(){return ae(t.key)},style:{cursor:"pointer",fontWeight:"bold"},children:e})}}].concat(Object(C.a)(e))},[r,p,b]),de=[{title:"Driver",dataIndex:"driverName",key:"driverName"},{title:"Time Slots",dataIndex:"timeSlots",key:"timeSlots",render:function(e,t){return Object(oa.jsxs)("div",{onClick:function(){return ce(A,t.driverId)},style:{cursor:"pointer"},children:[e&&e.length>0?Object(oa.jsx)("p",{style:{color:"#000",fontFamily:"Nunito-Bold"},children:null===e||void 0===e?void 0:e.map(function(e){var t,n,a,i,c,o;return Array.isArray(null===e||void 0===e?void 0:e.time)?"".concat(null===e||void 0===e||null===(t=e.time)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.split(" ")[1],"-").concat(null===e||void 0===e||null===(a=e.time)||void 0===a||null===(i=a[1])||void 0===i?void 0:i.split(" ")[1]).concat(null!==e&&void 0!==e&&null!==(c=e.time)&&void 0!==c&&c[1]&&null!==e&&void 0!==e&&null!==(o=e.time)&&void 0!==o&&o[0]&&tc()(e.time[1]).isAfter(tc()(e.time[0]),"day")?" (next day)":""," ").concat(null===e||void 0===e?void 0:e.shiftType," ").concat(null===e||void 0===e?void 0:e.locationType):e}).join(", ")}):b?"N/A":"Click to add",Object(oa.jsxs)("div",{style:{marginTop:5,fontSize:"12px",color:"#888"},children:[Object(oa.jsx)("strong",{children:"Tasks:"})," ",q.filter(function(e){return e.driverId.toString()===t.driverId.toString()}).length>0?Object(oa.jsx)("ul",{children:q.filter(function(e){return e.driverId.toString()===t.driverId.toString()}).map(function(e,t){return Object(oa.jsx)("li",{children:e.name},t)})}):Object(oa.jsx)("span",{children:" No tasks assigned"})]})]})}}],ue=A?Object(C.a)(r).sort(function(e,t){return e.driverName.localeCompare(t.driverName)}).map(function(e){var t;return{key:e.driverId,driverName:e.driverName,driverId:e.driverId,timeSlots:(null===(t=p.find(function(e){return e.key===A}))||void 0===t?void 0:t[e.driverId])||[]}}):[],ve=function(){var e=p.map(function(e){return e.key});return{columns:[{title:"Driver",dataIndex:"driverName",key:"driverName"}].concat(Object(C.a)(e.map(function(e){return{title:tc()(e).format("dddd, YYYY-MM-DD"),dataIndex:e,key:e,render:function(t,n){return Object(oa.jsx)("div",{onClick:function(){return ce(e,n.key)},style:{cursor:"pointer"},children:t&&t.length>0?Object(oa.jsx)("p",{children:t.map(function(e,t){var n,a,i,c,o,l;return Array.isArray(null===e||void 0===e?void 0:e.time)?Object(oa.jsxs)("span",{style:{color:"#000",fontFamily:"Nunito-Bold"},children:["".concat(null===e||void 0===e||null===(n=e.time)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.split(" ")[1],"-").concat(null===e||void 0===e||null===(i=e.time)||void 0===i||null===(c=i[1])||void 0===c?void 0:c.split(" ")[1]).concat(null!==e&&void 0!==e&&null!==(o=e.time)&&void 0!==o&&o[1]&&null!==e&&void 0!==e&&null!==(l=e.time)&&void 0!==l&&l[0]&&tc()(e.time[1]).isAfter(tc()(e.time[0]),"day")?" (next day)":""," ").concat(null===e||void 0===e?void 0:e.shiftType," ").concat(null===e||void 0===e?void 0:e.locationType),Object(oa.jsx)("br",{})]},t):Object(oa.jsxs)("span",{style:{color:"#000",fontFamily:"Nunito-Bold"},children:[e,Object(oa.jsx)("br",{})]},t)})}):b?"N/A":"Click to add"})}}}))),rows:Object(C.a)(r).sort(function(e,t){return e.driverName.localeCompare(t.driverName)}).map(function(t){var n={key:t.driverId,driverName:t.driverName};return e.forEach(function(e){var a;n[e]=(null===(a=p.find(function(t){return t.key===e}))||void 0===a?void 0:a[t.driverId])||[]}),n})}};return Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Vn.a,{onClick:function(){return W(function(e){return!e})},style:{marginBottom:16},children:H?"Drivers as Columns":"Dates as Columns"}),H?Object(oa.jsx)(Xi.a,{columns:ve().columns,dataSource:ve().rows,pagination:!1,scroll:{x:"max-content"}}):A?Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:10},children:[Object(oa.jsx)(Vn.a,{onClick:function(){M(null),F([])},icon:Object(oa.jsx)(Eo.a,{})}),Object(oa.jsx)("h5",{style:{marginLeft:16},children:tc()(A).format("dddd, YYYY-MM-DD")})]}),Object(oa.jsx)(Xi.a,{columns:de,dataSource:ue,pagination:!1,scroll:{x:"max-content"}})]}):Object(oa.jsx)(is,{data:p,columns:re}),Object(oa.jsxs)($n.a,{title:"Add Time Slots",className:"beam-modal",footer:[],visible:S,onCancel:function(){R([]),N(!1)},children:[Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(Zn.a,{value:G,onChange:J,format:"HH:mm",placeholder:"Start Time"}),Object(oa.jsx)(Zn.a,{value:X,onChange:ee,format:"HH:mm",placeholder:"End Time"}),Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){return function(e){if(e&&e[0]&&e[1]){var t=e[0],n=e[1];n.isBefore(t)&&(n=n.add(1,"day")),R(function(e){return[].concat(Object(C.a)(e),[{time:[t,n]}])})}}([G,X])},disabled:!G||!X,children:"Add"})]}),Object(oa.jsxs)("div",{style:{marginTop:20},children:[Object(oa.jsx)("h5",{children:"Selected Time Slots:"}),Object(oa.jsx)("ul",{style:{padding:0},children:E.map(function(e,t){var n,a;return Object(oa.jsxs)(Yn.a,{gutter:8,className:"align-items-center d-flex",children:[(null===e||void 0===e||null===(n=e.time)||void 0===n?void 0:n[0])&&(null===e||void 0===e||null===(a=e.time)||void 0===a?void 0:a[1])&&Object(oa.jsxs)(oa.Fragment,{children:[e.time[0].format("HH:mm")," - ",e.time[1].format("HH:mm"),e.time[1].isAfter(e.time[0],"day")&&Object(oa.jsx)("span",{style:{color:"#888",marginLeft:4},children:"(next day)"})]}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsxs)(Gn.a,{value:e.shiftType,onChange:function(e){return se(t,{shiftType:e})},placeholder:"Shift Type",style:{width:120},children:[Object(oa.jsx)(Gn.a.Option,{value:"Shift",children:"Shift"}),Object(oa.jsx)(Gn.a.Option,{value:"Available",children:"Available"}),Object(oa.jsx)(Gn.a.Option,{value:"On Call",children:"On Call"}),Object(oa.jsx)(Gn.a.Option,{value:"N/A",children:"N/A"})]})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsxs)(Gn.a,{value:e.locationType,onChange:function(e){return se(t,{locationType:e})},placeholder:"Location",style:{width:120},children:[Object(oa.jsx)(Gn.a.Option,{value:"Kingston",children:"Kingston"}),Object(oa.jsx)(Gn.a.Option,{value:"Brockville",children:"Brockville"}),Object(oa.jsx)(Gn.a.Option,{value:"Belleville",children:"Belleville"})]})}),Object(oa.jsx)(Vn.a,{onClick:function(){return e=t,void R(function(t){return t.filter(function(t,n){return n!==e})});var e},style:{boxShadow:"none",width:35,height:35,display:"flex",justifyContent:"center",alignItems:"center"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})]},e.id||t)})})]}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",type:"primary",htmlType:"submit",onClick:function(){if(g){var e=p.map(function(e){return e.key===g.key?Object(d.a)(Object(d.a)({},e),{},Object(T.a)({},g.column,E)):e});O(le(e)),c&&c(le(e))}R([]),N(!1)},children:"OK"})}),Object(oa.jsx)(Hn.a,{span:12,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full w-full",onClick:function(){R([]),N(!1)},children:"Cancel"})})]})]})]})},os=function(e){var t,n,i,c=e.onClose,o=e.socket,l=e.student,r=(e.adminRoles,e.onAdd,e.drivers),d=e.userId,v=Object(a.useState)(!0),b=Object(u.a)(v,2),j=b[0],p=b[1],O=ei.a.useForm(),f=Object(u.a)(O,1)[0],h=Object(a.useState)(""),g=Object(u.a)(h,2),x=(g[0],g[1]),y=Object(a.useState)(!1),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(s.c)(function(e){return e.auth}),T=(k.projects,k.encrypted_token),C=(Mn().updateUserRequestPayloadV2,Object(a.useState)("1")),w=Object(u.a)(C,2),E=(w[0],w[1],null===l||void 0===l||null===(t=l.info)||void 0===t?void 0:t.startTimestamp),R=null===l||void 0===l||null===(n=l.info)||void 0===n?void 0:n.endTimestamp;Object(a.useEffect)(function(){var e,t,n;(o.subscribeToEvent(m.SubscribePageTopics,dn(null===T||void 0===T?void 0:T.connectionId),function(e){console.log("response",e),Lt("Shift saved successfully","success","TOP_CENTER",1e3),N(!1)},"editShift"),(null===l||void 0===l||null===(e=l.info)||void 0===e||null===(t=e.shift)||void 0===t?void 0:t.length)>0)&&f.setFieldsValue({shift:null===l||void 0===l||null===(n=l.info)||void 0===n?void 0:n.shift})},[]);var P=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:console.log("values",t),N(!0),D(l.objectId,t.shift);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:o.publishToEvent(m.PublishPageTopics,un(null===T||void 0===T?void 0:T.connectionId),Dn({objectId:t,changes:[{op:"replace",path:"/info/shift",value:n}]}));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}();return Object(oa.jsx)($n.a,{title:(null===l||void 0===l||null===(i=l.info)||void 0===i?void 0:i.name)||"Shift",visible:j,onCancel:function(){p(!1),c&&c(),localStorage.setItem("selectedTab","1")},width:d?"800px":"1200px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:f,onFinish:P,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsx)(ei.a.Item,{name:"shift",children:Object(oa.jsx)(cs,{startDate:E,endDate:R,drivers:r,userId:d})})}),!d&&Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:S,type:"primary",htmlType:"submit",onClick:function(){return x("")},children:"Save"})})})})]})})},ls=n(309),ss=n.n(ls),rs=["key"];Dc.d.register(Dc.a,Dc.j,Dc.e),tc.a.extend(ss.a);var ds,us=function(e){var t=e.socket,n=(e.params,e.componentUuid,e.userId),c=Object(s.c)(function(e){return e.auth}),o=c.selectedPage,l=c.encrypted_token,r=c.projects,v=c.adminUserRoles,b=Object(s.b)(),j=Object(a.useState)([]),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)([]),g=Object(u.a)(h,2),x=g[0],y=g[1];Object(a.useState)(!1);var I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1];Object(a.useState)(!1);Mn().getUserRequestPayload,Object(a.useRef)();var T=Object(a.useState)(void 0),C=Object(u.a)(T,2),w=C[0],E=C[1],R=Object(a.useRef)(!0),P=(Mn().updateUserRequestPayloadV2,Object(a.useState)(void 0)),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Object(a.useState)(""),U=Object(u.a)(L,2),q=U[0],F=(U[1],Object(a.useState)("")),B=Object(u.a)(F,2),_=(B[0],B[1]),$=Object(a.useState)(!1),Y=Object(u.a)($,2),W=Y[0],V=Y[1],Q=Object(a.useState)([]),G=Object(u.a)(Q,2),J=G[0],K=G[1],Z=function(e,t,n,a){for(var i=tc()(t),c=tc()(n),o=tc()(a),l=[],s=i,r=function(){var t=s.format("YYYY-MM-DD"),n=e.find(function(e){return e.key===t});n&&l.push(Object(d.a)({},n)),s=s.add(1,"day")};s.isSameOrBefore(c);)r();var u=o.diff(i,"day");return{data:l.map(function(e){var t=tc()(e.key).add(u,"day").format("YYYY-MM-DD"),n=(e.key,Object(Ka.a)(e,rs));return Object(d.a)(Object(d.a)({key:t},n),{},{date:tc()(t).format("dddd, YYYY-MM-DD")})}),toEnd:tc()(a).add(l.length-1,"day").format("YYYY-MM-DD")}},X=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){var a,i,c,o,s,r,d,u,v,b;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:console.log("values",n),"copy"===(null===A||void 0===A?void 0:A.type)?(v=Z(null===A||void 0===A||null===(c=A.action)||void 0===c||null===(o=c.info)||void 0===o?void 0:o.shift,null===A||void 0===A||null===(s=A.action)||void 0===s||null===(r=s.info)||void 0===r?void 0:r.startDate,null===A||void 0===A||null===(d=A.action)||void 0===d||null===(u=d.info)||void 0===u?void 0:u.endDate,n.startDate.format("YYYY-MM-DD")),i=H()(null===v||void 0===v?void 0:v.toEnd).valueOf(),a={startDate:n.startDate.format("YYYY-MM-DD"),endDate:null===v||void 0===v?void 0:v.toEnd,startTimestamp:n.startDate.valueOf(),endTimestamp:i,name:n.name,shift:null===v||void 0===v?void 0:v.data}):(i=n.endDate.valueOf(),a={startDate:n.startDate.format("YYYY-MM-DD"),endDate:n.endDate.format("YYYY-MM-DD"),startTimestamp:n.startDate.valueOf(),endTimestamp:i,name:n.name,shift:{}}),V(!0),b=[{op:"add",path:"/partitions",value:["org:".concat((null===l||void 0===l?void 0:l.cudbServiceId)||(null===l||void 0===l?void 0:l.serviceId)),"type:shift","startDate:".concat(n.startDate.valueOf()),"endDate:".concat(i)]},{op:"add",path:"/createdAt",value:(new Date).getTime()},{op:"add",path:"/info",value:a}],console.log("custom changes",b),t.publishToEvent(m.PublishPageTopics,rn(null===l||void 0===l?void 0:l.connectionId),Dn({changes:b}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:t.publishToEvent(m.PublishPageTopics,un(null===l||void 0===l?void 0:l.connectionId),Dn({objectId:n,changes:[{op:"replace",path:"/objectStatus",value:"deleted"}]}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}@partitions:{type\\:shift}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status"}},filter:{expression:""}};e||k(!0),b(tt({requestData:t,callback:function(e){console.log("response here",e),f(null===e||void 0===e?void 0:e.map(function(e){return Object(d.a)(Object(d.a)({key:null===e||void 0===e?void 0:e.objectId},null===e||void 0===e?void 0:e.info),{},{action:e})})),y([{title:"Name",key:"name",dataIndex:"name"},{title:"Start date",key:"startDate",dataIndex:"startDate"},{title:"End date",key:"endDate",dataIndex:"endDate"},n?{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsx)(Yn.a,{style:{width:135},children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),E(e)},children:Object(oa.jsx)(wc.a,{})})})})}}:{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),E(e)},children:Object(oa.jsx)(wo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn green-btn cover",onClick:function(){console.log("action",e),M({type:"copy",action:e})},children:Object(oa.jsx)(Xc.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Co.a,{title:"Are you sure to delete this shift schedule?",onConfirm:Object(_n.a)(Object(Bn.a)().m(function t(){return Object(Bn.a)().w(function(t){for(;;)switch(t.n){case 0:ee(e.objectId);case 1:return t.a(2)}},t)})),children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})})})]})}}]),k(!1)}}))};Object(a.useEffect)(function(){return R.current=!0,function(){R.current=!1}},[]),Object(a.useEffect)(function(){null!==r&&void 0!==r&&r.adminUserId&&(!function(e,t){var a,i="@serviceId:{'".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}");switch(t){case ac.Dispatcher:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Live:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Live)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Responder:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Manager:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)})}console.log("selected user roles",a);var c=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),o={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:i,searchOptions:"TIMEOUT 5000"},list:{objectIds:n?[n.toString()]:void 0},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(c.join("||"),")")},anyStatus:!1};k(!0),b(tt({requestData:o,callback:function(e){k(!1);var t=[];null===e||void 0===e||e.map(function(e,n){var a,i,c,o;t.push({driverId:e.id,driverName:"".concat(null===e||void 0===e||null===(a=e.live)||void 0===a||null===(i=a.profile)||void 0===i?void 0:i.firstName," ").concat(null===e||void 0===e||null===(c=e.live)||void 0===c||null===(o=c.profile)||void 0===o?void 0:o.lastName)})}),K(t),te()}}))}(v,ac.Responder),t.subscribeToEvent(m.SubscribePageTopics,sn(null===l||void 0===l?void 0:l.connectionId),function(e){var t,n;console.log("response",null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.id),M(void 0),V(!1),te()}),t.subscribeToEvent(m.SubscribePageTopics,dn(null===l||void 0===l?void 0:l.connectionId),function(e){console.log("response",e),te(!0)}))},[r]);var ne=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],ae=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[!n&&Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Shift"}),Object(oa.jsx)("p",{children:"Home > Shift"})]}),Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn green-btn cover",onClick:function(){M({type:"new"})},children:"Add"})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:N?ae:O,columns:N?ne:x,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==w&&Object(oa.jsx)(os,{socket:t,student:w,onClose:function(){E(void 0)},adminRoles:v,drivers:J,onAdd:function(e){te(!0)},userId:n}),Object(oa.jsx)($n.a,{title:"new"===(null===A||void 0===A?void 0:A.type)?"Add New Shift":"Copy Shift",visible:void 0!=A,onCancel:function(){return M(void 0)},okButtonProps:{disabled:!q.trim()},className:"beam-modal",footer:[],children:Object(oa.jsxs)(ei.a,{layout:"vertical",className:"auth-form",onFinish:X,children:[Object(oa.jsx)(ei.a.Item,{label:"Name",required:!0,name:"name",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter name"})}),Object(oa.jsx)(ei.a.Item,{label:"Start Date",name:"startDate",required:!0,className:"mt-3",children:Object(oa.jsx)(Jn.a,{className:"w-full"})}),"new"===(null===A||void 0===A?void 0:A.type)&&Object(oa.jsx)(ei.a.Item,{label:"End Date",name:"endDate",required:!0,className:"mt-3",children:Object(oa.jsx)(Jn.a,{className:"w-full"})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:W,type:"primary",htmlType:"submit",onClick:function(){return _("")},children:"Save"})})})})]})})]})},vs=(Za.a.Panel,Kl.a.TabPane),bs=function(e){var t,n,c=e.onClose,o=e.socket,l=e.student,r=e.onAdd,v=e.sourceData,b=e.fullScreen,j=Object(a.useState)(!0),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)("1"),g=Object(u.a)(h,2),I=g[0],S=g[1],N=ei.a.useForm(),k=Object(u.a)(N,1)[0],w=Object(a.useState)(""),E=Object(u.a)(w,2),R=(E[0],E[1]),P=Object(s.c)(function(e){return e.auth}).projects,D=Object(a.useState)(!1),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Mn().updateUserRequestPayloadV2,q=Object(a.useState)(window.innerWidth<=768),F=Object(u.a)(q,2),B=F[0],_=F[1];Object(a.useEffect)(function(){var e=function(){return _(window.innerWidth<=768)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[]);Object(a.useEffect)(function(){if(null!==l&&void 0!==l&&l.schoolBus){var e,t,n,a,i,c,o,s,r,u,v={},b=[];null===(e=Object.values((null===l||void 0===l||null===(t=l.schoolBus)||void 0===t?void 0:t.locationList)||{}))||void 0===e||e.map(function(e){var t,n,a,i,c,o,l,s,r,u={location:{label:null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.attributes)||void 0===n?void 0:n.address,value:{description:null===e||void 0===e||null===(a=e.location)||void 0===a||null===(i=a.attributes)||void 0===i?void 0:i.address,place_id:"",coordinates:null===e||void 0===e||null===(c=e.location)||void 0===c?void 0:c.coordinates,attributes:null===e||void 0===e||null===(o=e.location)||void 0===o?void 0:o.attributes}},days:null===e||void 0===e||null===(l=e.condition)||void 0===l?void 0:l.days,startTime:H()(null===e||void 0===e||null===(s=e.condition)||void 0===s?void 0:s.startTime),endTime:H()(null===e||void 0===e||null===(r=e.condition)||void 0===r?void 0:r.endTime)};b.push(u),v=Object(d.a)(Object(d.a)({},v),{},Object(T.a)(Object(T.a)(Object(T.a)(Object(T.a)({},"location-".concat(b.length-1),u.location),"start-time-".concat(b.length-1),u.startTime),"end-time-".concat(b.length-1),u.endTime),"days-".concat(b.length-1),u.days))}),k.setFieldsValue(Object(d.a)(Object(d.a)(Object(d.a)({operation:b},v),{},{license:null===l||void 0===l||null===(n=l.schoolBus)||void 0===n?void 0:n.license,preferences:null===l||void 0===l||null===(a=l.schoolBus)||void 0===a?void 0:a.preferences},null===l||void 0===l||null===(i=l.schoolBus)||void 0===i?void 0:i.license),{},{expiryDate:null!==l&&void 0!==l&&null!==(c=l.schoolBus)&&void 0!==c&&null!==(o=c.license)&&void 0!==o&&o.expiryDate?H()(null===l||void 0===l||null===(s=l.schoolBus)||void 0===s||null===(r=s.license)||void 0===r?void 0:r.expiryDate):void 0},null===l||void 0===l||null===(u=l.schoolBus)||void 0===u?void 0:u.preferences))}},[]);var $=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("values",t),i=(i=Object(C.a)((null===t||void 0===t||null===(n=t.operation)||void 0===n?void 0:n.map(function(e){var t,n,a,i;return{locationType:"operationStart",location:{coordinates:null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.coordinates,attributes:null===e||void 0===e||null===(a=e.location)||void 0===a||null===(i=a.value)||void 0===i?void 0:i.attributes},condition:{days:null===e||void 0===e?void 0:e.days,startTime:null===e||void 0===e?void 0:e.startTime,endTime:null===e||void 0===e?void 0:e.endTime}}}))||[])).reduce(function(e,t,n){var a=W();return e[a]=Object(d.a)({locationId:a},t),e},{}),L(!0),e.n=1,Y(null===l||void 0===l?void 0:l.id,null===P||void 0===P?void 0:P.userServiceId,{locationList:"1"===I?i:void 0,license:"2"===I?{licenseNumber:null===t||void 0===t?void 0:t.licenseNumber,licenseType:null===t||void 0===t?void 0:t.licenseType,experience:null===t||void 0===t?void 0:t.experience,expiryDate:null===t||void 0===t||null===(a=t.expiryDate)||void 0===a?void 0:a.format("MM/DD/YYYY HH:mm:ss")}:void 0,preferences:"3"===I?{experiencedStretcher:null===t||void 0===t?void 0:t.experiencedStretcher,trainedInStretchers:null===t||void 0===t?void 0:t.trainedInStretchers,wheelchairOnly:null===t||void 0===t?void 0:t.wheelchairOnly,stairChairs:null===t||void 0===t?void 0:t.stairChairs,overnightOnCall:null===t||void 0===t?void 0:t.overnightOnCall,preferredPartners:null===t||void 0===t?void 0:t.preferredPartners,preferenceNotes:null===t||void 0===t?void 0:t.preferenceNotes}:void 0});case 1:Lt("User updated successfully","success","TOP_CENTER",3e3),L(!1),r();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n,a){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,i){var c=a.locationList,l=a.license,s=a.preferences,r=[];c&&r.push({op:"add",path:"/persistent/static/schoolBus/locationList",value:c}),l&&r.push({op:"add",path:"/persistent/static/schoolBus/license",value:l}),s&&r.push({op:"add",path:"/persistent/static/schoolBus/preferences",value:s}),console.log("update user data",r),o.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,U(t,r),x.UpdateUserBio,n),o.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){e(t)})}))},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),V=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],z=function(e){var t=e.value,n=e.onChange,i=Object(a.useState)(t||[{location:void 0,startTime:void 0,endTime:void 0,days:void 0,timeWindow:10}]),c=Object(u.a)(i,2),o=c[0],l=c[1];Object(a.useEffect)(function(){t&&l(t)},[t]);var s=function(e,t,a){var i=o.map(function(n,i){return i===e?Object(d.a)(Object(d.a)({},n),{},Object(T.a)({},t,a)):n});null===n||void 0===n||n(i)},r=function(e){var t=e.value,n=e.onChange;return Object(oa.jsx)(gi,{placeholder:"Select Time",value:t?H()(t).format("HH:mm"):void 0,onChange:n})};return Object(oa.jsxs)(oa.Fragment,{children:[o.map(function(e,t){var n=V.filter(function(t){var n;return!o.reduce(function(e,t){return t.days?[].concat(Object(C.a)(e),Object(C.a)(t.days)):e},[]).includes(t)||(null===(n=e.days)||void 0===n?void 0:n.includes(t))});return Object(oa.jsxs)(Yn.a,{className:"mb-3",children:[Object(oa.jsx)(Hn.a,{span:21,className:"pr-3",children:Object(oa.jsx)(ei.a.Item,{label:"Operation start Location",name:"location-".concat(t),rules:[{required:!0,message:"Location is required"}],children:Object(oa.jsx)(ai,{placeholder:"Enter Start Location",onChange:function(e){return s(t,"location",e)}})})}),Object(oa.jsx)(Hn.a,{span:3,className:"t-right d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn orange-btn bordered",onClick:function(){return function(e){l(function(t){return t.filter(function(t,n){return n!==e})})}(t)},children:Object(oa.jsx)(na.a,{style:{color:"#FF5F25"}})})}),Object(oa.jsx)(Hn.a,{span:24,className:"mt-3",children:Object(oa.jsx)(ei.a.Item,{label:"Operation Days",name:"days-".concat(t),rules:[{required:!0,message:"Days selection is required"}],children:Object(oa.jsx)(Gn.a,{placeholder:"Select Days",mode:"multiple",value:e.days,onChange:function(e){return s(t,"days",e)},style:{width:"100%"},children:n.map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})})}),Object(oa.jsx)(Hn.a,{span:12,className:"mt-3",children:Object(oa.jsx)(ei.a.Item,{label:"Start Time",name:"start-time-".concat(t),rules:[{required:!0,message:"Start time is required"}],children:Object(oa.jsx)(r,{onChange:function(e){s(t,"startTime",e)}})})}),Object(oa.jsx)(Hn.a,{span:12,className:"mt-3 pl-2",children:Object(oa.jsx)(ei.a.Item,{label:"End Time",name:"end-time-".concat(t),rules:[{required:!0,message:"End time is required"}],children:Object(oa.jsx)(r,{onChange:function(e){s(t,"endTime",e)}})})})]},"location-".concat(t))}),Object(oa.jsx)(Yn.a,{className:"mt-3 mb-3",children:Object(oa.jsx)(Hn.a,{span:24,className:"d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn yellow-btn bordered",onClick:function(){l(function(e){return[].concat(Object(C.a)(e),[{location:void 0,startTime:void 0,endTime:void 0,days:void 0,timeWindow:10}])})},children:Object(oa.jsx)("span",{style:{color:"#FBAE16"},children:"Add"})})})})]})},Q=function(e){e.value,e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{label:"License Number",name:"licenseNumber",rules:[{required:!0,message:"Please input the license number"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter license number"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"License Type",name:"licenseType",rules:[{required:!0,message:"Please select a license type"}],children:Object(oa.jsx)(Gn.a,{placeholder:"Select license type",children:["CDL Class A","CDL Class B","CDL Class C"].map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"License Expiry Date",name:"expiryDate",rules:[{required:!0,message:"Please select the license expiry date"}],children:Object(oa.jsx)(Jn.a,{style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Years of Experience",name:"experience",rules:[{required:!0,message:"Please input years of experience"},{pattern:/^[0-9]+$/,message:"The input must be a number"}],children:Object(oa.jsx)(Wn.a,{min:0,max:50,placeholder:"Years of experience",style:{width:"100%"}})})]})},G=Gn.a.Option,J=function(e){var t;e.value,e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{name:"experiencedStretcher",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Experienced Stretcher Personnel"})}),Object(oa.jsx)(ei.a.Item,{name:"trainedInStretchers",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Trained in Stretchers (must go with Experienced Personnel)"})}),Object(oa.jsx)(ei.a.Item,{name:"wheelchairOnly",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Wheelchair Only"})}),Object(oa.jsx)(ei.a.Item,{name:"stairChairs",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Stair Chairs"})}),Object(oa.jsx)(ei.a.Item,{name:"overnightOnCall",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Potential Overnight On-Call Personnel"})}),Object(oa.jsx)(ei.a.Item,{name:"preferredPartners",label:"Preferred Partners to Drive With",className:"mt-3",children:Object(oa.jsx)(Gn.a,{mode:"multiple",placeholder:"Select preferred partners",allowClear:!0,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===v||void 0===v||null===(t=v.filter(function(e){return e.key!==(null===l||void 0===l?void 0:l.id)}))||void 0===t?void 0:t.map(function(e){return Object(oa.jsx)(G,{value:e.key,children:e.name})})})}),Object(oa.jsx)(ei.a.Item,{name:"preferenceNotes",label:"Preference Notes",className:"mt-3",children:Object(oa.jsx)(Wn.a.TextArea,{autoSize:{minRows:4,maxRows:6},placeholder:"Enter notes"})})]})};return Object(oa.jsx)(i.a.Fragment,{children:b?Object(oa.jsx)(Hn.a,{span:24,className:B?"d-flex flex-column align-items-start":"d-flex justify-content-space-between align-items-space-between",children:Object(oa.jsxs)(ei.a,{className:"auth-form ".concat(b?"full-width":""),name:"register-form",id:"register-form",layout:"vertical",form:k,onFinish:$,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsxs)(Kl.a,{defaultActiveKey:"1",type:"line",onChange:function(e){S(e)},children:[Object(oa.jsx)(vs,{tab:"Clock In/out",children:"1"===I&&Object(oa.jsx)(ns,{socket:o,userId:null===l||void 0===l?void 0:l.id})},"1"),Object(oa.jsx)(vs,{tab:"Shift",children:Object(oa.jsx)(ei.a.Item,{name:"shift",children:"2"===I&&Object(oa.jsx)(us,{socket:o,userId:null===l||void 0===l?void 0:l.id})})},"2"),Object(oa.jsx)(vs,{tab:"Timeoff",children:"3"===I&&Object(oa.jsx)(as,{socket:o,userId:null===l||void 0===l?void 0:l.id})},"3"),Object(oa.jsx)(vs,{tab:"Driver License",children:"4"===I&&Object(oa.jsx)(ei.a.Item,{name:"license",children:Object(oa.jsx)(Q,{})})},"4"),Object(oa.jsx)(vs,{tab:"Preferences",children:Object(oa.jsx)(ei.a.Item,{name:"preferences",children:"5"===I&&Object(oa.jsx)(J,{})})},"5")]})}),"1"!==I&&"2"!==I&&"3"!==I&&Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:M,type:"primary",htmlType:"submit",onClick:function(){return R("")},children:"Save"})})})})]})}):Object(oa.jsx)($n.a,{title:"Edit (".concat((null===l||void 0===l||null===(t=l.live)||void 0===t||null===(n=t.beamIds)||void 0===n?void 0:n[0])||"student",")"),visible:!!b||O,onCancel:function(){f(!1),c&&c()},width:b?"100vw":"800px",className:"beam-modal ".concat(b?"analytics-summary-modal":""),bodyStyle:{height:"100vh",overflow:"auto"},style:{height:"100vh",margin:b?0:void 0},footer:[],destroyOnClose:!0,closable:!b,children:Object(oa.jsxs)(ei.a,{className:"auth-form ".concat(b?"full-width":""),name:"register-form",id:"register-form",layout:"vertical",form:k,onFinish:$,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsxs)(Kl.a,{defaultActiveKey:"1",type:"line",onChange:function(e){S(e)},children:[Object(oa.jsx)(vs,{tab:"Driver Availability & Operation",children:"1"===I&&Object(oa.jsx)(ei.a.Item,{name:"vehicle",children:Object(oa.jsx)(ei.a.Item,{name:"operation",children:Object(oa.jsx)(z,{})})})},"1"),Object(oa.jsx)(vs,{tab:"Driver License",children:"2"===I&&Object(oa.jsx)(ei.a.Item,{name:"license",children:Object(oa.jsx)(Q,{})})},"2"),Object(oa.jsx)(vs,{tab:"Preferences",children:Object(oa.jsx)(ei.a.Item,{name:"preferences",children:"3"===I&&Object(oa.jsx)(J,{})})},"3"),Object(oa.jsx)(vs,{tab:"Shift",children:"6"===I&&Object(oa.jsx)(us,{socket:o,userId:null===l||void 0===l?void 0:l.id})},"6"),Object(oa.jsx)(vs,{tab:"Clock In/out",children:"4"===I&&Object(oa.jsx)(ns,{socket:o,userId:null===l||void 0===l?void 0:l.id})},"4"),Object(oa.jsx)(vs,{tab:"Timeoff",children:"5"===I&&Object(oa.jsx)(as,{socket:o,userId:null===l||void 0===l?void 0:l.id})},"5")]})}),"4"!==I&&"5"!==I&&"6"!==I&&Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:M,type:"primary",htmlType:"submit",onClick:function(){return R("")},children:"Save"})})})})]})})})};Dc.d.register(Dc.a,Dc.j,Dc.e);var js,ms=function(e){var t=e.socket,n=(e.params,e.componentUuid,e.userRole),c=Object(s.c)(function(e){return e.auth}),o=c.selectedPage,l=c.encrypted_token,r=c.projects,d=c.adminUserRoles,v=Object(s.b)(),b=Object(a.useState)([]),j=Object(u.a)(b,2),m=j[0],p=j[1],O=Object(a.useState)([]),f=Object(u.a)(O,2),h=f[0],g=f[1];Object(a.useState)(!1);var x=Object(a.useState)(!1),y=Object(u.a)(x,2),I=y[0],S=y[1];Object(a.useState)(!1);Mn().getUserRequestPayload;var N=Object(a.useRef)(),k=Object(a.useState)(void 0),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(a.useRef)(!0),R=function(e,t){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,c="@serviceId:{'".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}");switch(i&&i.length>2&&(c+=function(e){var t="",n=e.trim().split(" ").filter(function(e){return e.length>2}).map(function(e){return"*"+z(e)+"*"});return 0==n.length?t:(n.forEach(function(e){t+="@firstName:(".concat(e,")|@lastName:(").concat(e,")|")}),t+="@beamIds:{".concat(n.join("|"),"}"),"(".concat(t,")"))}(i)),t){case ac.Dispatcher:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)});break;case ac.Live:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Live)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Responder:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.OnMove)});break;case ac.Manager:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)})}console.log("selected user roles",a);var o=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),s={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:c,searchOptions:"TIMEOUT 5000"},list:{objectIds:"driver"===n?[null===l||void 0===l?void 0:l.userId]:void 0},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId",schoolBus:"$..schoolBus"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(o.join("||"),")")},anyStatus:!1};S(!0),v(tt({requestData:s,callback:function(e){S(!1);var t=[],n=[{title:"Status",key:"userStatus",dataIndex:"userStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Name",key:"name",dataIndex:"name"},{title:"Custom id",key:"customId",dataIndex:"customId"},{title:"Email",key:"email",dataIndex:"email"},{title:"Phone",key:"phone",dataIndex:"phone"},{title:"Operation start location",key:"operationLocation",dataIndex:"operationLocation"},{title:"License number",key:"licenseNumber",dataIndex:"licenseNumber"},{title:"License type",key:"licenseType",dataIndex:"licenseType"},{title:"License expiry",key:"licenseExpiry",dataIndex:"licenseExpiry"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsx)(Yn.a,{style:{width:135},children:Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),w(e.user)},children:Object(oa.jsx)(wo.a,{})})})})}}];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h,g,x,y,I,S=null===(a=Object.values((null===e||void 0===e||null===(i=e.schoolBus)||void 0===i?void 0:i.locationList)||{}))||void 0===a?void 0:a.find(function(e){return"operationStart"===e.locationType});t.push({key:e.id,userStatus:null===e||void 0===e||null===(c=e.status)||void 0===c?void 0:c.name,name:"".concat(null===e||void 0===e||null===(o=e.live)||void 0===o||null===(l=o.profile)||void 0===l?void 0:l.firstName," ").concat(null===e||void 0===e||null===(s=e.live)||void 0===s||null===(r=s.profile)||void 0===r?void 0:r.lastName),email:null===e||void 0===e||null===(d=e.live)||void 0===d||null===(u=d.alternativeIds)||void 0===u?void 0:u.email,phone:null===e||void 0===e||null===(v=e.live)||void 0===v||null===(b=v.alternativeIds)||void 0===b?void 0:b.phone,customId:null===e||void 0===e||null===(j=e.live)||void 0===j||null===(m=j.alternativeIds)||void 0===m?void 0:m.customId,operationLocation:null===S||void 0===S||null===(p=S.location)||void 0===p||null===(O=p.attributes)||void 0===O?void 0:O.address,licenseNumber:null===e||void 0===e||null===(f=e.schoolBus)||void 0===f||null===(h=f.license)||void 0===h?void 0:h.licenseNumber,licenseType:null===e||void 0===e||null===(g=e.schoolBus)||void 0===g||null===(x=g.license)||void 0===x?void 0:x.licenseType,licenseExpiry:null===e||void 0===e||null===(y=e.schoolBus)||void 0===y||null===(I=y.license)||void 0===I?void 0:I.expiryDate,action:{userId:null===e||void 0===e?void 0:e.id,user:e}})}),N.current=t,g(n),p(t)}}))};Object(a.useEffect)(function(){return E.current=!0,function(){E.current=!1}},[]),Object(a.useEffect)(function(){null!==r&&void 0!==r&&r.adminUserId&&R(d,ac.Responder)},[r]);var P=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],D=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Driver"}),Object(oa.jsx)("p",{children:"Home > Driver"})]}),Object(oa.jsx)(Wn.a,{onChange:function(e){var t=e.target.value;ds&&clearTimeout(ds),ds=setTimeout(function(){t.includes("-")&&(t=z(t)),R(d,ac.Responder,t)},500)},style:{width:350},placeholder:"Search user",suffix:Object(oa.jsx)(Jl.a,{})})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:I?D:m,columns:I?P:h,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==C&&Object(oa.jsx)(bs,{socket:t,student:C,onClose:function(){w(void 0)},onAdd:function(){R(d,ac.Responder)},sourceData:m})]})};Dc.d.register(Dc.a,Dc.j,Dc.e);var ps,Os=function(e){var t=e.socket,n=(e.params,e.componentUuid,e.userRole),c=Object(s.c)(function(e){return e.auth}),o=c.selectedPage,l=c.encrypted_token,r=c.projects,d=c.adminUserRoles,v=Object(s.b)(),b=Object(a.useState)([]),j=Object(u.a)(b,2),p=j[0],O=j[1],f=Object(a.useState)([]),h=Object(u.a)(f,2);h[0],h[1];Object(a.useState)(!1);var g=Object(a.useState)(!1),x=Object(u.a)(g,2),y=x[0],I=x[1];Object(a.useState)(!1);Mn().getUserRequestPayload;var S=Object(a.useRef)(),N=Object(a.useState)(void 0),k=Object(u.a)(N,2),T=(k[0],k[1],Object(a.useRef)(!0)),C=Object(a.useState)(null),w=Object(u.a)(C,2),E=w[0],R=w[1],P=function(e){return new Promise(function(n,a){var i;t.publishToEvent(m.PublishPageTopics,(i=null===l||void 0===l?void 0:l.connectionId,"".concat(Ut,"/connection/").concat(i,"/service/hpd-dps/addUserToOrgPages")),Dn({userId:null===e||void 0===e?void 0:e.toString(),serviceId:null===r||void 0===r?void 0:r.userServiceId})),t.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat(Ut,"/connection/").concat(e,"/service/hpd-dps/addUserToOrgPages/reply")}(null===l||void 0===l?void 0:l.connectionId),function(e){n(e)})})},D=Object(a.useMemo)(function(){return[{title:"Status",key:"userStatus",dataIndex:"userStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Name",key:"name",dataIndex:"name"},{title:"Custom id",key:"customId",dataIndex:"customId"},{title:"Email",key:"email",dataIndex:"email"},{title:"Phone",key:"phone",dataIndex:"phone"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsx)(Yn.a,{style:{width:135},children:Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",loading:E===e.userId,onClick:Object(_n.a)(Object(Bn.a)().m(function t(){var n,a,i;return Object(Bn.a)().w(function(t){for(;;)switch(t.p=t.n){case 0:return console.log("action",e),R(e.userId),t.p=1,t.n=2,P(e.userId);case 2:return a=t.v,t.n=3,new Promise(function(e){return setTimeout(e,3e3)});case 3:console.log("response",a),null!==a&&void 0!==a&&null!==(n=a.response)&&void 0!==n&&n.status?Lt("Sync requested successfully","success","TOP_CENTER",1e3):Lt(null===a||void 0===a||null===(i=a.response)||void 0===i?void 0:i.data.details,"error","TOP_CENTER",1e3);case 4:return t.p=4,R(null),t.f(4);case 5:return t.a(2)}},t,null,[[1,,4,5]])})),children:E!==e.userId&&Object(oa.jsx)(El.a,{})})})})}}]},[E]),A=function(e,t){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,c="@serviceId:{'".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}");switch(i&&i.length>2&&(c+=function(e){var t="",n=e.trim().split(" ").filter(function(e){return e.length>2}).map(function(e){return"*"+z(e)+"*"});return 0==n.length?t:(n.forEach(function(e){t+="@firstName:(".concat(e,")|@lastName:(").concat(e,")|")}),t+="@beamIds:{".concat(n.join("|"),"}"),"(".concat(t,")"))}(i)),t){case ac.Dispatcher:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)||-1!==e.permissions.indexOf(ic.Admin)});break;case ac.Live:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Live)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Responder:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.OnMove)});break;case ac.Manager:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)})}console.log("selected user roles",a);var o=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),s={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:c,searchOptions:"TIMEOUT 5000"},list:{objectIds:"driver"===n?[null===l||void 0===l?void 0:l.userId]:void 0},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId",schoolBus:"$..schoolBus"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(o.join("||"),")")},anyStatus:!1};I(!0),v(tt({requestData:s,callback:function(e){I(!1);var t=[];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h,g,x,y,I,S=null===(a=Object.values((null===e||void 0===e||null===(i=e.schoolBus)||void 0===i?void 0:i.locationList)||{}))||void 0===a?void 0:a.find(function(e){return"operationStart"===e.locationType});t.push({key:e.id,userStatus:null===e||void 0===e||null===(c=e.status)||void 0===c?void 0:c.name,name:"".concat(null===e||void 0===e||null===(o=e.live)||void 0===o||null===(l=o.profile)||void 0===l?void 0:l.firstName," ").concat(null===e||void 0===e||null===(s=e.live)||void 0===s||null===(r=s.profile)||void 0===r?void 0:r.lastName),email:null===e||void 0===e||null===(d=e.live)||void 0===d||null===(u=d.alternativeIds)||void 0===u?void 0:u.email,phone:null===e||void 0===e||null===(v=e.live)||void 0===v||null===(b=v.alternativeIds)||void 0===b?void 0:b.phone,customId:null===e||void 0===e||null===(j=e.live)||void 0===j||null===(m=j.alternativeIds)||void 0===m?void 0:m.customId,operationLocation:null===S||void 0===S||null===(p=S.location)||void 0===p||null===(O=p.attributes)||void 0===O?void 0:O.address,licenseNumber:null===e||void 0===e||null===(f=e.schoolBus)||void 0===f||null===(h=f.license)||void 0===h?void 0:h.licenseNumber,licenseType:null===e||void 0===e||null===(g=e.schoolBus)||void 0===g||null===(x=g.license)||void 0===x?void 0:x.licenseType,licenseExpiry:null===e||void 0===e||null===(y=e.schoolBus)||void 0===y||null===(I=y.license)||void 0===I?void 0:I.expiryDate,action:{userId:null===e||void 0===e?void 0:e.id,user:e}})}),S.current=t,O(t)}}))};Object(a.useEffect)(function(){return T.current=!0,function(){T.current=!1}},[]),Object(a.useEffect)(function(){null!==r&&void 0!==r&&r.adminUserId&&A(d,ac.Dispatcher)},[r]);var M=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],L=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Dispatcher"}),Object(oa.jsx)("p",{children:"Home > Dispatcher"})]}),Object(oa.jsx)(Wn.a,{onChange:function(e){var t=e.target.value;js&&clearTimeout(js),js=setTimeout(function(){t.includes("-")&&(t=z(t)),A(d,ac.Responder,t)},500)},style:{width:350},placeholder:"Search user",suffix:Object(oa.jsx)(Jl.a,{})})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:y?L:p,columns:y?M:D,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})})]})},fs=(Za.a.Panel,Kl.a.TabPane),hs=function(e){var t,n=e.onClose,c=e.socket,o=e.student,l=(e.adminRoles,e.onAdd),r=Object(a.useState)(!0),v=Object(u.a)(r,2),b=v[0],j=v[1],p=ei.a.useForm(),O=Object(u.a)(p,1)[0],f=Object(a.useState)(""),h=Object(u.a)(f,2),g=(h[0],h[1]),I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(s.c)(function(e){return e.auth}).projects,C=Mn().updateUserRequestPayloadV2,w=Object(a.useState)("1"),E=Object(u.a)(w,2),R=E[0],P=E[1];Object(a.useEffect)(function(){var e,t,n,a,i,c,l,s,r,u;null!==o&&void 0!==o&&o.static&&O.setFieldsValue(Object(d.a)(Object(d.a)(Object(d.a)({},null===o||void 0===o?void 0:o.static),null===o||void 0===o||null===(e=o.static)||void 0===e?void 0:e.preferences),{},{maintenanceDate:H()(null===o||void 0===o||null===(t=o.static)||void 0===t?void 0:t.maintenanceDate),responder:null!==o&&void 0!==o&&null!==(n=o.static)&&void 0!==n&&null!==(a=n.alternativeIds)&&void 0!==a&&a.userId?{type:"responder",id:null===o||void 0===o||null===(i=o.static)||void 0===i||null===(c=i.alternativeIds)||void 0===c?void 0:c.userId,beamId:null===o||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.alternativeIds)||void 0===s?void 0:s.beamId,valueName:null===o||void 0===o||null===(r=o.static)||void 0===r||null===(u=r.alternativeIds)||void 0===u?void 0:u.beamId}:void 0}))},[]);var D=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,s,r,d,u,v,b,j,m,p,O,f,h,g;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("values",t),n=t.name,a=t.makeAndModel,i=t.mileage,c=t.trim,s=t.colour,r=t.year,d=t.licensePlate,u=t.vin,v=t.permit,b=t.tireSize,j=t.engine,m=t.width,p=t.maintenanceDate,O=t.phoneMount,f=t.holePunched,h=t.bluetooth,g={vehicle:"1"===R?{name:n,makeAndModel:a,mileage:i,licensePlate:d,year:r,trim:c,colour:s,permit:v,tireSize:b,engine:j,width:m,maintenanceDate:p.format("MM/DD/YYYY HH:mm:ss"),vin:u}:void 0,preferences:"2"===R?{phoneMount:O,holePunched:f,bluetooth:h}:void 0},k(!0),e.n=1,A(null===o||void 0===o?void 0:o.id,null===T||void 0===T?void 0:T.userServiceId,g);case 1:Lt("User updated successfully","success","TOP_CENTER",3e3),k(!1),l();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n,a){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,i){var o,l=a.vehicle,s=a.preferences,r=[];l&&(null===(o=Object.keys(l))||void 0===o||o.map(function(e){r.push({op:"add",path:"/persistent/static/asset/".concat(e),value:null===l||void 0===l?void 0:l[e]})}));s&&r.push({op:"add",path:"/persistent/static/asset/preferences",value:s}),console.log("update user data",r),c.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,C(t,r),x.UpdateUserBio,n),c.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){e(t)})}))},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),M=function(e){e.value,e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input the vehicle name"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter name"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Make and Model",name:"makeAndModel",rules:[{required:!0,message:"Please enter the make and model"}],children:Object(oa.jsx)(Wn.a,{placeholder:"e.g., Ford Transit 2021"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Trim",name:"trim",rules:[{required:!0,message:"Please enter the vehicle trim"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter trim"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Colour",name:"colour",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter vehicle colour",style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Year",name:"year",rules:[{required:!0,message:"Please enter the vehicle year"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter vehicle year",style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"License Plate Number",name:"licensePlate",rules:[{required:!0,message:"Please enter the license plate number"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter license plate number"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Vehicle Identification Number (VIN)",name:"vin",rules:[{required:!0,message:"Please enter the vehicle identification number (VIN)"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter VIN"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Permit #",name:"permit",rules:[{required:!0,message:"Please enter permit #"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter permit #"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Tire Size",name:"tireSize",rules:[{required:!0,message:"Please enter tire size"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter tire size"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Engine",name:"engine",rules:[{required:!0,message:"Please enter engine"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter engine"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Ramp width",name:"width",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter width"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Current Mileage",name:"mileage",rules:[],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter mileage in miles or kilometers",style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Last Maintenance Date",name:"maintenanceDate",rules:[{required:!0,message:"Please select the last maintenance date"}],children:Object(oa.jsx)(Jn.a,{style:{width:"100%"}})})]})},L=function(e){e.value,e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("div",{className:"ant-col ant-form-item-label",children:Object(oa.jsx)("label",{className:"ant-form-item-required",title:"Name",children:"Features"})}),Object(oa.jsx)(ei.a.Item,{name:"phoneMount",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Phone Mount"})}),Object(oa.jsx)(ei.a.Item,{name:"holePunched",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Hole-punched CC"})}),Object(oa.jsx)(ei.a.Item,{name:"bluetooth",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Bluetooth"})})]})};return Object(oa.jsx)($n.a,{title:"Edit (".concat((null===o||void 0===o||null===(t=o.static)||void 0===t?void 0:t.name)||"vehicle",")"),visible:b,onCancel:function(){j(!1),n&&n()},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:O,onFinish:D,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsxs)(Kl.a,{defaultActiveKey:"1",type:"line",onChange:function(e){P(e)},children:[Object(oa.jsx)(fs,{tab:"Vehicle Information",children:Object(oa.jsx)(ei.a.Item,{name:"vehicle",children:Object(oa.jsx)(M,{})})},"1"),Object(oa.jsx)(fs,{tab:"Preferences",children:Object(oa.jsx)(ei.a.Item,{name:"preferences",children:Object(oa.jsx)(L,{})})},"2")]})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:N,type:"primary",htmlType:"submit",onClick:function(){return g("")},children:"Save"})})})})]})})};Dc.d.register(Dc.a,Dc.j,Dc.e);var gs=function(e){var t=e.socket,n=(e.params,e.componentUuid,Object(s.c)(function(e){return e.auth})),c=n.selectedPage,o=(n.encrypted_token,n.projects),l=n.adminUserRoles,r=Object(s.b)(),d=Object(a.useState)([]),v=Object(u.a)(d,2),b=v[0],j=v[1],m=Object(a.useState)([]),p=Object(u.a)(m,2),O=p[0],f=p[1];Object(a.useState)(!1);var h=Object(a.useState)(!1),g=Object(u.a)(h,2),x=g[0],y=g[1];Object(a.useState)(!1);Mn().getUserRequestPayload;var I=Object(a.useRef)(),S=Object(a.useState)(void 0),N=Object(u.a)(S,2),k=N[0],T=N[1],C=Object(a.useRef)(!0),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t="@userType:{asset}@serviceId:{'".concat(z(null===o||void 0===o?void 0:o.userServiceId),"'}"),n={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:t,searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",static:"$.persistent.static.asset",type:"$.persistent.static.asset.type",name:"$.persistent.static.asset.name",status:"$.nonpersistent.static.live.status"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@type) && @type=='vehicle' && exists(@name)"+"".concat(e&&""!==e?" && contains(@name, '".concat(e,"')"):"")},anyStatus:!1};y(!0),r(tt({requestData:n,callback:function(e){y(!1),console.log("respons ehere",e);var t=[],n=[{title:"Status",key:"userStatus",dataIndex:"userStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Name",key:"name",dataIndex:"name"},{title:"License plate number",key:"licensePlate",dataIndex:"licensePlate"},{title:"Make & Model",key:"makeAndModel",dataIndex:"makeAndModel"},{title:"Year",key:"year",dataIndex:"year"},{title:"VIN",key:"vin",dataIndex:"vin"},{title:"Permit #",key:"permit",dataIndex:"permit"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsx)(Yn.a,{style:{width:135},children:Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),T(e.user)},children:Object(oa.jsx)(wo.a,{})})})})}}];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l,s;t.push({key:e.id,name:null===e||void 0===e||null===(a=e.static)||void 0===a?void 0:a.name,licensePlate:null===e||void 0===e||null===(i=e.static)||void 0===i?void 0:i.licensePlate,makeAndModel:null===e||void 0===e||null===(c=e.static)||void 0===c?void 0:c.makeAndModel,year:null===e||void 0===e||null===(o=e.static)||void 0===o?void 0:o.year,vin:null===e||void 0===e||null===(l=e.static)||void 0===l?void 0:l.vin,permit:null===e||void 0===e||null===(s=e.static)||void 0===s?void 0:s.permit,status:null===e||void 0===e?void 0:e.status,action:{userId:null===e||void 0===e?void 0:e.id,user:e}})}),I.current=t,f(n),j(t)}}))};Object(a.useEffect)(function(){return C.current=!0,function(){C.current=!1}},[]),Object(a.useEffect)(function(){null!==o&&void 0!==o&&o.adminUserId&&w()},[o]);var E=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],R=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Vehicle"}),Object(oa.jsx)("p",{children:"Home > Vehicle"})]}),Object(oa.jsx)(Wn.a,{onChange:function(e){var t=e.target.value;ps&&clearTimeout(ps),ps=setTimeout(function(){t.includes("-")&&(t=z(t)),w(t)},500)},style:{width:350},placeholder:"Search user",suffix:Object(oa.jsx)(Jl.a,{})})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:x?R:b,columns:x?E:O,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===c||void 0===c||null===(n=c.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==k&&Object(oa.jsx)(hs,{socket:t,student:k,onClose:function(){T(void 0)},adminRoles:l,onAdd:function(){w()}})]})},xs=n(1035),ys=(Za.a.Panel,xs.a.Text),Is=["Stretcher","Broda","Wheelchair","Additional staff (Per Person)","Hulpr Wheelchair","Hulpr Broda","Oxygen","Overnight","Tax"],Ss=function(e,t){var n=1;return e.flatMap(function(e){return({"Hulpr Wheelchair":["Flat Rate"],"Hulpr Broda":["Flat Rate"],Overnight:["Overnight/Holiday multiplier"],Oxygen:["Oxygen (per L/min)"],Tax:["%"]}[e]||["Base Rate","KM Rate","Wait Time"]).map(function(a){return Object(d.a)({key:"".concat(n++),service:e,type:a},Object.fromEntries(t.map(function(e){return[e.name,0]})))})})},Ns=Kl.a.TabPane,ks=function(e){var t=e.onClose,n=e.socket,i=e.student,c=(e.adminRoles,e.onAdd),o=Object(a.useState)(!0),l=Object(u.a)(o,2),r=l[0],v=l[1],b=ei.a.useForm(),j=Object(u.a)(b,1)[0],p=Object(a.useState)(""),O=Object(u.a)(p,2),f=(O[0],O[1]),h=Object(a.useState)(!1),g=Object(u.a)(h,2),I=g[0],S=g[1],N=Object(s.c)(function(e){return e.auth}).projects,k=Mn().updateUserRequestPayloadV2,w=Object(a.useState)("1"),E=Object(u.a)(w,2),R=(E[0],E[1],function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("values",t),S(!0),e.n=1,P(null===t||void 0===t?void 0:t.pricingRates);case 1:S(!1),Lt("Pricing updated successfully","success","TOP_CENTER",3e3);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),P=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,a){var o=[],l=t.locations,s=t.rates;l&&o.push({op:"add",path:"/persistent/static/admin/pricingManagement/items/".concat(i._id,"/locations"),value:l}),s&&o.push({op:"add",path:"/persistent/static/admin/pricingManagement/items/".concat(i._id,"/rates"),value:s}),console.log("update user data",o),n.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,k(null===N||void 0===N?void 0:N.adminUserId,o),x.UpdateUserBio,null===N||void 0===N?void 0:N.userServiceId),n.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(n){console.log("update response",n),e(n),c&&c(t)})}))},e)}));return function(t){return e.apply(this,arguments)}}(),D=function(e){var t,n=e.onChange,c=Object(a.useState)((null===i||void 0===i||null===(t=i.rates)||void 0===t?void 0:t.length)>0?null===i||void 0===i?void 0:i.rates:Ss(Is,null===i||void 0===i?void 0:i.locations)),o=Object(u.a)(c,2),l=o[0],s=o[1],r=Object(a.useState)(null===i||void 0===i?void 0:i.locations),v=Object(u.a)(r,2),b=v[0],j=v[1],m=Object(a.useState)(!1),p=Object(u.a)(m,2),O=p[0],h=p[1],g=Object(a.useState)(!1),x=Object(u.a)(g,2),y=x[0],S=x[1],N=Object(a.useState)(""),k=Object(u.a)(N,2),w=k[0],E=k[1],R=Object(a.useState)({key:"",name:"",address:"",geofenceRadius:0}),D=Object(u.a)(R,2),A=D[0],M=D[1];Object(a.useEffect)(function(){n({locations:b,rates:l})},[b,l]);var L=[{title:"Location Name",dataIndex:"name",key:"name"},{title:"Address",dataIndex:"address",key:"address",render:function(e,t){var n,a,i,c,o,l={label:null===t||void 0===t||null===(n=t.address)||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.address,value:{description:null===t||void 0===t||null===(i=t.address)||void 0===i||null===(c=i.attributes)||void 0===c?void 0:c.address,place_id:"",coordinates:null===t||void 0===t||null===(o=t.address)||void 0===o?void 0:o.coordinates}};return Object(oa.jsx)("div",{style:{minWidth:200},children:Object(oa.jsx)(ai,{value:l,onChange:function(e){j(b.map(function(n){return n.key===t.key?Object(d.a)(Object(d.a)({},n),{},{address:e}):n}))}})})}},{title:"Geofence Radius (km)",dataIndex:"geofenceRadius",key:"geofenceRadius",render:function(e,t){return Object(oa.jsx)(Wn.a,{min:0,value:t.geofenceRadius,onChange:function(e){return j(b.map(function(n){return n.key===t.key?Object(d.a)(Object(d.a)({},n),{},{geofenceRadius:e.target.value}):n}))}})}},{title:"Action",key:"action",render:function(e,t){return Object(oa.jsx)(Co.a,{title:"Are you sure to delete this location?",onConfirm:function(){return function(e){var t=b.filter(function(t){return t.name!==e}),n=l.map(function(t){var n=Object(d.a)({},t);return delete n[e],n});j(t),s(n),P({locations:t,rates:n})}(t.name)},children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})})}}],U=[{title:"Service",dataIndex:"service",key:"service",render:function(e){return Object(oa.jsx)(ys,{strong:!0,children:e})}},{title:"Type",dataIndex:"type",key:"type"}].concat(Object(C.a)(b.map(function(e){return{title:e.name,dataIndex:e.name,key:e.name,render:function(t,n){return Object(oa.jsx)(Wn.a,{value:t,min:0,onChange:function(t){return function(e,t,n){var a=l.map(function(a){return a.key===t?Object(d.a)(Object(d.a)({},a),{},Object(T.a)({},n,e)):a});s(a)}(t.target.value,n.key,e.name)}})}}})),[{title:"Action",dataIndex:"action",key:"action",render:function(e,t){return l.filter(function(e){return e.service===t.service}).length>=1?Object(oa.jsx)(Co.a,{title:"Are you sure to delete this service?",onConfirm:function(){return e=t.service,void s(l.filter(function(t){return t.service!==e}));var e},children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})}):null}}]);return Object(oa.jsxs)("div",{children:[Object(oa.jsxs)(Kl.a,{defaultActiveKey:localStorage.getItem("selectedTab")||"1",type:"line",onChange:function(e){localStorage.setItem("selectedTab",e)},children:[Object(oa.jsxs)(Ns,{tab:"Locations",children:[Object(oa.jsx)(Yn.a,{className:"mb-3",children:Object(oa.jsx)(Hn.a,{span:24,className:"d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn yellow-btn bordered",onClick:function(){return S(!0)},children:"Add"})})}),Object(oa.jsx)(Xi.a,{dataSource:b,columns:L,pagination:!1,bordered:!0})]},"1"),Object(oa.jsxs)(Ns,{tab:"Service Rates",children:[Object(oa.jsx)(Yn.a,{className:"mb-3",children:Object(oa.jsx)(Hn.a,{span:24,className:"d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn yellow-btn bordered",onClick:function(){return h(!0)},children:"Add"})})}),Object(oa.jsx)(Xi.a,{dataSource:l,columns:U,pagination:!1,bordered:!0})]},"2")]}),Object(oa.jsx)($n.a,{title:"Add New Service",visible:O,onCancel:function(){return h(!1)},okButtonProps:{disabled:!w.trim()},className:"beam-modal",footer:[],children:Object(oa.jsxs)(ei.a,{layout:"vertical",className:"auth-form",onFinish:function(){if(w.trim()){var e=Ss([w],b);s([].concat(Object(C.a)(l),Object(C.a)(e))),E(""),h(!1)}h(!1)},children:[Object(oa.jsx)(ei.a.Item,{label:"Service Name",required:!0,children:Object(oa.jsx)(Wn.a,{value:w,onChange:function(e){return E(e.target.value)},placeholder:"Enter new service name"})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:I,type:"primary",htmlType:"submit",onClick:function(){return f("")},children:"Save"})})})})]})}),Object(oa.jsx)($n.a,{title:"Add New Location",visible:y,onCancel:function(){return S(!1)},className:"beam-modal",footer:[],children:Object(oa.jsxs)(ei.a,{layout:"vertical",className:"auth-form",onFinish:function(){if(A.name.trim()&&!b.some(function(e){return e.name===A.name})){var e,t,n=Object(d.a)(Object(d.a)({},A),{},{key:"".concat(b.length+1),address:{attributes:{address:null===A||void 0===A||null===(e=A.address)||void 0===e?void 0:e.label},coordinates:null===A||void 0===A||null===(t=A.address)||void 0===t?void 0:t.value.coordinates}}),a=[].concat(Object(C.a)(b),[n]),i=l.map(function(e){return Object(d.a)(Object(d.a)({},e),{},Object(T.a)({},A.name,0))});console.log("temp data source",i),j(a),s(i),M({key:"",name:"",address:"",geofenceRadius:0}),P({locations:a,rates:i})}S(!1)},children:[Object(oa.jsx)(ei.a.Item,{label:"Location Name",required:!0,children:Object(oa.jsx)(Wn.a,{value:A.name,onChange:function(e){return M(Object(d.a)(Object(d.a)({},A),{},{name:e.target.value}))},placeholder:"Enter location name"})}),Object(oa.jsx)(ei.a.Item,{label:"Address",className:"mt-3",children:Object(oa.jsx)(ai,{placeholder:"Enter address",onChange:function(e){M(Object(d.a)(Object(d.a)({},A),{},{address:e}))}})}),Object(oa.jsx)(ei.a.Item,{label:"Geofence Radius (km)",className:"mt-3",children:Object(oa.jsx)(Wn.a,{min:0,value:A.geofenceRadius,onChange:function(e){return M(Object(d.a)(Object(d.a)({},A),{},{geofenceRadius:e.target.value}))},placeholder:"Enter radius",style:{width:"100%"}})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:I,type:"primary",htmlType:"submit",onClick:function(){return f("")},children:"Save"})})})})]})})]})};return Object(oa.jsx)($n.a,{title:"Edit (".concat((null===i||void 0===i?void 0:i.name)||"pricing",")"),visible:r,onCancel:function(){v(!1),t&&t(),localStorage.setItem("selectedTab","1")},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:j,onFinish:R,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsx)(ei.a.Item,{name:"pricingRates",children:Object(oa.jsx)(D,{onChange:function(e){}})})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:I,type:"primary",htmlType:"submit",onClick:function(){return f("")},children:"Save"})})})})]})})};Dc.d.register(Dc.a,Dc.j,Dc.e);var Ts=function(e){var t=e.socket,n=(e.params,e.componentUuid,Object(s.c)(function(e){return e.auth})),c=n.selectedPage,o=(n.encrypted_token,n.projects),l=n.adminUserRoles,r=(Object(s.b)(),Object(a.useState)([])),v=Object(u.a)(r,2),b=v[0],j=v[1],p=Object(a.useState)([]),O=Object(u.a)(p,2),f=O[0],h=O[1];Object(a.useState)(!1);var g=Object(a.useState)(!1),I=Object(u.a)(g,2),S=I[0],N=I[1];Object(a.useState)(!1);var k=Mn().getUserRequestPayload,T=Object(a.useRef)(),C=Object(a.useState)(void 0),w=Object(u.a)(C,2),E=w[0],R=w[1],P=Object(a.useRef)(!0),D=Mn().updateUserRequestPayloadV2,A=Object(a.useState)(!1),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(""),F=Object(u.a)(q,2),B=F[0],_=F[1],$=Object(a.useState)(""),Y=Object(u.a)($,2),H=(Y[0],Y[1]),V=Object(a.useState)(!1),z=Object(u.a)(V,2),Q=z[0],G=z[1],J=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return G(!0),e.n=1,K({name:B});case 1:_(""),U(!1),G(!1),X();case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),K=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,a){n.vehicle,n.preferences;var i=[];0===(null===b||void 0===b?void 0:b.length)&&i.push({op:"add",path:"/persistent/static/admin/pricingManagement",value:{items:{}}});var c=W();i.push({op:"add",path:"/persistent/static/admin/pricingManagement/items/".concat(c),value:Object(d.a)(Object(d.a)({_id:c},n),{},{locations:[],rates:[]})}),console.log("update user data",i),t.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,D(null===o||void 0===o?void 0:o.adminUserId,i),x.UpdateUserBio,null===o||void 0===o?void 0:o.userServiceId),t.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){console.log("update response",t),e(t)})}))},e)}));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,a){var i=[];i.push({op:"remove",path:"/persistent/static/admin/pricingManagement/items/".concat(n)}),t.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,D(null===o||void 0===o?void 0:o.adminUserId,i),x.UpdateUserBio,null===o||void 0===o?void 0:o.userServiceId),t.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){console.log("delete response",t),e(t)})}))},e)}));return function(t){return e.apply(this,arguments)}}(),X=function(){t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,k(null===o||void 0===o?void 0:o.adminUserId,"$","$.persistent.static.admin.pricingManagement.items"),x.GetUserBio,null===o||void 0===o?void 0:o.userServiceId),N(!0),t.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,n,a,i,c;console.log("pricing management",null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]);var o=[];null===Object||void 0===Object||null===(a=Object.values((null===e||void 0===e||null===(i=e.data)||void 0===i||null===(c=i[0])||void 0===c?void 0:c[0])||{}))||void 0===a||a.map(function(e,t){o.push({key:e._id,name:null===e||void 0===e?void 0:e.name,action:{userId:null===e||void 0===e?void 0:e.id,user:e}})}),N(!1),T.current=o,j(o)}),h([{title:"Name",key:"name",dataIndex:"name"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),R(e.user)},children:Object(oa.jsx)(wo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Co.a,{title:"Are you sure to delete this pricing?",onConfirm:Object(_n.a)(Object(Bn.a)().m(function t(){return Object(Bn.a)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Z(e.user._id);case 1:X();case 2:return t.a(2)}},t)})),children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})})})]})}}])};Object(a.useEffect)(function(){return P.current=!0,function(){P.current=!1}},[]),Object(a.useEffect)(function(){null!==o&&void 0!==o&&o.adminUserId&&X()},[o]);var ee=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],te=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Pricing"}),Object(oa.jsx)("p",{children:"Home > Pricing"})]}),Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn green-btn cover",onClick:function(){U(!0)},children:"Add"})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:S?te:b,columns:S?ee:f,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===c||void 0===c||null===(n=c.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==E&&Object(oa.jsx)(ks,{socket:t,student:E,onClose:function(){R(void 0)},adminRoles:l,onAdd:function(e){var t=e.locations,n=e.rates;R(Object(d.a)(Object(d.a)({},E),{},{locations:t,rates:n})),X()}}),Object(oa.jsx)($n.a,{title:"Add New Pricing",visible:L,onCancel:function(){return U(!1)},okButtonProps:{disabled:!B.trim()},className:"beam-modal",footer:[],children:Object(oa.jsxs)(ei.a,{layout:"vertical",className:"auth-form",onFinish:J,children:[Object(oa.jsx)(ei.a.Item,{label:"Name",required:!0,children:Object(oa.jsx)(Wn.a,{value:B,onChange:function(e){return _(e.target.value)},placeholder:"Enter name"})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:Q,type:"primary",htmlType:"submit",onClick:function(){return H("")},children:"Save"})})})})]})})]})},Cs=(Za.a.Panel,xs.a.Text,function(e){var t=e.onClose,n=e.socket,i=e.student,c=(e.adminRoles,e.onAdd),o=Object(a.useState)(!0),l=Object(u.a)(o,2),r=l[0],v=l[1],b=ei.a.useForm(),j=Object(u.a)(b,1)[0],p=Object(a.useState)(""),O=Object(u.a)(p,2),f=(O[0],O[1]),h=Object(a.useState)(!1),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(s.c)(function(e){return e.auth}),S=(I.projects,I.encrypted_token),N=(Mn().updateUserRequestPayloadV2,Object(a.useState)("1")),k=Object(u.a)(N,2);k[0],k[1];Object(a.useEffect)(function(){n.subscribeToEvent(m.SubscribePageTopics,dn(null===S||void 0===S?void 0:S.connectionId),function(e){console.log("response",e),Lt("Location saved successfully","success","TOP_CENTER",1e3),y(!1),c(!0)},"editLocation"),null!==i&&void 0!==i&&i.info&&j.setFieldsValue(Object(d.a)({},null===i||void 0===i?void 0:i.info))},[]);var T=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var a,c,o;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:console.log("values",t),y(!0),o={name:t.name,fullName:null===(a=t.name)||void 0===a?void 0:a.toLowerCase(),location:t.location,address:t.location.label},console.log("student",i),n.publishToEvent(m.PublishPageTopics,un(null===S||void 0===S?void 0:S.connectionId),Dn({objectId:null===i||void 0===i||null===(c=i.objectId)||void 0===c?void 0:c.toString(),changes:[{op:"replace",path:"/info",value:o}]}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return Object(oa.jsx)($n.a,{title:"Edit location",visible:r,onCancel:function(){v(!1),t&&t(),localStorage.setItem("selectedTab","1")},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:j,onFinish:T,requiredMark:!1,children:[Object(oa.jsxs)("div",{className:"main-cards mt-3",children:[Object(oa.jsx)(ei.a.Item,{label:"Name",required:!0,name:"name",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter name"})}),Object(oa.jsx)(ei.a.Item,{label:"location",required:!0,name:"location",children:Object(oa.jsx)(ai,{onChange:function(e){console.log("location",e)}})})]}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:x,type:"primary",htmlType:"submit",onClick:function(){return f("")},children:"Save"})})})})]})})});Dc.d.register(Dc.a,Dc.j,Dc.e),tc.a.extend(ss.a);var ws=function(e){var t=e.socket,n=(e.params,e.componentUuid,e.userId),c=Object(s.c)(function(e){return e.auth}),o=c.selectedPage,l=c.encrypted_token,r=c.projects,v=c.adminUserRoles,b=Object(s.b)(),j=Object(a.useState)([]),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)([]),g=Object(u.a)(h,2),x=g[0],y=g[1];Object(a.useState)(!1);var I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1];Object(a.useState)(!1);Mn().getUserRequestPayload,Object(a.useRef)();var T=Object(a.useState)(void 0),C=Object(u.a)(T,2),w=C[0],E=C[1],R=Object(a.useRef)(!0),P=(Mn().updateUserRequestPayloadV2,Object(a.useState)(void 0)),D=Object(u.a)(P,2),A=D[0],M=D[1],L=Object(a.useState)(""),U=Object(u.a)(L,2),q=U[0],F=(U[1],Object(a.useState)("")),B=Object(u.a)(F,2),_=(B[0],B[1]),$=Object(a.useState)(!1),Y=Object(u.a)($,2),H=Y[0],W=Y[1],V=Object(a.useState)([]),Q=Object(u.a)(V,2),G=(Q[0],Q[1]),J=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){var a,i,c;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:console.log("values",n),i={name:n.name,fullName:null===(a=n.name)||void 0===a?void 0:a.toLowerCase(),location:n.location,address:n.location.label},W(!0),c=[{op:"add",path:"/partitions",value:["org:".concat((null===l||void 0===l?void 0:l.cudbServiceId)||(null===l||void 0===l?void 0:l.serviceId)),"type:location"]},{op:"add",path:"/createdAt",value:(new Date).getTime()},{op:"add",path:"/info",value:i}],console.log("custom changes",c),t.publishToEvent(m.PublishPageTopics,rn(null===l||void 0===l?void 0:l.connectionId),Dn({changes:c}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:t.publishToEvent(m.PublishPageTopics,un(null===l||void 0===l?void 0:l.connectionId),Dn({objectId:n,changes:[{op:"replace",path:"/objectStatus",value:"deleted"}]}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}@partitions:{type\\:location}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status"}},filter:{expression:""}};e||k(!0),b(tt({requestData:t,callback:function(e){console.log("response here",e),f(null===e||void 0===e?void 0:e.map(function(e){return Object(d.a)(Object(d.a)({key:null===e||void 0===e?void 0:e.objectId},null===e||void 0===e?void 0:e.info),{},{action:e})})),y([{title:"Name",key:"name",dataIndex:"name",sorter:function(e,t){var n;return null===(n=e.name)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.name)}},{title:"Address",key:"address",dataIndex:"address"},n?{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsx)(Yn.a,{style:{width:135},children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),E(e)},children:Object(oa.jsx)(wc.a,{})})})})}}:{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),E(e)},children:Object(oa.jsx)(wo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Co.a,{title:"Are you sure to delete this location?",onConfirm:Object(_n.a)(Object(Bn.a)().m(function t(){return Object(Bn.a)().w(function(t){for(;;)switch(t.n){case 0:K(e.objectId);case 1:return t.a(2)}},t)})),children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})})})]})}}]),k(!1)}}))};Object(a.useEffect)(function(){return R.current=!0,function(){R.current=!1}},[]),Object(a.useEffect)(function(){null!==r&&void 0!==r&&r.adminUserId&&(!function(e,t){var a,i="@serviceId:{'".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}");switch(t){case ac.Dispatcher:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Live:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Live)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Responder:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Manager:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)})}console.log("selected user roles",a);var c=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),o={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:i,searchOptions:"TIMEOUT 5000"},list:{objectIds:n?[n.toString()]:void 0},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(c.join("||"),")")},anyStatus:!1};k(!0),b(tt({requestData:o,callback:function(e){k(!1);var t=[];null===e||void 0===e||e.map(function(e,n){var a,i,c,o;t.push({driverId:e.id,driverName:"".concat(null===e||void 0===e||null===(a=e.live)||void 0===a||null===(i=a.profile)||void 0===i?void 0:i.firstName," ").concat(null===e||void 0===e||null===(c=e.live)||void 0===c||null===(o=c.profile)||void 0===o?void 0:o.lastName)})}),G(t),Z()}}))}(v,ac.Responder),t.subscribeToEvent(m.SubscribePageTopics,sn(null===l||void 0===l?void 0:l.connectionId),function(e){var t,n;console.log("response",null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.id),M(void 0),W(!1)}),t.subscribeToEvent(m.SubscribePageTopics,dn(null===l||void 0===l?void 0:l.connectionId),function(e){console.log("response",e)}))},[r]);var X=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],ee=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[!n&&Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Location"}),Object(oa.jsx)("p",{children:"Home > Location"})]}),Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn green-btn cover",onClick:function(){M({type:"new"})},children:"Add"})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:N?ee:O,columns:N?X:x,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==w&&Object(oa.jsx)(Cs,{socket:t,student:w,onClose:function(){E(void 0)},adminRoles:v,onAdd:function(e){E(void 0)}}),Object(oa.jsx)($n.a,{title:"new"===(null===A||void 0===A?void 0:A.type)?"Add New Location":"Copy Location",visible:void 0!=A,onCancel:function(){return M(void 0)},okButtonProps:{disabled:!q.trim()},className:"beam-modal",footer:[],children:Object(oa.jsxs)(ei.a,{layout:"vertical",className:"auth-form",onFinish:J,children:[Object(oa.jsx)(ei.a.Item,{label:"Name",required:!0,name:"name",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter name"})}),Object(oa.jsx)(ei.a.Item,{label:"location",required:!0,name:"location",children:Object(oa.jsx)(ai,{onChange:function(e){console.log("location",e)}})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:H,type:"primary",htmlType:"submit",onClick:function(){return _("")},children:"Save"})})})})]})})]})},Es=(Za.a.Panel,xs.a.Text,Kl.a.TabPane,function(e){var t=e.onClose,n=e.socket,i=e.student,c=(e.adminRoles,e.onAdd),o=Object(a.useState)(!0),l=Object(u.a)(o,2),r=l[0],v=l[1],b=ei.a.useForm(),j=Object(u.a)(b,1)[0],p=Object(a.useState)(""),O=Object(u.a)(p,2),f=(O[0],O[1]),h=Object(a.useState)(!1),g=Object(u.a)(h,2),I=g[0],S=g[1],N=Object(s.c)(function(e){return e.auth}).projects,k=Mn().updateUserRequestPayloadV2,T=Object(a.useState)("1"),w=Object(u.a)(T,2),E=(w[0],w[1],function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log(t),S(!0),e.n=1,R(null===t||void 0===t?void 0:t.equipments);case 1:S(!1),Lt("Equipment updated successfully","success","TOP_CENTER",3e3);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),R=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,a){var o=[];o.push({op:"add",path:"/persistent/static/admin/equipmentManagement/items/".concat(i._id,"/equipments"),value:t}),console.log("update user data",o),n.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,k(null===N||void 0===N?void 0:N.adminUserId,o),x.UpdateUserBio,null===N||void 0===N?void 0:N.userServiceId),n.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(n){console.log("update response",n),e(n),c&&c(t)})}))},e)}));return function(t){return e.apply(this,arguments)}}(),P=function(e){var t=e.onChange,n=Object(a.useState)((null===i||void 0===i?void 0:i.equipments)||[]),c=Object(u.a)(n,2),o=c[0],l=c[1],s=Object(a.useState)(!1),r=Object(u.a)(s,2),v=(r[0],r[1],Object(a.useState)(!1)),b=Object(u.a)(v,2),j=b[0],m=b[1],p=Object(a.useState)({key:"",name:"",description:"",maxWeight:0}),O=Object(u.a)(p,2),h=O[0],g=O[1];Object(a.useEffect)(function(){o&&t(o)},[o]);var x=[{title:"Name",dataIndex:"name",key:"name"},{title:"Description",dataIndex:"description",key:"description",render:function(e,t){return Object(oa.jsx)(Wn.a,{value:t.description,onChange:function(e){return l(o.map(function(n){return n.key===t.key?Object(d.a)(Object(d.a)({},n),{},{description:e.target.value}):n}))}})}},{title:"Max weight (lb)",dataIndex:"maxWeight",key:"maxWeight",render:function(e,t){return Object(oa.jsx)(Wn.a,{min:0,value:t.maxWeight,onChange:function(e){return l(o.map(function(n){return n.key===t.key?Object(d.a)(Object(d.a)({},n),{},{maxWeight:e.target.value||0}):n}))}})}},{title:"Action",key:"action",render:function(e,t){return Object(oa.jsx)(Co.a,{title:"Are you sure to delete this equipment?",onConfirm:function(){return function(e){var t=o.filter(function(t){return t.name!==e});l(t),R(t)}(t.name)},children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})})}}];return Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Yn.a,{className:"mb-3",children:Object(oa.jsx)(Hn.a,{span:24,className:"d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn yellow-btn bordered",onClick:function(){return m(!0)},children:"Add"})})}),Object(oa.jsx)(Xi.a,{dataSource:o,columns:x,pagination:!1,bordered:!0}),Object(oa.jsx)($n.a,{title:"Add New Equipment",visible:j,onCancel:function(){return m(!1)},className:"beam-modal",footer:[],children:Object(oa.jsxs)(ei.a,{layout:"vertical",className:"auth-form",onFinish:function(){if(h.name.trim()&&!o.some(function(e){return e.name===h.name})){var e=Object(d.a)(Object(d.a)({},h),{},{key:"".concat(o.length+1)}),t=[].concat(Object(C.a)(o),[e]);l(t),g({key:"",name:"",description:"",maxWeight:0}),console.log("temp equipments",t),R(t)}m(!1)},children:[Object(oa.jsx)(ei.a.Item,{label:"Equipment Name",required:!0,children:Object(oa.jsx)(Wn.a,{value:h.name,onChange:function(e){return g(Object(d.a)(Object(d.a)({},h),{},{name:e.target.value}))},placeholder:"Enter equipment name"})}),Object(oa.jsx)(ei.a.Item,{label:"Description",className:"mt-3",children:Object(oa.jsx)(Wn.a,{value:h.description,onChange:function(e){return g(Object(d.a)(Object(d.a)({},h),{},{description:e.target.value}))},placeholder:"Enter description"})}),Object(oa.jsx)(ei.a.Item,{label:"Max weight (lb)",className:"mt-3",children:Object(oa.jsx)(Wn.a,{value:h.maxWeight,onChange:function(e){return g(Object(d.a)(Object(d.a)({},h),{},{maxWeight:e.target.value}))},placeholder:"Enter max weight"})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:I,type:"primary",htmlType:"submit",onClick:function(){return f("")},children:"Save"})})})})]})})]})};return Object(oa.jsx)($n.a,{title:"Edit (".concat((null===i||void 0===i?void 0:i.name)||"pricing",")"),visible:r,onCancel:function(){v(!1),t&&t()},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:j,onFinish:E,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsx)(ei.a.Item,{name:"equipments",children:Object(oa.jsx)(P,{onChange:function(e){}})})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:I,type:"primary",htmlType:"submit",onClick:function(){return f("")},children:"Save"})})})})]})})});Dc.d.register(Dc.a,Dc.j,Dc.e);var Rs=function(e){var t=e.socket,n=(e.params,e.componentUuid,Object(s.c)(function(e){return e.auth})),c=n.selectedPage,o=(n.encrypted_token,n.projects),l=n.adminUserRoles,r=(Object(s.b)(),Object(a.useState)([])),v=Object(u.a)(r,2),b=v[0],j=v[1],p=Object(a.useState)([]),O=Object(u.a)(p,2),f=O[0],h=O[1];Object(a.useState)(!1);var g=Object(a.useState)(!1),I=Object(u.a)(g,2),S=I[0],N=I[1];Object(a.useState)(!1);var k=Mn().getUserRequestPayload,T=Object(a.useRef)(),C=Object(a.useState)(void 0),w=Object(u.a)(C,2),E=w[0],R=w[1],P=Object(a.useRef)(!0),D=Mn().updateUserRequestPayloadV2,A=Object(a.useState)(!1),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(""),F=Object(u.a)(q,2),B=F[0],_=F[1],$=Object(a.useState)(""),Y=Object(u.a)($,2),H=(Y[0],Y[1]),V=Object(a.useState)(!1),z=Object(u.a)(V,2),Q=z[0],G=z[1],J=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return G(!0),e.n=1,K({name:B});case 1:_(""),U(!1),G(!1),X();case 2:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),K=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,a){n.vehicle,n.preferences;var i=[];0===(null===b||void 0===b?void 0:b.length)&&i.push({op:"add",path:"/persistent/static/admin/equipmentManagement",value:{items:{}}});var c=W();i.push({op:"add",path:"/persistent/static/admin/equipmentManagement/items/".concat(c),value:Object(d.a)(Object(d.a)({_id:c},n),{},{equipments:[]})}),console.log("update user data",i),t.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,D(null===o||void 0===o?void 0:o.adminUserId,i),x.UpdateUserBio,null===o||void 0===o?void 0:o.userServiceId),t.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){console.log("update response",t),e(t)})}))},e)}));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,a){var i=[];i.push({op:"remove",path:"/persistent/static/admin/equipmentManagement/items/".concat(n)}),t.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,D(null===o||void 0===o?void 0:o.adminUserId,i),x.UpdateUserBio,null===o||void 0===o?void 0:o.userServiceId),t.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){console.log("delete response",t),e(t)})}))},e)}));return function(t){return e.apply(this,arguments)}}(),X=function(){t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,k(null===o||void 0===o?void 0:o.adminUserId,"$","$.persistent.static.admin.equipmentManagement.items"),x.GetUserBio,null===o||void 0===o?void 0:o.userServiceId),N(!0),t.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,n,a,i,c;console.log("equipment management",null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]);var o=[];null===Object||void 0===Object||null===(a=Object.values((null===e||void 0===e||null===(i=e.data)||void 0===i||null===(c=i[0])||void 0===c?void 0:c[0])||{}))||void 0===a||a.map(function(e,t){o.push({key:e._id,name:null===e||void 0===e?void 0:e.name,action:{userId:null===e||void 0===e?void 0:e.id,user:e}})}),N(!1),T.current=o,j(o)}),h([{title:"Name",key:"name",dataIndex:"name"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),R(e.user)},children:Object(oa.jsx)(wo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Co.a,{title:"Are you sure to delete this equipment type?",onConfirm:Object(_n.a)(Object(Bn.a)().m(function t(){return Object(Bn.a)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,Z(e.user._id);case 1:X();case 2:return t.a(2)}},t)})),children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",children:Object(oa.jsx)(na.a,{})})})})]})}}])};Object(a.useEffect)(function(){return P.current=!0,function(){P.current=!1}},[]),Object(a.useEffect)(function(){null!==o&&void 0!==o&&o.adminUserId&&X()},[o]);var ee=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],te=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Equipment"}),Object(oa.jsx)("p",{children:"Home > Equipment"})]}),Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn green-btn cover",onClick:function(){U(!0)},children:"Add"})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:S?te:b,columns:S?ee:f,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===c||void 0===c||null===(n=c.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==E&&Object(oa.jsx)(Es,{socket:t,student:E,onClose:function(){R(void 0)},adminRoles:l,onAdd:function(e){R(Object(d.a)(Object(d.a)({},E),{},{equipments:e})),X()}}),Object(oa.jsx)($n.a,{title:"Add New Type",visible:L,onCancel:function(){return U(!1)},okButtonProps:{disabled:!B.trim()},className:"beam-modal",footer:[],children:Object(oa.jsxs)(ei.a,{layout:"vertical",className:"auth-form",onFinish:J,children:[Object(oa.jsx)(ei.a.Item,{label:"Name",required:!0,children:Object(oa.jsx)(Wn.a,{value:B,onChange:function(e){return _(e.target.value)},placeholder:"Enter name"})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:Q,type:"primary",htmlType:"submit",onClick:function(){return H("")},children:"Save"})})})})]})})]})},Ps=n(379),Ds=(Za.a.Panel,Kl.a.TabPane,function(e){var t,n=e.onClose,c=(e.socket,e.student),o=e.adminRoles,l=e.onAdd,r=Object(a.useState)(!0),v=Object(u.a)(r,2),b=v[0],j=v[1],m=ei.a.useForm(),p=Object(u.a)(m,1)[0],O=Object(a.useState)(""),f=Object(u.a)(O,2),h=(f[0],f[1]),g=Object(a.useState)(!1),x=Object(u.a)(g,2),y=x[0],I=x[1],S=Object(s.c)(function(e){return e.auth}).projects,N=(Mn().updateUserRequestPayloadV2,Object(s.b)());Object(a.useEffect)(function(){var e,t,n,a,i,o;null!==c&&void 0!==c&&c.scheduleId&&p.setFieldsValue(Object(d.a)(Object(d.a)({},null===c||void 0===c?void 0:c.data),{},{drivers:null!==c&&void 0!==c&&null!==(e=c.data)&&void 0!==e&&e.drivers?{type:"responder",responders:null===(t=Object.values((null===c||void 0===c||null===(n=c.data)||void 0===n?void 0:n.drivers)||{}))||void 0===t?void 0:t.map(function(e){return{id:null===e||void 0===e?void 0:e.userId,beamId:null===e||void 0===e?void 0:e.beamId}}),values:null===(a=Object.values((null===c||void 0===c||null===(i=c.data)||void 0===i?void 0:i.drivers)||{}))||void 0===a?void 0:a.map(function(e){return null===e||void 0===e?void 0:e.userId})}:void 0,time:null===c||void 0===c||null===(o=c.data)||void 0===o?void 0:o.scheduleTime}))},[]);var k=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,o,s,r,u,v,b,j,m,p,O,f,h,g,x,y,N,k,w;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("values",t),i=t.name,o=t.daysOfTheWeek,s=t.notificationType,r=t.time,u=t.drivers,v={name:i,daysOfTheWeek:o,scheduleTime:r,notificationType:s,drivers:null===u||void 0===u||null===(n=u.responders)||void 0===n||null===(a=n.map(function(e){return{userId:null===e||void 0===e?void 0:e.id,beamId:null===e||void 0===e?void 0:e.beamId}}))||void 0===a?void 0:a.reduce(function(e,t,n){return e[t.userId]=Object(d.a)({},t),e},{}),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,cudbServiceId:null===S||void 0===S?void 0:S.userServiceId},b=Ps.tz(r,"MM/DD/YYYY HH:mm",Intl.DateTimeFormat().resolvedOptions().timeZone),j=b.utc().format("MM/DD/YYYY HH:mm"),m=new Date(j),p="".concat(m.getMinutes()," ").concat(m.getHours()," * 0-11 *"),null!==c&&void 0!==c&&c.scheduleId){e.n=3;break}return h={cron:p,topic:"".concat("beamdevlive","/service/scheduler-service/service/dps/sendReminderNotification"),data:v,info:{},to:0x10000000000000000},console.log("request",h),I(!0),e.n=1,T(h);case 1:return g=e.v,x=null===g||void 0===g||null===(O=g.data)||void 0===O||null===(f=O.id)||void 0===f?void 0:f.toString(),y={objectId:x,changes:[{op:"replace",path:"/partitions",value:["org:".concat(null===S||void 0===S?void 0:S.userServiceId),"type:notification"]}]},e.n=2,C(y);case 2:Lt("Schedule created successfully","success","TOP_CENTER",3e3),e.n=5;break;case 3:return I(!0),k=null===c||void 0===c||null===(N=c.scheduleId)||void 0===N?void 0:N.toString(),w={objectId:k,changes:[{op:"replace",path:"/cron",value:p},{op:"replace",path:"/data",value:v}]},e.n=4,C(w);case 4:Lt("Schedule updated successfully","success","TOP_CENTER",3e3);case 5:I(!1),l();case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){N(bt({request:t,callback:function(t){console.log("create response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){N(mt({request:t,callback:function(t){console.log("create response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),w=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],E=function(e){e.value,e.onChange;var t=function(e){var t=e.value,n=e.onChange;return Object(oa.jsx)(gi,{placeholder:"Select Time",value:t?Ps(t).format("HH:mm"):void 0,onChange:n})};return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{label:"Notification Schedule Name",name:"name",rules:[{required:!0,message:"Please input the schedule name"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter name"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Notification Type",name:"notificationType",rules:[{required:!0,message:"Please select notification type"}],children:Object(oa.jsxs)(yi.a.Group,{children:[Object(oa.jsx)(yi.a,{value:"push",children:"Push"}),Object(oa.jsx)(yi.a,{value:"email",children:"Email"}),Object(oa.jsx)(yi.a,{value:"sms",children:"SMS"})]})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Schedule Days",name:"daysOfTheWeek",rules:[{required:!0,message:"Days selection is required"}],children:Object(oa.jsx)(Gn.a,{placeholder:"Select Days",mode:"multiple",style:{width:"100%"},children:w.map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Schedule Time",name:"time",rules:[{required:!0,message:"Time is required"}],children:Object(oa.jsx)(t,{onChange:function(e){}})})]})};return Object(oa.jsx)($n.a,{title:null!==c&&void 0!==c&&c.scheduleId?"Edit (".concat(null===c||void 0===c||null===(t=c.data)||void 0===t?void 0:t.name,")"):"Add notification schedule",visible:b,onCancel:function(){j(!1),n&&n()},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:p,onFinish:k,requiredMark:!1,children:[Object(oa.jsxs)("div",{className:"main-cards mt-3",children:[Object(oa.jsx)(ei.a.Item,{name:"schedule",children:Object(oa.jsx)(E,{})}),Object(oa.jsx)(ei.a.Item,{name:"drivers",label:"Driver",className:"mt-3",children:Object(oa.jsx)(fi,{multiple:!0,placeholder:"Select drivers",adminRoles:o})})]}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:y,type:"primary",htmlType:"submit",onClick:function(){return h("")},children:"Save"})})})})]})})});Dc.d.register(Dc.a,Dc.j,Dc.e);Kl.a.TabPane;var As=function(e){var t,n=e.socket,c=(e.params,e.componentUuid,Object(s.c)(function(e){return e.auth})),o=c.selectedPage,l=(c.encrypted_token,c.projects),r=c.adminUserRoles,d=Object(s.b)(),v=Object(a.useState)([]),b=Object(u.a)(v,2),j=b[0],m=b[1],p=Object(a.useState)([]),O=Object(u.a)(p,2),f=O[0],h=O[1];Object(a.useState)(!1);var g=Object(a.useState)(!1),x=Object(u.a)(g,2),y=x[0],I=x[1];Object(a.useState)(!1);Mn().getUserRequestPayload;var S=Object(a.useRef)(),N=Object(a.useState)(void 0),k=Object(u.a)(N,2),T=k[0],C=k[1],w=Object(a.useState)(void 0),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useRef)(!0),A=function(){var e="@partitions:{'org\\:".concat(z(null===l||void 0===l?void 0:l.userServiceId),"}@partitions:{type\\:notification}"),t={select:{index:{searchIndex:"".concat("beamdevlive",":schedule:status"),searchQuery:e,searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",data:"$.data"}},apply:{expression:"",name:""},result:{},filter:{expression:""},anyStatus:!1};I(!0),d(tt({requestData:t,callback:function(e){I(!1),console.log("respons ehere",e);var t=[],n=[{title:"Schedule name",key:"name",dataIndex:"name"},{title:"Notification type",key:"notificationType",dataIndex:"notificationType"},{title:"Days",key:"days",dataIndex:"days"},{title:"Time",key:"time",dataIndex:"time"},{title:"Drivers",key:"drivers",dataIndex:"drivers"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),C(e)},children:Object(oa.jsx)(wo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",onClick:function(){console.log("action",e),P(e)},children:Object(oa.jsx)(na.a,{})})})]})}}];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l,s,r,d,u;t.push({key:e.id,name:null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.name,notificationType:null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.notificationType,days:null===e||void 0===e||null===(c=e.data)||void 0===c||null===(o=c.daysOfTheWeek)||void 0===o?void 0:o.toString(),time:null===(l=H()(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.scheduleTime))||void 0===l?void 0:l.format("HH:mm"),drivers:null===(r=Object.values(null===e||void 0===e||null===(u=e.data)||void 0===u?void 0:u.drivers))||void 0===r||null===(d=r.map(function(e){return e.beamId}))||void 0===d?void 0:d.toString(),action:{scheduleId:null===e||void 0===e?void 0:e.id,data:null===e||void 0===e?void 0:e.data}})}),S.current=t,h(n),m(t)}}))};Object(a.useEffect)(function(){return D.current=!0,function(){D.current=!1}},[]),Object(a.useEffect)(function(){null!==l&&void 0!==l&&l.adminUserId&&A()},[l]);Zn.a.RangePicker;var M=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){d(jt({request:t,callback:function(t){console.log("delete response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),L=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],U=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid",marginRight:-20},children:Object(oa.jsxs)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:[Object(oa.jsx)(Yn.a,{className:"mb-3",children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Notification"}),Object(oa.jsx)("p",{children:"Home > Notification"})]}),Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn green-btn cover",onClick:function(){C({})},children:"Add"})]})}),Object(oa.jsx)(Xi.a,{dataSource:y?U:j,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},columns:y?L:f,scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})]})}),void 0!==T&&Object(oa.jsx)(Ds,{socket:n,student:T,onClose:function(){C(void 0)},adminRoles:r,onAdd:function(){A()}}),R&&Object(oa.jsx)(Fo,{onClose:function(){P(void 0)},handleConfirm:Object(_n.a)(Object(Bn.a)().m(function e(){var t;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("delete here",R),e.n=1,M({objectId:null===R||void 0===R||null===(t=R.scheduleId)||void 0===t?void 0:t.toString()});case 1:P(void 0),Lt("Schedule deleted successfully","success","TOP_CENTER",3e3),A();case 2:return e.a(2)}},e)})),message:"Are you sure you want to delete schedule (".concat(null===R||void 0===R||null===(t=R.data)||void 0===t?void 0:t.name,")?")})]})},Ms=n(1029),Ls=n(325),Us=n(379),qs=(xs.a.Title,Gn.a.Option),Fs=(Za.a.Panel,function(e){var t=e.label,n=void 0===t?"Custom Dates":t,a=e.value,i=e.onChange;return Object(oa.jsxs)("div",{children:[Object(oa.jsx)("label",{className:"ant-form-item-required",children:n}),Object(oa.jsx)(Jn.a,{onChange:function(e){e&&(a.some(function(t){return t.isSame(e,"day")})||i([].concat(Object(C.a)(a),[e])))},disabledDate:function(e){return null===a||void 0===a?void 0:a.some(function(t){return null===t||void 0===t?void 0:t.isSame(e,"day")})},placeholder:"Select date"}),Object(oa.jsx)("div",{style:{marginTop:"16px"},className:"custom-tag",children:null===a||void 0===a?void 0:a.map(function(e){return Object(oa.jsx)(Kn.a,{className:"tag-item",closable:!0,onClose:function(){return function(e){var t=a.filter(function(t){return!t.isSame(e,"day")});i(t)}(e)},closeIcon:Object(oa.jsx)(Ls.a,{}),children:e.format("YYYY-MM-DD")},e.toISOString())})})]})}),Bs=(Kl.a.TabPane,[{label:"Sunday",value:0},{label:"Monday",value:1},{label:"Tuesday",value:2},{label:"Wednesday",value:3},{label:"Thursday",value:4},{label:"Friday",value:5},{label:"Saturday",value:6}]),_s=function(e){var t=Object(a.useState)({mode:"custom",customDates:[],repeatType:"daily",repeatDays:[],everyX:1,monthRepeatDates:[],endUntil:null}),n=Object(u.a)(t,2),i=n[0],c=n[1],o=function(t){var n,a=Object(d.a)(Object(d.a)({},i),t);null===e||void 0===e||null===(n=e.onChange)||void 0===n||n.call(e,a)};return Object(a.useEffect)(function(){e.value&&c(e.value)},[e.value]),Object(oa.jsxs)("div",{children:[Object(oa.jsx)("label",{className:"ant-form-item-required",children:"Schedule type"}),Object(oa.jsx)("div",{children:Object(oa.jsxs)(yi.a.Group,{value:i.mode,onChange:function(e){return o({mode:e.target.value})},children:[Object(oa.jsx)(yi.a,{value:"repeat",children:"Repeat Schedule"}),Object(oa.jsx)(yi.a,{value:"custom",children:"Custom Dates (Override)"})]})}),Object(oa.jsx)(Ms.a,{}),"custom"===i.mode&&Object(oa.jsx)(Fs,{value:i.customDates,onChange:function(e){return o({customDates:e})}}),"repeat"===i.mode&&Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("label",{className:"ant-form-item-required",children:"Repeat type"}),Object(oa.jsxs)(Gn.a,{value:i.repeatType,onChange:function(e){return o({repeatType:e})},children:[Object(oa.jsx)(qs,{value:"daily",children:"Daily"}),Object(oa.jsx)(qs,{value:"weekly",children:"Weekly"}),Object(oa.jsx)(qs,{value:"monthly",children:"Monthly"})]})]}),"daily"===i.repeatType&&Object(oa.jsxs)("div",{style:{marginTop:24},children:[Object(oa.jsx)("label",{className:"ant-form-item-required",children:"Repeat Every X Day"}),Object(oa.jsx)(Qo.a,{min:1,value:i.everyX,onChange:function(e){return o({everyX:null!==e&&void 0!==e?e:1})},className:"ant-input recurring-day-input"})]}),"weekly"===i.repeatType&&Object(oa.jsxs)("div",{style:{marginTop:24},children:[Object(oa.jsx)("label",{className:"ant-form-item-required",children:"Repeat Days of the Week"}),Object(oa.jsx)(Xn.a.Group,{options:Bs,value:i.repeatDays,onChange:function(e){return o({repeatDays:e})}})]}),"monthly"===i.repeatType&&Object(oa.jsxs)("div",{style:{marginTop:24},children:[Object(oa.jsx)("label",{className:"ant-form-item-required",children:"Repeat Dates in a Month"}),Object(oa.jsx)(Gn.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select days of the month",value:i.monthRepeatDates,onChange:function(e){return o({monthRepeatDates:e})},children:Array.from({length:31},function(e,t){return Object(oa.jsx)(qs,{value:t+1,children:t+1},t+1)})})]}),Object(oa.jsxs)("div",{style:{marginTop:24},children:[Object(oa.jsx)("label",{className:"ant-form-item-required",children:"End Until Date"}),Object(oa.jsx)(Jn.a,{value:i.endUntil,onChange:function(e){return o({endUntil:e})}})]})]}),Object(oa.jsx)(Ms.a,{})]})},$s=function(e){var t=e.onClose,n=e.socket,i=e.student,c=(e.adminRoles,e.onAdd),o=Object(a.useState)(!0),l=Object(u.a)(o,2),r=l[0],v=l[1],b=ei.a.useForm(),j=Object(u.a)(b,1)[0],m=Object(a.useState)(""),p=Object(u.a)(m,2),O=(p[0],p[1]),f=Object(a.useState)(!1),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)(!1),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)(!1),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(s.c)(function(e){return e.auth}),R=E.projects,P=E.encrypted_token,D=E.accounts,A=(Mn().updateUserRequestPayloadV2,Object(s.b)()),M=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("handle cancel  ",e),null!==i&&void 0!==i&&i.scheduleId&&!e&&S?w(!0):(null!==i&&void 0!==i&&i.scheduleId&&localStorage.removeItem("form"),v(!1),t&&t())};Object(a.useEffect)(function(){if(null!==i&&void 0!==i&&i.scheduleId){var e,t,n,a,c,o,l,s,r,u,v=(null===i||void 0===i||null===(e=i.data)||void 0===e||null===(t=e.events)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.unstructuredAttributes)||{},b=v.appointmentTime,m=v.pickupDate,p=v.pickupTime,O=v.returnPickupTime,f=v.patientDateOfBirth,h=v.vehicle,g=v.pricingType,x=v.schedule;j.setFieldsValue(Object(d.a)(Object(d.a)({},null!==(a=null===i||void 0===i||null===(c=i.data)||void 0===c||null===(o=c.events)||void 0===o||null===(l=o[0])||void 0===l?void 0:l.unstructuredAttributes)&&void 0!==a?a:{}),{},{pickupDate:m?Us(m):void 0,pickupTime:p?Us(p):void 0,returnPickupTime:O?Us(O):void 0,appointmentTime:b?Us(b):void 0,patientDateOfBirth:f?Us(f):void 0,vehicle:h?Object(d.a)(Object(d.a)({},h),{},{valueName:null===h||void 0===h||null===(s=h.obj)||void 0===s?void 0:s.name}):void 0,pricingType:g?Object(d.a)(Object(d.a)({},g),{},{valueName:null===g||void 0===g||null===(r=g.value)||void 0===r?void 0:r.name}):void 0,schedule:Object(d.a)(Object(d.a)({},x),{},{endUntil:null!==x&&void 0!==x&&x.endUntil?Us(null===x||void 0===x?void 0:x.endUntil):void 0,customDates:null===x||void 0===x||null===(u=x.customDates)||void 0===u?void 0:u.map(function(e){return Us(e)})})}))}else{var y=localStorage.getItem("form");if(y){var I,S;console.log("re submit here");var N=JSON.parse(y);console.log("form here",N);var k=N||{},T=k.appointmentTime,C=k.pickupDate,w=k.pickupTime,E=k.returnPickupTime,R=k.patientDateOfBirth,P=k.vehicle,D=k.pricingType;k.serviceType;j.setFieldsValue(Object(d.a)(Object(d.a)({},null!==N&&void 0!==N?N:{}),{},{pickupDate:C?Us(C):void 0,pickupTime:w?Us(w):void 0,returnPickupTime:E?Us(E):void 0,appointmentTime:T?Us(T):void 0,patientDateOfBirth:R?Us(R):void 0,vehicle:P?Object(d.a)(Object(d.a)({},P),{},{valueName:null===P||void 0===P||null===(I=P.obj)||void 0===I?void 0:I.name}):void 0,pricingType:D?Object(d.a)(Object(d.a)({},D),{},{valueName:null===D||void 0===D||null===(S=D.value)||void 0===S?void 0:S.name}):void 0}))}}},[]);var L=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,o,l,s,r,u,v,b,j,m,p,O,f,h,g,y,I,S,N,k,T,C,w,E,A,M,L,F,B,_,Y,H,V,z,Q,G,J,K,Z,ee,te,ne,ae,ie,ce,oe,le,se,re,de,ue,ve,be,je,me,pe,Oe,fe,he,ge,xe,ye,Ie,Se,Ne,ke,Te,Ce,we,Ee,Re,Pe,De;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("values",t),F=void 0,B=null===P||void 0===P?void 0:P.userId,_=null===P||void 0===P?void 0:P.connectionId,t[void 0]&&(t=t[void 0]),t.pickupLocation.type="temp-location",t.dropoffLocation&&(t.dropoffLocation.type="temp-location"),Y={},Object.keys(t).map(function(e){var n=X(e,e,t[e],[],{});Array.isArray(n)?null===n||void 0===n||n.map(function(e){$.a.merge(Y,e)}):$.a.merge(Y,n)}),H=null===D||void 0===D?void 0:D.find(function(e){var t;return(null===e||void 0===e||null===(t=e.objectId)||void 0===t?void 0:t.toString())===(null===Y||void 0===Y?void 0:Y.billingInstitute)}),V=null===(n=Object.values((null===H||void 0===H||null===(a=H.info)||void 0===a||null===(o=a.page)||void 0===o||null===(l=o.folder)||void 0===l?void 0:l.projectComponents)||{}))||void 0===n?void 0:n.find(function(e){var t;return"onMove"===(null===e||void 0===e||null===(t=e.components)||void 0===t?void 0:t[0])}),z=Object(d.a)(Object(d.a)({},Y),{},{billingInstituteName:null===H||void 0===H||null===(s=H.info)||void 0===s?void 0:s.name,project:{id:null===V||void 0===V?void 0:V.projectId,type:"project"},sharePassengerLink:t.sharePassengerLink,pricingType:null===(r=t)||void 0===r||null===(u=r.pricingType)||void 0===u||null===(v=u.value)||void 0===v?void 0:v.name,equipmentType:null===(b=t)||void 0===b||null===(j=b.equipment)||void 0===j||null===(m=j.categories)||void 0===m?void 0:m.toString(),equipment:null===(p=t)||void 0===p||null===(O=p.equipment)||void 0===O||null===(f=O.subCategories)||void 0===f?void 0:f.toString()}),Q=[],null!==z&&void 0!==z&&null!==(h=z.primaryResponder)&&void 0!==h&&h.id&&Q.push({id:null===z||void 0===z||null===(G=z.primaryResponder)||void 0===G?void 0:G.id,beamId:null===z||void 0===z||null===(J=z.primaryResponder)||void 0===J?void 0:J.beamId,permission:"edit"}),(null===z||void 0===z||null===(g=z.secondaryResponder)||void 0===g||null===(y=g.responders)||void 0===y?void 0:y.length)>0&&(null===z||void 0===z||null===(K=z.secondaryResponder)||void 0===K||null===(Z=K.responders)||void 0===Z||Z.map(function(e){Q.push({id:null===e||void 0===e?void 0:e.id,beamId:null===e||void 0===e?void 0:e.beamId,permission:"write"})})),ee=[],console.log("sorted attributes",z),te=Object(d.a)(Object(d.a)({},z),{},{returnPickupTime:void 0}),ne=new Date,ae=new Date(null===te||void 0===te?void 0:te.pickupTime),ne.setHours(ae.getHours()),ne.setMinutes(ae.getMinutes()),ie=ne.getTime(),te.pickupDate=null===(I=Us(ie))||void 0===I?void 0:I.format("MMM D YYYY"),te.pickupTime=null===(S=Us(ie))||void 0===S?void 0:S.format("HH:mm"),te.appointmentTime=null===(N=Us(null===te||void 0===te?void 0:te.appointmentTime))||void 0===N?void 0:N.format("HH:mm"),null!==te&&void 0!==te&&te.patientDateOfBirth&&(te.patientDateOfBirth=null===(ce=Us(null===te||void 0===te?void 0:te.patientDateOfBirth))||void 0===ce?void 0:ce.format("MM/DD/YYYY")),ee.push({userId:B,attributes:Object(d.a)(Object(d.a)({},te),{},{pickupAddress:null===te||void 0===te||null===(k=te.pickupLocation)||void 0===k||null===(T=k.attributes)||void 0===T?void 0:T.address,dropoffAddress:null===te||void 0===te||null===(C=te.dropoffLocation)||void 0===C||null===(w=C.attributes)||void 0===w?void 0:w.address,patientFullName:"".concat(null===te||void 0===te||null===(E=te.patientFirstName)||void 0===E?void 0:E.toLowerCase()," ").concat(null===te||void 0===te||null===(A=te.patientLastName)||void 0===A?void 0:A.toLowerCase()),schedule:void 0}),responders:Q,submitted:!0,connectionId:_,unstructuredAttributes:Object(d.a)(Object(d.a)({},t),{},{returnPickupTime:void 0}),pageId:F,title:"".concat(null===te||void 0===te?void 0:te.patientFirstName).concat(null!==te&&void 0!==te&&te.patientLastName&&""!==(null===te||void 0===te?void 0:te.patientLastName)?" "+(null===te||void 0===te?void 0:te.patientLastName):"",", <pickupDate> ").concat(Us(ie).format("hh:mm A")),createdAt:ie||(new Date).getTime(),cudbServiceId:null===R||void 0===R?void 0:R.userServiceId}),"C/R"===(null===z||void 0===z?void 0:z.serviceType)&&(je=Object(d.a)(Object(d.a)({},z),{},{pickupLocationName:z.dropoffLocationName,pickupLocation:z.dropoffLocation,pickupDoorCode:z.dropoffDoorCode,pickupEntranceUnitRoom:z.dropoffEntranceUnitRoom,dropoffLocationName:z.pickupLocationName,dropoffLocation:z.pickupLocation,dropoffDoorCode:z.pickupDoorCode,dropoffEntranceUnitRoom:z.pickupEntranceUnitRoom,pickupTime:z.returnPickupTime,pickupInstructions:z.dropoffInstructions,dropoffInstructions:z.pickupInstructions,returnPickupTime:void 0,appointmentTime:void 0}),me=Object(d.a)(Object(d.a)({},t),{},{pickupLocationName:t.dropoffLocationName,pickupLocation:t.dropoffLocation,pickupDoorCode:t.dropoffDoorCode,pickupEntranceUnitRoom:t.dropoffEntranceUnitRoom,dropoffLocationName:t.pickupLocationName,dropoffLocation:t.pickupLocation,dropoffDoorCode:t.pickupDoorCode,dropoffEntranceUnitRoom:t.pickupEntranceUnitRoom,pickupTime:t.returnPickupTime,pickupInstructions:t.dropoffInstructions,dropoffInstructions:t.pickupInstructions,returnPickupTime:void 0,appointmentTime:void 0}),pe=new Date(null===je||void 0===je?void 0:je.pickupDate),je.pickupTime&&(Oe=new Date(null===je||void 0===je?void 0:je.pickupTime),pe.setHours(Oe.getHours()),pe.setMinutes(Oe.getMinutes())),fe=pe.getTime(),je.pickupDate=null===(oe=Us(fe))||void 0===oe?void 0:oe.format("MMM D YYYY"),je.pickupTime=je.pickupTime?null===(le=Us(fe))||void 0===le?void 0:le.format("HH:mm"):"N/A",null!==je&&void 0!==je&&je.patientDateOfBirth&&(je.patientDateOfBirth=null===(he=Us(null===je||void 0===je?void 0:je.patientDateOfBirth))||void 0===he?void 0:he.format("MM/DD/YYYY")),ee.push({userId:B,attributes:Object(d.a)(Object(d.a)({},je),{},{pickupAddress:null===je||void 0===je||null===(se=je.pickupLocation)||void 0===se||null===(re=se.attributes)||void 0===re?void 0:re.address,dropoffAddress:null===je||void 0===je||null===(de=je.dropoffLocation)||void 0===de||null===(ue=de.attributes)||void 0===ue?void 0:ue.address,patientFullName:"".concat(null===je||void 0===je||null===(ve=je.patientFirstName)||void 0===ve?void 0:ve.toLowerCase()," ").concat(null===je||void 0===je||null===(be=je.patientLastName)||void 0===be?void 0:be.toLowerCase()),schedule:void 0}),responders:Q,submitted:!0,connectionId:_,unstructuredAttributes:Object(d.a)({},me),pageId:F,title:"".concat(null===je||void 0===je?void 0:je.patientFirstName).concat(null!==je&&void 0!==je&&je.patientLastName&&""!==(null===je||void 0===je?void 0:je.patientLastName)?" "+(null===je||void 0===je?void 0:je.patientLastName):"",", ").concat(je.pickupTime?"<pickupDate> ".concat(Us(fe).format("hh:mm A")):"<pickupDate> N/A"),createdAt:fe||(new Date).getTime(),cudbServiceId:null===R||void 0===R?void 0:R.userServiceId})),ee=ee.map(function(e,t){var n=[],a=e.attributes,i=a.pickupTime,c=a.returnPickupTime,o=(a.pickupDate,a.serviceType),l=a.transferType,s=a.equipmentNeeded,r=a.patientFirstName,u=a.patientLastName,v=a.patientDateOfBirth,b=a.weightHeigth,j=a.oxygen,m=a.oxygenSupplied,p=a.pickupLocationName,O=a.pickupEntranceUnitRoom,f=a.pickupAddress,h=a.dropoffLocationName,g=a.dropoffEntranceUnitRoom,x=a.dropoffAddress,y=a.pickupInstructions,I=a.dropoffInstructions,S=a.diagnoses,N=a.instructions,k=a.pickupLocation,T=a.dropoffLocation,C=a.waitTime;if(n.push({type:"text",attributes:{body:"".concat(i," - <pickupDate> - ").concat(o," - ").concat(l," (").concat(s,") - Pickup: ").concat(r," ").concat(u," (DOB ").concat(v,", Weight: ").concat(b||"N/A",", ").concat(j?"Oxygen: ".concat(j,"L"):""," ").concat(m?"- supplied by:".concat(m):"",") at ").concat(p," - ").concat(O," - ").concat(f," ").concat(y&&""!==y?"- ".concat(y):"",", Take to: ").concat(h," - ").concat(g," - ").concat(x," ").concat(I&&""!==I?"- ".concat(I):""," Diagnosis: ").concat(S||"N/A"," Instructions: ").concat(N||"N/A")}}),"W/R"===o&&n.push({type:"text",attributes:{body:"".concat(c," - <pickupDate> - ").concat(o," - ").concat(l," (").concat(s,") - Pickup: ").concat(r," ").concat(u," (DOB ").concat(v,", Weight: ").concat(b||"N/A",", ").concat(j?"Oxygen: ".concat(j,"L"):""," ").concat(m?"- supplied by:".concat(m):"",") at ").concat(h," - ").concat(g," - ").concat(x,", Take to: ").concat(p," - ").concat(O," - ").concat(f)}}),Q&&Q.length>0){var w={type:"place",attributes:{body:"Pickup location",attributes:k.attributes,display:{type:"marker",color:"blue"},coordinates:k.coordinates}},E={type:"place",attributes:{body:"Dropoff location",attributes:T.attributes,display:{type:"marker",color:"blue"},coordinates:T.coordinates}};n.push({type:"rsvp",attributes:Object(d.a)(Object(d.a)({body:"Accept job"},{type:"yes-no",options:{option1:"Yes",option2:"No"},rsvpTitle:"Accept job"}),{},{callback:{topic:"".concat("beamdevlive","/connection/").concat(_,"/service/hpd-dps/rsvpReplyEvent"),data:{type:"cancelPage",pickupLocation:w,dropoffLocation:E,serviceType:o,waitTime:C}}})})}return e.customMessages=n,e.attributes.customMessages=n,e}),console.log("requests",ee),ge={schedule:null===(M=t)||void 0===M?void 0:M.schedule,events:ee,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,cudbServiceId:null===R||void 0===R?void 0:R.userServiceId,scheduleUdid:null!==i&&void 0!==i&&i.scheduleId?null===i||void 0===i||null===(L=i.data)||void 0===L?void 0:L.scheduleUdid:W()},xe=Us.tz("01/01/2025 23:55","MM/DD/YYYY HH:mm",Intl.DateTimeFormat().resolvedOptions().timeZone),ye=xe.utc().format("MM/DD/YYYY HH:mm"),Ie=new Date(ye),Se="".concat(Ie.getMinutes()," ").concat(Ie.getHours()," * 0-11 *"),console.log("cron",Se),null!==i&&void 0!==i&&i.scheduleId){e.n=3;break}return Te={cron:Se,topic:"".concat("beamdevlive","/service/scheduler-service/service/dps/createRecurringEventPage"),data:ge,info:{},to:0x10000000000000000},console.log("request",Te),x(!0),e.n=1,U(Te);case 1:return Ce=e.v,we=null===Ce||void 0===Ce||null===(Ne=Ce.data)||void 0===Ne||null===(ke=Ne.id)||void 0===ke?void 0:ke.toString(),Ee={objectId:we,changes:[{op:"replace",path:"/partitions",value:["org:".concat(null===R||void 0===R?void 0:R.userServiceId),"type:recurringEvent"]}]},e.n=2,q(Ee);case 2:Lt("Recurring schedule created successfully","success","TOP_CENTER",3e3),e.n=5;break;case 3:return x(!0),Pe=null===i||void 0===i||null===(Re=i.scheduleId)||void 0===Re?void 0:Re.toString(),De={objectId:Pe,changes:[{op:"replace",path:"/cron",value:Se},{op:"replace",path:"/data",value:ge}]},e.n=4,q(De);case 4:Lt("Recurring schedule updated successfully","success","TOP_CENTER",3e3);case 5:localStorage.removeItem("form"),x(!1),c();case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){A(bt({request:t,callback:function(t){console.log("create response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){A(mt({request:t,callback:function(t){console.log("create response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}();return Object(oa.jsxs)($n.a,{title:null!==i&&void 0!==i&&i.scheduleId?"Edit schedule":"Add schedule",visible:r,onCancel:function(){M()},width:"1200px",className:"beam-modal",footer:[],destroyOnClose:!0,children:[Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:j,onFinish:L,onFinishFailed:function(e){var t=e.errorFields;if(t.length>0){var n=t[0],a=n.name.join("_"),i="register-form_".concat(a),c=document.getElementById(i);if(!c){var o=document.querySelector('label[for="'.concat(i,'"]'));o&&(c=o.closest(".ant-form-item"))}c||(c=document.querySelector(".ant-form-item-has-error")),console.log("error element",n,c),c&&c.scrollIntoView({behavior:"smooth",block:"center"})}},requiredMark:!1,onValuesChange:function(e,t){localStorage.setItem("form",JSON.stringify(t)),null!==i&&void 0!==i&&i.scheduleId&&N(!0)},initialValues:{dispatch:{type:"dispatchType",value:"immediate"},rideType:{type:"rideType",value:"O/W"},fareType:{type:"fareType",value:"variable"},payType:{type:"payType",value:"meter"},numberOfStaff:1},children:[Object(oa.jsxs)("div",{className:"main-cards mt-3",children:[Object(oa.jsx)(ei.a.Item,{name:"schedule",children:Object(oa.jsx)(_s,{})}),Object(oa.jsx)(dl,{socket:n,nine11Form:j,pickup:!1,ridePageId:""})]}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full",loading:g,onClick:function(){localStorage.removeItem("form"),N(!1),j.resetFields(),j.setFieldsValue({dispatch:{type:"dispatchType",value:"immediate"},rideType:{type:"rideType",value:"O/W"},fareType:{type:"fareType",value:"variable"},payType:{type:"payType",value:"meter"},numberOfStaff:1})},children:"Clear"})})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full ml-2",loading:g,type:"primary",htmlType:"submit",onClick:function(){return O("")},children:"Save"})})})]})]}),C&&Object(oa.jsx)(Fo,{onClose:function(){return w(!1)},handleConfirm:function(){return M(!0)},message:"Are you sure you want to discard changes?"})]})};Dc.d.register(Dc.a,Dc.j,Dc.e);Kl.a.TabPane;var Ys,Hs=function(e){var t,n=e.socket,c=(e.params,e.componentUuid,Object(s.c)(function(e){return e.auth})),o=c.selectedPage,l=(c.encrypted_token,c.projects),r=c.adminUserRoles,v=Object(s.b)(),b=Object(a.useState)([]),j=Object(u.a)(b,2),m=j[0],p=j[1],O=Object(a.useState)([]),f=Object(u.a)(O,2),h=f[0],g=f[1];Object(a.useState)(!1);var x=Object(a.useState)(!1),y=Object(u.a)(x,2),I=y[0],S=y[1];Object(a.useState)(!1);Mn().getUserRequestPayload;var N=Object(a.useRef)(),k=Object(a.useState)(void 0),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(a.useState)(void 0),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useRef)(!0);function M(e){if(!e)return"";if(console.log("schedule",e),"custom"===e.mode){if(!e.customDates.length)return"No custom dates selected.";var t=e.customDates.map(function(e){return tc()(e).format("YYYY-MM-DD")}).join(", ");return"Custom schedule on: ".concat(t)}if("repeat"===e.mode){var n="Repeat ";if("daily"===e.repeatType&&(n+="every ".concat(e.everyX," day").concat(e.everyX>1?"s":"")),"weekly"===e.repeatType){var a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=e.repeatDays.map(function(e){return a[e]}).join(", ");n+="on ".concat(i," every week")}if("monthly"===e.repeatType){var c=e.monthRepeatDates.map(function(e){return"".concat(e).concat(function(e){if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}(e))}).join(", ");n+="on the ".concat(c," of every month")}return e.endUntil&&(n+=" until ".concat(tc()(e.endUntil).format("YYYY-MM-DD"))),n}return"No schedule selected."}var L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t="@partitions:{'org\\:".concat(z(null===l||void 0===l?void 0:l.userServiceId),"}@partitions:{type\\:recurringEvent}"),n={select:{index:{searchIndex:"".concat("beamdevlive",":schedule:status"),searchQuery:t,searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",data:"$.data",patientFullName:"$..patientFullName"}},apply:{expression:"",name:""},result:{},filter:{expression:e&&""!==e?"exists(@patientFullName) && contains(@patientFullName, '".concat(e,"')"):""},anyStatus:!1};S(!0),v(tt({requestData:n,callback:function(e){S(!1),console.log("respons ehere",e);var t=[],n=[{title:"Schedule",key:"schedule",dataIndex:"schedule"},{title:"Job",key:"job",dataIndex:"job"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),w(e)},children:Object(oa.jsx)(wo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",onClick:function(){console.log("action",e),D(e)},children:Object(oa.jsx)(na.a,{})})})]})}}];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l,s,r,u;t.push(Object(d.a)(Object(d.a)({key:e.id},null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.schedule),{},{schedule:M(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.schedule),job:null===e||void 0===e||null===(c=e.data)||void 0===c||null===(o=c.events)||void 0===o||null===(l=o[0])||void 0===l||null===(s=l.customMessages)||void 0===s||null===(r=s[0])||void 0===r||null===(u=r.attributes)||void 0===u?void 0:u.body,action:{scheduleId:null===e||void 0===e?void 0:e.id,data:null===e||void 0===e?void 0:e.data}}))}),N.current=t,g(n),p(t)}}))};Object(a.useEffect)(function(){return A.current=!0,function(){A.current=!1}},[]),Object(a.useEffect)(function(){null!==l&&void 0!==l&&l.adminUserId&&L()},[l]);Zn.a.RangePicker;var U=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){v(jt({request:t,callback:function(t){console.log("delete response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),q=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],F=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid",marginRight:-20},children:Object(oa.jsxs)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:[Object(oa.jsx)(Yn.a,{className:"mb-3",children:Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Recurring"}),Object(oa.jsx)("p",{children:"Home > Recurring"})]}),Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(Wn.a,{onChange:function(e){var t=e.target.value;Ys&&clearTimeout(Ys),Ys=setTimeout(function(){t.includes("-")&&(t=z(t)),L(t)},500)},style:{width:350},placeholder:"Search patient",className:"mr-2",suffix:Object(oa.jsx)(Jl.a,{})}),Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn green-btn cover",onClick:function(){w({})},children:"Add"})]})]})}),Object(oa.jsx)(Xi.a,{dataSource:I?F:m,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},columns:I?q:h,scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})]})}),void 0!==C&&Object(oa.jsx)($s,{socket:n,student:C,onClose:function(){w(void 0)},adminRoles:r,onAdd:function(){L(),w(void 0)}}),P&&Object(oa.jsx)(Fo,{onClose:function(){D(void 0)},handleConfirm:Object(_n.a)(Object(Bn.a)().m(function e(){var t;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("delete here",P),e.n=1,U({objectId:null===P||void 0===P||null===(t=P.scheduleId)||void 0===t?void 0:t.toString()});case 1:D(void 0),Lt("Schedule deleted successfully","success","TOP_CENTER",3e3),L();case 2:return e.a(2)}},e)})),message:"Are you sure you want to delete schedule (".concat(null===P||void 0===P||null===(t=P.data)||void 0===t?void 0:t.name,")?")})]})};Dc.d.register(Dc.a,Dc.j,Dc.e);Kl.a.TabPane;var Ws=Gn.a.Option,Vs=Jn.a.RangePicker,zs=function(e){var t=e.value,n=e.onChange,i=Object(a.useState)(t),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)(null),r=Object(u.a)(s,2),d=r[0],v=r[1];Object(a.useEffect)(function(){t&&l(t)},[t]);var b=function(e,t){n&&n({startTimestamp:e,endTimestamp:t})};return Object(oa.jsxs)("div",{className:"w-100",children:[Object(oa.jsxs)(Gn.a,{style:{width:200},placeholder:"Select time range",className:"w-100",value:o,onChange:function(e){var t,n=H()(),a=n.valueOf();switch("customRange"!==e&&v(null),e){case"last24hours":t=n.subtract(24,"hours").valueOf();break;case"last3days":t=n.subtract(3,"days").valueOf();break;case"last1week":t=n.subtract(7,"days").valueOf();break;case"last1month":t=n.subtract(1,"month").valueOf();break;case"customRange":d?(t=d[0],a=d[1]):console.warn("Select a custom range from the date picker.");break;default:return void console.warn("Invalid selection")}l(e),b(t,a)},children:[Object(oa.jsx)(Ws,{value:"last24hours",children:"Last 24 Hours"}),Object(oa.jsx)(Ws,{value:"last3days",children:"Last 3 Days"}),Object(oa.jsx)(Ws,{value:"last1week",children:"Last 1 Week"}),Object(oa.jsx)(Ws,{value:"last1month",children:"Last 1 Month"}),Object(oa.jsx)(Ws,{value:"customRange",children:"Custom Range"})]}),"customRange"===o&&Object(oa.jsx)(Vs,{style:{marginTop:16},onChange:function(e){if(e){var t=e[0].valueOf(),n=e[1].valueOf();v([t,n]),b(t,n)}else v(null)},format:"YYYY-MM-DD",disabledTime:function(){return{}},showTime:!1})]})},Qs=function(e){var t,n=e.socket,c=(e.params,e.componentUuid,Object(s.c)(function(e){return e.auth})),o=c.selectedPage,l=c.encrypted_token,r=c.projects,v=c.adminUserRoles,b=Object(s.b)(),j=Object(a.useState)([]),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)([]),g=Object(u.a)(h,2),x=g[0],y=g[1],I=[{title:"Driver name",dataIndex:"userName",key:"userName"},{title:"Start Date",dataIndex:"startDate",key:"startDate"},{title:"End Date",dataIndex:"endDate",key:"endDate"},{title:"Reason",dataIndex:"reason",key:"reason"},{title:"Status",dataIndex:"status",key:"status",render:function(e){var t="Accepted"===e?"green":"Rejected"===e?"red":"orange";return Object(oa.jsx)(Kn.a,{color:t,children:e})}},{title:"Action",key:"action",render:function(e,t){return Object(oa.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover",onClick:function(){return B(t,"Accepted")},children:"Accept"}),Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn cover",onClick:function(){return B(t,"Rejected")},children:"Reject"})]})}}],S=Object(a.useRef)({status:void 0}),N=Object(a.useRef)({time:void 0,user:void 0}),k=Object(a.useRef)([]),T=Object(a.useState)(!1),C=Object(u.a)(T,2),w=C[0],E=C[1],R=Object(a.useState)(),P=Object(u.a)(R,2),D=(P[0],P[1],Mn().getUserRequestPayload,Object(a.useState)(void 0)),A=Object(u.a)(D,2),M=(A[0],A[1],Object(a.useState)(void 0)),L=Object(u.a)(M,2),U=L[0],q=L[1],F=Object(a.useRef)(!0),B=function(e,t){console.log("record",e,t),n.publishToEvent(m.PublishPageTopics,un(null===l||void 0===l?void 0:l.connectionId),Dn({objectId:null===e||void 0===e?void 0:e.key,changes:[{op:"replace",path:"$.info.status",value:t}]}))},_=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}@partitions:{type\\:timeoff}").concat(N.current.time?N.current.time:"").concat(N.current.user?N.current.user:""),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status"}},filter:{expression:S.current.status?S.current.status:""}};e||E(!0),b(tt({requestData:t,callback:function(e){console.log("response here",e),f(null===e||void 0===e?void 0:e.map(function(e){var t,n,a,i,c,o=null===e||void 0===e||null===(t=e.partitions)||void 0===t||null===(n=t.find(function(e){return null===e||void 0===e?void 0:e.includes("user")}))||void 0===n||null===(a=n.split(":"))||void 0===a?void 0:a[1],l=null===(i=k.current)||void 0===i||null===(c=i.find(function(e){var t;return(null===e||void 0===e||null===(t=e.key)||void 0===t?void 0:t.toString())===o}))||void 0===c?void 0:c.name;return console.log("user id",o,l),Object(d.a)(Object(d.a)({key:null===e||void 0===e?void 0:e.objectId},null===e||void 0===e?void 0:e.info),{},{userId:o,userName:l})})),E(!1)}}))};Object(a.useEffect)(function(){return F.current=!0,function(){F.current=!1}},[]),Object(a.useEffect)(function(){null!==r&&void 0!==r&&r.adminUserId&&(!function(e,t){var n,a="@serviceId:{'".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}");switch(t){case ac.Dispatcher:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Live:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Live)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Responder:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Manager:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)})}console.log("selected user roles",n);var i=n.map(function(e){return"@roleId === '".concat(e._id,"'")}),c={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:a,searchOptions:"TIMEOUT 5000"},list:{objectIds:void 0},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(i.join("||"),")")},anyStatus:!1};E(!0),b(tt({requestData:c,callback:function(e){E(!1);var t=[];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l,s,r,d,u,v,b;t.push({key:e.id,userStatus:null===e||void 0===e||null===(a=e.status)||void 0===a?void 0:a.name,name:"".concat(null===e||void 0===e||null===(i=e.live)||void 0===i||null===(c=i.profile)||void 0===c?void 0:c.firstName," ").concat(null===e||void 0===e||null===(o=e.live)||void 0===o||null===(l=o.profile)||void 0===l?void 0:l.lastName),email:null===e||void 0===e||null===(s=e.live)||void 0===s||null===(r=s.alternativeIds)||void 0===r?void 0:r.email,phone:null===e||void 0===e||null===(d=e.live)||void 0===d||null===(u=d.alternativeIds)||void 0===u?void 0:u.phone,customId:null===e||void 0===e||null===(v=e.live)||void 0===v||null===(b=v.alternativeIds)||void 0===b?void 0:b.customId})}),y(t),k.current=t,_()}}))}(v,ac.Responder),n.subscribeToEvent(m.SubscribePageTopics,dn(null===l||void 0===l?void 0:l.connectionId),function(e){console.log("response",e),_(!0)}))},[r]);Zn.a.RangePicker;var $=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){b(jt({request:t,callback:function(t){console.log("delete response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),Y=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],H=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select status",allowClear:!0,showSearch:!0,options:[{label:"Pending",value:"Pending"},{label:"Accepted",value:"Accepted"},{label:"Rejected",value:"Rejected"}],onChange:function(e){console.log("value here",e),S.current.status=e?"exists(@status) && @status === '".concat(e,"'"):void 0,_()}})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-3",children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select driver",allowClear:!0,showSearch:!0,options:null===x||void 0===x?void 0:x.map(function(e){return{label:e.name,value:e.key}}),onChange:function(e){N.current.user=e?"@partitions:{user\\:".concat(e,"}"):void 0,_()}})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-3",children:Object(oa.jsx)(zs,{onChange:function(e){console.log("value here",e),function(e){if(e.startTimestamp){var t=new Date(e.startTimestamp);t.setHours(0),t.setMinutes(1);var n=new Date(e.endTimestamp);n.setHours(23),n.setMinutes(59),N.current.time="@createdAt:[".concat(t.getTime(),",+inf]@createdAt:[-inf, ").concat(n.getTime(),"]")}else N.current.time=void 0;_()}(e)},value:void 0})})]})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:w?H:O,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},columns:w?Y:I,scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),U&&Object(oa.jsx)(Fo,{onClose:function(){q(void 0)},handleConfirm:Object(_n.a)(Object(Bn.a)().m(function e(){var t;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("delete here",U),e.n=1,$({objectId:null===U||void 0===U||null===(t=U.scheduleId)||void 0===t?void 0:t.toString()});case 1:q(void 0),Lt("Schedule deleted successfully","success","TOP_CENTER",3e3),_();case 2:return e.a(2)}},e)})),message:"Are you sure you want to delete schedule (".concat(null===U||void 0===U||null===(t=U.data)||void 0===t?void 0:t.name,")?")})]})},Gs=n(1043),Js=n(1067);Dc.d.register(Dc.a,Dc.j,Dc.e);Kl.a.TabPane;var Ks=Gn.a.Option,Zs=Jn.a.RangePicker,Xs=function(e){var t=e.value,n=e.onChange,i=Object(a.useState)(t),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)(null),r=Object(u.a)(s,2),d=r[0],v=r[1];Object(a.useEffect)(function(){t&&l(t)},[t]);var b=function(e,t){n&&n({startTimestamp:e,endTimestamp:t})};return Object(oa.jsxs)("div",{className:"w-100",children:[Object(oa.jsxs)(Gn.a,{style:{width:200},placeholder:"Select time range",className:"w-100",value:o,onChange:function(e){var t,n=H()(),a=n.valueOf();switch("customRange"!==e&&v(null),e){case"last24hours":t=n.subtract(24,"hours").valueOf();break;case"last3days":t=n.subtract(3,"days").valueOf();break;case"last1week":t=n.subtract(7,"days").valueOf();break;case"last1month":t=n.subtract(1,"month").valueOf();break;case"customRange":d?(t=d[0],a=d[1]):console.warn("Select a custom range from the date picker.");break;default:return void console.warn("Invalid selection")}l(e),b(t,a)},children:[Object(oa.jsx)(Ks,{value:"last24hours",children:"Last 24 Hours"}),Object(oa.jsx)(Ks,{value:"last3days",children:"Last 3 Days"}),Object(oa.jsx)(Ks,{value:"last1week",children:"Last 1 Week"}),Object(oa.jsx)(Ks,{value:"last1month",children:"Last 1 Month"}),Object(oa.jsx)(Ks,{value:"customRange",children:"Custom Range"})]}),"customRange"===o&&Object(oa.jsx)(Zs,{style:{marginTop:16},onChange:function(e){if(e){var t=e[0].valueOf(),n=e[1].valueOf();v([t,n]),b(t,n)}else v(null)},format:"YYYY-MM-DD",disabledTime:function(){return{}},showTime:!1})]})},er=function(e){var t,n=e.socket,c=(e.params,e.componentUuid,Object(s.c)(function(e){return e.auth})),o=c.selectedPage,l=c.encrypted_token,r=c.projects,v=c.adminUserRoles,b=Object(s.b)(),j=Object(a.useState)([]),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)([]),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(a.useRef)({status:void 0}),S=Object(a.useRef)({time:void 0,user:void 0}),N=Object(a.useRef)([]),k=Object(a.useState)(!1),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(a.useState)(),R=Object(u.a)(E,2),P=(R[0],R[1],Mn().getUserRequestPayload,Object(a.useState)(void 0)),D=Object(u.a)(P,2),A=(D[0],D[1],Object(a.useState)(void 0)),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useRef)(!0),F=function(e){var t=Math.floor(e/60),n=e%60;return"".concat(t,"h").concat(n,"m")},B=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}@partitions:{type\\:timesheet}").concat(S.current.time?S.current.time:"").concat(S.current.user?S.current.user:""),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status"}},filter:{expression:I.current.status?I.current.status:""}};e||w(!0),b(tt({requestData:t,callback:function(e){var t;console.log("response here",e),f(null===e||void 0===e||null===(t=e.map(function(e){var t,n,a,i,c,o,l,s,r,u,v,b=null===e||void 0===e||null===(t=e.partitions)||void 0===t||null===(n=t.find(function(e){return null===e||void 0===e?void 0:e.includes("user")}))||void 0===n||null===(a=n.split(":"))||void 0===a?void 0:a[1],j=null===(i=N.current)||void 0===i||null===(c=i.find(function(e){var t;return(null===e||void 0===e||null===(t=e.key)||void 0===t?void 0:t.toString())===b}))||void 0===c?void 0:c.name;return console.log("user id",b,j),Object(d.a)(Object(d.a)({key:null===e||void 0===e?void 0:e.objectId},null===e||void 0===e?void 0:e.info),{},{userId:b,userName:j,startTime:null===(o=H()(null===e||void 0===e||null===(l=e.info)||void 0===l?void 0:l.startTime))||void 0===o?void 0:o.format("MM/DD/YYYY HH:mm"),endTime:null===(s=H()(null===e||void 0===e||null===(r=e.info)||void 0===r?void 0:r.endTime))||void 0===s?void 0:s.format("MM/DD/YYYY HH:mm"),hoursWorked:F(null===e||void 0===e||null===(u=e.info)||void 0===u?void 0:u.totalWorkedTimeInMinutes),breakTime:F((null===e||void 0===e||null===(v=e.info)||void 0===v?void 0:v.breakTimeInSeconds)/60)})}))||void 0===t?void 0:t.filter(function(e){return void 0!==(null===e||void 0===e?void 0:e.totalWorkedTimeInMinutes)})),w(!1)}}))};Object(a.useEffect)(function(){return q.current=!0,function(){q.current=!1}},[]),Object(a.useEffect)(function(){null!==r&&void 0!==r&&r.adminUserId&&(!function(e,t){var n,a="@serviceId:{'".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}");switch(t){case ac.Dispatcher:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Live:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Live)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Responder:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Manager:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)})}console.log("selected user roles",n);var i=n.map(function(e){return"@roleId === '".concat(e._id,"'")}),c={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:a,searchOptions:"TIMEOUT 5000"},list:{objectIds:void 0},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(i.join("||"),")")},anyStatus:!1};w(!0),b(tt({requestData:c,callback:function(e){w(!1);var t=[];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l,s,r,d,u,v,b;t.push({key:e.id,userStatus:null===e||void 0===e||null===(a=e.status)||void 0===a?void 0:a.name,name:"".concat(null===e||void 0===e||null===(i=e.live)||void 0===i||null===(c=i.profile)||void 0===c?void 0:c.firstName," ").concat(null===e||void 0===e||null===(o=e.live)||void 0===o||null===(l=o.profile)||void 0===l?void 0:l.lastName),email:null===e||void 0===e||null===(s=e.live)||void 0===s||null===(r=s.alternativeIds)||void 0===r?void 0:r.email,phone:null===e||void 0===e||null===(d=e.live)||void 0===d||null===(u=d.alternativeIds)||void 0===u?void 0:u.phone,customId:null===e||void 0===e||null===(v=e.live)||void 0===v||null===(b=v.alternativeIds)||void 0===b?void 0:b.customId})}),y(t),N.current=t,B()}}))}(v,ac.Responder),n.subscribeToEvent(m.SubscribePageTopics,dn(null===l||void 0===l?void 0:l.connectionId),function(e){console.log("response",e),B(!0)}))},[r]);Zn.a.RangePicker;var _=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){b(jt({request:t,callback:function(t){console.log("delete response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),$=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],Y=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select driver",allowClear:!0,showSearch:!0,options:null===x||void 0===x?void 0:x.map(function(e){return{label:e.name,value:e.key}}),onChange:function(e){S.current.user=e?"@partitions:{user\\:".concat(e,"}"):void 0,B()}})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-3",children:Object(oa.jsx)(Xs,{onChange:function(e){console.log("value here",e),function(e){if(e.startTimestamp){var t=new Date(e.startTimestamp);t.setHours(0),t.setMinutes(1);var n=new Date(e.endTimestamp);n.setHours(23),n.setMinutes(59),S.current.time="@createdAt:[".concat(t.getTime(),",+inf]@createdAt:[-inf, ").concat(n.getTime(),"]")}else S.current.time=void 0;B()}(e)},value:void 0})})]})]}),Object(oa.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(oa.jsxs)(Cc.a,{bordered:!1,style:{textAlign:"center",width:"calc(50% - 10px)"},className:"filter-card mt-3",children:[Object(oa.jsx)(Zl.a,{style:{fontSize:"40px",color:"#40CC52",marginBottom:10}}),Object(oa.jsx)(Gs.a,{title:"Total Hours Worked",value:F(null===O||void 0===O?void 0:O.reduce(function(e,t){return e+t.totalWorkedTimeInMinutes},0)),suffix:"",valueStyle:{color:"#40CC52"}})]}),Object(oa.jsxs)(Cc.a,{bordered:!1,style:{textAlign:"center",width:"calc(50% - 10px)"},className:"filter-card mt-3",children:[Object(oa.jsx)(Js.a,{style:{fontSize:"40px",color:"#FF5F25",marginBottom:10}}),Object(oa.jsx)(Gs.a,{title:"Total Idle Time",value:F((null===O||void 0===O?void 0:O.reduce(function(e,t){return e+t.breakTimeInSeconds},0))/60),suffix:"",valueStyle:{color:"#FF5F25"}})]})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:C?Y:O,pagination:!1,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},columns:C?$:[{title:"Driver name",dataIndex:"userName",key:"userName"},{title:"Start Time",dataIndex:"startTime",key:"startTime"},{title:"End Time",dataIndex:"endTime",key:"endTime"},{title:"Break Time",dataIndex:"breakTime",key:"breakTime"},{title:"Hours worked",dataIndex:"hoursWorked",key:"hoursWorked"}],scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),L&&Object(oa.jsx)(Fo,{onClose:function(){U(void 0)},handleConfirm:Object(_n.a)(Object(Bn.a)().m(function e(){var t;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("delete here",L),e.n=1,_({objectId:null===L||void 0===L||null===(t=L.scheduleId)||void 0===t?void 0:t.toString()});case 1:U(void 0),Lt("Schedule deleted successfully","success","TOP_CENTER",3e3),B();case 2:return e.a(2)}},e)})),message:"Are you sure you want to delete schedule (".concat(null===L||void 0===L||null===(t=L.data)||void 0===t?void 0:t.name,")?")})]})},tr=function(e){e.socket;var t,n=e.params,a=e.userRole,i=n.screen,c=n.setScreen,o=Object(s.c)(function(e){return e.auth}),l=o.projects,r=o.encrypted_token,d=[{id:nc.Dashboard,key:"dashboard",name:"Booking",src:"/images/desktop-icon.svg",onClick:function(){c(nc.Dashboard)}},{id:nc.Driver,key:"driver",name:"Driver",src:"/images/community-icon.svg",onClick:function(){c(nc.Driver)}},{id:nc.Dispatcher,key:"dispatcher",name:"Dispatcher",src:"/images/community-icon.svg",onClick:function(){c(nc.Dispatcher)}},{id:nc.Vehicle,key:"vehicle",name:"Vehicle",src:"/images/ride-dispatch-icon.svg",cssClass:"settings-icon",onClick:function(){c(nc.Vehicle)}},{id:nc.Equipment,key:"equipment",name:"Equipment",src:"/images/setting-icon.svg",cssClass:"settings-icon",onClick:function(){c(nc.Equipment)}},{id:nc.Pricing,key:"pricing",name:"Pricing",src:"/images/payment-icon.svg",cssClass:"settings-icon",onClick:function(){c(nc.Pricing)}},{id:nc.Location,key:"location",name:"Location",src:"/images/location-icon.svg",cssClass:"",onClick:function(){c(nc.Location)}},{id:nc.Scheduler,key:"notification",name:"Notification",src:"/images/message-white-icon.svg",cssClass:"settings-icon",onClick:function(){c(nc.Scheduler)}},{id:nc.Recurring,key:"recurring",name:"Recurring",src:"/images/ride-dispatch-icon.svg",cssClass:"settings-icon",onClick:function(){c(nc.Recurring)}},{id:nc.Timeoff,key:"timeoff",name:"Timeoff",src:"/images/clock-icon.svg",cssClass:"settings-icon",onClick:function(){c(nc.Timeoff)}},{id:nc.Timesheet,key:"clockIn",name:"Timesheet",src:"/images/calendar-icon.svg",cssClass:"",onClick:function(){c(nc.Timesheet)}},{id:nc.Shift,key:"shift",name:"Shift",src:"/images/setting-icon.svg",cssClass:"settings-icon",onClick:function(){c(nc.Shift)}},{id:nc.QuickBooks,key:"quickbooks",name:"QuickBooks",src:"/images/account-icon.svg",cssClass:"settings-icon",onClick:function(){window.open("https://hpd-dps-api.staging.beam.live/quickbook/auth?userId=".concat(null===r||void 0===r?void 0:r.userId,"&cudbServiceId=").concat(null===l||void 0===l?void 0:l.userServiceId),"_blank")}}];return Object(oa.jsx)("div",{className:"main-column search-panel mr-4",style:{width:110},children:Object(oa.jsx)("div",{className:"sidebar",children:Object(oa.jsx)("ul",{style:{overflow:"scroll",height:"125vh"},children:null===d||void 0===d||null===(t=d.filter(function(e){return"admin"===a||"dashboard"===e.key||a===(null===e||void 0===e?void 0:e.key)}))||void 0===t?void 0:t.map(function(e){return Object(oa.jsx)("li",{className:i===e.id&&"selected",onClick:function(){var t=d.find(function(t){return t.id===e.id});null===t||void 0===t||t.onClick()},children:Object(oa.jsx)("div",{children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)(fa.a,{className:e.cssClass,src:e.src}),Object(oa.jsx)("p",{children:e.name})]})})},"selected-"+e.id)})})})})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var nr=function(e){var t=e.socket,n=Object(s.b)(),c=Object(a.useState)(void 0),o=Object(u.a)(c,2),r=o[0],d=o[1],b=Object(a.useState)(),j=Object(u.a)(b,2),p=j[0],O=j[1],f=Object(a.useState)(),g=Object(u.a)(f,2),x=g[0],I=g[1],S=Object(a.useState)(!1),N=Object(u.a)(S,2),k=N[0],T=N[1],C=Object(s.c)(function(e){return e.auth}),w=C.encrypted_token,E=C.projects,R=Object(a.useState)({all:W(),driver:W(),vehicle:W(),dispatcher:W(),pricing:W(),equipment:W(),schedule:W(),timeoff:W(),timesheet:W(),shift:W(),recurring:W(),location:W()}),P=Object(u.a)(R,2),D=P[0],A=(P[1],{screen:r,setScreen:d}),M=Object(l.g)().search,L=Mn().getUserRequestPayload,U=Object(a.useState)(!0),q=Object(u.a)(U,2),F=q[0],B=q[1];Object(a.useEffect)(function(){w&&(t.subscribeToEvent(m.SubscribePageTopics,qt(null===w||void 0===w?void 0:w.connectionId)),t.publishToEvent(m.PublishPageTopics,Ft(null===w||void 0===w?void 0:w.connectionId),Dn({userId:null===w||void 0===w?void 0:w.userId,cudbServiceId:(null===w||void 0===w?void 0:w.cudbServiceId)||(null===w||void 0===w?void 0:w.serviceId)})))},[w]);return Object(a.useEffect)(function(){p&&(t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,L(w.userId,"$","$..roleId"),h.GetBio,null===E||void 0===E?void 0:E.userServiceId),t.subscribeToSurvey(m.SurveyTopics,h.GetBio,function(e){var t,n,a,i,c,o,l=p.find(function(t){var n,a;return(null===t||void 0===t?void 0:t._id)===(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n[0])||void 0===a?void 0:a[0])});(null!==l&&void 0!==l&&null!==(t=l.permissions)&&void 0!==t&&t.includes(ic.Admin)||null!==l&&void 0!==l&&null!==(n=l.permissions)&&void 0!==n&&n.includes(ic.Cad))&&I("admin"),null===l||void 0===l||null===(a=l.permissions)||void 0===a||!a.includes(ic.OnMove)||null!==l&&void 0!==l&&null!==(i=l.permissions)&&void 0!==i&&i.includes(ic.Admin)||I("driver"),null===l||void 0===l||null===(c=l.permissions)||void 0===c||!c.includes(ic.Live)||null!==l&&void 0!==l&&null!==(o=l.permissions)&&void 0!==o&&o.includes(ic.Admin)||I("student")}))},[p]),Object(a.useEffect)(function(){x&&d(nc.Dashboard)},[x]),Object(a.useEffect)(function(){var e,n;null!==E&&void 0!==E&&E.adminUserId&&(e=null===E||void 0===E?void 0:E.adminUserId,n=null===E||void 0===E?void 0:E.userServiceId,t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,L(e,"$","$..role"),hn(null===w||void 0===w?void 0:w.connectionId),n),t.subscribeToSurvey(m.SurveyTopics,hn(null===w||void 0===w?void 0:w.connectionId),function(e){var t,n;O(null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0])},D.all))},[E]),Object(a.useEffect)(function(){if(t.client){var e=new URLSearchParams(M),a=e.get("userId"),i=e.get("connectionId"),c=e.get("token");n(c?ct({data:{payload:c},callback:function(e){}}):{type:"ADD_ENCRYPTED_TOKEN",payload:{connectionId:i,userId:a}})}},[M,t.client]),Object(oa.jsxs)(Yn.a,{className:"main-layout",style:{transform:"scale(0.8)",transformOrigin:"0 0",width:"125vw",height:"100vh"},children:[void 0!==r?Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(tr,{socket:t,params:A,userRole:x})}):Object(oa.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}})]}),r===nc.Dashboard&&Object(oa.jsxs)(i.a.Fragment,{children:[k&&Object(oa.jsx)(Hn.a,{span:22,style:{height:"calc((100vh / 0.8) - 50px)",overflow:"scroll"},children:Object(oa.jsx)(Il,{socket:t,params:A,fullScreen:!0,scale:!0,toggleDispatch:function(){return T(function(e){return!e})}})}),Object(oa.jsx)(Hn.a,{span:22,style:{height:"calc((100vh / 0.8) - 70px)",overflow:"scroll"},children:Object(oa.jsxs)(Yn.a,{children:[F&&Object(oa.jsx)(Hn.a,{span:24,className:"ride-container",children:Object(oa.jsx)(Cl,{socket:t,params:A})}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mt-3",style:{padding:0},children:Object(oa.jsx)(Gl,{socket:t,filter:!0,componentUuid:D.all,toggleMap:function(){return B(function(e){return!e})},toggleDispatch:function(){return T(function(e){return!e})}})})})})]})})]}),r===nc.Driver&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(ms,{socket:t,componentUuid:D.driver,userRole:x})})})}),r===nc.Dispatcher&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(Os,{socket:t,componentUuid:D.dispatcher,userRole:x})})})}),r===nc.Timeoff&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(Qs,{socket:t,componentUuid:D.timeoff})})})}),r===nc.Timesheet&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(er,{socket:t,componentUuid:D.timesheet})})})}),r===nc.Scheduler&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(As,{socket:t,componentUuid:D.schedule})})})}),r===nc.Recurring&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(Hs,{socket:t,componentUuid:D.recurring})})})}),r===nc.Vehicle&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(gs,{socket:t,componentUuid:D.vehicle})})})}),r===nc.Pricing&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(Ts,{socket:t,componentUuid:D.pricing})})})}),r===nc.Location&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(ws,{socket:t,componentUuid:D.location})})})}),r===nc.Equipment&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(Rs,{socket:t,componentUuid:D.equipment})})})}),r===nc.Shift&&Object(oa.jsx)(Hn.a,{span:22,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:0},children:Object(oa.jsx)(us,{socket:t,componentUuid:D.shift})})})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})},ar=Object(da.compose)(Object(da.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M&v=3.exp&libraries=geometry,drawing,places",loadingElement:Object(oa.jsx)("div",{style:{height:"100%"}}),containerElement:Object(oa.jsx)("div",{style:{height:"100%"}}),mapElement:Object(oa.jsx)("div",{style:{height:"100%"}})}),Object(da.withStateHandlers)(function(){return{isOpen:!1,activeMarker:null,directions:null,selectDirectionPin:null,drawingMode:null,activeInfo:null}},{onToggleOpen:function(e){var t=e.isOpen;return function(e){return{isOpen:!t,activeMarker:e}}},showDirection:function(){return function(e){return{directions:e}}},setDrawingMode:function(){return function(e){return{drawingMode:e}}},setSelectDirectionPin:function(){return function(e){return{selectDirectionPin:e}}},setActiveInfo:function(){return function(e){return{activeInfo:e}}}}),ua.withScriptjs,ua.withGoogleMap)(function(e){e.isOpen,e.active,e.setActive;var t,n,i,c=e.markers,o=e.assetMarkers,l=e.currentMarkers,r=e.currentLocation,d=e.getPlaces,u=e.setActiveInfo,v=e.activeInfo,b=(e.showDirection,e.directions),j=e.polygon,m=e.circle,p=e.stands,O=Object(a.useRef)(null),f=(Object(a.useRef)(!1),Object(s.c)(function(e){return e.auth})),h=f.selectedResponders,g=f.selectedAssets,x=Object(s.b)();Object(a.useEffect)(function(){h&&h.length>0&&console.log("update component")},[h]);var y=function(){i&&clearTimeout(i),i=setTimeout(function(){if(O.current){var e=O.current.getBounds();if(e){var t=e.getNorthEast(),n=e.getSouthWest();d({center:O.current.getCenter(),bounds:{minLat:n.lat(),maxLat:t.lat(),minLon:n.lng(),maxLon:t.lng()}})}}},500)};Object(a.useEffect)(function(){!function(){var e=new google.maps.LatLngBounds;c.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),o.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),l.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),p.forEach(function(t){var n,a;e.extend({lat:null===(n=t.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=t.location.coordinates)||void 0===a?void 0:a.long})}),e.isEmpty()||O.current.fitBounds(e)}()},[c,l,o,p]);return Object(oa.jsxs)(ua.GoogleMap,{defaultZoom:14,options:{maxZoom:19,styles:[{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]}]},center:r,onZoomChanged:function(){y()},onCenterChanged:function(){y()},onTilesLoaded:function(){O.current&&r&&y()},ref:O,children:[j&&Object(oa.jsx)(ua.Polygon,{path:j.paths,editable:!1,options:{strokeColor:"#FF0000",fillColor:"#FF0000"},onClick:function(e){}}),m&&Object(oa.jsx)(ua.Circle,{center:{lat:null===(t=m.location.coordinates)||void 0===t?void 0:t[1],lng:null===(n=m.location.coordinates)||void 0===n?void 0:n[0]},radius:m.radius,options:{strokeColor:"FF0000",fillColor:"FF0000"},onClick:function(e){}}),null===p||void 0===p?void 0:p.map(function(e,t){var n,a;return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-green.svg",scaledSize:new google.maps.Size(22,34)},position:{lat:null===(n=e.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=e.location.coordinates)||void 0===a?void 0:a.long},onClick:function(){x({type:Ee,payload:e})}},t)}),c.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/car-".concat(-1===h.findIndex(function(t){return t.id===e.id})?e.status:"blue",".svg"),scaledSize:new google.maps.Size(60,60)},position:{lat:e.lat,lng:e.lng},onClick:function(){"green"===(null===e||void 0===e?void 0:e.status)&&x({type:Ce,payload:e})},label:e.title},t)}),o.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===g.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){x({type:we,payload:e})},label:e.title},t)}),l.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===h.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){u(t)},children:v===t&&Object(oa.jsx)(ua.InfoWindow,{onCloseClick:function(){u(null)},children:Object(oa.jsx)("div",{children:Object(oa.jsx)("div",{children:e.title})})})},t)}),Object(oa.jsx)(ua.Marker,{position:r,icon:{url:"/images/map-plain-icon-blue.svg",scaledSize:new google.maps.Size(22,34)},onClick:function(){}}),b&&Object(oa.jsx)(ua.DirectionsRenderer,{directions:b,options:{markerOptions:{opacity:1},panel:document.getElementById("direction-panel")}})]})}),ir={lat:29.95106579999999,lng:-90.0715323};var cr,or=function(e){var t=e.socket,n=e.params,i=(n.screens,n.setScreens,Object(a.useState)()),c=Object(u.a)(i,2),o=(c[0],c[1],Object(a.useState)()),r=Object(u.a)(o,2),v=r[0],b=r[1],j=Object(a.useState)(!0),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)(!0),g=Object(u.a)(h,2),x=g[0],y=(g[1],Object(a.useState)([])),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)([]),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(a.useState)([]),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(!1),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useReducer)(function(e){return e+1},0),F=Object(u.a)(q,2),B=(F[0],F[1],Object(s.c)(function(e){return e.auth})),_=B.responders,$=B.vehicles,Y=(B.incidentLocation,B.project),H=B.eventLocations,W=B.geofenceLocation,V=B.standLocations,z=B.encrypted_token,Q=B.projects,G=B.assets,J=Object(l.g)().search,K=Object(a.useState)(),Z=Object(u.a)(K,2),X=Z[0],ee=Z[1],te=(Object(s.b)(),function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],i=t[1];Object(a.useEffect)(function(){i(!0)},[])}(),{createPlaceMarker:function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m=arguments.length>1&&void 0!==arguments[1]&&arguments[1],p=arguments.length>2?arguments[2]:void 0;null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.geoJson)||void 0===n||null===(a=n.features)||void 0===a||a.map(function(e){(null===e||void 0===e?void 0:e.geometry.coordinates.length)>0&&(j=e.geometry)});var O=(null===(i=e.beamIds)||void 0===i?void 0:i[0])||"".concat(e.profile.firstName,".").concat(e.profile.lastName);return null===p||void 0===p||p.map(function(t){t.id===e.id&&(O=t.name)}),Object(d.a)(Object(d.a)({},e),{},{lat:null===(c=j)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o[1],lng:null===(l=j)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s[0],title:O,color:"orange",paths:{lat:null===(r=j)||void 0===r||null===(u=r.coordinates)||void 0===u?void 0:u[1],lng:null===(v=j)||void 0===v||null===(b=v.coordinates)||void 0===b?void 0:b[0]},type:"marker",filter:"viewOnly",fitBounds:m})},createCurrentMarker:function(e){var t,n,a,i,c,o,l,s;return Object(d.a)(Object(d.a)({},e),{},{lat:null===e||void 0===e||null===(t=e.value)||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.lat,lng:null===e||void 0===e||null===(a=e.value)||void 0===a||null===(i=a.coordinates)||void 0===i?void 0:i.long,title:null===e||void 0===e?void 0:e.label,color:"blue",paths:{lat:null===e||void 0===e||null===(c=e.value)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o.lat,lng:null===e||void 0===e||null===(l=e.value)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s.long},type:"marker"})},createAssetMarker:function(e){var t,n,a,i,c,o,l,s,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"fixedAsset"===(null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.type)?s=null===e||void 0===e?void 0:e.asset:"poi"===(null===e||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)&&(s=null===e||void 0===e?void 0:e.poi);var u=s.location;return Object(d.a)(Object(d.a)({},s),{},{id:e.id,assetType:null===e||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.type,lat:null===u||void 0===u||null===(i=u.coordinates)||void 0===i?void 0:i.lat,lng:null===u||void 0===u||null===(c=u.coordinates)||void 0===c?void 0:c.long,title:u.attributes.title,color:"orange",paths:{lat:null===u||void 0===u||null===(o=u.coordinates)||void 0===o?void 0:o.lat,lng:null===u||void 0===u||null===(l=u.coordinates)||void 0===l?void 0:l.long},type:"marker",filter:"viewOnly",fitBounds:r})}}),ne=te.createPlaceMarker,ae=te.createCurrentMarker,ie=te.createAssetMarker,ce=Object(a.useState)(!1),oe=Object(u.a)(ce,2),le=oe[0],se=oe[1],re=Object(a.useState)(void 0),de=Object(u.a)(re,2),ue=de[0],ve=de[1],be=Object(a.useState)(void 0),je=Object(u.a)(be,2),me=je[0],pe=je[1],Oe=Object(a.useState)([]),fe=Object(u.a)(Oe,2),he=fe[0],ge=fe[1];Object(a.useEffect)(function(){var e=new URLSearchParams(J),t=e.get("lat"),n=e.get("lng");t&&n?b({lat:parseFloat(t),lng:parseFloat(n),current:!0}):xe()},[J]),Object(a.useEffect)(function(){if(H){console.log("event locations",H);var e=Object.keys(H).map(function(e){return ae(H[e])});D(e)}},[H]),Object(a.useEffect)(function(){if(W)if(console.log("geofence location",W),"Polygon"===(null===W||void 0===W?void 0:W.location.type)){var e=null===W||void 0===W?void 0:W.location.coordinates.map(function(e){return{lat:null===e||void 0===e?void 0:e[1],lng:null===e||void 0===e?void 0:e[0]}});ve({paths:e})}else pe(W);else ve(void 0),pe(void 0)},[W]),Object(a.useEffect)(function(){V&&(console.log("stand locations",V),ge(V))},[V]);Object(a.useEffect)(function(){if(Y&&X)X.latLong,X.height,X.width},[Y]),Object(a.useEffect)(function(){if(se(!1),_){var e=_.map(function(e){return ne(e,!1,$)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),console.log("markers here",e),N(e)}},[_]),Object(a.useEffect)(function(){if(se(!1),G&&G.length>0){console.log("assets here",G);var e=G.map(function(e){return ie(e)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),w(e)}},[G]);var xe=function(){v&&null!==v&&void 0!==v&&v.current?b(Object(d.a)({},v)):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,n,a,i,c;b({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,lng:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude,current:!0}),gc.a.fromLatLng(null===e||void 0===e||null===(a=e.coords)||void 0===a||null===(i=a.latitude)||void 0===i?void 0:i.toString(),null===(c=e.coords.longitude)||void 0===c?void 0:c.toString()).then(function(e){for(var t=0,n=e.results[0].address_components.length;t<n;t++){var a=e.results[0].address_components[t];a.types.indexOf("administrative_area_level_1")>=0&&a.short_name,a.types.indexOf("country")>=0&&a.short_name}},function(e){console.error(e),b(ir)})},function(e){console.error(e),b(ir)}):(alert("Geolocation is not supported by this browser."),b(ir))},ye=function(e,t,n,a){var i=Ie(n-e),c=Ie(a-t),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(Ie(e))*Math.cos(Ie(n))*Math.sin(c/2)*Math.sin(c/2);return 1e3*(6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))))},Ie=function(e){return e*(Math.PI/180)};return Object(oa.jsx)("div",{className:"main-column map-panel mr-4",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsx)("div",{className:"search-bar mt-3",children:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)("div",{className:"g-map-search-input",children:Object(oa.jsx)(Ii.a,{autocompletionRequest:{},selectProps:{onChange:function(e){e&&function(e){Object(Ii.b)(e.place_id).then(function(e){e[0].geometry&&b({lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),current:!1})}).catch(function(e){return console.error(e)})}(e.value)},isClearable:!0,placeholder:"Search map",styles:{input:function(e){return Object(d.a)(Object(d.a)({},e),{},{fontFamily:"Nunito-Regular"})}}},apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"})}),Object(oa.jsx)(Sl.a,{overlay:"My location",children:Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/location-icon.svg",onClick:xe})})}),Object(oa.jsx)(Sl.a,{overlay:"Reset map",children:Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/reload-icon.svg",onClick:function(){f(!1),U(!1),N([]),w([]),xe()}})})}),Object(oa.jsx)(Sl.a,{overlay:"Search responders",children:Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",onClick:function(){var e;if(!le&&X){var n=X.latLong;X.height,X.width;e=n,se(!0),t.publishToEvent(m.PublishPageTopics,Yt(null===z||void 0===z?void 0:z.connectionId),Dn({userId:null===z||void 0===z?void 0:z.userId,projectId:Y,cudbServiceId:null===Q||void 0===Q?void 0:Q.userServiceId,latLng:e,height:3e5,width:3e5}))}},children:le?Object(oa.jsx)(Ic.a,{type:"TailSpin",color:"#95a8c8",height:20,width:20}):Object(oa.jsx)(fa.a,{src:"/images/car.svg",className:"car-icon"})})})]})}),Object(oa.jsx)("div",{className:"main-cards",children:Object(oa.jsxs)(Yn.a,{className:"map-container-layout",children:[Object(oa.jsx)(Hn.a,{md:L?6:0,children:Object(oa.jsx)("div",{id:"direction-panel"})}),Object(oa.jsx)(Hn.a,{md:L?18:24,children:x&&Object(oa.jsx)(ar,{currentLocation:v,markers:S,assetMarkers:C,currentMarkers:P,polygon:ue,circle:me,stands:he,active:O,setActive:f,getPlaces:function(e){var t=e.bounds,n=e.center,a=ye(t.minLat,t.maxLon,t.maxLat,t.maxLon),i=ye(t.minLat,t.maxLon,t.minLat,t.minLon),c={lat:n.lat(),long:n.lng()};ee({latLong:c,height:a,width:i})}})})]})})]})})},lr=function(e){var t=e.inputArray,n=e.visible,i=(e.onSave,e.onCancel),c=e.socket,o=e.defaultIndex,l=void 0===o?0:o,r=Object(a.useState)(),d=Object(u.a)(r,2),v=d[0],b=d[1],j=Object(a.useState)(!1),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)(Object(C.a)(t)),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(a.useState)(),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(s.c)(function(e){return e.auth}).encrypted_token;Object(a.useEffect)(function(){console.log("input array",t),null===t||void 0===t||t.map(function(e,t){var n,a,i,c,o,s;(null===e||void 0===e?void 0:e.key)===l&&(b(t),k(null===e||void 0===e||null===(n=e.action)||void 0===n||null===(a=n.page)||void 0===a||null===(i=a.profile)||void 0===i||null===(c=i.customMessages)||void 0===c||null===(o=c[0])||void 0===o||null===(s=o.attributes)||void 0===s?void 0:s.body))}),console.log("pageId",l),c.subscribeToEvent(m.SubscribePageTopics,on(null===T||void 0===T?void 0:T.connectionId),function(e){f(!1),Lt("Custom message saved successfully","success","TOP_CENTER",1e3)})},[]);return Object(oa.jsxs)($n.a,{title:"Edit Notification Message",className:"beam-modal",visible:n,onCancel:i,children:[Object(oa.jsx)("div",{style:{marginBottom:16},children:Object(oa.jsx)(Wn.a.TextArea,{value:N,onChange:function(e){k(e.target.value)},rows:4,autoSize:{minRows:4},placeholder:"Edit custom message"})}),Object(oa.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(oa.jsx)(Vn.a,{icon:Object(oa.jsx)(Rl.a,{}),onClick:function(){if(v>0){var e,t,n,a,i,c,o,l=v-1;b(l),k((null===(e=x[l])||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.profile)||void 0===a||null===(i=a.customMessages)||void 0===i||null===(c=i[0])||void 0===c||null===(o=c.attributes)||void 0===o?void 0:o.body)||"")}},disabled:0===v,className:"beam-btn yellow-btn bordered",children:"Previous"}),Object(oa.jsx)(Vn.a,{icon:Object(oa.jsx)(Pl.a,{}),onClick:function(){if(v<x.length-1){var e,t,n,a,i,c,o,l=v+1;b(l),k((null===(e=x[l])||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.profile)||void 0===a||null===(i=a.customMessages)||void 0===i||null===(c=i[0])||void 0===c||null===(o=c.attributes)||void 0===o?void 0:o.body)||"")}},disabled:v===x.length-1,className:"beam-btn yellow-btn bordered",children:"Next"})]}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:12,xs:24,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:i,children:"Cancel"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",xs:24,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){!function(){var e=Object(C.a)(x);e[v].action.page.profile.customMessages[0].attributes.body=N,y(e),f(!0),c.publishToEvent(m.PublishPageTopics,ln(null===T||void 0===T?void 0:T.connectionId),Dn({objectId:e[v].key.toString(),changes:[{op:"replace",path:"$..profile.customMessages[0]..body",value:N}]}))}()},loading:O,children:"Save"})})]})]})};n(972);Dc.d.register(Dc.a,Dc.e);var sr=Jn.a.RangePicker,rr=Gn.a.Option,dr=function(e){return e.Assigned="assigned",e.Completed="completed",e.Escalated="escalated",e.Cancelled="cancelled",e.Processed="processed",e}({}),ur={green:dr.Completed,amber:dr.Assigned,red:dr.Escalated,black:dr.Cancelled,gray:dr.Processed},vr={green:"#40CC52",amber:"#FBAE16",red:"#FF5F25",blue:"#508AFA",purple:"#463BBD",gray:"#91A5C6",black:"#000000",brown:"#964B00",aqua:"#00FFFF"},br=function(e){var t=e.value,n=e.onChange,i=Object(a.useState)(t),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)(null),r=Object(u.a)(s,2),d=r[0],v=r[1],b=Object(a.useState)(null),j=Object(u.a)(b,2),m=j[0],p=j[1];Object(a.useEffect)(function(){t&&l(t)},[t]);var O=function(e,t,a){n&&n({startTimestamp:e,endTimestamp:t,selected:a})};return Object(oa.jsxs)("div",{className:"w-100",children:[Object(oa.jsxs)(Gn.a,{style:{width:200},placeholder:"Select time range",className:"w-100",value:o,onChange:function(e){var t,n=H()(),a=n.valueOf();switch("customRange"!==e&&v(null),"specificDate"!==e&&p(null),e){case"last24hours":t=void 0;break;case"last3days":t=n.subtract(3,"days").valueOf();break;case"last1week":t=n.subtract(7,"days").valueOf();break;case"last1month":t=n.subtract(1,"month").valueOf();break;case"customRange":d?(t=d[0],a=d[1]):console.warn("Select a custom range from the date picker.");break;case"specificDate":if(m)t=H()(m).startOf("day").valueOf(),a=H()(m).endOf("day").valueOf();else console.warn("Select a specific date.");break;default:return void console.warn("Invalid selection")}l(e),O(t,a,e)},children:[Object(oa.jsx)(rr,{value:"last24hours",children:"Last 1 Day and Upcoming"}),Object(oa.jsx)(rr,{value:"last3days",children:"Last 3 Days"}),Object(oa.jsx)(rr,{value:"last1week",children:"Last 1 Week"}),Object(oa.jsx)(rr,{value:"last1month",children:"Last 1 Month"}),Object(oa.jsx)(rr,{value:"specificDate",children:"Specific Date"}),Object(oa.jsx)(rr,{value:"customRange",children:"Custom Range"})]}),"customRange"===o&&Object(oa.jsx)(sr,{style:{marginTop:16},onChange:function(e){if(e){var t=e[0].valueOf(),n=e[1].valueOf();v([t,n]),O(t,n,"customRange")}else v(null)},format:"YYYY-MM-DD",disabledTime:function(){return{}},showTime:!1}),"specificDate"===o&&Object(oa.jsx)(Jn.a,{style:{marginTop:16},onChange:function(e){if(e){p(e);var t=H()(e).startOf("day").valueOf(),n=H()(e).endOf("day").valueOf();O(t,n,"specificDate")}else p(null)},format:"YYYY-MM-DD"})]})},jr=function(e){var t=e.socket,n=e.filter,c=e.selected,o=e.componentUuid,l=e.toggleMap,r=Object(s.c)(function(e){return e.auth}),v=r.userRequests,b=r.projects,j=r.selectedPage,p=r.encrypted_token,O=r.searchByPhone,f=r.adminUserRoles,h=(r.accounts,Object(s.b)()),g=Object(a.useState)("project"),x=Object(u.a)(g,2),y=x[0],I=x[1],S=Object(a.useState)("state"),N=Object(u.a)(S,2),k=N[0],w=N[1],E=Object(a.useState)(!1),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(void 0),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(void 0),F=Object(u.a)(q,2),B=F[0],_=F[1],$=Object(a.useState)(!1),Y=Object(u.a)($,2),V=Y[0],Q=Y[1],G=Object(a.useState)(!1),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)(!1),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)([]),ie=Object(u.a)(ae,2),oe=ie[0],le=ie[1],se=Object(a.useState)([]),re=Object(u.a)(se,2),de=re[0],ue=re[1],ve=Object(a.useState)([]),be=Object(u.a)(ve,2),je=(be[0],be[1]),me=Object(a.useState)([]),pe=Object(u.a)(me,2),Oe=(pe[0],pe[1]),fe=Object(a.useRef)(W()),he=Object(a.useRef)(void 0),ge=Object(a.useRef)(void 0),xe=Object(a.useRef)(0),ye=Object(a.useRef)(void 0),Ie=Object(a.useRef)(!1),Se=Object(a.useRef)(void 0),Ne=Object(a.useRef)(void 0),ke=Object(a.useRef)([]),Te=Object(a.useRef)([]),Ce=Object(a.useState)(),we=Object(u.a)(Ce,2),Ee=we[0],Re=we[1],Pe=Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0}),De=Object(u.a)(Pe,2),Ae=De[0],Ue=De[1],qe=Object(a.useState)(0),Fe=Object(u.a)(qe,2),_e=Fe[0],$e=Fe[1],Ye=Object(a.useState)([]),He=Object(u.a)(Ye,2),We=He[0],Ve=He[1],ze=Object(a.useRef)(void 0),Qe=Object(a.useRef)(!1),Ge=Object(a.useRef)(void 0),Je=Object(a.useState)([]),Ke=Object(u.a)(Je,2),Ze=Ke[0],Xe=Ke[1],et=Object(a.useState)(!1),nt=Object(u.a)(et,2),at=nt[0],it=nt[1],ct=Object(a.useState)(!1),ot=Object(u.a)(ct,2),lt=(ot[0],ot[1],Object(a.useState)([])),st=Object(u.a)(lt,2),rt=(st[0],st[1]),dt=Object(a.useState)(void 0),ut=Object(u.a)(dt,2),vt=ut[0],bt=ut[1],jt=Object(a.useRef)({project:void 0,user:void 0,area:void 0,time:void 0,name:void 0}),mt=Object(a.useRef)({status:void 0,time:void 0,phone:void 0}),pt=Object(a.useRef)({}),Ot=Object(a.useRef)(),ft=Object(a.useRef)([]),ht=Object(a.useState)(void 0),gt=Object(u.a)(ht,2),xt=gt[0],yt=gt[1],It=Object(a.useState)(["First string","Second string","Third string"]),St=Object(u.a)(It,2),Nt=(St[0],St[1]),kt=Object(a.useState)(""),Tt=Object(u.a)(kt,2),Ct=(Tt[0],Tt[1]),wt=Object(a.useState)(""),Et=Object(u.a)(wt,2),Rt=Et[0],Pt=Et[1],Dt=Object(a.useState)("last24hours"),At=Object(u.a)(Dt,2),Mt=At[0],Lt=At[1],Ut=Object(a.useCallback)(Object(Ac.a)(2e3,function(){console.log("debounce"),Wt()},{atBegin:!0}),[]),qt=Object(a.useCallback)(function(e){var t,n,a;null!==(t=pt.current)&&void 0!==t&&t[e]||(pt.current[e]=Object(Ac.a)(2e3,function(e){console.log("search page here",e),Ht(e)},{atBegin:!1})),null===(n=pt.current)||void 0===n||null===(a=n[e])||void 0===a||a.call(n,e)},[]),Ft=function(e){mt.current.status=e?"@rideStatus:{".concat(ur[e],"}"):void 0,mt.current.phone=void 0,Q(!0),ye.current=e,bt(e),Gt()};Object(a.useEffect)(function(){var e;O&&(e=null===O||void 0===O?void 0:O.phone,jt.current.name=e&&""!==e?"exists(@patientPhoneNumber) && contains(@patientPhoneNumber, '".concat(e,"')"):void 0,Q(!0),Gt())},[O]);var Bt=function(e){var t;if(y!==e&&null!==b&&void 0!==b&&b.projects&&f){U(void 0),le([]);switch(e){case"project":var n=[];null===b||void 0===b||null===(t=b.projects)||void 0===t||t.map(function(e){n.push({label:e.name,value:e.id})}),le(n);break;case"vehicle":var a,i=[];null===b||void 0===b||null===(a=b.projects)||void 0===a||a.filter(function(e){return"vehicle"===(null===e||void 0===e?void 0:e.type)}).map(function(e){i.push({label:e.name,value:e.id})}),le(i);break;case"manager":$t(f,"manager");break;case"dispatcher":$t(f,"dispatcher");break;case"responder":$t(f,"responder")}I(e)}},_t=function(e){k!==e&&(_(void 0),ue([]),Yt(e),w(e))},$t=function(e,n){var a;switch(n){case"dispatcher":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")});break;case"responder":a=e.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")});break;case"manager":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")})}var i=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),c={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(i.join("||"),")")},anyStatus:!1};console.log("userRequest",c),t.publishToEvent(m.PublishPageTopics,xn(null===p||void 0===p?void 0:p.connectionId),Dn(c,"".concat(fe.current,":").concat(n))),D(!0)},Yt=function(e){Z(!0);var t={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===p||void 0===p?void 0:p.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(T.a)({},e,"$.persistent.static.profile.".concat(e))},groupBy:{properties:["@".concat(e)],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:""}};h(tt({requestData:t,callback:function(e){Z(!1);var t=[];null===e||void 0===e||e.map(function(e){e[Object.keys(e)[0]]&&t.push({label:e[Object.keys(e)[0]],value:e[Object.keys(e)[0]]})}),ue(t)}}))},Ht=function(e){var t;if("string"===typeof e){var n={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===(t=Ot.current)||void 0===t?void 0:t.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},list:{objectIds:[e]},load:{persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId"}},filter:{expression:""}};h(tt({requestData:n,callback:function(e){Re(null===e||void 0===e?void 0:e[0])}}))}},Wt=function(){var e,t=[],n="";if(mt.current.time)n+=mt.current.time;else{var a=new Date;a.setHours(0),a.setMinutes(1),n+="@createdAt:[".concat(a.getTime(),",+inf]")}jt.current&&Object.keys(jt.current).map(function(e){var n,a;null!==(n=jt.current)&&void 0!==n&&n[e]&&t.push(null===(a=jt.current)||void 0===a?void 0:a[e])});var i={};ft.current&&ft.current.map(function(e){i[e.key]=e.value});var c={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{'".concat(null===Ot||void 0===Ot||null===(e=Ot.current)||void 0===e?void 0:e.userId,"'}").concat(Ie.current?"":"(-@rideType:{hail})","@pageType:{event}").concat(n),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",rideType:"$..profile.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",projectId:"$..profile.projectId",createdAt:"$.persistent.static.metadata.createdAt",status:"$.nonpersistent.static.live.status.name",vehicleProjectId:"$..profile.vehicle..projectId",patientFullName:"$..profile.patientFullName",patientPhoneNumber:"$..profile.patientPhoneNumber",customerId:"$..profile.customerId",staffId:"$..profile.staffId"},k,"$..profile.".concat(k)),i)},groupBy:{properties:["@status"],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:t.join("&&")}};h(tt({requestData:c,callback:function(e){var t=0,n={amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0};e.map(function(e){n[e.status]=e.count,t+=e.count}),Ue(Object(d.a)({all:t,live:t},n))}}))};Object(a.useEffect)(function(){Ae&&$e(_e+1)},[JSON.stringify(Ae)]),Object(a.useEffect)(function(){if(Ee){var e,t,n,a,i,c,o,l,s,r,u,v,j,m,p,O,f,h,g,x,y,I,S,N,k,T,w,E,R,P,D,A,M,L,U,q,F,B,_,$,Y,W,V,z,Q,G,J,K,Z=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===Ee||void 0===Ee||null===(e=Ee.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.profile)||{}),(null===Ee||void 0===Ee||null===(n=Ee.persistent)||void 0===n||null===(a=n.static)||void 0===a?void 0:a.dashboard)||{}),(null===Ee||void 0===Ee||null===(i=Ee.persistent)||void 0===i||null===(c=i.static)||void 0===c?void 0:c.ride)||{}),(null===Ee||void 0===Ee||null===(o=Ee.persistent)||void 0===o||null===(l=o.dynamic)||void 0===l?void 0:l.ride)||{}),X=null===Ee||void 0===Ee||null===(s=Ee.nonpersistent)||void 0===s||null===(r=s.static)||void 0===r||null===(u=r.live)||void 0===u||null===(v=u.status)||void 0===v?void 0:v.name,ee=null===Ee||void 0===Ee||null===(j=Ee.persistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.profile)||void 0===p?void 0:p.type,te=null===Ee||void 0===Ee||null===(O=Ee.persistent)||void 0===O||null===(f=O.static)||void 0===f||null===(h=f.metadata)||void 0===h?void 0:h.type;if(!Ie.current&&"hail"===ee||"event"!==te)return;var ne=Object(C.a)(We),ae=ne.findIndex(function(e){return e.key===Ee.pageId});if(Ut(),ye.current&&ye.current!==X)return void(-1!==ae&&(ne.splice(ae,1),Ve(ne),ze.current=ne));var ie={};Object.keys(Z).map(function(e){"string"===typeof Z[e]&&(ie[e]=Z[e])});var ce,oe,le,se,re,de=(null===(g=Ge.current)||void 0===g||null===(x=g.find(function(e){var t,n,a;return e.id===(null===Ee||void 0===Ee||null===(t=Ee.nonpersistent)||void 0===t||null===(n=t.dynamic)||void 0===n||null===(a=n.ride)||void 0===a?void 0:a.dispatchRequestBy)}))||void 0===x?void 0:x.beamId)||"",ue=(null===(y=Ge.current)||void 0===y||null===(I=y.find(function(e){var t,n,a,i;return e.id===(null===(t=Object.keys((null===Ee||void 0===Ee||null===(n=Ee.nonpersistent)||void 0===n||null===(a=n.dynamic)||void 0===a||null===(i=a.ride)||void 0===i?void 0:i.manualUsers)||{}))||void 0===t?void 0:t[0])||""}))||void 0===I?void 0:I.beamId)||"";if(null===(S=Object.keys((null===Ee||void 0===Ee||null===(N=Ee.persistent)||void 0===N||null===(k=N.static)||void 0===k||null===(T=k.payment)||void 0===T?void 0:T.stripe)||{}))||void 0===S||S.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Ee||void 0===Ee||null===(t=Ee.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"succeeded"===(null===Ee||void 0===Ee||null===(o=Ee.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(ce=null===Ee||void 0===Ee||null===(u=Ee.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])}),!ce)null===(oe=Object.keys((null===Ee||void 0===Ee||null===(le=Ee.persistent)||void 0===le||null===(se=le.static)||void 0===se||null===(re=se.payment)||void 0===re?void 0:re.stripe)||{}))||void 0===oe||oe.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Ee||void 0===Ee||null===(t=Ee.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"requires_capture"===(null===Ee||void 0===Ee||null===(o=Ee.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(ce=null===Ee||void 0===Ee||null===(u=Ee.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])});var ve,be,je=Object(d.a)(Object(d.a)({key:Ee.pageId,pageStatus:null===Ee||void 0===Ee||null===(w=Ee.nonpersistent)||void 0===w||null===(E=w.static)||void 0===E||null===(R=E.live)||void 0===R||null===(P=R.status)||void 0===P?void 0:P.name,requestedBy:de,requestedAt:new Date(null===Ee||void 0===Ee||null===(D=Ee.persistent)||void 0===D||null===(A=D.static)||void 0===A||null===(M=A.metadata)||void 0===M?void 0:M.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:ue,name:null===Ee||void 0===Ee||null===(L=Ee.persistent)||void 0===L||null===(U=L.static)||void 0===U||null===(q=U.metadata)||void 0===q?void 0:q.title,action:{pageId:Ee.pageId,page:Object(d.a)(Object(d.a)({},Ee),{},{profile:Z}),summary:ie.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId,stripe:ce}},ie),{},{address:null!==ie&&void 0!==ie&&ie.address&&""!==(null===ie||void 0===ie?void 0:ie.adress)?null===ie||void 0===ie?void 0:ie.address:null===Z||void 0===Z||null===(F=Z.pickupLocation)||void 0===F||null===(B=F.attributes)||void 0===B?void 0:B.address,dropoffAddress:null!==ie&&void 0!==ie&&ie.dropoffAddress&&""!==(null===ie||void 0===ie?void 0:ie.dropoffAddress)?null===ie||void 0===ie?void 0:ie.dropoffAddress:null===Z||void 0===Z||null===(_=Z.dropoffLocation)||void 0===_||null===($=_.attributes)||void 0===$?void 0:$.address,driverName:null===Z||void 0===Z||null===(Y=Z.primaryResponder)||void 0===Y?void 0:Y.name,driverId:null===Z||void 0===Z||null===(W=Z.primaryResponder)||void 0===W||null===(V=W.id)||void 0===V?void 0:V.toString(),vehicleName:null===Z||void 0===Z||null===(z=Z.vehicle)||void 0===z||null===(Q=z.obj)||void 0===Q?void 0:Q.name,description:(null===Z||void 0===Z||null===(G=Z.customMessages)||void 0===G||null===(J=G[0])||void 0===J||null===(K=J.attributes)||void 0===K?void 0:K.body)||"N/A"});if(-1!==ae)ne[ae]=Object(d.a)(Object(d.a)({},je),{},{invited:null===ze||void 0===ze||null===(ve=ze.current)||void 0===ve||null===(be=ve[ae])||void 0===be?void 0:be.invited});else ne.unshift(je);Oe(null===ne||void 0===ne?void 0:ne.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;return{lat:null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(i=a.static)||void 0===i||null===(c=i.live)||void 0===c||null===(o=c.location)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l.lat,lng:null===e||void 0===e||null===(s=e.action)||void 0===s||null===(r=s.page)||void 0===r||null===(d=r.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.location)||void 0===b?void 0:b.coordinates.long,title:null===e||void 0===e||null===(j=e.action)||void 0===j||null===(m=j.page)||void 0===m||null===(p=m.persistent)||void 0===p||null===(O=p.static)||void 0===O||null===(f=O.metadata)||void 0===f?void 0:f.title}}));var me=Ne.current?H()(Ne.current).format("YYYY-MM-DD"):void 0,pe=me?[].concat(Object(C.a)(ne.filter(function(e){return!e.driverId}).map(function(e,t){return Object(d.a)({key:"unassigned-task-".concat(t),driverId:"",driverName:"",isShift:!1},e)})),Object(C.a)(Te.current.flatMap(function(e){var t,n=ne.filter(function(t){return t.driverId===e.id});if(0===n.length)return[];var a={key:"".concat(e.id,"-shift"),driverId:e.id,driverName:e.fullName,isShift:!0,timeSlots:(null===(t=ke.current.find(function(e){return e.key===me}))||void 0===t?void 0:t[e.id])||[]},i=n.map(function(t,n){return Object(d.a)({key:"".concat(e.id,"-task-").concat(n),isShift:!1},t)});return[a].concat(Object(C.a)(i))})),Object(C.a)(Te.current.filter(function(e){return 0===ne.filter(function(t){return t.driverId===e.id}).length}).map(function(e){var t;return{key:"".concat(e.id,"-shift"),driverId:e.id,driverName:e.fullName,isShift:!0,timeSlots:(null===(t=ke.current.find(function(e){return e.key===me}))||void 0===t?void 0:t[e.id])||[]}}))):ne;Ve(pe),ze.current=pe}},[Ee]);var Vt=[{label:"Pending",color:"purple"},{label:"Assigned",color:"amber"},{label:"Escalated",color:"red"},{label:"Completed",color:"green"},{label:"Cancelled",color:"black"}],zt=function(e){var t=Al.a.json_to_sheet(We),n=Al.a.book_new();Al.a.book_append_sheet(n,t,"Data"),Al.b(n,"table_data.".concat(e))},Qt=function(e){var t={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}@partitions:{type\\:shift}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status",startTimestamp:"$..startTimestamp",endTimestamp:"$..endTimestamp"}},filter:{expression:"exists(@startTimestamp) && exists(@endTimestamp) && @startTimestamp < ".concat(e," && @endTimestamp > ").concat(e)}};h(tt({requestData:t,callback:function(t){var n,a;console.log(" shift response here",t),ke.current=null===t||void 0===t||null===(n=t[0])||void 0===n||null===(a=n.info)||void 0===a?void 0:a.shift,Ne.current=e,Gt()}}))},Gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=[],a="",i="";if("advance"===c)ye.current="brown",n.push("exists(@status) && @status === 'brown'");else if("dispatch"===c)ye.current="purple",n.push("exists(@status) && @status === 'purple'");else if(jt.current)if(Object.keys(jt.current).map(function(e){var t,a;null!==(t=jt.current)&&void 0!==t&&t[e]&&n.push(null===(a=jt.current)||void 0===a?void 0:a[e])}),mt.current.time||mt.current.phone)mt.current.time&&(a+=mt.current.time);else{var o=new Date;o.setHours(0),o.setMinutes(1),a+="@createdAt:[".concat(o.getTime(),",+inf]")}mt.current.status&&n.push("exists(@status) && @status === '".concat(ye.current,"'")),mt.current.phone&&(i=mt.current.phone);var l={};ft.current&&ft.current.map(function(e){l[e.key]=e.value}),xe.current=e;var s={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===p||void 0===p?void 0:p.userId,"}").concat(Ie.current?"":"(-@rideType:{hail})","@pageType:{event}").concat(a).concat("").concat(i),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",ride:"$.persistent.static.ride",type:"$..persistent.static.metadata.type",pageId:"$.objectId",projectId:"$..profile.projectId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",rideType:"$..profile.type",phone:"$..profile.studentPhone",patientFullName:"$..profile.patientFullName",patientPhoneNumber:"$..profile.patientPhoneNumber",customerId:"$..profile.customerId",staffId:"$..profile.staffId"},k,"$..profile.".concat(k)),l)},filter:{expression:n.join("&&")},sortBy:{properties:[{field:"@createdAt",order:"DESC"}],max:1e3},result:mt.current.phone?{pagination:{offset:e,limit:50}}:{}};h({type:Le}),h(tt({requestData:s,callback:function(n){console.log("resppnse",n),je(n),xe.current=xe.current+30;var a=e>0?Object(C.a)(We):[],i=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e,n){var a=Object(oa.jsx)(ti.a,{onClick:function(e){var a=e.key;!function(e,n){var a,i=(null===(a=Vt.find(function(e){return e.label===n}))||void 0===a?void 0:a.color)||"gray",c=[{op:"replace",path:"/nonpersistent/static/live/status",value:{name:i,color:vr[i]}}];Se.current=null===e||void 0===e?void 0:e.toString(),t.publishToEvent(m.PublishPageTopics,ln(null===p||void 0===p?void 0:p.connectionId),Dn({objectId:e.toString(),changes:c}))}(n.key,a)},items:Vt.map(function(e){return{label:e.label,key:e.label}})});return n.isShift?Object(oa.jsx)("div",{}):Object(oa.jsx)(ni.a,{overlay:a,trigger:["click"],children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})})}},{title:"Action",key:"action",dataIndex:"action",render:function(e,t){return t.isShift?Object(oa.jsx)("div",{}):Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Sl.a,{overlay:"Go to page chat",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){var t;t=null===e||void 0===e?void 0:e.pageId,h(ce({data:{payload:JSON.stringify({userId:null===p||void 0===p?void 0:p.userId,connectionId:null===p||void 0===p?void 0:p.connectionId,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId})},callback:function(e){window.open("".concat("https://live.staging.beam.live","/auth/login?token=").concat(e.encryptedPayload,"&redirect=page/").concat(t))}}))},children:Object(oa.jsx)(Zc.a,{})})})}),(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t;window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(null===p||void 0===p?void 0:p.connectionId,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:Object(oa.jsx)(Ec.a,{})})})]})}},{title:"Client id",key:"customerId",dataIndex:"customerId",sorter:function(e,t){var n;return null===(n=e.customerId)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.customerId)}},{title:"Client name",key:"name",dataIndex:"name",sorter:function(e,t){var n;return null===(n=e.name)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.name)}},{title:"Category",key:"categoryName",dataIndex:"categoryName",sorter:function(e,t){var n;return null===(n=e.categoryName)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.categoryName)}},{title:"Service",key:"projectName",dataIndex:"projectName",sorter:function(e,t){var n;return null===(n=e.categoryName)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.categoryName)}},{title:"Schedule Time",key:"scheduleTime",dataIndex:"scheduleTime",sorter:function(e,t){var n;return null===(n=e.pickupTime)||void 0===n?void 0:n.localeCompare(null===t||void 0===t?void 0:t.pickupTime)}},{title:"Schedule Date",key:"scheduleDate",dataIndex:"scheduleDate",sorter:function(e,t){return H()(e.date,"D MMM YYYY").valueOf()-H()(t.date,"D MMM YYYY").valueOf()}},{title:"Staff name",key:"staffName",dataIndex:"staffName"},{title:"Notes",key:"notes",dataIndex:"notes"}];null===n||void 0===n||n.map(function(e,t){var n,i,c,o,l,s,r,u,v,j,m,p,O,f,h,g=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),x={};Object.keys(g).map(function(e){"string"===typeof g[e]&&(x[e]=g[e])});var y,I,S=Ge.current||JSON.parse(localStorage.getItem("rideUsers")||"[]"),N=(null===S||void 0===S||null===(n=S.find(function(t){var n;return t.id===(null===e||void 0===e||null===(n=e.requestedBy)||void 0===n?void 0:n.toString())}))||void 0===n?void 0:n.beamId)||"",k=(null===S||void 0===S||null===(i=S.find(function(t){var n;return t.id===(null===(n=Object.keys((null===e||void 0===e?void 0:e.manualUsers)||{}))||void 0===n?void 0:n[0])||""}))||void 0===i?void 0:i.beamId)||"";(null===(c=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===c||c.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"succeeded"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(y=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}),y)||(null===(I=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===I||I.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"requires_capture"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(y=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}));a.push(Object(d.a)(Object(d.a)({pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:g}),summary:x.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId,stripe:y}},x),{},{address:null!==x&&void 0!==x&&x.address&&""!==(null===x||void 0===x?void 0:x.adress)?null===x||void 0===x?void 0:x.address:null===g||void 0===g||null===(o=g.pickupLocation)||void 0===o||null===(l=o.attributes)||void 0===l?void 0:l.address,dropoffAddress:null!==x&&void 0!==x&&x.dropoffAddress&&""!==(null===x||void 0===x?void 0:x.dropoffAddress)?null===x||void 0===x?void 0:x.dropoffAddress:null===g||void 0===g||null===(s=g.dropoffLocation)||void 0===s||null===(r=s.attributes)||void 0===r?void 0:r.address,invited:"",driverName:null===g||void 0===g||null===(u=g.primaryResponder)||void 0===u?void 0:u.name,driverId:null===g||void 0===g||null===(v=g.primaryResponder)||void 0===v||null===(j=v.id)||void 0===j?void 0:j.toString(),vehicleName:null===g||void 0===g||null===(m=g.vehicle)||void 0===m||null===(p=m.obj)||void 0===p?void 0:p.name,requestedBy:N,requestedAt:new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),description:(null===g||void 0===g||null===(O=g.customMessages)||void 0===O||null===(f=O[0])||void 0===f||null===(h=f.attributes)||void 0===h?void 0:h.body)||"N/A",assigned:k,key:e.pageId}))}),console.log("source data",a),a.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===i.findIndex(function(t){return t.key===e})&&t[e]})}),Xe(i);Ne.current&&H()(Ne.current).format("YYYY-MM-DD");console.log("detail data",a),Ve(a),ze.current=a;var c={};a.map(function(e){var t,n,a,i,o,l,s,r,u,v,b,j,m,p,O,f;null!==e&&void 0!==e&&null!==(t=e.action)&&void 0!==t&&null!==(n=t.page)&&void 0!==n&&null!==(a=n.profile)&&void 0!==a&&null!==(i=a.unstructuredAttributes)&&void 0!==i&&null!==(o=i.undefined)&&void 0!==o&&o.address&&(c[null===e||void 0===e?void 0:e.key]=Object(d.a)(Object(d.a)({},null===e||void 0===e||null===(l=e.action)||void 0===l||null===(s=l.page)||void 0===s||null===(r=s.profile)||void 0===r||null===(u=r.unstructuredAttributes)||void 0===u||null===(v=u.undefined)||void 0===v?void 0:v.address),{},{label:"".concat(null===e||void 0===e||null===(b=e.action)||void 0===b||null===(j=b.page)||void 0===j||null===(m=j.profile)||void 0===m?void 0:m.name," - ").concat(null===e||void 0===e||null===(p=e.action)||void 0===p||null===(O=p.page)||void 0===O||null===(f=O.profile)||void 0===f?void 0:f.projectName)}))}),h({type:Me,payload:c}),Oe(null===n||void 0===n?void 0:n.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),Q(!1),D(!1),Z(!1),ne(!1)}})),Ut()};return Object(a.useEffect)(function(){p&&(Ot.current=p,t.subscribeToEvent(m.SubscribePageTopics,Rn(null===p||void 0===p?void 0:p.userId),function(e){qt(null===e||void 0===e?void 0:e.data)},o),D(!0),rt(JSON.parse(localStorage.getItem("tableHideList"))||[]),t.subscribeToEvent(m.SubscribePageTopics,on(null===p||void 0===p?void 0:p.connectionId),function(e){Se.current&&Ht(Se.current)}))},[p]),Object(a.useEffect)(function(){f&&(null===f||void 0===f?void 0:f.length)>0&&!Qe.current&&(Qe.current=!0,Gt(),function(){var e="@serviceId:{'".concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}"),t=f.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")});console.log("selected user roles",t);var n=t.map(function(e){return"@roleId === '".concat(e._id,"'")}),a={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:e,searchOptions:"TIMEOUT 5000"},list:{objectIds:void 0},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(n.join("||"),")")},anyStatus:!1};h(tt({requestData:a,callback:function(e){var t=[];null===e||void 0===e||e.map(function(e,n){var a,i,c,o;t.push({id:e.id.toString(),fullName:"".concat(null===e||void 0===e||null===(a=e.live)||void 0===a||null===(i=a.profile)||void 0===i?void 0:i.firstName," ").concat(null===e||void 0===e||null===(c=e.live)||void 0===c||null===(o=c.profile)||void 0===o?void 0:o.lastName)})}),t=t.sort(function(e,t){return e.fullName.localeCompare(t.fullName)}),Te.current=t}}))}(),Yt("state"))},[f]),Object(a.useEffect)(function(){if(b){var e,n=[];null===b||void 0===b||null===(e=b.projects)||void 0===e||e.map(function(e){n.push({label:e.name,value:e.id})}),le(n),null!==b&&void 0!==b&&b.adminUserId&&(t.subscribeToEvent(m.SubscribePageTopics,bn(null===p||void 0===p?void 0:p.connectionId,null===b||void 0===b?void 0:b.userServiceId)),t.subscribeToEvent(m.SubscribePageTopics,yn(null===p||void 0===p?void 0:p.connectionId)))}},[b]),Object(a.useEffect)(function(){if(v&&t.client){var e,n;if(!Ge.current&&null!==v&&void 0!==v&&v[null===(e=Object.keys(v))||void 0===e?void 0:e[0]])Ge.current=null===v||void 0===v?void 0:v[null===(n=Object.keys(v))||void 0===n?void 0:n[0]],localStorage.setItem("rideUsers",JSON.stringify(Ge.current));if(null!==v&&void 0!==v&&v["".concat(fe.current,":").concat(y)]){var a;D(!1);var i=[];null===v||void 0===v||null===(a=v["".concat(fe.current,":").concat(y)])||void 0===a||a.map(function(e){i.push({label:"".concat(e.fullName,": ").concat(e.email),value:e.id})}),le(i)}}},[v,t.client]),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{gutter:30,className:"mb-2",style:at?{}:{display:"none"},children:[Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{gutter:16,className:"d-flex px-1 flex-wrap",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){Bt("project")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("project"===y?"green-btn cover":""),children:"Service"})}),Object(oa.jsx)("div",{onClick:function(){Bt("dispatcher")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("dispatcher"===y?"green-btn cover":""),children:"Staff"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:P,value:L,allowClear:!0,showSearch:!0,filterOption:function(e,t){var n;return null===(n=t.label)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},options:oe,onChange:function(e){!function(e){switch(U(e),y){case"project":jt.current.project=e?"exists(@projectId) && @projectId === '".concat(e,"'"):void 0,jt.current.user=void 0,D(!0);break;case"responder":case"dispatcher":jt.current.project=e?"exists(@staffId) && @staffId === '".concat(e,"'"):void 0,jt.current.user=void 0,D(!0)}Gt()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex px-2 flex-wrap mt-4",children:Object(oa.jsx)(Hn.a,{sm:24,md:4,children:Object(oa.jsx)("h5",{className:"mb-0",children:"Search"})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Wn.a,{placeholder:"Client Id",value:Rt,className:"lighthouse-input",allowClear:!0,onChange:function(e){var t=e.target.value;Pt(t),cr&&clearTimeout(cr),cr=setTimeout(function(){!function(e){jt.current.name=e&&""!==e?"exists(@customerId) && contains(@customerId, '".concat(e,"')"):void 0,Q(!0),Gt()}(t)},700)}})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{className:"d-flex flex-wrap",id:"filters",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){_t("state")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("state"===k?"green-btn cover":""),children:"Province"})}),Object(oa.jsx)("div",{onClick:function(){_t("city")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("city"===k?"green-btn cover":""),children:"City"})}),Object(oa.jsx)("div",{onClick:function(){_t("county")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("county"===k?"green-btn cover":""),children:"Municipality"})}),Object(oa.jsx)("div",{onClick:function(){_t("zip")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("zip"===k?"green-btn cover":""),children:"Postal Code"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{xs:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:K,allowClear:!0,options:de,value:B,onChange:function(e){!function(e){_(e),jt.current.time=e?"exists(@".concat(k,") && @").concat(k," === '").concat(e,"'"):void 0,Z(!0),Gt()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex flex-wrap mt-3 mx-0",children:Object(oa.jsx)(br,{onChange:function(e){console.log("value here",e),Lt(e.selected),function(e){if(he.current=e.startTimestamp,ge.current=e.endTimestamp,he.current&&ge.current){var t=new Date(he.current);t.setHours(0),t.setMinutes(1);var n=new Date(ge.current);n.setHours(23),n.setMinutes(59),mt.current.time="@createdAt:[".concat(t.getTime(),",+inf]@createdAt:[-inf, ").concat(n.getTime(),"]"),Z(!0),"specificDate"===e.selected?Qt(e.startTimestamp):(Ne.current=void 0,Gt())}else he.current||ge.current||(mt.current.time="",Z(!0),Ne.current=void 0,Gt())}(e)},value:Mt})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select Hour(s)",disabled:!0})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:4,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsx)("p",{className:"mb-2 text-center",children:"Export to"}),Object(oa.jsxs)("div",{className:"d-flex flex-row flex-md-column justify-content-center",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",onClick:function(){return zt("csv")},children:Object(oa.jsx)(fa.a,{src:"/images/export-csv.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",onClick:function(){return zt("xlsx")},children:Object(oa.jsx)(fa.a,{src:"/images/export-xls.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",onClick:function(){var e=new Ml.default,t=Ze.map(function(e){return e.title}),n=We.map(function(e){return Ze.map(function(t){return e[t.dataIndex]})});Ul()(e,{head:[t],body:n}),e.save("table_data.pdf")},children:Object(oa.jsx)(fa.a,{src:"/images/export-pdf.svg"})})})]})]})})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid"},children:Object(oa.jsxs)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:[n&&Object(oa.jsxs)(Yn.a,{className:"d-flex mb-2",children:[Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat(void 0===vt?"status-selected":""),onClick:function(){Ft(void 0)},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"All"}),Object(oa.jsx)("h4",{children:Ae.live})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("purple"===vt?"status-selected":""),onClick:function(){Ft("purple")},children:Object(oa.jsxs)("div",{className:"purple",children:[Object(oa.jsx)("span",{children:"Pending"}),Object(oa.jsx)("h4",{children:Ae.purple})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("amber"===vt?"status-selected":""),onClick:function(){Ft("amber")},children:Object(oa.jsxs)("div",{className:"amber",children:[Object(oa.jsx)("span",{children:"Assigned"}),Object(oa.jsx)("h4",{children:Ae.amber})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("red"===vt?"status-selected":""),onClick:function(){Ft("red")},children:Object(oa.jsxs)("div",{className:"red",children:[Object(oa.jsx)("span",{children:"Escalated"}),Object(oa.jsx)("h4",{children:Ae.red})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("green"===vt?"status-selected":""),onClick:function(){Ft("green")},children:Object(oa.jsxs)("div",{className:"green",children:[Object(oa.jsx)("span",{children:"Completed"}),Object(oa.jsx)("h4",{children:Ae.green})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("black"===vt?"status-selected":""),onClick:function(){Ft("black")},children:Object(oa.jsxs)("div",{className:"black",children:[Object(oa.jsx)("span",{children:"Cancelled"}),Object(oa.jsx)("h4",{children:Ae.black})]})}),Object(oa.jsx)(Sl.a,{overlay:"Toggle map",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0px 10px 0"},onClick:function(){l()},children:Object(oa.jsx)(fa.a,{src:"/images/map.svg"})})}),Object(oa.jsx)(Sl.a,{overlay:"Filter jobs",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0 10px 0"},onClick:function(){it(!at)},children:Object(oa.jsx)(Rc.a,{})})}),Object(oa.jsx)(Sl.a,{overlay:"Refresh table",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0px 10px 0"},loading:P||V,onClick:function(){D(!0),Gt()},children:!P&&!V&&Object(oa.jsx)(El.a,{})})}),Object(oa.jsx)(Sl.a,{overlay:"Reset filter",children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 10px 10px 0",padding:"0 12px "},loading:te,onClick:function(){jt.current={project:void 0,user:void 0,area:void 0,time:void 0,name:void 0},mt.current={status:void 0,time:void 0,phone:void 0},I("project"),w("state"),U(void 0),_(void 0),bt(void 0),ye.current=void 0,ne(!0),Ct(""),Pt(""),Lt("last24hours"),Ne.current=void 0,Gt()},children:!te&&Object(oa.jsx)(fa.a,{src:"/images/reload-icon.svg"})})})]}),Object(oa.jsx)(Xi.a,{dataSource:We,className:(null===We||void 0===We?void 0:We.length)>0?"":"table-empty",onRow:function(e){return{onDoubleClick:function(){var t,n,a,i,c,o,l;console.log("record here",e);var s={objectId:null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.pageId)||void 0===a?void 0:a.toString(),dashboard:!0,persistent:{static:{profile:{unstructuredAttributes:Object(d.a)({},null===e||void 0===e||null===(i=e.action)||void 0===i||null===(c=i.page)||void 0===c||null===(o=c.profile)||void 0===o?void 0:o.unstructuredAttributes)}}}};h({type:Be,payload:s}),h({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e||null===(l=e.action)||void 0===l?void 0:l.page}})},onClick:function(){}}},columns:Ze,onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)!==(null===j||void 0===j||null===(n=j.page)||void 0===n?void 0:n.pageId)||null!==j&&void 0!==j&&j.ignorePage?"":"row-selected"}})]})}),void 0!==xt&&Object(oa.jsx)(lr,{inputArray:We,visible:void 0!==xt,onSave:function(e){console.log("Updated Array:",e),Nt(e),yt(void 0)},onCancel:function(){return yt(void 0)},defaultIndex:xt,socket:t})]})};Object(pl.hb)("Mgo+DSMBaFt/QHRqVVhkVFpFdEBBXHxAd1p/VWJYdVt5flBPcDwsT3RfQF5jSn5bdkNhX3xbeH1UQA==;Mgo+DSMBPh8sVXJ0S0J+XE9AflRDX3xKf0x/TGpQb19xflBPallYVBYiSV9jS31TdUVrWXlcdndQT2FZVw==;ORg4AjUWIQA/Gnt2VVhkQlFacldJXGFWfVJpTGpQdk5xdV9DaVZUTWY/P1ZhSXxQdkZjUX9YcnJWQ2lfVEI=;MTI3OTc4NUAzMjMwMmUzNDJlMzBFYkNEeXZCNEppU3FkZkZNYks1V0loTzlaajdjLyttcStERE1Sc0VERlhzPQ==;MTI3OTc4NkAzMjMwMmUzNDJlMzBIdW4xM1NDVm5tcTB1Q2tEdk9NNkVsallXeE9mYU5xWTZXU2lwYkJzMjRzPQ==;NRAiBiAaIQQuGjN/V0Z+WE9EaFtKVmJLYVB3WmpQdldgdVRMZVVbQX9PIiBoS35RdUVgWXdednZTRWZcUkJw;MTI3OTc4OEAzMjMwMmUzNDJlMzBFRGJlZVhDZjJmRE1mYWNsRXZsTkQxeGNlOUtJOWFzU0RORVVhMHJzdFp3PQ==;MTI3OTc4OUAzMjMwMmUzNDJlMzBqNUw3TXlZWUhrTS9VenErVW1qbWgxUjg1R04rSEtYcTgveTRRT3Uvdkw4PQ==;Mgo+DSMBMAY9C3t2VVhkQlFacldJXGFWfVJpTGpQdk5xdV9DaVZUTWY/P1ZhSXxQdkZjUX9YcnJWQGFeVEI=;MTI3OTc5MUAzMjMwMmUzNDJlMzBIL3I3R0FkZU0vbG96eXRFbmhXeTRpZEdiblhEMFdMYi82R1RrUEZxTXFFPQ==;MTI3OTc5MkAzMjMwMmUzNDJlMzBZTlo1YlRXUXBLWnNYYjBaZGtTS2NicTQzbURmSCtybGFlS1psSU85emlRPQ==;MTI3OTc5M0AzMjMwMmUzNDJlMzBFRGJlZVhDZjJmRE1mYWNsRXZsTkQxeGNlOUtJOWFzU0RORVVhMHJzdFp3PQ==");var mr,pr=Gn.a.Option,Or=function(e){e.onClose;var t=e.adminRoles,n=e.onSubmitHandler,i=Object(a.useRef)(),c=Object(a.useRef)(!1),o=Object(l.g)().search,r=(Object(l.f)(),Object(s.c)(function(e){return e.auth.projects},function(e,t){return JSON.stringify(e)===JSON.stringify(t)})),d=Object(a.useRef)({}),u=function(e){var t,n;return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select project",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.project,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].project=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===r||void 0===r||null===(n=r.projects)||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(pr,{value:e.id,children:e.name})})})},v=function(e){var t,n=[{id:"immediate",name:"Immediate"},{id:"schedule",name:"Schedule"},{id:"deadline",name:"Deadline"}];return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select dispatch type",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.dispatchType,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].dispatchType=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===n||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(pr,{value:e.id,children:e.name})})})},b=function(e){var t;return Object(oa.jsx)(fl,{placeholder:"Select task",rowIndex:null===e||void 0===e?void 0:e.rowIndex,allProjects:d,value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.task,onChange:function(t){var n,a;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].task=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.task)||void 0===n||null===(a=n.id)||void 0===a?void 0:a.toString()},null===e||void 0===e?void 0:e.address)}})},j=function(e){var t;return Object(oa.jsx)("div",{className:"datetime-item",children:Object(oa.jsx)(di,{placeholder:"Select date",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.date,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].date=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)}})})},m=function(e){var t;return Object(oa.jsx)(gi,{name:"Select time",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.time,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].time=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)}})},p=function(e){var t;return Object(oa.jsx)(ai,{placeholder:"Select location",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.incidentLocation,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].incidentLocation=t}})},O=function(e){var n;return Object(oa.jsx)(fi,{placeholder:"Select responder",adminRoles:t,value:null===(n=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===n?void 0:n.responder,onChange:function(t){var n,a,i;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].responder=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.responders)||void 0===n||null===(a=n[0])||void 0===a||null===(i=a.id)||void 0===i?void 0:i.toString()},null===e||void 0===e?void 0:e.address)}})},f=function(e){var t;return Object(oa.jsx)(ji,{placeholder:"Select location",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.location,onChange:function(t){var n,a,i,c,o,l,s;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].location=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.asset)||void 0===n?void 0:n.name},null===e||void 0===e?void 0:e.address),null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(a=t.asset)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c[1]},Object(bl.b)(null===e||void 0===e?void 0:e.rowIndex,1)),null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(o=t.asset)||void 0===o||null===(l=o.location)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s[0]},Object(bl.b)(null===e||void 0===e?void 0:e.rowIndex,2))}})},h=function(){var e,t,n,a,i,c=new URLSearchParams(o).get("projectId"),l=c&&""!==c?(null===r||void 0===r||null===(e=r.sections)||void 0===e||null===(t=e[1])||void 0===t||null===(n=t[0])||void 0===n?void 0:n[c])||[]:null===r||void 0===r||null===(a=r.sections)||void 0===a||null===(i=a[0])||void 0===i?void 0:i[0],s=[{label:"title"},{label:"location-lat"},{label:"location-long"}];return l.forEach(function(e){e.Rows.forEach(function(e){e.Cols.forEach(function(e){s.push({label:e.name,type:e.type})})})}),s.push({label:"dispatchType",type:"dispatchType"}),s.push({label:"dispatchDate",type:"dispatchDate"}),s.push({label:"dispatchTime",type:"dispatchTime"}),s};return Object(oa.jsx)("div",{className:"control-pane",children:Object(oa.jsx)("div",{className:"control-section spreadsheet-control",children:Object(oa.jsx)(jl.a,{allowDelete:!1,allowOpen:!0,openUrl:"https://ej2services.syncfusion.com/production/web-services/api/spreadsheet/open",openComplete:function(){for(var e=i.current.sheets,t=function(){i.current.sheets[n].name,Object(bl.c)([0,0,e[n].usedRange.rowIndex,e[n].usedRange.colIndex]);var t=h(),a=Object(C.a)(Array(e[n].usedRange.rowIndex-1).keys());t.map(function(e,t){"project"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return u({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"dispatchType"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return v({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"responder"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return O({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"fixed-asset"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return f({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"task-picker"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return b({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"date"===(null===e||void 0===e?void 0:e.type)||"dispatchDate"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return j({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"time"===(null===e||void 0===e?void 0:e.type)||"dispatchTime"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return m({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"incident-location"===(null===e||void 0===e?void 0:e.type)&&a.map(function(e){i.current.updateRange({template:function(){return p({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})})}),setTimeout(function(){i.current.setRowsHeight(50),i.current.setColumnsWidth(150),c.current||(i.current.addFileMenuItems([{text:"Insert row",iconCss:"e-icons e-plus"}],"Open"),c.current=!0)},100)},n=0;n<e.length;n++)t()},allowSave:!0,saveUrl:"https://ej2services.syncfusion.com/production/web-services/api/spreadsheet/save",ref:function(e){i.current=e},created:function(){mr&&clearTimeout(mr),mr=setTimeout(function(){i.current.addFileMenuItems([{text:"Submit",iconCss:"e-icons e-save-2"}],"Open")},1e3)},fileMenuItemSelect:function(e){switch(e.item.text){case"Insert row":var t=h(),a=i.current.sheets[0].usedRange.rowIndex;i.current.insertRow(a),t.map(function(e,t){"project"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return u({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"dispatchType"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return v({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"responder"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return O({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"fixed-asset"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return f({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"task-picker"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return b({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"date"===(null===e||void 0===e?void 0:e.type)||"dispatchDate"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return j({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"time"===(null===e||void 0===e?void 0:e.type)||"dispatchTime"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return m({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"incident-location"===(null===e||void 0===e?void 0:e.type)&&i.current.updateRange({template:function(){return p({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)})}),setTimeout(function(){i.current.setRowsHeight(53),i.current.setColumnsWidth(150)},100);break;case"Submit":i.current.saveAsJson().then(function(e){var t,a,i,c,o,l=[];console.log("save",e,d);var s=null!==(t=null===e||void 0===e||null===(a=e.jsonObject)||void 0===a||null===(i=a.Workbook)||void 0===i||null===(c=i.sheets)||void 0===c||null===(o=c[0])||void 0===o?void 0:o.rows)&&void 0!==t?t:[],r=h();Object.keys(d.current).map(function(e){var t,n=null===s||void 0===s||null===(t=s[e])||void 0===t?void 0:t.cells,a={};r.map(function(t,i){var c,o,l;if(a[t.label]=null===n||void 0===n||null===(c=n[i])||void 0===c?void 0:c.value,"project"===t.type)a[t.label]=null===(o=d.current)||void 0===o||null===(l=o[e])||void 0===l?void 0:l.project;else if("fixed-asset"===t.type){var s,r;a[t.label]=null===(s=d.current)||void 0===s||null===(r=s[e])||void 0===r?void 0:r.location}else if("responder"===t.type){var u,v;a[t.label]=null===(u=d.current)||void 0===u||null===(v=u[e])||void 0===v?void 0:v.responder}else if("task-picker"===t.type){var b,j;a[t.label]=null===(b=d.current)||void 0===b||null===(j=b[e])||void 0===j?void 0:j.task}else if("date"===t.type){var m,p;a[t.label]=null===(m=d.current)||void 0===m||null===(p=m[e])||void 0===p?void 0:p.date}else if("time"===t.type){var O,f;a[t.label]=null===(O=d.current)||void 0===O||null===(f=O[e])||void 0===f?void 0:f.time}else if("incident-location"===t.type){var h,g;a[t.label]=null===(h=d.current)||void 0===h||null===(g=h[e])||void 0===g?void 0:g.incidentLocation}else if("dispatchType"===t.type){var x,y,I,S,N,k;a.dispatch={value:null===(x=d.current)||void 0===x||null===(y=x[e])||void 0===y?void 0:y.dispatchType,type:"dispatchType",date:null===(I=d.current)||void 0===I||null===(S=I[e])||void 0===S?void 0:S.date,time:null===(N=d.current)||void 0===N||null===(k=N[e])||void 0===k?void 0:k.time}}}),delete a.dispatchDate,delete a.dispatchTime,delete a.dispatchType,l.push(a)}),l.map(function(e){var t=n(e);return console.log("submit",t),t})})}},children:Object(oa.jsx)(ml.b,{children:Object(oa.jsx)(ml.a,{name:"Event form",rowCount:40,colCount:30,showGridLines:!0})})})})})},fr=(Gn.a.Option,function(e){var t=e.onClose,n=e.adminRoles,i=e.onSubmitHandler,c=Object(a.useState)(!0),o=Object(u.a)(c,2),r=o[0],d=o[1],v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=(b[0],b[1]),m=Object(a.useState)(),p=Object(u.a)(m,2),O=p[0],f=(p[1],Object(a.useState)()),h=Object(u.a)(f,2),g=(h[0],h[1],Object(s.c)(function(e){return e.auth})),x=g.projects,y=g.csvToSend,I=(Object(s.c)(function(e){return e.auth}).userBds,Object(a.useState)()),S=Object(u.a)(I,2),N=S[0],k=(S[1],Object(l.g)().search),T=Object(s.b)();return Object(a.useEffect)(function(){j(!1)},[y]),Object(oa.jsx)($n.a,{title:"Bulk creator",visible:r,onOk:function(){var e=new URLSearchParams(k).get("userId"),t={};null===x||void 0===x||x.sections.forEach(function(e){return e.Rows.forEach(function(e){e.Cols.forEach(function(e){"location"===(null===e||void 0===e?void 0:e.type)||null!==e&&void 0!==e&&e.type.includes("location")?(t["".concat(null===e||void 0===e?void 0:e.name,"-lat")]="",t["".concat(null===e||void 0===e?void 0:e.name,"-long")]=""):t[null===e||void 0===e?void 0:e.name]=""})})});var n=new FormData;n.append("file",O),n.append("projectId",JSON.stringify(N)),n.append("dispatcherUserId",JSON.stringify(e)),n.append("isExecute",JSON.stringify(!0)),n.append("adminUser",JSON.stringify({cudbServiceId:null===x||void 0===x?void 0:x.userServiceId})),n.append("basicFieldsName",JSON.stringify({title:"","location-lat":"","location-long":""})),n.append("extendedFieldsName",JSON.stringify(t)),T(Ie({form:n})),j(!0)},onCancel:function(){d(!1),t&&t()},width:"1000px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsx)(Or,{adminRoles:n,onSubmitHandler:i})})}),hr=(Za.a.Panel,function(e){var t=e.onClose,n=e.handleConfirm,i=e.message,c=Object(a.useState)(!0),o=Object(u.a)(c,2),l=o[0],s=o[1],r=ei.a.useForm(),d=Object(u.a)(r,1)[0],v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=b[0],m=b[1],p=function(){s(!1),t&&t()};return Object(oa.jsx)($n.a,{title:"Please Confirm",visible:l,onCancel:p,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"confirmation-form",id:"confirmation-form",layout:"vertical",form:d,requiredMark:!1,children:[Object(oa.jsx)(ei.a.Item,{name:"password",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(Jc.a,{children:i||"Are you sure you want to continue?"})}),Object(oa.jsx)(ei.a.Item,{className:"action-grp mt-4",children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{loading:j,className:"beam-btn green-btn cover w-full",onClick:function(){m(!0),n()},children:"Confirm"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:p,children:"Cancel"})})]})})]})})});gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var gr=Za.a.Panel,xr=function(e){var t=e.socket,n=e.params,c=e.date,o=e.onEventCreated,r=e.selectedCustomerId,v=e.selectedProjectId,b=ei.a.useForm(),j=Object(u.a)(b,1)[0],p=Object(a.useState)(""),O=Object(u.a)(p,2),f=O[0],h=O[1],g=n.screens,x=n.setScreens,I=Object(l.g)().search,N=Object(l.f)(),k=Object(s.c)(function(e){return e.auth}),w=k.messages,E=k.encrypted_token,R=k.page,P=Object(s.c)(function(e){return e.auth.projects},function(e,t){return JSON.stringify(e)===JSON.stringify(t)}),D=Object(s.b)(),A=Mn(),M=A.getUserRequestPayload,L=A.handleMessages,U=Object(a.useState)(),q=Object(u.a)(U,2),F=q[0],B=q[1],_=Object(s.c)(function(e){return e.auth.selectedResponders},function(e,t){return JSON.stringify(e)===JSON.stringify(t)}),Y=Object(s.c)(function(e){return e.auth.submitted},function(e,t){return JSON.stringify(e)===JSON.stringify(t)}),V=Object(a.useState)(!1),z=Object(u.a)(V,2),G=z[0],J=z[1],K=Object(a.useState)(),Z=Object(u.a)(K,2),ee=Z[0],te=Z[1],ne=Object(a.useState)(!1),ae=Object(u.a)(ne,2),ie=ae[0],ce=ae[1],oe=Object(a.useState)(),le=Object(u.a)(oe,2),se=le[0],re=le[1],de=Object(a.useState)([]),ue=Object(u.a)(de,2),ve=ue[0],be=ue[1],je=Object(a.useState)([]),me=Object(u.a)(je,2),pe=me[0],Oe=me[1],fe=Object(a.useState)({what:[],account:[],where:[],who:[],when:[],why:[]}),he=Object(u.a)(fe,2),ge=he[0],xe=(he[1],Object(a.useState)([])),ye=Object(u.a)(xe,2),Ie=ye[0],Se=ye[1],Ne={what:"/images/pause-icon.svg",account:"/images/account-icon.svg",where:"/images/geo-icon.svg",who:"/images/user1-icon.svg",when:"/images/clock.svg",why:"/images/why.svg"},ke=Object(a.useState)(!1),Te=Object(u.a)(ke,2),Ce=Te[0],we=Te[1],Ee=Object(a.useState)(),Re=Object(u.a)(Ee,2),Me=Re[0],Le=Re[1],Ue=Object(a.useState)(),qe=Object(u.a)(Ue,2),Fe=qe[0],Be=(qe[1],Object(a.useRef)(null)),_e=Object(a.useRef)([]),$e=function(e){var n,a,i,c;we(!1);var o=null===E||void 0===E?void 0:E.userId,l=null===E||void 0===E?void 0:E.connectionId,s=v||(null===E||void 0===E?void 0:E.projectId);null!==Ie&&void 0!==Ie&&Ie.value.length&&(e[void 0][null===Ie||void 0===Ie?void 0:Ie.itemName[1]]=null===Ie||void 0===Ie?void 0:Ie.value);var r=Object(d.a)({},e);console.log("values",e),e[void 0]&&delete(e=Object(d.a)(Object(d.a)({},e[void 0]),e))[void 0];var u={},b={},j=1;Object.keys(e).map(function(t){var n,a=e[t];if(t.includes("-")){var i=t.split("-");null!==b&&void 0!==b&&b[null===i||void 0===i?void 0:i[0]]||(b[i[0]]=j,j++),t="".concat(b[i[0]],"-").concat(null===i||void 0===i?void 0:i[1])}var c=X(t,t,a,[].concat(Object(C.a)(ve),Object(C.a)(pe)),ge,null!==Ie&&void 0!==Ie&&null!==(n=Ie.value)&&void 0!==n&&n.length?S.Service:"");Array.isArray(c)?null===c||void 0===c||c.map(function(e){$.a.merge(u,e)}):$.a.merge(u,c)});var p=Object.keys(u).find(function(e){var t;return"project"===(null===u||void 0===u||null===(t=u[e])||void 0===t?void 0:t.type)}),O=s&&""!==s?s:null===(n=u[p])||void 0===n?void 0:n.id,f=null===P||void 0===P||null===(a=P.projects)||void 0===a?void 0:a.find(function(e){return e.id===O}),g=Object(d.a)(Object(d.a)({},u),{},Object(T.a)({projectName:null===f||void 0===f?void 0:f.name},p||"incidentType",{id:null===f||void 0===f?void 0:f.id,type:"project"})),x=_.map(function(e){return{id:e.id,beamId:e.title}}),y=Object.values(g).find(function(e){return"responder"===(null===e||void 0===e?void 0:e.type)});y&&(x=[].concat(Object(C.a)(x),[y]));var I,N="Lighthouse Beloved Community CLT Financial Application"===Me?null===g||void 0===g?void 0:g["1.applicantName"]:(new Date).toLocaleString(),k=!0,w=(new Date).getTime();Object.keys(g).map(function(e){var t,n,a,i,c,o;"media"===(null===g||void 0===g||null===(t=g[e])||void 0===t?void 0:t.type)&&(null===g||void 0===g||null===(i=g[e])||void 0===i||null===(c=i.files)||void 0===c||c.map(function(t,n){g["".concat(n+1,".").concat(e)]=Object(d.a)(Object(d.a)({},t),{},{type:"media"})}),delete g[e]);"task"===(null===g||void 0===g||null===(n=g[e])||void 0===n?void 0:n.type)&&(I=null===g||void 0===g||null===(o=g[e])||void 0===o?void 0:o.tasks,null===g||void 0===g||delete g[e]);if("dispatchType"===(null===g||void 0===g||null===(a=g[e])||void 0===a?void 0:a.type)){var l,s,r,u,v,b,j;if("schedule"===(null===g||void 0===g||null===(l=g[e])||void 0===l?void 0:l.value)){var m,p,O,f,h,x,y,S,T;g.scheduleDate=null===g||void 0===g||null===(m=g[e])||void 0===m?void 0:m.date,g.scheduleTime=null===g||void 0===g||null===(p=g[e])||void 0===p?void 0:p.time;var C=Object.keys(g).find(function(e){var t;return"incident-location"===(null===g||void 0===g||null===(t=g[e])||void 0===t?void 0:t.type)}),E="";Object.keys(g).map(function(e){"string"===typeof g[e]&&(E+="".concat(Q(e),": ").concat(g[e],"\n"))});var R,P=new Date(null===g||void 0===g||null===(O=g[e])||void 0===O?void 0:O.dateTimestamp),D=new Date(null===g||void 0===g||null===(f=g[e])||void 0===f?void 0:f.timeTimestamp);if(P.setHours(D.getHours()),P.setMinutes(D.getMinutes()),w=P.getTime(),g.notify)g.notify.utcDateTime=new Date(P.getTime()).toUTCString(),null!==g&&void 0!==g&&null!==(R=g.notify)&&void 0!==R&&R.customTime&&(g.notify.notifyTime=g.notify.customTime.toString());g.eventSchedule={type:"event",dateTime:P.getTime(),description:E,location:null!==(h=g[C])&&void 0!==h&&h.coordinates?{attributes:null===(x=g[C])||void 0===x?void 0:x.attributes,coordinates:null===(y=g[C])||void 0===y?void 0:y.coordinates}:void 0,repeat:!1,notifyTime:g.notify?new Date(P.getTime()-6e4*(null===g||void 0===g||null===(S=g.notify)||void 0===S?void 0:S.notifyTime)).getTime():void 0,notifyVia:null===g||void 0===g||null===(T=g.notify)||void 0===T?void 0:T.notifyVia,title:N},k=!1}else delete g.notify;if("deadline"===(null===g||void 0===g||null===(s=g[e])||void 0===s?void 0:s.value))g.deadlineDate=null===g||void 0===g||null===(r=g[e])||void 0===r?void 0:r.date,g.deadlineTime=null===g||void 0===g||null===(u=g[e])||void 0===u?void 0:u.time,g.deadlineRSVP={type:"rsvp",subType:"calendar",rsvpTitle:"Schedule visit before ".concat(null===g||void 0===g||null===(v=g[e])||void 0===v?void 0:v.date," ").concat(null===g||void 0===g||null===(b=g[e])||void 0===b?void 0:b.time," deadline"),startDate:(new Date).getTime(),endDate:new Date(null===g||void 0===g||null===(j=g[e])||void 0===j?void 0:j.date).getTime()},k=!1;null===g||void 0===g||delete g[e]}}),console.log("sorted attributes",g),h(void 0),J(!0),_e.current=[],I&&I.length>0?I.map(function(e){var t,n,a,i,c,s,u,v,b,j="taskEventLocation";Object.keys(g).map(function(e){var t;"incident-location"===(null===g||void 0===g||null===(t=g[e])||void 0===t?void 0:t.type)&&(j=e)}),"manual"!==e.locationType&&"lbs"!==e.locationType||null===(t=e.location)||void 0===t||null===(n=t.coordinates)||void 0===n||!n.lat||0===(null===(a=e.location)||void 0===a||null===(i=a.coordinates)||void 0===i?void 0:i.lat)||(g[j]=Object(d.a)({type:"incident-location"},e.location)),_e.current.push({userId:o,attributes:Object(d.a)(Object(d.a)({taskName:e.name,taskDescription:e.description,taskDate:e.dateTime?null===(c=H()(e.dateTime))||void 0===c?void 0:c.format("MM/DD/YYYY"):void 0,taskTime:e.dateTime?null===(s=H()(e.dateTime))||void 0===s?void 0:s.format("hh:mm A"):void 0,taskEvent:e.dateTime?{type:"event",dateTime:new Date(e.dateTime).getTime(),description:e.description,location:null!==(u=g[j])&&void 0!==u&&u.coordinates?{attributes:null===(v=g[j])||void 0===v?void 0:v.attributes,coordinates:null===(b=g[j])||void 0===b?void 0:b.coordinates}:void 0,repeat:!1,title:e.name}:void 0},g),{},{shareCustomerLink:!0}),responders:x,assets:[],connectionId:l,pageId:void 0,submitted:!0,unstructuredAttributes:r,title:N,invitation:k,assistPageId:se,createdAt:w,cudbServiceId:null===E||void 0===E?void 0:E.cudbServiceId,url:window.location.href})}):null!==Ie&&void 0!==Ie&&null!==(i=Ie.value)&&void 0!==i&&i.length?null===Ie||void 0===Ie||Ie.value.map(function(e){var t;null===e||void 0===e||null===(t=e.services)||void 0===t||t.map(function(t,n){var a="";Object.keys(t).map(function(e){"string"===typeof t[e]&&(a+="".concat(Q(e),": ").concat(t[e],"\n"))});var i=Object(d.a)(Object(d.a)({},e),{},{services:[Object(d.a)({},t)]}),c=Object(d.a)(Object(d.a)({},e),t);null===c||void 0===c||delete c.services,_e.current.push({userId:o,attributes:Object(d.a)(Object(d.a)(Object(d.a)({serviceEvent:t.scheduleDate?{type:"event",dateTime:H()("".concat(t.scheduleDate," ").concat(t.scheduleTime),"YYYY-MM-DD HH:mm").valueOf(),description:a,repeat:!1,title:"".concat(null===t||void 0===t?void 0:t.projectName," ").concat(null===t||void 0===t?void 0:t.scheduleDate," ").concat(null===t||void 0===t?void 0:t.scheduleTime)}:void 0},g),c),{},{shareCustomerLink:!0}),responders:null!==t&&void 0!==t&&t.staffId?[{id:null===t||void 0===t?void 0:t.staffId,beamId:null===t||void 0===t?void 0:t.staffBeamId}]:[],assets:[],connectionId:l,pageId:ee,submitted:!0,unstructuredAttributes:{undefined:Object(d.a)(Object(d.a)({},r[void 0]),{},Object(T.a)({},null===Ie||void 0===Ie?void 0:Ie.itemName[1],[Object(d.a)({},i)]))},title:"".concat(null===t||void 0===t?void 0:t.projectName," ").concat(null===t||void 0===t?void 0:t.scheduleDate," ").concat(null===t||void 0===t?void 0:t.scheduleTime),invitation:k,assistPageId:void 0,createdAt:H()("".concat(t.scheduleDate," ").concat(t.scheduleTime),"YYYY-MM-DD HH:mm").valueOf(),cudbServiceId:null===E||void 0===E?void 0:E.cudbServiceId,url:window.location.href})})}):_e.current.push({userId:o,attributes:Object(d.a)(Object(d.a)({},g),{},{shareCustomerLink:!0}),responders:x,assets:[],connectionId:l,pageId:ee,submitted:!0,unstructuredAttributes:{tempValues:r},title:N,invitation:k,assistPageId:se,createdAt:w,cudbServiceId:null===E||void 0===E?void 0:E.cudbServiceId,url:window.location.href}),null===(c=_e.current)||void 0===c||c.map(function(e){t.publishToEvent(m.PublishPageTopics,Wt(l),Dn(e))})};Object(a.useEffect)(function(){if(Y)if(o&&o(j.getFieldsValue()),Y.status){J(!1),te(void 0),re(void 0),Lt("Event page submitted successfully","success","TOP_CENTER",1e3),localStorage.removeItem("form"),localStorage.removeItem("active"),setTimeout(function(){j.resetFields()},500),x(Object(d.a)(Object(d.a)({},g),{},{map:!1}));var e=new URLSearchParams(I);e.delete("pageId"),N.replace({search:e.toString()}),D({type:De,payload:!1})}else if(!1===Y.status){var t;J(!1),Lt((null===Y||void 0===Y||null===(t=Y.data)||void 0===t?void 0:t.details)||"Request failed","error","TOP_CENTER",3e3),D({type:"SET_ONLY_SUBMITTED",payload:!1})}},[D,N,j,g,I,G,x,Y]),Object(a.useEffect)(function(){if(null!==P&&void 0!==P&&P.sections){var e,n,a,i,o,l,s=v||(null===E||void 0===E?void 0:E.projectId),d=null===P||void 0===P||null===(e=P.projects)||void 0===e?void 0:e.find(function(e){return e.id===s});Le(null===d||void 0===d?void 0:d.name);var u=null===E||void 0===E?void 0:E.assistPageId,b=null===E||void 0===E?void 0:E.connectionId;u&&(ce(!0),t.subscribeToEvent(m.SubscribePageTopics,jn(u,b)),Ve(u));var p,O,f=s&&""!==s?(null===P||void 0===P||null===(n=P.sections)||void 0===n||null===(a=n[1])||void 0===a||null===(i=a[0])||void 0===i?void 0:i[s])||[]:null===P||void 0===P||null===(o=P.sections)||void 0===o||null===(l=o[0])||void 0===l?void 0:l[0],h=f.filter(function(e){return!0===e.conditional})||[];f=f.filter(function(e){return void 0===e.conditional||!1===e.conditional})||[],be(f),Oe(h),f.map(function(e){null===e||void 0===e||e.Rows.map(function(e){var t;null===e||void 0===e||null===(t=e.Cols)||void 0===t||t.map(function(e){"dispatchType"===(null===e||void 0===e?void 0:e.type)&&(p=e),"customer-search"===(null===e||void 0===e?void 0:e.type)&&(O=e)})})}),p&&c&&j.setFieldsValue({undefined:Object(T.a)({},p.name,{type:"dispatchType",value:"schedule",date:c,time:c})}),O&&r&&We({itemName:[O.name],value:r})}null!==P&&void 0!==P&&P.adminUserId&&Ye(null===P||void 0===P?void 0:P.adminUserId,null===P||void 0===P?void 0:P.userServiceId);var g=new URLSearchParams(I).get("pageId");g&&(te(g),t.publishToEvent(m.PublishPageTopics,cn(null===E||void 0===E?void 0:E.connectionId),Dn({objectId:g,paths:["$"],returnPaths:["$"]},g)))},[P]);var Ye=function(e,n){t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,M(e,"$","$..role"),hn(null===E||void 0===E?void 0:E.connectionId),n),t.subscribeToSurvey(m.SurveyTopics,hn(null===E||void 0===E?void 0:E.connectionId),function(e){var t,n;B(null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0])})};Object(a.useEffect)(function(){if(t.client){var e=new URLSearchParams(I),n=e.get("userId"),a=e.get("connectionId"),i=e.get("projectId"),c=e.get("pageId"),o=e.get("assistPageId"),l=e.get("cudbServiceId"),s=e.get("token");D(s?ct({data:{payload:s},callback:function(e){}}):{type:"ADD_ENCRYPTED_TOKEN",payload:{connectionId:a,userId:n,projectId:i,pageId:c,assistPageId:o,cudbServiceId:l}})}},[I,t.client]),Object(a.useEffect)(function(){E&&(t.subscribeToEvent(m.SubscribePageTopics,qt(null===E||void 0===E?void 0:E.connectionId)),t.subscribeToEvent(m.SubscribePageTopics,$t(null===E||void 0===E?void 0:E.connectionId)),t.subscribeToEvent(m.SubscribePageTopics,vn(null===E||void 0===E?void 0:E.connectionId)),t.subscribeToEvent(m.SubscribePageTopics,Ht(null===E||void 0===E?void 0:E.connectionId)),t.subscribeToEvent(m.SubscribePageTopics,an(null===E||void 0===E?void 0:E.connectionId)),t.publishToEvent(m.PublishPageTopics,Ft(null===E||void 0===E?void 0:E.connectionId),Dn({userId:null===E||void 0===E?void 0:E.userId,cudbServiceId:null===E||void 0===E?void 0:E.cudbServiceId})))},[E]),Object(a.useEffect)(function(){if(R){var e,t,n,a,i=new URLSearchParams(I).get("pageId");if(console.log("page here",R),i!==R.objectId&&!R.dashboard)return;j.setFieldsValue(null!==(e=null===R||void 0===R||null===(t=R.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.profile)||void 0===a?void 0:a.unstructuredAttributes)&&void 0!==e?e:{}),te(R.objectId)}},[R]);var He=function(e){D({type:Pe,payload:e});var t=j.getFieldsValue();Object.keys(t[void 0]||{}).map(function(e){var n,a;"task-picker"===(null===(n=t[void 0])||void 0===n||null===(a=n[e])||void 0===a?void 0:a.type)&&j.setFieldsValue({undefined:Object(d.a)(Object(d.a)({},t[void 0]),{},Object(T.a)({},e,void 0))})})},We=function(e){var t=e.itemName,n=e.value;if(n){var a,i,c,o,l,s=null===n||void 0===n||null===(a=n.info)||void 0===a?void 0:a.customer;Object.keys(s).map(function(e){var t,n,a,i,c,o;"location"===(null===s||void 0===s||null===(t=s[e])||void 0===t?void 0:t.type)&&(s[e]={type:"location",label:null===s||void 0===s||null===(n=s[e])||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.address,value:{description:null===s||void 0===s||null===(i=s[e])||void 0===i||null===(c=i.attributes)||void 0===c?void 0:c.address,placeId:"",coordinates:null===s||void 0===s||null===(o=s[e])||void 0===o?void 0:o.coordinates}})}),j.setFieldsValue({undefined:Object(d.a)(Object(d.a)(Object(T.a)({},(null===t||void 0===t?void 0:t[0])||(null===t||void 0===t?void 0:t[1]),null===n||void 0===n||null===(i=n.info)||void 0===i?void 0:i.id),null===n||void 0===n||null===(c=n.info)||void 0===c?void 0:c.customer),{},{relation:(null===n||void 0===n||null===(o=n.info)||void 0===o||null===(l=o.customer)||void 0===l?void 0:l.relation)||[]})})}},Ve=function(e){var t=W();localStorage.setItem("requestId",t),localStorage.setItem("requestService","summary");var n={select:{index:{searchIndex:"".concat("beamdevlive",":message:createdAt"),searchQuery:"@pageId:{".concat(e.toString(),"}@type:{'place'}"),searchOptions:"TIMEOUT 100"},load:{object:"$"}},operations:[{sortBy:{properties:[{field:"@createdAt",order:"DESC"}]}}],result:{pagination:{offset:0,limit:1}},sortBy:{properties:[{field:"@createdAt",order:"DESC"}],max:1e4}};D(tt({requestData:n,callback:function(e){console.log("message response",e),L(t,e)}}))};Object(a.useEffect)(function(){var e,t,n,a,i;w&&w.length>0&&(Object.keys(ge).map(function(t){ge[t].map(function(t){var n;null===t||void 0===t||null===(n=t.Cols)||void 0===n||n.map(function(t){"incident-location"===(null===t||void 0===t?void 0:t.type)&&(e=t)})})}),null===ve||void 0===ve||ve.map(function(t){t.Rows.map(function(t){var n;null===t||void 0===t||null===(n=t.Cols)||void 0===n||n.map(function(t){"incident-location"===(null===t||void 0===t?void 0:t.type)&&(e=t)})})}),e&&(a=null===(t=e)||void 0===t?void 0:t.name,i=null===w||void 0===w||null===(n=w[0])||void 0===n?void 0:n.data,gc.a.fromLatLng(i.coordinates.lat,i.coordinates.long).then(function(e){var t,n,c=j.getFieldsValue();j.setFieldsValue({undefined:Object(d.a)(Object(d.a)({},c[void 0]),{},Object(T.a)({},a,{label:i.attributes.address,value:Object(d.a)(Object(d.a)({},null===e||void 0===e||null===(t=e.results)||void 0===t?void 0:t[0]),{},{coordinates:i.coordinates}),type:"incident-location"}))}),ze(Object(T.a)({},a,{label:i.attributes.address,value:Object(d.a)(Object(d.a)({},null===e||void 0===e||null===(n=e.results)||void 0===n?void 0:n[0]),{},{coordinates:i.coordinates}),type:"incident-location"})),x(Object(d.a)(Object(d.a)({},g),{},{map:!0,form:window.innerWidth>=700}))},function(e){console.error(e)})))},[w]);var ze=function(e){D({type:Ae,payload:e}),j.setFieldsValue({incidentType:void 0}),D({type:Pe,payload:void 0})},Qe=function(e){Se(e)};return Object(oa.jsxs)("div",{className:"main-column ride-dispatch-panel mobile-responsive mr-4",children:[Ce&&Object(oa.jsx)(fr,{onClose:function(){we(!1)},adminRoles:F,onSubmitHandler:$e}),Object(oa.jsx)("div",{className:"main-content",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",initialValues:JSON.parse(localStorage.getItem("form")||"{}"),id:"register-form",layout:"vertical",form:j,onFinish:$e,requiredMark:!1,onValuesChange:function(e,t){localStorage.setItem("form",JSON.stringify(t))},children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsxs)("div",{className:"d-flex",children:["Lighthouse Beloved Community CLT Financial Application"===Me&&Object(oa.jsx)(Xa.a,{height:50,width:35,src:"https://media.staging.beam.live/106749_original.png",preview:!1}),Object(oa.jsx)("h3",{className:"ml-3",children:Me||"Event creator"})]}),Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn map-icon",style:{padding:0},children:Object(oa.jsx)(fa.a,{src:"/images/map.svg",onClick:function(){x(Object(d.a)(Object(d.a)({},g),{},{map:!0,form:window.innerWidth>=700}))}})})})]}),Object(oa.jsxs)("div",{className:"main-cards mt-3",ref:Be,children:[Object(oa.jsx)(Za.a,{activeKey:["account","where","what","who","when","why"].concat(Object(C.a)(null===ve||void 0===ve?void 0:ve.map(function(e){return e.sectionName}))),bordered:!1,className:"simple-collapse",onChange:function(e){localStorage.setItem("active",JSON.stringify(e))},children:null===ve||void 0===ve?void 0:ve.map(function(e,n){return Object(oa.jsx)(gr,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[(null===Ne||void 0===Ne?void 0:Ne[e.sectionName.toLowerCase()])&&Object(oa.jsx)(fa.a,{src:null===Ne||void 0===Ne?void 0:Ne[e.sectionName.toLowerCase()]}),Object(oa.jsx)("h5",{className:"ml-3",children:e.sectionName})]}),children:Object(oa.jsx)("div",{className:"sub-cards-2",children:null===e||void 0===e?void 0:e.Rows.map(function(n,a){return Object(oa.jsx)(Yn.a,{className:a>0?"mt-3":"",children:Object(oa.jsxs)(i.a.Fragment,{children:[!n.isMulti&&(null===n||void 0===n?void 0:n.Cols.map(function(e,n){return Object(oa.jsx)(Hn.a,{span:e.ColSize,className:"pr-2",xs:24,sm:e.ColSize,children:Object(oa.jsx)(dc,{data:e,projects:P,addOtherLocation:ze,onProjectChange:He,onCustomerSearch:We,adminRoles:F,customerDisabled:void 0!==r&&""!==r,dispatchDisabled:void 0!==c,conditionalSections:pe,socket:t,formValues:Fe,relationDisbaled:!0,onServiceChange:Qe})},n)})),n.isMulti&&Object(oa.jsx)(vc,{listName:"".concat(e.sectionName,"MultiRow").concat(a),cols:null===n||void 0===n?void 0:n.Cols,RenderFields:dc,customerDisabled:void 0!==r&&""!==r,dispatchDisabled:void 0!==c,projects:P,addOtherLocation:ze,onProjectChange:He,adminRoles:F})]})},a)})})},e.sectionName)})}),void 0!==v&&""!==v&&Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"shareCustomerLink",valuePropName:"checked",children:Object(oa.jsx)(Xn.a,{children:"Do you want to share link with customer?"})})})})]}),f&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:f})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:8,className:"",xs:24,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full",onClick:function(){setTimeout(function(){localStorage.removeItem("form"),D({type:De,payload:!1}),j.resetFields(),x(Object(d.a)(Object(d.a)({},g),{},{map:!1}));var e=new URLSearchParams(I);e.delete("pageId"),N.replace({search:e.toString()}),D({type:"SET_SELECTED_PAGE",payload:{page:void 0}}),te(void 0),re(void 0)})},children:"Clear"})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:G,children:ee?"Save":"Submit"})})})]})]})}),ie&&Object(oa.jsx)(hr,{onClose:function(){ce(!1)},handleConfirm:function(){re(null===E||void 0===E?void 0:E.assistPageId),ce(!1)},message:"Do you want to add assist user to the event page?"})]})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var yr,Ir=function(e){var t=e.socket,n=(Object(s.b)(),Object(a.useState)(nc.Dashboard)),c=Object(u.a)(n,2),o=c[0],r=c[1],d=Object(a.useState)(),b=Object(u.a)(d,2),j=(b[0],b[1]),p=Object(a.useState)(),O=Object(u.a)(p,2),f=(O[0],O[1]),h=Object(a.useRef)(!1),g=Object(s.c)(function(e){return e.auth}),x=g.encrypted_token,I=g.projects,S=Object(a.useState)({all:W(),driver:W(),vehicle:W(),dispatcher:W(),pricing:W(),equipment:W(),schedule:W(),timeoff:W(),timesheet:W(),shift:W(),recurring:W()}),N=Object(u.a)(S,2),k=N[0],T=(N[1],{screen:o,setScreen:r}),C=(Object(l.g)().search,Mn().getUserRequestPayload),w=Object(a.useState)(!0),E=Object(u.a)(w,2),R=E[0],P=E[1];return Object(a.useEffect)(function(){var e,n;null!==I&&void 0!==I&&I.adminUserId&&!h.current&&(h.current=!0,e=null===I||void 0===I?void 0:I.adminUserId,n=null===I||void 0===I?void 0:I.userServiceId,t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,C(e,"$","$..role"),hn(null===x||void 0===x?void 0:x.connectionId),n),t.subscribeToSurvey(m.SurveyTopics,hn(null===x||void 0===x?void 0:x.connectionId),function(e){var t,n;j(null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0])},k.all),f("admin"))},[I]),Object(oa.jsxs)(Yn.a,{className:"main-layout",style:{transform:"scale(0.8)",transformOrigin:"0 0",width:"125vw",height:"100vh"},children:[void 0!==o?Object(oa.jsx)("div",{}):Object(oa.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}})]}),o===nc.Dashboard&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Hn.a,{span:7,style:{height:"calc((100vh / 0.8) - 50px)",overflow:"scroll"},className:"lighthouse-dashboard",children:Object(oa.jsx)(xr,{socket:t,params:{screens:o,setScreens:function(){}}})}),Object(oa.jsx)(Hn.a,{span:17,style:{height:"calc((100vh / 0.8) - 70px)",overflow:"scroll"},children:Object(oa.jsxs)(Yn.a,{children:[R&&Object(oa.jsx)(Hn.a,{span:24,className:"ride-container",children:Object(oa.jsx)(or,{socket:t,params:T})}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mt-3",style:{padding:0},children:Object(oa.jsx)(jr,{socket:t,filter:!0,componentUuid:k.all,toggleMap:function(){return P(function(e){return!e})}})})})})]})})]}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})},Sr=n(323),Nr=(Za.a.Panel,function(e){var t=e.onClose,n=e.handleConfirm,i=e.message,c=Object(a.useState)(!0),o=Object(u.a)(c,2),l=o[0],s=o[1],r=ei.a.useForm(),d=Object(u.a)(r,1)[0],v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=b[0],m=b[1],p=function(){s(!1),t&&t()};return Object(oa.jsx)($n.a,{title:"Please Confirm",visible:l,onCancel:p,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"confirmation-form",id:"confirmation-form",layout:"vertical",form:d,requiredMark:!1,children:[Object(oa.jsx)(ei.a.Item,{name:"message",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(Jc.a,{children:i||"Are you sure you want to continue?"})}),Object(oa.jsx)(ei.a.Item,{className:"action-grp mt-4",children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{loading:j,className:"beam-btn green-btn cover w-full",onClick:function(){m(!0),n()},children:"Confirm"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:p,children:"Cancel"})})]})})]})})});n(212);Dc.d.register(Dc.a,Dc.j,Dc.e);var kr=Gn.a.Option,Tr=Jn.a.RangePicker,Cr=function(e){return e.Assigned="assigned",e.Started="started",e.Completed="completed",e.Escalated="escalated",e.Cancelled="cancelled",e.Processed="processed",e}({}),wr={green:Cr.Completed,amber:Cr.Assigned,red:Cr.Escalated,blue:Cr.Started,black:Cr.Cancelled,gray:Cr.Processed},Er=function(e){var t=e.socket,n=e.filter,c=e.selected,o=e.componentUuid,l=e.userRole,r=Object(s.c)(function(e){return e.auth}),v=r.userRequests,b=r.projects,j=r.selectedPage,p=r.encrypted_token,O=r.searchByPhone,f=r.adminUserRoles,h=Object(s.b)(),g=Object(a.useState)("project"),x=Object(u.a)(g,2),y=x[0],I=x[1],S=Object(a.useState)("state"),N=Object(u.a)(S,2),k=N[0],w=N[1],E=Object(a.useState)(!1),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(void 0),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(void 0),F=Object(u.a)(q,2),B=F[0],_=F[1],$=Object(a.useState)(!1),Y=Object(u.a)($,2),V=Y[0],Q=Y[1],G=Object(a.useState)(!1),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)([]),ee=Object(u.a)(X,2),ae=ee[0],ie=ee[1],ce=Object(a.useState)([]),oe=Object(u.a)(ce,2),le=oe[0],se=oe[1],re=Object(a.useState)([]),de=Object(u.a)(re,2),ue=(de[0],de[1]),ve=Object(a.useState)([]),be=Object(u.a)(ve,2),je=(be[0],be[1]),me=Object(a.useRef)(W()),pe=Object(a.useRef)(void 0),Oe=Object(a.useRef)(void 0),fe=Object(a.useRef)(0),he=Object(a.useRef)(void 0),ge=Object(a.useRef)(!1),xe=Object(a.useRef)(),ye=Object(a.useState)(),Ie=Object(u.a)(ye,2),Se=Ie[0],Ne=Ie[1],Te=Object(a.useState)("last24hours"),Ce=Object(u.a)(Te,2),we=Ce[0],Ee=Ce[1],Re=Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0}),Pe=Object(u.a)(Re,2),De=Pe[0],Ae=Pe[1],Me=Object(a.useState)(0),Le=Object(u.a)(Me,2),Ue=Le[0],qe=Le[1],Fe=Object(a.useState)([]),Be=Object(u.a)(Fe,2),_e=Be[0],$e=Be[1],Ye=Object(a.useRef)(void 0),He=Object(a.useRef)(void 0),We=Object(a.useState)([]),Ve=Object(u.a)(We,2),ze=Ve[0],Qe=Ve[1],Ge=Object(a.useState)(!1),Je=Object(u.a)(Ge,2),Ke=Je[0],Ze=Je[1],Xe=Object(a.useState)([]),et=Object(u.a)(Xe,2),nt=(et[0],et[1]),at=Object(a.useState)(void 0),it=Object(u.a)(at,2),ct=it[0],ot=it[1],lt=Object(a.useRef)({project:void 0,user:void 0,area:void 0,time:void 0}),st=Object(a.useRef)({status:void 0,time:void 0,phone:void 0}),rt=Object(a.useRef)({}),dt=Object(a.useRef)(),ut=Object(a.useState)(void 0),vt=Object(u.a)(ut,2),bt=vt[0],jt=vt[1],mt=Object(a.useState)(void 0),pt=Object(u.a)(mt,2),Ot=pt[0],ft=pt[1],ht=Object(a.useRef)([]),gt=Object(a.useState)(window.innerWidth<=768),xt=Object(u.a)(gt,2),yt=xt[0],It=xt[1],St=Object(a.useState)(),Nt=Object(u.a)(St,2),kt=Nt[0],Tt=Nt[1];Object(a.useEffect)(function(){var e=function(){return It(window.innerWidth<=768)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[]);var Ct=Object(a.useCallback)(Object(Ac.a)(2e3,function(){console.log("debounce"),_t()},{atBegin:!0}),[]),wt=Object(a.useCallback)(function(e){var t,n,a;null!==(t=rt.current)&&void 0!==t&&t[e]||(rt.current[e]=Object(Ac.a)(2e3,function(e){console.log("search page here",e),Bt(e)},{atBegin:!1})),null===(n=rt.current)||void 0===n||null===(a=n[e])||void 0===a||a.call(n,e)},[]),Et=function(e){st.current.status=e?"@rideStatus:{".concat(wr[e],"}"):void 0,st.current.phone=void 0,Q(!0),he.current=e,ot(e),Ht()},Rt=function(e){st.current.phone=e?"@passengerPhoneNumber:{".concat(z(e),"}"):void 0,Q(!0),st.current.status=void 0,he.current="lime",ot("lime"),Ht()};Object(a.useEffect)(function(){O&&Rt(null===O||void 0===O?void 0:O.phone)},[O]);var Pt=function(e){var t,n;if(y!==e&&null!==b&&void 0!==b&&b.projects&&f){U(void 0),ie([]);var a=[];switch(e){case"project":null===b||void 0===b||null===(t=b.projects)||void 0===t||t.filter(function(e){return null===e.type}).map(function(e){a.push({label:e.name,value:e.id})}),ie(a);break;case"vehicle":null===b||void 0===b||null===(n=b.projects)||void 0===n||n.filter(function(e){return"vehicle"===e.type}).map(function(e){a.push({label:e.name,value:e.id})}),ie(a);break;case"manager":qt(f,"manager");break;case"dispatcher":qt(f,"dispatcher");break;case"responder":qt(f,"responder");break;case"student":Dt()}I(e)}},Dt=function(){D(!0);var e={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}@partitions:{type\\:student}").concat("student"===l?"@partitions:{parent\\:".concat(null===p||void 0===p?void 0:p.userId,"}"):""),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status",searchName:"$..searchName"}},filter:{expression:""}};h(tt({requestData:e,callback:function(e){D(!1);var t=null===e||void 0===e?void 0:e.map(function(e){var t,n,a={id:null===e||void 0===e||null===(t=e.objectId)||void 0===t?void 0:t.toString(),name:null===e||void 0===e||null===(n=e.info)||void 0===n?void 0:n.name};return{value:a.id,label:a.name}}).filter(function(e){return!ae.find(function(t){return e.value===t.value})});ie(t)}}))},At=function(e){var t=e.value,n=e.onChange,i=Object(a.useState)(t),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)(null),r=Object(u.a)(s,2),d=r[0],v=r[1];Object(a.useEffect)(function(){t&&l(t)},[t]);var b=function(e,t,a){n&&n({value:e,startTimestamp:t,endTimestamp:a})};return Object(oa.jsxs)("div",{className:"w-100",children:[Object(oa.jsxs)(Gn.a,{style:{width:200},placeholder:"Select time range",className:"w-100",value:o,onChange:function(e){var t,n=H()(),a=n.valueOf();switch("customRange"!==e&&v(null),e){case"last24hours":t=n.subtract(24,"hours").valueOf();break;case"last3days":t=n.subtract(3,"days").valueOf();break;case"last1week":t=n.subtract(7,"days").valueOf();break;case"last1month":t=n.subtract(1,"month").valueOf();break;case"customRange":d?(t=d[0],a=d[1]):console.warn("Select a custom range from the date picker.");break;default:return void console.warn("Invalid selection")}l(e),b(e,t,a)},children:[Object(oa.jsx)(kr,{value:"last24hours",children:"Last 24 Hours"}),Object(oa.jsx)(kr,{value:"last3days",children:"Last 3 Days"}),Object(oa.jsx)(kr,{value:"last1week",children:"Last 1 Week"}),Object(oa.jsx)(kr,{value:"last1month",children:"Last 1 Month"}),Object(oa.jsx)(kr,{value:"customRange",children:"Custom Range"})]}),"customRange"===o&&Object(oa.jsx)(Tr,{style:{marginTop:16},onChange:function(e){if(e){var t=e[0].valueOf(),n=e[1].valueOf();v([t,n]),b("customRange",t,n)}else v(null)},format:"YYYY-MM-DD",disabledTime:function(){return{}},showTime:!1})]})},Mt=function(e){k!==e&&(_(void 0),se([]),Ft(e),w(e))},qt=function(e,n){var a;switch(n){case"dispatcher":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1===e.permissions.indexOf("admin")});break;case"responder":a=e.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")});break;case"manager":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")})}var i=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),c={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(i.join("||"),")")},anyStatus:!1};t.publishToEvent(m.PublishPageTopics,xn(null===p||void 0===p?void 0:p.connectionId),Dn(c,"".concat(me.current,":").concat(n))),D(!0)},Ft=function(e){Z(!0);var t={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===p||void 0===p?void 0:p.userId,"'}@partitions:{'org\\:").concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(T.a)({},e,"$.persistent.static.profile.".concat(e))},groupBy:{properties:["@".concat(e)],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:""}};h(tt({requestData:t,callback:function(e){Z(!1);var t=[];null===e||void 0===e||e.map(function(e){e[Object.keys(e)[0]]&&t.push({label:e[Object.keys(e)[0]],value:e[Object.keys(e)[0]]})}),se(t)}}))},Bt=function(e){var t;if("string"===typeof e){var n={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===(t=dt.current)||void 0===t?void 0:t.userId,"'}@partitions:{'org\\:").concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},list:{objectIds:[e]},load:{persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",activeIot:"$..activeIot"}},filter:{expression:""}};h(tt({requestData:n,callback:function(e){Ne(null===e||void 0===e?void 0:e[0])}}))}},_t=function(){var e,t=["exists(@rideType)"],n="";if(st.current.time)n+=st.current.time;else{var a=new Date;a.setHours(0),a.setMinutes(1),n+="@createdAt:[".concat(a.getTime(),",+inf]")}lt.current&&Object.keys(lt.current).map(function(e){var n,a;null!==(n=lt.current)&&void 0!==n&&n[e]&&t.push(null===(a=lt.current)||void 0===a?void 0:a[e])});var i={};ht.current&&ht.current.map(function(e){i[e.key]=e.value});var c={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{'".concat(null===dt||void 0===dt||null===(e=dt.current)||void 0===e?void 0:e.userId,"'}").concat(ge.current?"":"(-@rideType:{hail})","@pageType:{event}@partitions:{'org\\:").concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}").concat(n),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)({profile:"$..profile",rideType:"$..profile.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",status:"$.nonpersistent.static.live.status.name",vehicleProjectId:"$..profile.vehicleProjectId"},i)},groupBy:{properties:["@status"],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:t.join("&&")}};h(tt({requestData:c,callback:function(e){var t=0,n={amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0};e.map(function(e){n[e.status]=e.count,t+=e.count}),Ae(Object(d.a)({all:t,live:t},n))}}))};Object(a.useEffect)(function(){De&&qe(Ue+1)},[JSON.stringify(De)]),Object(a.useEffect)(function(){var e,t,n;if(Se&&null!==Se&&void 0!==Se&&null!==(e=Se.persistent)&&void 0!==e&&null!==(t=e.static)&&void 0!==t&&null!==(n=t.profile)&&void 0!==n&&n.type){var a,i,c,o,l,s,r,u,v,j,m,p,O,f,h,g,x,y,I,S,N,k,T,w,E,R,P,D,A,M,L,U,q,F,B,_,$,Y,H,W,V,z,Q,G,J,K,Z,X,ee,te,ne=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===Se||void 0===Se||null===(a=Se.persistent)||void 0===a||null===(i=a.static)||void 0===i?void 0:i.profile)||{}),(null===Se||void 0===Se||null===(c=Se.persistent)||void 0===c||null===(o=c.static)||void 0===o?void 0:o.dashboard)||{}),(null===Se||void 0===Se||null===(l=Se.persistent)||void 0===l||null===(s=l.static)||void 0===s?void 0:s.ride)||{}),(null===Se||void 0===Se||null===(r=Se.persistent)||void 0===r||null===(u=r.dynamic)||void 0===u?void 0:u.ride)||{}),ae=null===Se||void 0===Se||null===(v=Se.nonpersistent)||void 0===v||null===(j=v.static)||void 0===j||null===(m=j.live)||void 0===m||null===(p=m.status)||void 0===p?void 0:p.name,ie=null===Se||void 0===Se||null===(O=Se.persistent)||void 0===O||null===(f=O.static)||void 0===f||null===(h=f.profile)||void 0===h?void 0:h.type,ce=null===Se||void 0===Se||null===(g=Se.persistent)||void 0===g||null===(x=g.static)||void 0===x||null===(y=x.metadata)||void 0===y?void 0:y.type;if(!ge.current&&"hail"===ie||"event"!==ce)return;var oe=Object(C.a)(_e),le=oe.findIndex(function(e){return e.key===Se.pageId});if(Ct(),he.current&&he.current!==ae)return void(-1!==le&&(oe.splice(le,1),$e(oe),Ye.current=oe));var se={};Object.keys(ne).map(function(e){"string"===typeof ne[e]&&(se[e]=ne[e])});var re,de,ue,ve,be,me,pe=(null===(I=He.current)||void 0===I||null===(S=I.find(function(e){var t,n,a;return e.id===(null===Se||void 0===Se||null===(t=Se.nonpersistent)||void 0===t||null===(n=t.dynamic)||void 0===n||null===(a=n.ride)||void 0===a?void 0:a.dispatchRequestBy)}))||void 0===S?void 0:S.beamId)||"",Oe=(null===(N=He.current)||void 0===N||null===(k=N.find(function(e){var t,n,a,i;return e.id===(null===(t=Object.keys((null===Se||void 0===Se||null===(n=Se.nonpersistent)||void 0===n||null===(a=n.dynamic)||void 0===a||null===(i=a.ride)||void 0===i?void 0:i.manualUsers)||{}))||void 0===t?void 0:t[0])||""}))||void 0===k?void 0:k.beamId)||"";if(null===(T=Object.keys((null===Se||void 0===Se||null===(w=Se.persistent)||void 0===w||null===(E=w.static)||void 0===E||null===(R=E.payment)||void 0===R?void 0:R.stripe)||{}))||void 0===T||T.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Se||void 0===Se||null===(t=Se.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"succeeded"===(null===Se||void 0===Se||null===(o=Se.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(re=null===Se||void 0===Se||null===(u=Se.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])}),!re)null===(de=Object.keys((null===Se||void 0===Se||null===(ue=Se.persistent)||void 0===ue||null===(ve=ue.static)||void 0===ve||null===(be=ve.payment)||void 0===be?void 0:be.stripe)||{}))||void 0===de||de.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Se||void 0===Se||null===(t=Se.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"requires_capture"===(null===Se||void 0===Se||null===(o=Se.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(re=null===Se||void 0===Se||null===(u=Se.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])});for(var fe=null===Se||void 0===Se?void 0:Se.activeIot,ye=0,Ie=Object.keys(fe);ye<Ie.length;ye++)for(var Ne=Ie[ye],ke=0,Te=Object.keys(fe[Ne]);ke<Te.length;ke++)for(var Ce=Te[ke],we=0,Ee=Object.keys(fe[Ne][Ce]);we<Ee.length;we++){var Re=Ee[we];me=fe[Ne][Ce][Re]}var Pe=!1;me&&(null===(P=xe.current)||void 0===P||null===(D=P.pageId)||void 0===D?void 0:D.toString())===(null===(A=Se.pageId)||void 0===A?void 0:A.toString())?Pe=!0:me||(null===(M=xe.current)||void 0===M||null===(L=M.pageId)||void 0===L?void 0:L.toString())!==(null===(U=Se.pageId)||void 0===U?void 0:U.toString())||Tt(void 0);var De,Ae,Me=Object(d.a)(Object(d.a)({key:Se.pageId,pageStatus:null===Se||void 0===Se||null===(q=Se.nonpersistent)||void 0===q||null===(F=q.static)||void 0===F||null===(B=F.live)||void 0===B||null===(_=B.status)||void 0===_?void 0:_.name,requestedBy:pe,requestedAt:new Date(null===Se||void 0===Se||null===($=Se.persistent)||void 0===$||null===(Y=$.static)||void 0===Y||null===(H=Y.metadata)||void 0===H?void 0:H.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:Oe,name:null===Se||void 0===Se||null===(W=Se.persistent)||void 0===W||null===(V=W.static)||void 0===V||null===(z=V.metadata)||void 0===z?void 0:z.title,action:{selected:Pe,pageId:Se.pageId,page:Object(d.a)(Object(d.a)({},Se),{},{profile:ne,activeIot:me,status:null===Se||void 0===Se||null===(Q=Se.nonpersistent)||void 0===Q||null===(G=Q.static)||void 0===G||null===(J=G.live)||void 0===J||null===(K=J.status)||void 0===K?void 0:K.name}),summary:se.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId,stripe:re}},se),{},{address:null!==se&&void 0!==se&&se.address&&""!==(null===se||void 0===se?void 0:se.adress)?null===se||void 0===se?void 0:se.address:null===ne||void 0===ne||null===(Z=ne.pickupLocation)||void 0===Z||null===(X=Z.attributes)||void 0===X?void 0:X.address,dropoffAddress:null!==se&&void 0!==se&&se.dropoffAddress&&""!==(null===se||void 0===se?void 0:se.dropoffAddress)?null===se||void 0===se?void 0:se.dropoffAddress:null===ne||void 0===ne||null===(ee=ne.dropoffLocation)||void 0===ee||null===(te=ee.attributes)||void 0===te?void 0:te.address});if(-1!==le)oe[le]=Object(d.a)(Object(d.a)({},Me),{},{invited:null===Ye||void 0===Ye||null===(De=Ye.current)||void 0===De||null===(Ae=De[le])||void 0===Ae?void 0:Ae.invited});else oe.unshift(Me);je(null===oe||void 0===oe?void 0:oe.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;return{lat:null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(i=a.static)||void 0===i||null===(c=i.live)||void 0===c||null===(o=c.location)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l.lat,lng:null===e||void 0===e||null===(s=e.action)||void 0===s||null===(r=s.page)||void 0===r||null===(d=r.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.location)||void 0===b?void 0:b.coordinates.long,title:null===e||void 0===e||null===(j=e.action)||void 0===j||null===(m=j.page)||void 0===m||null===(p=m.persistent)||void 0===p||null===(O=p.static)||void 0===O||null===(f=O.metadata)||void 0===f?void 0:f.title}})),$e(oe),Ye.current=oe}},[Se]);var $t=function(e){var t=e.channels.filter(function(e){return e.timestamp&&e.value});if(0!==t.length){var n=t.reduce(function(e,t){return e.timestamp>t.timestamp?e:t}),a=function(e,t){var n=ne(e,t);return te(n)}(n.value);return Object(d.a)(Object(d.a)({},n),{},{location:a})}},Yt=function(e){e.map(function(e){console.log("un subscribe to topic",e),t.unSubscribeToEvent(m.UnSubscribePageTopics,e)})};Object(a.useEffect)(function(){var e,n;kt?(void 0!==xe.current&&xe.current.imei!==kt.imei&&Yt([xe.current.imei]),e=kt.userId,n=kt.userName,t.publishToEvent(m.PublishPageTopics,"".concat("beamdevlive","/connection/").concat(null===p||void 0===p?void 0:p.connectionId,"/service/iot-service/getLastIndex"),Dn({filter:"ecosystem=".concat("beamdevlive"," userId=").concat(e," channelName=locationGps"),options:{latest:!1}},e)),t.subscribeToEvent(m.PublishPageTopics,"".concat("beamdevlive","/connection/").concat(null===p||void 0===p?void 0:p.connectionId,"/service/iot-service/getLastIndex/reply"),function(t){var a,i,c;console.log("last index response",t);var o=$t(null===t||void 0===t||null===(a=t.response)||void 0===a?void 0:a.data);if(console.log("last location",o),null!==o&&void 0!==o&&null!==(i=o.location)&&void 0!==i&&i.latitude&&null!==o&&void 0!==o&&null!==(c=o.location)&&void 0!==c&&c.longitude){var l,s,r={id:e,beamIds:[n],status:"green",location:{objectId:null===o||void 0===o?void 0:o.objectId,timestamp:(new Date).getTime(),geoJson:{features:[{geometry:{type:"Point",coordinates:[null===o||void 0===o||null===(l=o.location)||void 0===l?void 0:l.longitude,null===o||void 0===o||null===(s=o.location)||void 0===s?void 0:s.latitude]}}]}}};console.log("responder",r),h({type:ke,payload:[r]})}}),[kt.imei].map(function(e){console.log("subscribe to topic",e),t.subscribeToEvent(m.SubscribePageTopics,e,function(e){var t,n,a,i=null===e||void 0===e||null===(t=e.samples)||void 0===t||null===(n=t[0])||void 0===n||null===(a=n.dataset)||void 0===a?void 0:a.locationGps;if(null!==i&&void 0!==i&&i.lat&&null!==i&&void 0!==i&&i.long){var c,o,l={id:null===(c=xe.current)||void 0===c?void 0:c.userId,beamIds:[null===(o=xe.current)||void 0===o?void 0:o.userName],status:"green",location:{objectId:null===i||void 0===i?void 0:i.objectId,timestamp:(new Date).getTime(),geoJson:{features:[{geometry:{type:"Point",coordinates:[null===i||void 0===i?void 0:i.long,null===i||void 0===i?void 0:i.lat]}}]}}};h({type:ke,payload:[l]})}})}),xe.current=kt):void 0!==xe.current&&(Yt([xe.current.imei]),xe.current=void 0,h({type:ke,payload:[]}))},[kt]);var Ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=["exists(@rideType)"],n="",a="";if("advance"===c)he.current="brown",t.push("exists(@status) && @status === 'brown'");else if("dispatch"===c)he.current="purple",t.push("exists(@status) && @status === 'purple'");else if(lt.current)if(Object.keys(lt.current).map(function(e){var n,a;null!==(n=lt.current)&&void 0!==n&&n[e]&&t.push(null===(a=lt.current)||void 0===a?void 0:a[e])}),st.current.time||st.current.phone)st.current.time&&(n+=st.current.time);else{var i=new Date;i.setHours(0),i.setMinutes(1),n+="@createdAt:[".concat(i.getTime(),",+inf]")}st.current.status&&t.push("exists(@status) && @status === '".concat(he.current,"'")),st.current.phone&&(a=st.current.phone);var o={};ht.current&&ht.current.map(function(e){o[e.key]=e.value}),fe.current=e;var s={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===p||void 0===p?void 0:p.userId,"}").concat(ge.current?"":"(-@rideType:{hail})","@pageType:{event}@partitions:{'org\\:").concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}").concat(n).concat("").concat(a),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",ride:"$.persistent.static.ride",type:"$..persistent.static.metadata.type",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",rideType:"$..profile.type",phone:"$..profile.parentPhone",vehicleProjectId:"$..profile.vehicleProjectId",activeIot:"$..activeIot"},k,"$..profile.".concat(k)),o)},filter:{expression:t.join("&&")},sortBy:{properties:["advance"===c?{field:"@createdAt",order:"ASC"}:{field:"@updatedAt",order:"DESC"}],max:1e3},result:st.current.phone?{pagination:{offset:e,limit:50}}:{}};h(tt({requestData:s,callback:function(t){console.log("resppnse",t),ue(t),fe.current=fe.current+30;var n=e>0?Object(C.a)(_e):[],a=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Schedule Date",key:"scheduleDate",dataIndex:"scheduleDate"},{title:"Schedule Time",key:"scheduleTime",dataIndex:"scheduleTime"},{title:"Address",key:"address",dataIndex:"address"},{title:"Student Name",key:"studentName",dataIndex:"studentName"},{title:"Parent Phone",key:"parentPhone",dataIndex:"parentPhone"},{title:"Parent Email",key:"parentEmail",dataIndex:"parentEmail"},{title:"Driver Name",key:"driverName",dataIndex:"driverName"},{title:"Vehicle Name",key:"vehicleName",dataIndex:"vehicleName"}];null===t||void 0===t||t.map(function(e,t){var a,i,c,o,l,s,r,u=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),v={};Object.keys(u).map(function(e){"string"===typeof u[e]&&(v[e]=u[e])});var j,m,p,O=He.current||JSON.parse(localStorage.getItem("rideUsers")||"[]"),f=(null===O||void 0===O||null===(a=O.find(function(t){var n;return t.id===(null===e||void 0===e||null===(n=e.requestedBy)||void 0===n?void 0:n.toString())}))||void 0===a?void 0:a.beamId)||"",h=(null===O||void 0===O||null===(i=O.find(function(t){var n;return t.id===(null===(n=Object.keys((null===e||void 0===e?void 0:e.manualUsers)||{}))||void 0===n?void 0:n[0])||""}))||void 0===i?void 0:i.beamId)||"";(null===(c=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===c||c.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"succeeded"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(j=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}),j)||(null===(m=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===m||m.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"requires_capture"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(j=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}));for(var g=null===e||void 0===e?void 0:e.activeIot,x=0,y=Object.keys(g);x<y.length;x++)for(var I=y[x],S=0,N=Object.keys(g[I]);S<N.length;S++)for(var k=N[S],T=0,C=Object.keys(g[I][k]);T<C.length;T++){var w=C[T];p=g[I][k][w]}n.push(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:u,activeIot:p}),summary:v.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId,stripe:j}},v),{},{address:null!==v&&void 0!==v&&v.address&&""!==(null===v||void 0===v?void 0:v.adress)?null===v||void 0===v?void 0:v.address:null===u||void 0===u||null===(o=u.pickupLocation)||void 0===o||null===(l=o.attributes)||void 0===l?void 0:l.address,dropoffAddress:null!==v&&void 0!==v&&v.dropoffAddress&&""!==(null===v||void 0===v?void 0:v.dropoffAddress)?null===v||void 0===v?void 0:v.dropoffAddress:null===u||void 0===u||null===(s=u.dropoffLocation)||void 0===s||null===(r=s.attributes)||void 0===r?void 0:r.address,invited:"",requestedBy:f,requestedAt:new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:h}))}),console.log("source data",n),n.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===a.findIndex(function(t){return t.key===e})&&t[e]})}),a.push({title:"Action",key:"action",dataIndex:"action",render:function(e){var t,n,a;return console.log("action",e),Object(oa.jsxs)(Yn.a,{style:{width:135},children:[(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t;window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(null===p||void 0===p?void 0:p.connectionId,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:Object(oa.jsx)(Ec.a,{})})}),(null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.activeIot)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn mr-2 ".concat(null!==e&&void 0!==e&&e.selected?"blue-btn":""),onClick:function(){var t;!function(e,t){var n=Object(C.a)(Ye.current);console.log("page",e);var a=n.findIndex(function(t){return t.key.toString()===e.toString()});console.log("index",a);var i="".concat("beamdevlive","/device/").concat(t.iotUdid,"/user/").concat(t.userId,"/iotAppend/").concat(t.iotUserId,"/gps");if(-1!==a){var c,o;if(null!==n&&void 0!==n&&null!==(c=n[a])&&void 0!==c&&null!==(o=c.action)&&void 0!==o&&o.selected)n[a]=Object(d.a)(Object(d.a)({},null===n||void 0===n?void 0:n[a]),{},{action:Object(d.a)(Object(d.a)({},n[a].action),{},{selected:!1})}),Tt(void 0);else{var l,s=n.findIndex(function(e){return!0===e.action.selected});-1!==s&&(n[s]=Object(d.a)(Object(d.a)({},null===n||void 0===n?void 0:n[s]),{},{action:Object(d.a)(Object(d.a)({},n[s].action),{},{selected:!1})})),n[a]=Object(d.a)(Object(d.a)({},null===n||void 0===n?void 0:n[a]),{},{action:Object(d.a)(Object(d.a)({},n[a].action),{},{selected:!0})}),Tt({pageId:e,imei:i,userId:t.userId,userName:null===(l=n[a])||void 0===l?void 0:l.driverName})}$e(n),Ye.current=n}}(null===e||void 0===e?void 0:e.pageId,null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.activeIot)},children:Object(oa.jsx)(fa.a,{src:"/images/iot-icon.svg",className:"blue-icon iot-icon"})})}),"admin"!==l&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",onClick:function(){var t;console.log("action",e),jt(null===e||void 0===e||null===(t=e.pageId)||void 0===t?void 0:t.toString())},children:Object(oa.jsx)(na.a,{})})}),"driver"===l&&"green"!==(null===e||void 0===e||null===(n=e.page)||void 0===n?void 0:n.status)&&"red"!==(null===e||void 0===e||null===(a=e.page)||void 0===a?void 0:a.status)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn green-btn cover ml-2",onClick:function(){var t;console.log("action",e),ft(null===e||void 0===e||null===(t=e.pageId)||void 0===t?void 0:t.toString())},children:Object(oa.jsx)(Sr.a,{})})})]})}}),Qe(a),$e(n),Ye.current=n,je(null===t||void 0===t?void 0:t.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),Q(!1),D(!1),Z(!1)}})),Ct()};Object(a.useEffect)(function(){var e;p&&(dt.current=p,t.subscribeToEvent(m.SubscribePageTopics,Rn(null===p||void 0===p?void 0:p.userId),function(e){wt(null===e||void 0===e?void 0:e.data)},o),t.subscribeToEvent(m.SubscribePageTopics,nn(null===p||void 0===p?void 0:p.connectionId),function(e){Lt("Ride cancelled successfully","success","TOP_CENTER",1e3)}),t.subscribeToEvent(m.SubscribePageTopics,(e=null===p||void 0===p?void 0:p.connectionId,"".concat(Ut,"/connection/").concat(e,"/service/dps/completeSchoolBusPage/reply")),function(e){Lt("Ride status updated successfully","success","TOP_CENTER",1e3)}),D(!0),Ht(),Ft("state"),nt(JSON.parse(localStorage.getItem("tableHideList"))||[]))},[p]),Object(a.useEffect)(function(){if(b){var e,n=[];null===b||void 0===b||null===(e=b.projects)||void 0===e||e.filter(function(e){return null===e.type}).map(function(e){n.push({label:e.name,value:e.id})}),ie(n),null!==b&&void 0!==b&&b.adminUserId&&(t.subscribeToEvent(m.SubscribePageTopics,bn(null===p||void 0===p?void 0:p.connectionId,null===b||void 0===b?void 0:b.userServiceId)),t.subscribeToEvent(m.SubscribePageTopics,yn(null===p||void 0===p?void 0:p.connectionId)))}},[b]),Object(a.useEffect)(function(){if(v&&t.client){var e,n;if(!He.current&&null!==v&&void 0!==v&&v[null===(e=Object.keys(v))||void 0===e?void 0:e[0]])He.current=null===v||void 0===v?void 0:v[null===(n=Object.keys(v))||void 0===n?void 0:n[0]],localStorage.setItem("rideUsers",JSON.stringify(He.current));if(null!==v&&void 0!==v&&v["".concat(me.current,":").concat(y)]){var a;D(!1);var i=[];null===v||void 0===v||null===(a=v["".concat(me.current,":").concat(y)])||void 0===a||a.map(function(e){i.push({label:"".concat(e.fullName,": ").concat(e.email),value:e.id})}),ie(i)}}},[v,t.client]);var Wt=function(){return new Promise(function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){var n,a;e({lat:null===t||void 0===t||null===(n=t.coords)||void 0===n?void 0:n.latitude,long:null===t||void 0===t||null===(a=t.coords)||void 0===a?void 0:a.longitude})},function(t){console.error(t),e({})}):(alert("Geolocation is not supported by this browser."),e({}))})};return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{gutter:30,className:"mb-2",style:Ke?{}:{display:"none"},children:[Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,style:{width:"100%",marginBottom:yt?10:0},children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{gutter:16,className:"d-flex px-1 flex-wrap",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){Pt("project")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("project"===y?"green-btn cover":""),children:"Route"})}),Object(oa.jsx)("div",{onClick:function(){Pt("vehicle")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("vehicle"===y?"green-btn cover":""),children:"Vehicle"})}),Object(oa.jsx)("div",{onClick:function(){Pt("student")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("student"===y?"green-btn cover":""),children:"Student"})}),Object(oa.jsx)("div",{onClick:function(){Pt("responder")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("responder"===y?"green-btn cover":""),children:"Driver"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:P,value:L,allowClear:!0,showSearch:!0,filterOption:function(e,t){var n;return null===(n=t.label)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},options:ae,onChange:function(e){!function(e){switch(U(e),y){case"project":lt.current.project=e?"exists(@iotAssetConfigId) && @iotAssetConfigId === '".concat(e,"'"):void 0,lt.current.user=void 0,D(!0);break;case"vehicle":lt.current.project=e?"exists(@vehicleProjectId) && @vehicleProjectId === '".concat(e,"'"):void 0,lt.current.user=void 0,D(!0);break;case"responder":case"dispatcher":ht.current=[{key:"user",value:"$.persistent.static.metadata.members.users.".concat(e)}],lt.current.user=e?"exists(@user)":void 0,lt.current.project=void 0,D(!0);break;case"student":ht.current=[{key:"user",value:"$..unstructuredAttributes.userId"}],lt.current.user=e?"exists(@user) && @user === '".concat(e,"'"):void 0,lt.current.project=void 0,D(!0)}Ht()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex px-2 flex-wrap mt-4",children:Object(oa.jsx)(Hn.a,{sm:24,md:4,children:Object(oa.jsx)("h5",{className:"mb-0",children:"Search"})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Fi.a,{placeholder:"Phone number",defaultCountry:"US",allowClear:!0,onChange:function(e){console.log("phone",e),yr&&clearTimeout(yr),yr=setTimeout(function(){Rt(e)},700)}})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,style:{width:"100%",marginBottom:yt?10:0},children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{className:"d-flex flex-wrap",id:"filters",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){Mt("state")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("state"===k?"green-btn cover":""),children:"State"})}),Object(oa.jsx)("div",{onClick:function(){Mt("city")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("city"===k?"green-btn cover":""),children:"City"})}),Object(oa.jsx)("div",{onClick:function(){Mt("county")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("county"===k?"green-btn cover":""),children:"County"})}),Object(oa.jsx)("div",{onClick:function(){Mt("zip")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("zip"===k?"green-btn cover":""),children:"Zip"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{xs:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:K,allowClear:!0,options:le,value:B,onChange:function(e){!function(e){_(e),lt.current.time=e?"exists(@".concat(k,") && @").concat(k," === '").concat(e,"'"):void 0,Z(!0),Ht()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex flex-wrap mt-3 mx-0",children:Object(oa.jsx)(At,{onChange:function(e){console.log("value here",e),function(e){if(pe.current=e.startTimestamp,Oe.current=e.endTimestamp,Ee(null===e||void 0===e?void 0:e.value),pe.current&&Oe.current){var t=new Date(pe.current);t.setHours(0),t.setMinutes(1);var n=new Date(Oe.current);n.setHours(23),n.setMinutes(59),st.current.time="@createdAt:[".concat(t.getTime(),",+inf]@createdAt:[-inf, ").concat(n.getTime(),"]"),Z(!0),Ht()}else pe.current||pe.current||(st.current.time="",Z(!0),Ht())}(e)},value:we})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select Hour(s)",disabled:!0})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:4,style:{width:"100%",marginBottom:yt?10:0},children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsx)("p",{className:"mb-2 text-center",children:"Export to"}),Object(oa.jsxs)("div",{className:"d-flex flex-row flex-md-column justify-content-center",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-csv.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-xls.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-pdf.svg"})})})]})]})})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid"},children:Object(oa.jsxs)(Hn.a,{xs:24,sm:24,md:24,style:Object(d.a)({maxHeight:1e3,overflow:"scroll"},yt?{paddingLeft:28,paddingTop:20}:{}),children:[n&&Object(oa.jsxs)(Yn.a,{className:"d-flex mb-2",children:[Object(oa.jsx)(Hn.a,{sm:2,xs:7,className:"mb-1 border rounded text-center p-2 cursor-pointer ".concat(void 0===ct?"status-selected":""," ").concat(yt?"":"mx-2"),onClick:function(){Et(void 0)},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"All"}),Object(oa.jsx)("h4",{children:De.live})]})}),Object(oa.jsx)(Hn.a,{sm:2,xs:7,className:"mb-1 border rounded text-center p-2 cursor-pointer ".concat("amber"===ct?"status-selected":""," ").concat(yt?"":"mx-2"),onClick:function(){Et("amber")},children:Object(oa.jsxs)("div",{className:"amber",children:[Object(oa.jsx)("span",{children:"Assigned"}),Object(oa.jsx)("h4",{children:De.amber})]})}),Object(oa.jsx)(Hn.a,{sm:2,xs:7,className:"mb-1 border rounded text-center p-2 cursor-pointer ".concat("blue"===ct?"status-selected":""," ").concat(yt?"":"mx-2"),onClick:function(){Et("blue")},children:Object(oa.jsxs)("div",{className:"blue",children:[Object(oa.jsx)("span",{children:"Started"}),Object(oa.jsx)("h4",{children:De.blue})]})}),Object(oa.jsx)(Hn.a,{sm:2,xs:7,className:"mb-1 border rounded text-center p-2 cursor-pointer ".concat("purple"===ct?"status-selected":""," ").concat(yt?"":"mx-2"),onClick:function(){Et("purple")},children:Object(oa.jsxs)("div",{className:"purple",children:[Object(oa.jsx)("span",{children:"Picked Up"}),Object(oa.jsx)("h4",{children:De.purple})]})}),Object(oa.jsx)(Hn.a,{sm:2,xs:7,className:"mb-1 border rounded text-center p-2 cursor-pointer ".concat("red"===ct?"status-selected":""," ").concat(yt?"":"mx-2"),onClick:function(){Et("red")},children:Object(oa.jsxs)("div",{className:"red",children:[Object(oa.jsx)("span",{children:"Escalated"}),Object(oa.jsx)("h4",{children:De.red})]})}),Object(oa.jsx)(Hn.a,{sm:2,xs:7,className:"mb-1 border rounded text-center p-2 cursor-pointer ".concat("green"===ct?"status-selected":""," ").concat(yt?"":"mx-2"),onClick:function(){Et("green")},children:Object(oa.jsxs)("div",{className:"green",children:[Object(oa.jsx)("span",{children:"Dropped Off"}),Object(oa.jsx)("h4",{children:De.green})]})}),Object(oa.jsx)(Hn.a,{sm:2,xs:7,className:"mb-1 border rounded text-center p-2 cursor-pointer ".concat("grey"===ct?"status-selected":""," ").concat(yt?"":"mx-2"),onClick:function(){Et("grey")},children:Object(oa.jsxs)("div",{className:"grey",children:[Object(oa.jsx)("span",{children:"Processed"}),Object(oa.jsx)("h4",{children:De.grey})]})}),Object(oa.jsx)(Hn.a,{sm:2,xs:7,className:"mb-1 border rounded text-center p-2 cursor-pointer ".concat("black"===ct?"status-selected":""," ").concat(yt?"":"mx-2"),onClick:function(){Et("black")},children:Object(oa.jsxs)("div",{className:"black",children:[Object(oa.jsx)("span",{children:"Cancelled"}),Object(oa.jsx)("h4",{children:De.black})]})}),Object(oa.jsxs)("div",{className:"ant-col text-center ant-col-xs-7 ant-col-sm-2",children:[Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0 10px 0"},onClick:function(){Ze(!Ke)},children:Object(oa.jsx)(Rc.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 10px 10px 0"},loading:P||V,onClick:function(){D(!0),Ht()},children:!P&&!V&&Object(oa.jsx)(Pc.a,{})})]})]}),Object(oa.jsx)(Xi.a,{dataSource:_e,className:(null===_e||void 0===_e?void 0:_e.length)>0?"":"table-empty",onRow:function(e){return{onDoubleClick:function(){var t,n;"admin"===l&&(h({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e||null===(t=e.action)||void 0===t?void 0:t.page}}),console.log("active page",null===e||void 0===e||null===(n=e.action)||void 0===n?void 0:n.page))},onClick:function(){}}},columns:ze,scroll:{x:!0},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===j||void 0===j||null===(n=j.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})]})}),bt&&Object(oa.jsx)(Nr,{onClose:function(){jt(void 0)},handleConfirm:function(){t.publishToEvent(m.PublishPageTopics,Jt(null===p||void 0===p?void 0:p.connectionId),Dn({pageId:bt,userId:null===p||void 0===p?void 0:p.userId})),jt(void 0)},message:"Are you sure you want to cancel?"}),Ot&&Object(oa.jsx)(Nr,{onClose:function(){ft(void 0)},handleConfirm:Object(_n.a)(Object(Bn.a)().m(function e(){var n;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Wt();case 1:n=e.v,console.log("coordinates",n),t.publishToEvent(m.PublishPageTopics,Kt(null===p||void 0===p?void 0:p.connectionId),Dn({pageId:Ot,userId:null===p||void 0===p?void 0:p.userId,location:{coordinates:n,attributes:{address:""}}})),ft(void 0);case 2:return e.a(2)}},e)})),message:"Are you sure you want to continue?"})]})},Rr=Object(da.compose)(Object(da.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M&v=3.exp&libraries=geometry,drawing,places",loadingElement:Object(oa.jsx)("div",{style:{height:"100%"}}),containerElement:Object(oa.jsx)("div",{style:{height:"100%"}}),mapElement:Object(oa.jsx)("div",{style:{height:"100%"}})}),Object(da.withStateHandlers)(function(){return{isOpen:!1,activeMarker:null,directions:null,selectDirectionPin:null,drawingMode:null,activeInfo:null}},{onToggleOpen:function(e){var t=e.isOpen;return function(e){return{isOpen:!t,activeMarker:e}}},showDirection:function(){return function(e){return{directions:e}}},setDrawingMode:function(){return function(e){return{drawingMode:e}}},setSelectDirectionPin:function(){return function(e){return{selectDirectionPin:e}}},setActiveInfo:function(){return function(e){return{activeInfo:e}}}}),ua.withScriptjs,ua.withGoogleMap)(function(e){e.isOpen,e.active,e.setActive;var t,n,i,c=e.markers,o=e.assetMarkers,l=e.currentMarkers,r=e.currentLocation,d=e.getPlaces,u=e.setActiveInfo,v=e.activeInfo,b=e.showDirection,j=e.directions,m=e.polygon,p=e.circle,O=e.stands,f=Object(a.useRef)(null),h=Object(a.useRef)(!1),g=Object(s.c)(function(e){return e.auth}),x=g.selectedResponders,y=g.selectedAssets,I=Object(s.b)();Object(a.useEffect)(function(){x&&x.length>0&&console.log("update component")},[x]);var S=function(){i&&clearTimeout(i),i=setTimeout(function(){if(f.current){var e=f.current.getBounds();if(e){var t=e.getNorthEast(),n=e.getSouthWest();d({center:f.current.getCenter(),bounds:{minLat:n.lat(),maxLat:t.lat(),minLon:n.lng(),maxLon:t.lng()}})}}},500)};Object(a.useEffect)(function(){var e,t;!function(){var e=new google.maps.LatLngBounds;c.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),o.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),l.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),O.forEach(function(t){var n,a;e.extend({lat:null===(n=t.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=t.location.coordinates)||void 0===a?void 0:a.long})}),e.isEmpty()||f.current.fitBounds(e)}(),l&&2===l.length?(h.current=!0,e=l[0],t=l[1],(new google.maps.DirectionsService).route({origin:new google.maps.LatLng(e.lat,e.lng),destination:new google.maps.LatLng(t.lat,t.lng),travelMode:google.maps.TravelMode.DRIVING},function(e,t){t===google.maps.DirectionsStatus.OK?h.current&&b(e):console.error("error fetching directions ".concat(e))})):(h.current=!1,b(void 0))},[c,l,o,O]);return Object(oa.jsxs)(ua.GoogleMap,{defaultZoom:14,options:{maxZoom:19,styles:[{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]}]},center:r,onZoomChanged:function(){S()},onCenterChanged:function(){S()},onTilesLoaded:function(){f.current&&r&&S()},ref:f,children:[m&&Object(oa.jsx)(ua.Polygon,{path:m.paths,editable:!1,options:{strokeColor:"#FF0000",fillColor:"#FF0000"},onClick:function(e){}}),p&&Object(oa.jsx)(ua.Circle,{center:{lat:null===(t=p.location.coordinates)||void 0===t?void 0:t[1],lng:null===(n=p.location.coordinates)||void 0===n?void 0:n[0]},radius:p.radius,options:{strokeColor:"FF0000",fillColor:"FF0000"},onClick:function(e){}}),null===O||void 0===O?void 0:O.map(function(e,t){var n,a;return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-green.svg",scaledSize:new google.maps.Size(22,34)},position:{lat:null===(n=e.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=e.location.coordinates)||void 0===a?void 0:a.long},onClick:function(){I({type:Ee,payload:e})}},t)}),c.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/car-".concat(-1===x.findIndex(function(t){return t.id===e.id})?e.status:"blue",".svg"),scaledSize:new google.maps.Size(60,60)},position:{lat:e.lat,lng:e.lng},onClick:function(){"green"===(null===e||void 0===e?void 0:e.status)&&I({type:Ce,payload:e})},label:e.title},t)}),o.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===y.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){I({type:we,payload:e})},label:e.title},t)}),l.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===x.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){u(t)},children:v===t&&Object(oa.jsx)(ua.InfoWindow,{onCloseClick:function(){u(null)},children:Object(oa.jsx)("div",{children:Object(oa.jsx)("div",{children:e.title})})})},t)}),Object(oa.jsx)(ua.Marker,{position:r,icon:{url:"/images/map-plain-icon-blue.svg",scaledSize:new google.maps.Size(22,34)},onClick:function(){}}),j&&Object(oa.jsx)(ua.DirectionsRenderer,{directions:j,options:{markerOptions:{opacity:1},panel:document.getElementById("direction-panel")}})]})}),Pr={lat:29.95106579999999,lng:-90.0715323};var Dr=function(e){var t=e.socket,n=e.params,i=e.userRole,c=(n.screens,n.setScreens,Object(a.useState)()),o=Object(u.a)(c,2),r=(o[0],o[1],Object(a.useState)()),v=Object(u.a)(r,2),b=v[0],j=v[1],p=Object(a.useState)(!0),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(a.useState)(!0),x=Object(u.a)(g,2),y=x[0],I=(x[1],Object(a.useState)([])),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(a.useState)([]),C=Object(u.a)(T,2),w=C[0],E=C[1],R=Object(a.useState)([]),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Object(a.useState)(!1),L=Object(u.a)(M,2),U=L[0],q=L[1],F=Object(a.useReducer)(function(e){return e+1},0),B=Object(u.a)(F,2),_=(B[0],B[1],Object(s.c)(function(e){return e.auth})),$=_.responders,Y=_.vehicles,H=(_.incidentLocation,_.project),W=_.otherLocations,V=_.assets,z=_.geofenceLocation,Q=_.standLocations,G=_.encrypted_token,J=_.projects,K=Object(l.g)().search,Z=Object(a.useState)(),X=Object(u.a)(Z,2),ee=X[0],te=X[1],ne=(Object(s.b)(),function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],i=t[1];Object(a.useEffect)(function(){i(!0)},[])}(),{createPlaceMarker:function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m=arguments.length>1&&void 0!==arguments[1]&&arguments[1],p=arguments.length>2?arguments[2]:void 0;null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.geoJson)||void 0===n||null===(a=n.features)||void 0===a||a.map(function(e){(null===e||void 0===e?void 0:e.geometry.coordinates.length)>0&&(j=e.geometry)});var O=(null===(i=e.beamIds)||void 0===i?void 0:i[0])||"".concat(e.profile.firstName,".").concat(e.profile.lastName);return null===p||void 0===p||p.map(function(t){t.id===e.id&&(O=t.name)}),Object(d.a)(Object(d.a)({},e),{},{lat:null===(c=j)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o[1],lng:null===(l=j)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s[0],title:O,color:"orange",paths:{lat:null===(r=j)||void 0===r||null===(u=r.coordinates)||void 0===u?void 0:u[1],lng:null===(v=j)||void 0===v||null===(b=v.coordinates)||void 0===b?void 0:b[0]},type:"marker",filter:"viewOnly",fitBounds:m})},createCurrentMarker:function(e){var t,n,a,i,c,o,l,s;return console.log("render point here",e),Object(d.a)(Object(d.a)({},e),{},{lat:null===e||void 0===e||null===(t=e.value)||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.lat,lng:null===e||void 0===e||null===(a=e.value)||void 0===a||null===(i=a.coordinates)||void 0===i?void 0:i.long,title:null===e||void 0===e?void 0:e.label,color:"blue",paths:{lat:null===e||void 0===e||null===(c=e.value)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o.lat,lng:null===e||void 0===e||null===(l=e.value)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s.long},type:"marker"})},createAssetMarker:function(e){var t,n,a,i,c,o,l,s,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"fixedAsset"===(null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.type)?s=null===e||void 0===e?void 0:e.asset:"poi"===(null===e||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)&&(s=null===e||void 0===e?void 0:e.poi);var u=s.location;return Object(d.a)(Object(d.a)({},s),{},{id:e.id,assetType:null===e||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.type,lat:null===u||void 0===u||null===(i=u.coordinates)||void 0===i?void 0:i.lat,lng:null===u||void 0===u||null===(c=u.coordinates)||void 0===c?void 0:c.long,title:u.attributes.title,color:"orange",paths:{lat:null===u||void 0===u||null===(o=u.coordinates)||void 0===o?void 0:o.lat,lng:null===u||void 0===u||null===(l=u.coordinates)||void 0===l?void 0:l.long},type:"marker",filter:"viewOnly",fitBounds:r})}}),ae=ne.createPlaceMarker,ie=ne.createCurrentMarker,ce=ne.createAssetMarker,oe=Object(a.useState)(!1),le=Object(u.a)(oe,2),se=le[0],re=le[1],de=Object(a.useState)(void 0),ue=Object(u.a)(de,2),ve=ue[0],be=ue[1],je=Object(a.useState)(void 0),me=Object(u.a)(je,2),pe=me[0],Oe=me[1],fe=Object(a.useState)([]),he=Object(u.a)(fe,2),ge=he[0],xe=he[1];Object(a.useEffect)(function(){var e=new URLSearchParams(K),t=e.get("lat"),n=e.get("lng");t&&n?j({lat:parseFloat(t),lng:parseFloat(n),current:!0}):ye()},[K]),Object(a.useEffect)(function(){if(W){console.log("other locations",W);var e=Object.keys(W).map(function(e){return ie(W[e])});A(e)}},[W]),Object(a.useEffect)(function(){if(z)if(console.log("geofence location",z),"Polygon"===(null===z||void 0===z?void 0:z.location.type)){var e=null===z||void 0===z?void 0:z.location.coordinates.map(function(e){return{lat:null===e||void 0===e?void 0:e[1],lng:null===e||void 0===e?void 0:e[0]}});be({paths:e})}else Oe(z);else be(void 0),Oe(void 0)},[z]),Object(a.useEffect)(function(){Q&&(console.log("stand locations",Q),xe(Q))},[Q]);Object(a.useEffect)(function(){null!==J&&void 0!==J&&J.adminUserId&&t.subscribeToEvent(m.SubscribePageTopics,$t(null===G||void 0===G?void 0:G.connectionId))},[J]),Object(a.useEffect)(function(){if(H&&ee)ee.latLong,ee.height,ee.width},[H]),Object(a.useEffect)(function(){if(re(!1),$){console.log("responders here",$);var e=$.map(function(e){return ae(e,!1,Y)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),console.log("markers here",e),k(e)}},[$]),Object(a.useEffect)(function(){if(re(!1),V&&V.length>0){console.log("assets here",V);var e=V.map(function(e){return ce(e)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),E(e)}},[V]);var ye=function(){b&&null!==b&&void 0!==b&&b.current?j(Object(d.a)({},b)):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,n,a,i,c;j({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,lng:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude,current:!0}),gc.a.fromLatLng(null===e||void 0===e||null===(a=e.coords)||void 0===a||null===(i=a.latitude)||void 0===i?void 0:i.toString(),null===(c=e.coords.longitude)||void 0===c?void 0:c.toString()).then(function(e){for(var t=0,n=e.results[0].address_components.length;t<n;t++){var a=e.results[0].address_components[t];a.types.indexOf("administrative_area_level_1")>=0&&a.short_name,a.types.indexOf("country")>=0&&a.short_name}},function(e){console.error(e),j(Pr)})},function(e){console.error(e),j(Pr)}):(alert("Geolocation is not supported by this browser."),j(Pr))},Ie=function(e,t,n,a){var i=Se(n-e),c=Se(a-t),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(Se(e))*Math.cos(Se(n))*Math.sin(c/2)*Math.sin(c/2);return 1e3*(6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))))},Se=function(e){return e*(Math.PI/180)};return Object(oa.jsx)("div",{className:"main-column map-panel mr-4",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsx)("div",{className:"search-bar mt-3",children:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)("div",{className:"g-map-search-input",children:Object(oa.jsx)(Ii.a,{autocompletionRequest:{},selectProps:{onChange:function(e){e&&function(e){Object(Ii.b)(e.place_id).then(function(e){e[0].geometry&&j({lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),current:!1})}).catch(function(e){return console.error(e)})}(e.value)},isClearable:!0,placeholder:"Search map",styles:{input:function(e){return Object(d.a)(Object(d.a)({},e),{},{fontFamily:"Nunito-Regular"})}}},apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/location-icon.svg",onClick:ye})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/reload-icon.svg",onClick:function(){h(!1),q(!1),k([]),E([]),ye()}})}),"admin"===i&&Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",onClick:function(){var e;if(!se&&ee){var n=ee.latLong;ee.height,ee.width;e=n,re(!0),t.publishToEvent(m.PublishPageTopics,Yt(null===G||void 0===G?void 0:G.connectionId),Dn({userId:null===G||void 0===G?void 0:G.userId,projectId:H,cudbServiceId:null===J||void 0===J?void 0:J.userServiceId,latLng:e,height:3e5,width:3e5}))}},children:se?Object(oa.jsx)(Ic.a,{type:"TailSpin",color:"#95a8c8",height:20,width:20}):Object(oa.jsx)(fa.a,{src:"/images/car.svg",className:"car-icon"})})]})}),Object(oa.jsx)("div",{className:"main-cards",children:Object(oa.jsxs)(Yn.a,{className:"map-container-layout",children:[Object(oa.jsx)(Hn.a,{md:U?6:0,children:Object(oa.jsx)("div",{id:"direction-panel"})}),Object(oa.jsx)(Hn.a,{md:U?18:24,sm:24,style:{width:"inherit"},children:y&&Object(oa.jsx)(Rr,{currentLocation:b,markers:N,assetMarkers:w,currentMarkers:D,polygon:ve,circle:pe,stands:ge,active:f,setActive:h,getPlaces:function(e){var t=e.bounds,n=e.center,a=Ie(t.minLat,t.maxLon,t.maxLat,t.maxLon),i=Ie(t.minLat,t.maxLon,t.minLat,t.minLon),c={lat:n.lat(),long:n.lng()};te({latLong:c,height:a,width:i})}})})]})})]})})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var Ar=function(e){var t,n=e.socket,c=Object(s.b)(),o=Object(a.useState)(void 0),r=Object(u.a)(o,2),d=r[0],b=r[1],j=Object(a.useState)(!1),p=Object(u.a)(j,2),O=(p[0],p[1]),f=Object(a.useState)(),h=Object(u.a)(f,2),g=h[0],x=h[1],I=Object(a.useState)(),S=Object(u.a)(I,2),N=S[0],k=(S[1],Object(a.useState)()),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(s.c)(function(e){return e.auth}),R=E.encrypted_token,P=E.projects,D=Object(a.useState)({all:W()}),A=Object(u.a)(D,2),M=A[0],L=(A[1],Object(a.useState)(!0)),U=Object(u.a)(L,2),q=U[0],F=(U[1],{screen:d,setScreen:b}),B=Object(l.g)().search,_=Mn().getUserRequestPayload,$=Object(a.useState)(window.innerWidth<=768),Y=Object(u.a)($,2),H=Y[0],V=Y[1];Object(a.useEffect)(function(){var e=function(){return V(window.innerWidth<=768)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[]),Object(a.useEffect)(function(){R&&(n.subscribeToEvent(m.SubscribePageTopics,qt(null===R||void 0===R?void 0:R.connectionId)),n.publishToEvent(m.PublishPageTopics,Ft(null===R||void 0===R?void 0:R.connectionId),Dn({userId:null===R||void 0===R?void 0:R.userId,cudbServiceId:(null===R||void 0===R?void 0:R.cudbServiceId)||(null===R||void 0===R?void 0:R.serviceId)})))},[R]);Object(a.useEffect)(function(){},[g]),Object(a.useEffect)(function(){},[N]),Object(a.useEffect)(function(){var e,t;null!==P&&void 0!==P&&P.adminUserId&&(e=null===P||void 0===P?void 0:P.adminUserId,t=null===P||void 0===P?void 0:P.userServiceId,n.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,_(e,"$","$..role"),hn(null===R||void 0===R?void 0:R.connectionId),t),n.subscribeToSurvey(m.SurveyTopics,hn(null===R||void 0===R?void 0:R.connectionId),function(e){var t,n;x(null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0])},M.all),Q())},[P]);var Q=function(){var e="@serviceId:{'".concat(z(null===P||void 0===P?void 0:P.userServiceId),"'}"),t={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:e,searchOptions:"TIMEOUT 5000"},list:{objectIds:[null===R||void 0===R?void 0:R.userId]},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId",schoolBus:"$..schoolBus"}},apply:{expression:"",name:""},result:{},filter:{expression:""},anyStatus:!1};O(!0),c(tt({requestData:t,callback:function(e){var t=[];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l,s,r,d,u,v,j,m,p,f,h,g,x,y,I,S,N,k,T,C,E=null===(a=Object.values((null===e||void 0===e||null===(i=e.schoolBus)||void 0===i?void 0:i.locationList)||{}))||void 0===a?void 0:a.find(function(e){return"operationStart"===e.locationType});(t.push({key:e.id,userStatus:null===e||void 0===e||null===(c=e.status)||void 0===c?void 0:c.name,name:"".concat(null===e||void 0===e||null===(o=e.live)||void 0===o||null===(l=o.profile)||void 0===l?void 0:l.firstName," ").concat(null===e||void 0===e||null===(s=e.live)||void 0===s||null===(r=s.profile)||void 0===r?void 0:r.lastName),email:null===e||void 0===e||null===(d=e.live)||void 0===d||null===(u=d.alternativeIds)||void 0===u?void 0:u.email,phone:null===e||void 0===e||null===(v=e.live)||void 0===v||null===(j=v.alternativeIds)||void 0===j?void 0:j.phone,customId:null===e||void 0===e||null===(m=e.live)||void 0===m||null===(p=m.alternativeIds)||void 0===p?void 0:p.customId,operationLocation:null===E||void 0===E||null===(f=E.location)||void 0===f||null===(h=f.attributes)||void 0===h?void 0:h.address,licenseNumber:null===e||void 0===e||null===(g=e.schoolBus)||void 0===g||null===(x=g.license)||void 0===x?void 0:x.licenseNumber,licenseType:null===e||void 0===e||null===(y=e.schoolBus)||void 0===y||null===(I=y.license)||void 0===I?void 0:I.licenseType,licenseExpiry:null===e||void 0===e||null===(S=e.schoolBus)||void 0===S||null===(N=S.license)||void 0===N?void 0:N.expiryDate,action:{userId:null===e||void 0===e?void 0:e.id,user:e}}),w(null===t||void 0===t?void 0:t[0]),null!==t&&void 0!==t&&t[0])&&(null!==P&&void 0!==P&&null!==(k=P.webSettings)&&void 0!==k&&k.ride?b(nc.Vehicle):null!==P&&void 0!==P&&null!==(T=P.webSettings)&&void 0!==T&&T.eventCreator?b(nc.Driver):null!==P&&void 0!==P&&null!==(C=P.webSettings)&&void 0!==C&&C.projectEventCreator&&b(nc.Dashboard));O(!1)})}}))};return Object(a.useEffect)(function(){if(n.client){var e=new URLSearchParams(B),t=e.get("userId"),a=e.get("connectionId"),i=e.get("token"),o=e.get("cudbServiceId");c(i?ct({data:{payload:i},callback:function(e){}}):{type:"ADD_ENCRYPTED_TOKEN",payload:{connectionId:a,userId:t,cudbServiceId:o}})}},[B,n.client]),Object(oa.jsxs)(Yn.a,{className:"main-layout",style:{transform:"scale(0.765)",transformOrigin:"0 0",width:"133vw",height:"100vh",paddingTop:10},children:[Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-start align-items-start",children:[Object(oa.jsx)("div",{children:void 0!==d?Object(oa.jsx)(i.a.Fragment,{}):Object(oa.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}})]})}),Object(oa.jsxs)(Yn.a,{style:{height:"130vh",overflow:"scroll",width:"100%"},children:[d===nc.Dashboard&&Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(Hn.a,{sm:24,xs:24,style:H?{}:{height:"130vh",overflow:"scroll"},children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:24,className:"ride-container",children:Object(oa.jsx)(Dr,{socket:n,params:F,userRole:N})}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mt-3",style:{padding:0},children:Object(oa.jsx)(Er,{socket:n,filter:!0,componentUuid:M.all,userRole:N})})})})]})})}),d===nc.Driver&&Object(oa.jsx)(Hn.a,{span:24,style:{width:"100%"},children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:H?16:0,minHeight:"130vh"},children:Object(oa.jsx)(bs,{socket:n,student:null===C||void 0===C||null===(t=C.action)||void 0===t?void 0:t.user,onClose:function(){},onAdd:function(){Q()},sourceData:[C],fullScreen:!0})})})}),d===nc.Vehicle&&Object(oa.jsx)(Hn.a,{span:24,style:{width:"100%"},children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal ".concat(q?"mr-4":""),children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:H?16:0,minHeight:"130vh"},children:Object(oa.jsx)(Uo,{socket:n})})})})]})]}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var Mr=function(e){var t=e.socket,n=(Object(l.f)(),Object(s.b)(),Object(a.useState)({form:!0,map:!0})),i=Object(u.a)(n,2),c=i[0],o=i[1],r=Object(a.useState)(window.innerWidth<=768),d=Object(u.a)(r,2),v=d[0],b=d[1];Object(a.useEffect)(function(){var e=function(){return b(window.innerWidth<=768)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[]);var j={screens:c,setScreens:o};return Object(oa.jsxs)(Yn.a,{className:"main-layout",children:[c.form&&Object(oa.jsx)(Hn.a,{md:c.map?12:24,xs:24,className:"form"===c.active?"active-screen":"",children:c.form&&Object(oa.jsx)(io,{socket:t,params:j,fullScreen:!0})}),c.map&&!v&&Object(oa.jsx)(Hn.a,{md:12,xs:24,className:"map"===c.active?"active-screen":"",children:Object(oa.jsx)(lo,{socket:t,params:j})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})},Lr=Gn.a.Option,Ur=function(e){var t,n=e.value,i=e.placeholder,c=e.onChange,o=e.adminRoles,l=e.multiple,r=Object(s.c)(function(e){return e.auth}),v=r.projects,b=r.users_filter,j=Object(a.useState)(0),m=Object(u.a)(j,2),p=m[0],O=m[1],f=Object(a.useState)(!1),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)(!0),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useState)(!1),T=Object(u.a)(k,2),w=T[0],E=T[1],R=Object(a.useState)([]),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Object(s.b)(),L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";O(e),x(!0);o.filter(function(e){return-1!==e.permissions.indexOf("live")&&-1===e.permissions.indexOf("admin")}).map(function(e){return"@roleId === '".concat(e._id,"'")});x(!0);var n={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===v||void 0===v?void 0:v.userServiceId),"'}@partitions:{type\\:student}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status",searchName:"$..searchName"}},filter:{expression:t&&""!==t?"exists(@searchName) && contains(@searchName, '".concat(t,"')"):""}};M(tt({requestData:n,callback:function(e){x(!1);var t=null===e||void 0===e?void 0:e.map(function(e){var t,n,a,i={id:null===e||void 0===e||null===(t=e.objectId)||void 0===t?void 0:t.toString(),name:null===e||void 0===e||null===(n=e.info)||void 0===n?void 0:n.name,beamId:null===e||void 0===e||null===(a=e.info)||void 0===a?void 0:a.name};return{id:i.id,name:i.beamId,obj:i}}).filter(function(e){return!D.find(function(t){return e.id===t.id})});console.log("options",t),A([].concat(Object(C.a)(D),Object(C.a)(t))),E(!0),0===t.length&&N(!1)}}))};return Object(oa.jsx)(Gn.a,{showSearch:!0,mode:l?"multiple":void 0,className:"w-full",value:w?l?null===n||void 0===n?void 0:n.map(function(e){return null===e||void 0===e?void 0:e.id}):null===n||void 0===n?void 0:n.id:l?null===n||void 0===n?void 0:n.map(function(e){return null===e||void 0===e?void 0:e.beamId}):null===n||void 0===n?void 0:n.beamId,placeholder:i,allowClear:!0,disabled:void 0===o,onChange:function(e){if(console.log("values",e),l){var t=[];e.map(function(e){var n=D.find(function(t){return t.id===e});n&&t.push(Object(d.a)({id:e},n.obj))}),console.log("changes",t),c(t)}else{var n=D.find(function(t){return t.id===e});c(Object(d.a)({id:e},n.obj))}},loading:g,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},onFocus:function(){var e;0===(null!==(e=null===b||void 0===b?void 0:b.length)&&void 0!==e?e:0)&&L(0)},onSearch:function(e){t&&clearTimeout(t),t=setTimeout(function(){e&&""!==e?(L(0,e),N(!1)):L(0)},500)},onPopupScroll:function(e){e.persist();var t=e.target;t.scrollTop+t.offsetHeight===t.scrollHeight&&S&&L(p+1)},children:null===D||void 0===D?void 0:D.map(function(e,t){return Object(oa.jsx)(Lr,{value:e.id,children:e.name},t)})})},qr=(Za.a.Panel,function(e){var t=e.onClose,n=e.handleConfirm,i=e.message,c=Object(a.useState)(!0),o=Object(u.a)(c,2),l=o[0],s=o[1],r=ei.a.useForm(),d=Object(u.a)(r,1)[0],v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=b[0],m=b[1],p=function(){s(!1),t&&t()};return Object(oa.jsx)($n.a,{title:"Please Confirm",visible:l,onCancel:p,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"confirmation-form",id:"confirmation-form",layout:"vertical",form:d,requiredMark:!1,children:[Object(oa.jsx)(ei.a.Item,{name:"password",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(Jc.a,{children:i||"Are you sure you want to continue?"})}),Object(oa.jsx)(ei.a.Item,{className:"action-grp mt-4",children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{loading:j,className:"beam-btn green-btn cover w-full",onClick:function(){m(!0),n()},children:"Confirm"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:p,children:"Cancel"})})]})})]})})});gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var Fr=Wn.a.TextArea,Br=function(e){var t,n,c,o,r,v,b,j=e.socket,p=e.params,O=e.fullScreen,f=e.scale,h=(e.componentUuids,e.userRole),g=ei.a.useForm(),x=Object(u.a)(g,1)[0],y=Object(a.useState)(""),I=Object(u.a)(y,2),S=I[0],N=I[1],k=p.screens,T=p.setScreens,C=Object(l.g)().search,w=Object(l.f)(),E=Object(s.c)(function(e){return e.auth}).projects,R=Object(s.b)(),P=Object(s.c)(function(e){return e.auth}),D=P.submitted,A=P.page,M=P.encrypted_token,L=P.selectedPickup,U=P.standLocations,q=P.selectedPage,F=P.adminUserRoles,B=Object(a.useState)(!1),_=Object(u.a)(B,2),Y=_[0],W=_[1],V=Object(a.useState)(!1),z=Object(u.a)(V,2),Q=z[0],G=(z[1],Object(a.useState)(void 0)),J=Object(u.a)(G,2),K=J[0],Z=J[1],ee=Object(a.useState)(void 0),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ie=Object(a.useState)(),ce=Object(u.a)(ie,2),oe=(ce[0],ce[1]),le=Object(a.useState)(),se=Object(u.a)(le,2),re=se[0],de=(se[1],Object(a.useState)(!1)),ue=Object(u.a)(de,2),ve=ue[0],be=ue[1],je=Object(a.useRef)(!0),me=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,o,l,s,r,u,v;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(!((null===U||void 0===U?void 0:U.length)>0)){e.n=1;break}return e.a(2);case 1:return o=null===M||void 0===M?void 0:M.userId,l=K,s=null===M||void 0===M?void 0:M.connectionId,t[void 0]&&(t=t[void 0]),r={},Object.keys(t).map(function(e){var n=X(e,e,t[e],[],{});Array.isArray(n)?null===n||void 0===n||n.map(function(e){$.a.merge(r,e)}):$.a.merge(r,n)}),N(void 0),W(!0),u=Object(d.a)(Object(d.a)({},r),{},{driver:null===r||void 0===r||null===(n=r.driver)||void 0===n?void 0:n.value,vehicle:null===r||void 0===r||null===(a=r.vehicle)||void 0===a?void 0:a.value,studentId:null===(i=t)||void 0===i||null===(c=i.studentId)||void 0===c?void 0:c.id}),v=[],e.n=2,Promise.all(Object.keys(u).map(function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,r,b,j,m,p,O;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:"dispatchType"===(null===u||void 0===u||null===(n=u[t])||void 0===n?void 0:n.type)&&(i=Object(d.a)({},u),"schedule"===(null===u||void 0===u||null===(a=u[t])||void 0===a?void 0:a.value)?(i.scheduleDate=null===i||void 0===i||null===(c=i[t])||void 0===c?void 0:c.date,i.scheduleTime=null===i||void 0===i||null===(r=i[t])||void 0===r?void 0:r.time,m=new Date(null===i||void 0===i||null===(b=i[t])||void 0===b?void 0:b.dateTimestamp),p=new Date(null===i||void 0===i||null===(j=i[t])||void 0===j?void 0:j.timeTimestamp),m.setHours(p.getHours()),m.setMinutes(p.getMinutes()),i[t]={utcDateTime:new Date(m.getTime()).toUTCString(),rideDateTime:new Date(m.getTime()).toUTCString(),ridelocalDateTime:m.getTime(),type:"schedule"}):(O=new Date,i[t]={utcDateTime:new Date(O.getTime()).toUTCString(),rideDateTime:new Date(O.getTime()).toUTCString(),ridelocalDateTime:O.getTime(),type:"immediate"}),v.push({userId:o,rideRequestAttributes:Object(d.a)({},i),connectionId:s,pageId:je.current?l:void 0,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()));case 2:v.map(function(e){j.publishToEvent(m.PublishPageTopics,Qt(s),Dn(e))});case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){var e,t,n,a,i,c,o,l,s;q&&(pe(Object(d.a)(Object(d.a)({},null===q||void 0===q?void 0:q.page),{},{persistent:{static:{profile:null===q||void 0===q||null===(e=q.page)||void 0===e?void 0:e.profile}}})),null!==q&&void 0!==q&&q.ignorePage?(Z(void 0),ae(void 0)):(Z(null===q||void 0===q||null===(t=q.page)||void 0===t||null===(n=t.pageId)||void 0===n?void 0:n.toString()),ae((null===q||void 0===q||null===(a=q.page)||void 0===a?void 0:a.status)||(null===q||void 0===q||null===(i=q.page)||void 0===i||null===(c=i.nonpersistent)||void 0===c||null===(o=c.static)||void 0===o||null===(l=o.live)||void 0===l||null===(s=l.status)||void 0===s?void 0:s.name))))},[q]),Object(a.useEffect)(function(){if(L){var e,t,n={type:"incident-location",label:null===(e=L.location.attributes)||void 0===e?void 0:e.address,value:{description:null===L||void 0===L||null===(t=L.location.attributes)||void 0===t?void 0:t.address,place_id:"",coordinates:null===L||void 0===L?void 0:L.location.coordinates}};x.setFieldsValue({pickupLocation:n}),n&&(Oe({pickupLocation:n}),T(Object(d.a)(Object(d.a)({},k),{},{map:!0})),R({type:Ue,payload:void 0}),R({type:qe,payload:[]}))}},[L]);var pe=function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m,p;x.resetFields(),R({type:De,payload:!1}),console.log("page",e);var O,f,h,g=(null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.profile)||void 0===a?void 0:a.unstructuredAttributes)||{},y=g.location,I=g.time,S=g.projectId,N=g.vehicleId,k=g.driverId,T=g.userId,C=g.studentName;(console.log("user",T,C),y)&&(O={type:"location",label:null===y||void 0===y||null===(f=y.attributes)||void 0===f?void 0:f.address,value:{description:null===y||void 0===y||null===(h=y.attributes)||void 0===h?void 0:h.address,place_id:"",coordinates:null===y||void 0===y?void 0:y.coordinates}},Oe({location:O}));x.setFieldsValue(Object(d.a)(Object(d.a)({},null!==(i=null===e||void 0===e||null===(c=e.persistent)||void 0===c||null===(o=c.static)||void 0===o?void 0:o.profile)&&void 0!==i?i:{}),{},{location:O,dispatch:{value:"schedule",type:"dispatchType",date:H()(I).format("MM/DD/YYYY HH:mm:ss"),time:H()(I).format("MM/DD/YYYY HH:mm:ss")},project:S,vehicle:{type:"vehicle",value:N,valueName:null===e||void 0===e||null===(l=e.persistent)||void 0===l||null===(s=l.static)||void 0===s||null===(r=s.profile)||void 0===r?void 0:r.vehicleName},studentId:T?{id:T,beamId:null===e||void 0===e||null===(u=e.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.profile)||void 0===b?void 0:b.studentName}:void 0,driver:{type:"responder",value:k,beamId:null===e||void 0===e||null===(j=e.persistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.profile)||void 0===p?void 0:p.driverName,id:k}}))};Object(a.useEffect)(function(){A&&pe(A)},[JSON.stringify(null!==(t=null===A||void 0===A||null===(n=A.persistent)||void 0===n||null===(c=n.static)||void 0===c?void 0:c.profile)&&void 0!==t?t:{})]),Object(a.useEffect)(function(){if(D)if(W(!1),D.status)Lt("Ride request submitted","success","TOP_CENTER",1e3),R({type:De,payload:!1}),fe();else if(!1===D.status){var e;Lt((null===D||void 0===D||null===(e=D.data)||void 0===e?void 0:e.details)||"Ride request failed","error","TOP_CENTER",3e3),R({type:De,payload:!1})}},[R,w,x,Q,k,C,Y,T,D]),Object(a.useEffect)(function(){if(null!==E&&void 0!==E&&E.adminUserId){var e=null===M||void 0===M?void 0:M.connectionId;j.subscribeToEvent(m.SubscribePageTopics,yn(e)),j.subscribeToEvent(m.SubscribePageTopics,bn(e,null===E||void 0===E?void 0:E.userServiceId))}},[E]),Object(a.useEffect)(function(){if(M){var e=new URLSearchParams(C),t=e.get("token"),n=e.get("setup_intent_client_secret");if(t&&n){var a=JSON.parse(localStorage.getItem("formValues"));a&&x.setFieldsValue(Object(d.a)({},a))}j.subscribeToEvent(m.SubscribePageTopics,(i=null===M||void 0===M?void 0:M.connectionId,"".concat(Ut,"/connection/").concat(i,"/service/dps/updateSchoolBusPage/reply"))),j.subscribeToEvent(m.SubscribePageTopics,fn(null===M||void 0===M?void 0:M.userId),function(e){var t,n,a;pe(Object(d.a)(Object(d.a)({},null===e||void 0===e?void 0:e.page),{},{persistent:{static:{profile:null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.profile}}})),Z(null===e||void 0===e||null===(n=e.page)||void 0===n||null===(a=n.pageId)||void 0===a?void 0:a.toString())}),j.subscribeToEvent(m.SubscribePageTopics,nn(null===M||void 0===M?void 0:M.connectionId),function(e){Lt("Ride cancelled successfully","success","TOP_CENTER",1e3),R({type:De,payload:!1}),fe()}),j.subscribeToEvent(m.SubscribePageTopics,an(null===M||void 0===M?void 0:M.connectionId)),null!==M&&void 0!==M&&M.pageId&&j.publishToEvent(m.PublishPageTopics,cn(null===M||void 0===M?void 0:M.connectionId),Dn({objectId:null===M||void 0===M?void 0:M.pageId,paths:["$"],returnPaths:["$"]},null===M||void 0===M?void 0:M.pageId))}var i},[M]);var Oe=function(e){R({type:Ae,payload:e})},fe=function(){setTimeout(function(){var e=new URLSearchParams(C);e.delete("pageId"),e.delete("sessionId"),w.replace({search:e.toString()}),localStorage.removeItem("form"),localStorage.removeItem("formValues"),localStorage.removeItem("active"),R({type:De,payload:!1}),R({type:"SET_SELECTED_PAGE",payload:{page:void 0}}),x.resetFields(),x.setFieldsValue({dispatch:{type:"dispatchType",value:"schedule"}}),Z(void 0)})};return Object(oa.jsxs)("div",{className:"main-column ride-dispatch-panel mr-4",style:f?{height:"auto"}:{},children:[Object(oa.jsx)("div",{className:"main-content",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",initialValues:{dispatch:{type:"dispatchType",value:"schedule"},scheduleType:"pickup"},id:"register-form",layout:"vertical",form:x,onFinish:me,requiredMark:!1,onValuesChange:function(e,t){localStorage.setItem("form",JSON.stringify(t))},style:O?{}:{height:"48vh"},children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h3",{className:"ml-3",children:K&&A?"".concat(null===A||void 0===A||null===(o=A.persistent)||void 0===o||null===(r=o.static)||void 0===r||null===(v=r.metatdata)||void 0===v?void 0:v.title):"School bus"})}),Object(oa.jsx)("div",{className:"d-flex"})]}),Object(oa.jsxs)("div",{className:"main-cards",style:{maxHeight:f?"calc(100vh)":"calc(100vh - 200px)"},children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"studentId",children:Object(oa.jsx)(Ur,{multiple:!1,placeholder:"Select student",adminRoles:K?void 0:F})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"location",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(ai,{placeholder:"Location",onChange:function(e){Oe({location:e}),T(Object(d.a)(Object(d.a)({},k),{},{map:!0}))}})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(ei.a.Item,{label:"Schedule type",name:"scheduleType",children:Object(oa.jsxs)(yi.a.Group,{children:[Object(oa.jsx)(yi.a,{value:"pickup",children:"Pickup"}),Object(oa.jsx)(yi.a,{value:"dropoff",children:"Dropoff"})]})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"dispatch",rules:[{required:!0,message:"**Required Field"},{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if("schedule"!==(null===n||void 0===n?void 0:n.value)||null!==n&&void 0!==n&&n.date&&null!==n&&void 0!==n&&n.time){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(Ci,{placeholder:"Select dispatch",dispatchOptions:[{id:"immediate",name:"Immediate"},{id:"schedule",name:"Schedule"}],onChange:function(e){oe(e.value)}})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"project",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select project",onChange:function(e){},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===E||void 0===E||null===(b=E.projects)||void 0===b?void 0:b.map(function(e,t){return Object(oa.jsx)(Gn.a.Option,{value:e.id,children:e.name})})})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"vehicle",children:Object(oa.jsx)(zc,{placeholder:"Select vehicle",onChange:function(e){},socket:j,vehicleType:re,vehicleId:!0})})})}),F&&F.length>0&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"driver",children:Object(oa.jsx)(fi,{placeholder:"Select driver",adminRoles:F,onChange:function(e){},multiple:!1})})})})]}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"instructions",children:Object(oa.jsx)(Fr,{autoSize:{minRows:4,maxRows:6},placeholder:"Instructions"})})})}),Object(oa.jsxs)(Yn.a,{className:"d-flex px-2",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("p",{children:"Optional"})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("p",{children:"max. 500 character"})})]})]}),S&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:S})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:K?8:12,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full w-full",onClick:function(){fe()},children:"Clear"})}),K&&Object(oa.jsx)(Hn.a,{span:8,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full w-full",onClick:function(){be(!0)},disabled:"black"===ne,children:"Cancel"})}),Object(oa.jsx)(Hn.a,{span:K?8:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:Y,disabled:"admin"!==h,onClick:function(){je.current=!0},children:"Dispatch"})})]})]})}),ve&&Object(oa.jsx)(qr,{onClose:function(){be(void 0)},handleConfirm:function(){j.publishToEvent(m.PublishPageTopics,Jt(null===M||void 0===M?void 0:M.connectionId),Dn({pageId:K,userId:null===M||void 0===M?void 0:M.userId})),be(void 0)},message:"Are you sure you want to cancel?"})]})},_r=(Za.a.Panel,Kl.a.TabPane),$r=function(e){var t,n,c=e.onClose,o=e.socket,l=e.student,r=e.onAdd,v=e.userRole,b=Object(a.useState)(!0),j=Object(u.a)(b,2),p=j[0],O=j[1],f=ei.a.useForm(),h=Object(u.a)(f,1)[0],g=Object(a.useState)(""),x=Object(u.a)(g,2),y=(x[0],x[1]),I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1],w=Object(a.useState)("1"),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(s.c)(function(e){return e.auth}),A=D.projects,M=D.encrypted_token;Mn().updateUserRequestPayloadV2;Object(a.useEffect)(function(){if(null!==l&&void 0!==l&&l.schoolBus){var e,t,n,a,i,c,o,s,r,u={},v=[],b=[],j=[];null===(e=Object.values((null===l||void 0===l||null===(t=l.schoolBus)||void 0===t?void 0:t.pickupLocationList)||{}))||void 0===e||e.map(function(e){var t,n,a,i,c,o,l,s=K(null===e||void 0===e||null===(t=e.condition)||void 0===t?void 0:t.cron),r=(s.date,s.daysOfWeek),b={location:{label:null===e||void 0===e||null===(n=e.location)||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.address,value:{description:null===e||void 0===e||null===(i=e.location)||void 0===i||null===(c=i.attributes)||void 0===c?void 0:c.address,place_id:"",coordinates:null===e||void 0===e||null===(o=e.location)||void 0===o?void 0:o.coordinates,attributes:null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.attributes}},days:r};v.push(b),u=Object(d.a)(Object(d.a)({},u),{},Object(T.a)(Object(T.a)({},"location-Pickup-".concat(v.length-1),b.location),"days-Pickup-".concat(v.length-1),b.days))}),null===(n=Object.values((null===l||void 0===l||null===(a=l.schoolBus)||void 0===a?void 0:a.dropoffLocationList)||{}))||void 0===n||n.map(function(e){var t,n,a,i,c,o,l,s=K(null===e||void 0===e||null===(t=e.condition)||void 0===t?void 0:t.cron),r=(s.date,s.daysOfWeek),v={location:{label:null===e||void 0===e||null===(n=e.location)||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.address,value:{description:null===e||void 0===e||null===(i=e.location)||void 0===i||null===(c=i.attributes)||void 0===c?void 0:c.address,place_id:"",coordinates:null===e||void 0===e||null===(o=e.location)||void 0===o?void 0:o.coordinates,attributes:null===e||void 0===e||null===(l=e.location)||void 0===l?void 0:l.attributes}},days:r};b.push(v),u=Object(d.a)(Object(d.a)({},u),{},Object(T.a)(Object(T.a)({},"location-Dropoff-".concat(b.length-1),v.location),"days-Dropoff-".concat(b.length-1),v.days))}),null===(i=Object.values((null===l||void 0===l||null===(c=l.schoolBus)||void 0===c?void 0:c.holidays)||{}))||void 0===i||i.map(function(e){j.push(H()(null===e||void 0===e?void 0:e.timestamp))}),h.setFieldsValue(Object(d.a)(Object(d.a)({pickup:v,dropoff:b,holidays:j},u),{},{emergency:null===l||void 0===l||null===(o=l.schoolBus)||void 0===o?void 0:o.emergency,rfidNumber:null===l||void 0===l||null===(s=l.schoolBus)||void 0===s?void 0:s.rfidNumber,preferences:null===l||void 0===l||null===(r=l.schoolBus)||void 0===r?void 0:r.preferences}))}},[]);var L=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,o,s,u,v;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("values",t),s=null===t||void 0===t||null===(n=t.pickup)||void 0===n||null===(a=n.map(function(e){var t,n,a,i;return{locationType:"pickup",location:{coordinates:null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.coordinates,attributes:null===e||void 0===e||null===(a=e.location)||void 0===a||null===(i=a.value)||void 0===i?void 0:i.attributes},condition:{cron:J(new Date,null===e||void 0===e?void 0:e.days),validity:-1}}}))||void 0===a?void 0:a.reduce(function(e,t,n){var a=W();return e[a]=Object(d.a)({locationId:a},t),e},{}),u=null===t||void 0===t||null===(i=t.dropoff)||void 0===i||null===(c=i.map(function(e){var t,n,a,i;return{locationType:"dropoff",location:{coordinates:null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.coordinates,attributes:null===e||void 0===e||null===(a=e.location)||void 0===a||null===(i=a.value)||void 0===i?void 0:i.attributes},condition:{cron:J(new Date,null===e||void 0===e?void 0:e.days),validity:-1}}}))||void 0===c?void 0:c.reduce(function(e,t,n){var a=W();return e[a]=Object(d.a)({locationId:a},t),e},{}),v=null===t||void 0===t||null===(o=t.holidays)||void 0===o?void 0:o.reduce(function(e,t,n){var a=t.toDate().getTime();return e[a]={timestamp:a,type:"emergency"},e},{}),k(!0),console.log("student here",l),e.n=1,U(null===l||void 0===l?void 0:l.id,null===A||void 0===A?void 0:A.userServiceId,{pickupLocationList:s,dropoffLocationList:u,holidays:v,emergency:null===t||void 0===t?void 0:t.emergency,preferences:null===t||void 0===t?void 0:t.preferences,rfidNumber:null===t||void 0===t?void 0:t.rfidNumber});case 1:console.log("request",{pickupLocationList:s,dropoffLocationList:u,holidays:v,emergency:null===t||void 0===t?void 0:t.emergency,preferences:null===t||void 0===t?void 0:t.preferences}),Lt("User updated successfully","success","TOP_CENTER",3e3),k(!1),r();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n,a){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){var i=a.pickupLocationList,c=a.dropoffLocationList,l=a.holidays,s=a.emergency,r=a.preferences,d=a.rfidNumber,u=[];i&&u.push({op:"add",path:"/info/schoolBus/pickupLocationList",value:i}),c&&u.push({op:"add",path:"/info/schoolBus/dropoffLocationList",value:c}),l&&u.push({op:"add",path:"/info/schoolBus/holidays",value:l}),s&&u.push({op:"add",path:"/info/schoolBus/emergency",value:s}),r&&u.push({op:"add",path:"/info/schoolBus/preferences",value:r}),d&&u.push({op:"add",path:"/info/schoolBus/rfidNumber",value:d}),console.log("update user data",u),o.publishToEvent(m.PublishPageTopics,un(null===M||void 0===M?void 0:M.connectionId),Dn({objectId:t,changes:u})),o.subscribeToEvent(m.SubscribePageTopics,dn(null===M||void 0===M?void 0:M.connectionId),function(t){console.log("update response",t),e(t)})}))},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),q=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],F=function(e){var t=e.value,n=e.keyPrefix,i=void 0===n?"Pickup":n,c=e.onChange,o=Object(a.useState)(t||[{location:void 0,days:void 0}]),l=Object(u.a)(o,2),s=l[0],r=l[1];Object(a.useEffect)(function(){t&&r(t)},[t]);var v=function(e,t,n){var a=s.map(function(a,i){return i===e?Object(d.a)(Object(d.a)({},a),{},Object(T.a)({},t,n)):a});null===c||void 0===c||c(a)};return Object(oa.jsxs)(oa.Fragment,{children:[s.map(function(e,t){var n=q.filter(function(t){var n;return!s.reduce(function(e,t){return t.days?[].concat(Object(C.a)(e),Object(C.a)(t.days)):e},[]).includes(t)||(null===(n=e.days)||void 0===n?void 0:n.includes(t))});return Object(oa.jsxs)(Yn.a,{className:"mb-3",children:[Object(oa.jsx)(Hn.a,{span:22,className:"pr-2",children:Object(oa.jsx)(ei.a.Item,{label:"".concat(i," Location"),name:"location-".concat(i,"-").concat(t),rules:[{required:!0,message:"Location is required"}],children:Object(oa.jsx)(ai,{placeholder:"Enter Location",onChange:function(e){return v(t,"location",e)}})})}),Object(oa.jsx)(Hn.a,{span:2,className:"t-right d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn orange-btn bordered",onClick:function(){return function(e){r(function(t){return t.filter(function(t,n){return n!==e})})}(t)},children:Object(oa.jsx)(na.a,{})})}),Object(oa.jsx)(Hn.a,{span:24,className:"mt-3",children:Object(oa.jsx)(ei.a.Item,{label:"".concat(i," Days"),name:"days-".concat(i,"-").concat(t),rules:[{required:!0,message:"Days selection is required"}],children:Object(oa.jsx)(Gn.a,{placeholder:"Select Days",mode:"multiple",value:e.days,onChange:function(e){return v(t,"days",e)},style:{width:"100%"},children:n.map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})})})]},"location-".concat(t))}),Object(oa.jsx)(Yn.a,{className:"mt-3 mb-3",children:Object(oa.jsx)(Hn.a,{span:24,className:"d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn yellow-btn bordered",onClick:function(){r(function(e){return[].concat(Object(C.a)(e),[{location:void 0,days:void 0}])})},children:"Add"})})})]})},B=function(e){var t=e.value,n=void 0===t?[]:t,a=e.onChange;return Object(oa.jsxs)("div",{children:[Object(oa.jsx)("label",{className:"ant-form-item-required",children:"Holidays"}),Object(oa.jsx)(Jn.a,{onChange:function(e){if(e&&(null===n||void 0===n||!n.find(function(t){return t.isSame(e,"day")}))){var t=[].concat(Object(C.a)(n),[e]);null===a||void 0===a||a(t)}},disabledDate:function(e){return null===n||void 0===n?void 0:n.some(function(t){return null===t||void 0===t?void 0:t.isSame(e,"day")})},placeholder:"Select date"}),Object(oa.jsx)("div",{style:{marginTop:"16px"},className:"custom-tag",children:null===n||void 0===n?void 0:n.map(function(e){return Object(oa.jsx)(Kn.a,{className:"tag-item",closable:!0,onClose:function(){return function(e){var t=null===n||void 0===n?void 0:n.filter(function(t){return!t.isSame(e,"day")});null===a||void 0===a||a(t)}(e)},closeIcon:Object(oa.jsx)(Ls.a,{}),children:e.format("YYYY-MM-DD")},e.toISOString())})})]})},_=function(e){var t=e.value,n=e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{label:"Emergency Contact Name",required:!0,children:Object(oa.jsx)(Wn.a,{placeholder:"Enter contact name",value:null===t||void 0===t?void 0:t.name,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{name:e.target.value}))}})}),Object(oa.jsx)(ei.a.Item,{label:"Emergency Contact Number",required:!0,className:"mt-3",children:Object(oa.jsx)(Fi.a,{defaultCountry:"US",placeholder:"Enter contact number",value:null===t||void 0===t?void 0:t.phoneNumber,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{phoneNumber:e}))}})}),Object(oa.jsx)(ei.a.Item,{label:"Relationship to Student",required:!0,className:"mt-3",children:Object(oa.jsxs)(Gn.a,{placeholder:"Select relationship",value:null===t||void 0===t?void 0:t.relationship,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{relationship:e}))},children:[Object(oa.jsx)(Gn.a.Option,{value:"Mother",children:"Mother"}),Object(oa.jsx)(Gn.a.Option,{value:"Father",children:"Father"}),Object(oa.jsx)(Gn.a.Option,{value:"Relative",children:"Relative"}),Object(oa.jsx)(Gn.a.Option,{value:"Guardian",children:"Guardian"}),Object(oa.jsx)(Gn.a.Option,{value:"Other",children:"Other"})]})})]})},$=function(e){var t=e.value,n=e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(ei.a.Item,{children:[Object(oa.jsx)(Xn.a,{checked:null===t||void 0===t?void 0:t.hasSpecialNeeds,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{hasSpecialNeeds:e.target.checked}))},children:"Special Needs Requirements"}),(null===t||void 0===t?void 0:t.hasSpecialNeeds)&&Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsx)(Wn.a,{placeholder:"Specify special needs",value:null===t||void 0===t?void 0:t.specialNeedsInfo,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{specialNeedsInfo:e.target.value}))},className:"mt-2"}),Object(oa.jsx)(Xn.a.Group,{className:"mt-3",options:[{label:"Wheelchair Access",value:"Wheelchair Access"},{label:"Assistance Needed",value:"Assistance Needed"}],value:null===t||void 0===t?void 0:t.specialNeeds,onChange:function(e){null===n||void 0===n||n(Object(d.a)(Object(d.a)({},t),{},{specialNeeds:e}))}})]})]}),Object(oa.jsx)(ei.a.Item,{label:"Safety Requirements",className:"mt-3",children:Object(oa.jsx)(Xn.a.Group,{options:[{label:"Bus Monitor Required",value:"Bus Monitor Required"},{label:"Seat Belt Required",value:"Seat Belt Required"}],value:null===t||void 0===t?void 0:t.safetyRequirements,onChange:function(e){null===n||void 0===n||n(Object(d.a)(Object(d.a)({},t),{},{safetyRequirements:e}))}})})]})};return Object(oa.jsx)($n.a,{title:"Edit (".concat((null===l||void 0===l||null===(t=l.live)||void 0===t||null===(n=t.beamIds)||void 0===n?void 0:n[0])||"student",")"),visible:p,onCancel:function(){O(!1),c&&c()},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:h,onFinish:L,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsxs)(Kl.a,{defaultActiveKey:"1",type:"line",onChange:function(e){P(e)},children:[Object(oa.jsx)(_r,{tab:"Pickup",children:"1"===R&&Object(oa.jsx)(ei.a.Item,{name:"pickup",children:Object(oa.jsx)(F,{keyPrefix:"Pickup"})})},"1"),Object(oa.jsx)(_r,{tab:"Dropoff",children:"2"===R&&Object(oa.jsx)(ei.a.Item,{name:"dropoff",children:Object(oa.jsx)(F,{keyPrefix:"Dropoff"})})},"2"),Object(oa.jsx)(_r,{tab:"Holidays",children:"3"===R&&Object(oa.jsx)(ei.a.Item,{name:"holidays",children:Object(oa.jsx)(B,{})})},"3"),Object(oa.jsx)(_r,{tab:"Emergency Contact",children:"4"===R&&Object(oa.jsx)(ei.a.Item,{name:"emergency",children:Object(oa.jsx)(_,{})})},"4"),Object(oa.jsx)(_r,{tab:"Preferences",children:"5"===R&&Object(oa.jsx)(ei.a.Item,{name:"preferences",children:Object(oa.jsx)($,{})})},"5"),"admin"===v&&Object(oa.jsx)(_r,{tab:"RFID",children:"6"===R&&Object(oa.jsx)(ei.a.Item,{label:"RFID Number",name:"rfidNumber",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter RFID Number"})})},"6")]})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:N,type:"primary",htmlType:"submit",onClick:function(){return y("")},children:"Save"})})})})]})})},Yr=n(532);Dc.d.register(Dc.a,Dc.j,Dc.e);var Hr,Wr,Vr=Gn.a.Option,zr=function(e){var t,n=e.socket,c=(e.params,e.componentUuid,e.userRole),o=Object(s.c)(function(e){return e.auth}),l=o.selectedPage,r=o.encrypted_token,v=o.projects,b=o.adminUserRoles,j=Object(s.b)(),p=Object(a.useState)([]),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(a.useState)([]),x=Object(u.a)(g,2),y=x[0],I=x[1];Object(a.useState)(!1);var S=Object(a.useState)(!1),N=Object(u.a)(S,2),k=N[0],T=N[1];Object(a.useState)(!1);Mn().getUserRequestPayload;var w=Object(a.useRef)(),E=Object(a.useState)(void 0),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(void 0),M=Object(u.a)(A,2),L=M[0],U=(M[1],Object(a.useState)(!1)),q=Object(u.a)(U,2),F=q[0],B=q[1],_=Object(a.useState)([]),$=Object(u.a)(_,2),Y=$[0],H=$[1],W=ei.a.useForm(),V=Object(u.a)(W,1)[0],Q=Object(a.useState)(void 0),G=Object(u.a)(Q,2),J=G[0],K=G[1],Z=Object(a.useRef)(!0),X=Object(a.useRef)(null),ee=Object(a.useState)(window.innerWidth<=768),te=Object(u.a)(ee,2),ne=te[0],ae=te[1];Object(a.useEffect)(function(){var e=window.matchMedia("(max-width: 768px)"),t=function(e){return ae(e.matches)};return e.addEventListener("change",t),function(){return e.removeEventListener("change",t)}},[]);var ie=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===v||void 0===v?void 0:v.userServiceId),"'}@partitions:{type\\:student}").concat("student"===c?"@partitions:{parent\\:".concat(null===r||void 0===r?void 0:r.userId,"}"):""),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",objectId:"$.objectId",partitions:"$.partitions",status:"$..status",searchName:"$..searchName"}},filter:{expression:e&&""!==e?"exists(@searchName) && contains(@searchName, '".concat(e,"')"):""}};T(!0),j(tt({requestData:t,callback:function(e){console.log("students here",e),I([{title:"Name",key:"name",dataIndex:"name"},{title:"Custom id",key:"customId",dataIndex:"customId"},{title:"Gender",key:"gender",dataIndex:"gender"},{title:"Date of birth",key:"dob",dataIndex:"dob"},{title:"Parent",key:"parentBeamId",dataIndex:"parentBeamId"},{title:"Pickup location",key:"pickupLocation",dataIndex:"pickupLocation"},{title:"Dropoff location",key:"dropoffLocation",dataIndex:"dropoffLocation"},{title:"Emergency contact",key:"emergencyName",dataIndex:"emergencyName"},{title:"Emergency phone",key:"emergencyPhone",dataIndex:"emergencyPhone"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),D(e.user)},children:Object(oa.jsx)(wo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",onClick:function(){console.log("action",e),K(e)},children:Object(oa.jsx)(na.a,{})})})]})}}]),h(null===e||void 0===e?void 0:e.map(function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m,p,O,f,h=null===(t=Object.values((null===e||void 0===e||null===(n=e.info)||void 0===n||null===(a=n.schoolBus)||void 0===a?void 0:a.pickupLocationList)||{}))||void 0===t?void 0:t.find(function(e){return"pickup"===e.locationType}),g=null===(i=Object.values((null===e||void 0===e||null===(c=e.info)||void 0===c||null===(o=c.schoolBus)||void 0===o?void 0:o.dropoffLocationList)||{}))||void 0===i?void 0:i.find(function(e){return"dropoff"===e.locationType});return Object(d.a)(Object(d.a)({key:null===e||void 0===e?void 0:e.objectId},null===e||void 0===e?void 0:e.info),{},{pickupLocation:null===h||void 0===h||null===(l=h.location)||void 0===l||null===(s=l.attributes)||void 0===s?void 0:s.address,dropoffLocation:null===g||void 0===g||null===(r=g.location)||void 0===r||null===(u=r.attributes)||void 0===u?void 0:u.address,emergencyName:null===e||void 0===e||null===(v=e.info)||void 0===v||null===(b=v.schoolBus)||void 0===b||null===(j=b.emergency)||void 0===j?void 0:j.name,emergencyPhone:null===e||void 0===e||null===(m=e.info)||void 0===m||null===(p=m.schoolBus)||void 0===p||null===(O=p.emergency)||void 0===O?void 0:O.phoneNumber,action:{userId:null===e||void 0===e?void 0:e.objectId,user:Object(d.a)({id:null===e||void 0===e||null===(f=e.objectId)||void 0===f?void 0:f.toString()},null===e||void 0===e?void 0:e.info)}})})),T(!1)}}))},ce=function(e){return new Promise(function(t,n){var a={select:{index:{searchIndex:"".concat("beamdevlive",":custom:createdAt"),searchQuery:"@partitions:{'org\\:".concat(z(null===v||void 0===v?void 0:v.userServiceId),"'}@partitions:{type\\:student}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{customId:"$.info.customId",objectId:"$.objectId"}},filter:{expression:"exists(@customId) && @customId === '".concat(e,"'")}};j(tt({requestData:a,callback:function(e){console.log("customId here",e),t(e)}}))})},oe=function(e){console.log("record",e),n.publishToEvent(m.PublishPageTopics,un(null===r||void 0===r?void 0:r.connectionId),Dn({objectId:null===e||void 0===e?void 0:e.userId,changes:[{op:"replace",path:"$.objectStatus",value:"deleted"}]})),n.subscribeToEvent(m.SubscribePageTopics,dn(null===r||void 0===r?void 0:r.connectionId),function(e){console.log("update response",e),ie()})},le=function(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i="@serviceId:{'".concat(z(null===v||void 0===v?void 0:v.userServiceId),"'}");switch(a&&a.length>2&&(i+=function(e){var t="",n=e.trim().split(" ").filter(function(e){return e.length>2}).map(function(e){return"*"+z(e)+"*"});return 0==n.length?t:(n.forEach(function(e){t+="@firstName:(".concat(e,")|@lastName:(").concat(e,")|")}),t+="@beamIds:{".concat(n.join("|"),"}"),"(".concat(t,")"))}(a)),t){case ac.Dispatcher:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Live:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Live)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Responder:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Manager:n=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)})}var o=n.map(function(e){return"@roleId === '".concat(e._id,"'")}),l={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:i,searchOptions:"TIMEOUT 5000"},list:{objectIds:"student"===c?[null===r||void 0===r?void 0:r.userId]:void 0},load:{id:"$.objectId",email:"$..live.alternativeIds.email",phone:"$..live.alternativeIds.phone",profile:"$..profile",roleId:"$..admin.profile.roleId",extendedBio:"$..extendedBio"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(o.join("||"),")")},anyStatus:!1};console.log("user request",l),j(tt({requestData:l,callback:function(e){var t=null===e||void 0===e?void 0:e.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h,g={id:null===e||void 0===e||null===(t=e.id)||void 0===t?void 0:t.toString(),name:(null===e||void 0===e||null===(n=e.profile)||void 0===n?void 0:n.firstName)+" "+(null===(a=e.profile)||void 0===a?void 0:a.lastName),extendedBio:null===e||void 0===e?void 0:e.extendedBio,extendedBioValue:null===e||void 0===e?void 0:e.extendedBioValue,firstName:null!==(i=null===e||void 0===e||null===(c=e.profile)||void 0===c?void 0:c.firstName)&&void 0!==i?i:"",lastName:null!==(o=null===e||void 0===e||null===(l=e.profile)||void 0===l?void 0:l.lastName)&&void 0!==o?o:"",gender:null!==(s=null===e||void 0===e||null===(r=e.profile)||void 0===r?void 0:r.gender)&&void 0!==s?s:"",dob:null!==(d=null===e||void 0===e||null===(u=e.profile)||void 0===u?void 0:u.dob)&&void 0!==d?d:"",email:e.email,phone:e.phone,beamId:"".concat(null===e||void 0===e||null===(v=e.profile)||void 0===v||null===(b=v.firstName)||void 0===b?void 0:b.toLowerCase(),".").concat(null===e||void 0===e||null===(j=e.profile)||void 0===j||null===(m=j.lastName)||void 0===m?void 0:m.toLowerCase()),location:null!==e&&void 0!==e&&null!==(p=e.profile)&&void 0!==p&&null!==(O=p.location)&&void 0!==O&&O.coordinates?{coordinates:[null===e||void 0===e||null===(f=e.profile)||void 0===f?void 0:f.location.coordinates.long,null===e||void 0===e||null===(h=e.profile)||void 0===h?void 0:h.location.coordinates.lat]}:void 0};return{id:g.id,name:g.beamId,obj:g}}).filter(function(e){return!Y.find(function(t){return e.id===t.id})});console.log("options",Y),H([].concat(Object(C.a)(Y),Object(C.a)(t))),w.current=[]}}))};Object(a.useEffect)(function(){return Z.current=!0,function(){Z.current=!1}},[]),Object(a.useEffect)(function(){null!==v&&void 0!==v&&v.adminUserId&&(le(b,ac.Live),ie(),n.subscribeToEvent(m.SubscribePageTopics,sn(null===r||void 0===r?void 0:r.connectionId),function(e){var t,n;console.log("response",null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.id),ie()}))},[v]);Object(a.useEffect)(function(){L&&function(e){try{JSON.stringify(e);var t,n=document.createElement("canvas"),a=null===(t=X.current)||void 0===t?void 0:t.querySelector("canvas");if(!a)return;var i=a.width,c=i+30;n.width=i,n.height=c;var o=n.getContext("2d");if(o){o.fillStyle="#000",o.font="20px Arial",o.textAlign="center",o.fillText(null===e||void 0===e?void 0:e.name,i/2,20),o.drawImage(a,0,30);var l=n.toDataURL("image/png"),s=document.createElement("a");s.href=l,s.download="".concat((null===e||void 0===e?void 0:e.name)||"","_qr_code.png"),document.body.appendChild(s),s.click(),document.body.removeChild(s)}}catch(r){alert("Invalid JSON input")}}(L)},[L]);var se=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:V.validateFields().then(function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var a,i,o,l,s,d,u,v,b;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("values here",t),s="student"===c?null===r||void 0===r?void 0:r.userId:null===t||void 0===t?void 0:t.parent,d=null===Y||void 0===Y?void 0:Y.find(function(e){return(null===e||void 0===e?void 0:e.id)===s}),u={name:null===t||void 0===t?void 0:t.name,searchName:null===t||void 0===t||null===(a=t.name)||void 0===a?void 0:a.toLowerCase(),customId:null===t||void 0===t?void 0:t.customId,gender:null===t||void 0===t?void 0:t.gender,dob:null===t||void 0===t||null===(i=t.dob)||void 0===i||null===(o=i.split(" "))||void 0===o?void 0:o[0],parentId:s,parentBeamId:null===d||void 0===d||null===(l=d.obj)||void 0===l?void 0:l.beamId,schoolBus:{}},v=[{op:"add",path:"/partitions",value:["org:".concat((null===r||void 0===r?void 0:r.cudbServiceId)||(null===r||void 0===r?void 0:r.serviceId)),"parent:".concat(null===t||void 0===t?void 0:t.parent),"type:student"]},{op:"add",path:"/createdAt",value:(new Date).getTime()},{op:"add",path:"/info",value:u}],console.log("custom changes",v),T(!0),e.n=1,ce(null===t||void 0===t?void 0:t.customId);case 1:b=e.v,T(!1),null!==b&&void 0!==b&&b[0]?Lt("Student with customId already exists","error","TOP_CENTER",3e3):(V.resetFields(),B(!1),n.publishToEvent(m.PublishPageTopics,rn(null===r||void 0===r?void 0:r.connectionId),Dn({changes:v})));case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:return e.a(2)}},e)}));return function(){return e.apply(this,arguments)}}(),re=function(){B(!1)},de=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],ue=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:ne?"d-flex flex-column align-items-start":"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Student"}),Object(oa.jsx)("p",{children:"Home > Student"})]}),Object(oa.jsxs)("div",{className:"d-flex align-items-space-between",style:ne?{width:"100%"}:{},children:[Object(oa.jsx)(Wn.a,{onChange:function(e){var t=e.target.value;Hr&&clearTimeout(Hr),Hr=setTimeout(function(){ie(!1,t)},500)},style:ne?{width:"100%",marginTop:10}:{width:350},placeholder:"Search student",suffix:Object(oa.jsx)(Jl.a,{}),className:"mr-3"}),Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover",onClick:function(){B(!0)},style:ne?{width:75,marginTop:10}:{},children:"Add"})]})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:k?ue:f,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},columns:k?de:y,scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===l||void 0===l||null===(n=l.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==P&&Object(oa.jsx)($r,{socket:n,student:P,onClose:function(){D(void 0)},onAdd:function(){ie()},userRole:c}),Object(oa.jsx)($n.a,{title:"Add student",className:"beam-modal",visible:F,onCancel:re,children:Object(oa.jsxs)(ei.a,{form:V,layout:"vertical",children:[Object(oa.jsx)(ei.a.Item,{label:"Student name",name:"name",rules:[{required:!0,message:"Student name is required"}],className:"mt-3",children:Object(oa.jsx)(Wn.a,{})}),Object(oa.jsx)(ei.a.Item,{label:"Student customId",name:"customId",rules:[{required:!0,message:"Student customId is required"}],className:"mt-3",children:Object(oa.jsx)(Wn.a,{})}),Object(oa.jsx)(ei.a.Item,{label:"Student gender",name:"gender",className:"mt-3",style:{width:150},children:Object(oa.jsx)(Bc,{})}),Object(oa.jsx)(ei.a.Item,{label:"Student date of birth",name:"dob",className:"mt-3",children:Object(oa.jsx)(di,{})}),Object(oa.jsx)(ei.a.Item,{label:"Student grade/class",name:"grade",className:"mt-3",children:Object(oa.jsx)(Wn.a,{})}),"admin"===c&&Object(oa.jsx)(ei.a.Item,{name:"parent",label:"Parent",className:"mt-3",rules:[{required:!0,message:"Parent is required"}],children:Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select parent",allowClear:!0,filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},onSearch:function(e){Hr&&clearTimeout(Hr),Hr=setTimeout(function(){e&&""!==e?le(b,ac.Live,e):le(b,ac.Live)},500)},children:null===Y||void 0===Y?void 0:Y.map(function(e,t){return Object(oa.jsx)(Vr,{value:e.id,children:e.name},t)})})}),Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:12,xs:12,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:function(){return re()},children:"Cancel"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",xs:12,sm:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:k,onClick:function(){return se()},children:"Save"})})]})})]})}),J&&Object(oa.jsx)(Nr,{onClose:function(){K(void 0)},handleConfirm:Object(_n.a)(Object(Bn.a)().m(function e(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("delete here",J),e.n=1,oe(J);case 1:K(void 0);case 2:return e.a(2)}},e)})),message:"Are you sure you want to delete student (".concat(null===J||void 0===J||null===(t=J.user)||void 0===t?void 0:t.name,")?")}),Object(oa.jsx)("div",{ref:X,style:{display:"none"},children:L&&Object(oa.jsx)(Yr.a,{value:L?JSON.stringify(L):"",size:256,level:"H",title:null===L||void 0===L?void 0:L.name,includeMargin:!0})})]})},Qr=(Za.a.Panel,Kl.a.TabPane),Gr=function(e){var t,n,c=e.onClose,o=e.socket,l=e.student,r=e.onAdd,v=Object(a.useState)(!0),b=Object(u.a)(v,2),j=b[0],p=b[1],O=Object(a.useState)("1"),f=Object(u.a)(O,2),h=f[0],g=f[1],I=ei.a.useForm(),S=Object(u.a)(I,1)[0],N=Object(a.useState)(""),k=Object(u.a)(N,2),w=(k[0],k[1]),E=Object(s.c)(function(e){return e.auth}).projects,R=Object(a.useState)(!1),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Mn().updateUserRequestPayloadV2;Object(a.useEffect)(function(){if(null!==l&&void 0!==l&&l.schoolBus){var e,t,n,a,i,c,o,s,r,u,v={},b=[];null===(e=Object.values((null===l||void 0===l||null===(t=l.schoolBus)||void 0===t?void 0:t.locationList)||{}))||void 0===e||e.map(function(e){var t,n,a,i,c,o,l,s,r,u={location:{label:null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.attributes)||void 0===n?void 0:n.address,value:{description:null===e||void 0===e||null===(a=e.location)||void 0===a||null===(i=a.attributes)||void 0===i?void 0:i.address,place_id:"",coordinates:null===e||void 0===e||null===(c=e.location)||void 0===c?void 0:c.coordinates,attributes:null===e||void 0===e||null===(o=e.location)||void 0===o?void 0:o.attributes}},days:null===e||void 0===e||null===(l=e.condition)||void 0===l?void 0:l.days,startTime:H()(null===e||void 0===e||null===(s=e.condition)||void 0===s?void 0:s.startTime),endTime:H()(null===e||void 0===e||null===(r=e.condition)||void 0===r?void 0:r.endTime)};b.push(u),v=Object(d.a)(Object(d.a)({},v),{},Object(T.a)(Object(T.a)(Object(T.a)(Object(T.a)({},"location-".concat(b.length-1),u.location),"start-time-".concat(b.length-1),u.startTime),"end-time-".concat(b.length-1),u.endTime),"days-".concat(b.length-1),u.days))}),S.setFieldsValue(Object(d.a)(Object(d.a)(Object(d.a)({operation:b},v),{},{license:null===l||void 0===l||null===(n=l.schoolBus)||void 0===n?void 0:n.license,preferences:null===l||void 0===l||null===(a=l.schoolBus)||void 0===a?void 0:a.preferences},null===l||void 0===l||null===(i=l.schoolBus)||void 0===i?void 0:i.license),{},{expiryDate:null!==l&&void 0!==l&&null!==(c=l.schoolBus)&&void 0!==c&&null!==(o=c.license)&&void 0!==o&&o.expiryDate?H()(null===l||void 0===l||null===(s=l.schoolBus)||void 0===s||null===(r=s.license)||void 0===r?void 0:r.expiryDate):void 0},null===l||void 0===l||null===(u=l.schoolBus)||void 0===u?void 0:u.preferences))}},[]);var L=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("values",t),c=(c=Object(C.a)((null===t||void 0===t||null===(n=t.operation)||void 0===n?void 0:n.map(function(e){var t,n,a,i;return{locationType:"operationStart",location:{coordinates:null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.coordinates,attributes:null===e||void 0===e||null===(a=e.location)||void 0===a||null===(i=a.value)||void 0===i?void 0:i.attributes},condition:{days:null===e||void 0===e?void 0:e.days,startTime:null===e||void 0===e?void 0:e.startTime,endTime:null===e||void 0===e?void 0:e.endTime}}}))||[])).reduce(function(e,t,n){var a=W();return e[a]=Object(d.a)({locationId:a},t),e},{}),A(!0),e.n=1,U(null===l||void 0===l?void 0:l.id,null===E||void 0===E?void 0:E.userServiceId,{locationList:"1"===h?c:void 0,license:"2"===h?{licenseNumber:null===t||void 0===t?void 0:t.licenseNumber,licenseType:null===t||void 0===t?void 0:t.licenseType,experience:null===t||void 0===t?void 0:t.experience,expiryDate:null===t||void 0===t||null===(a=t.expiryDate)||void 0===a?void 0:a.format("MM/DD/YYYY HH:mm:ss")}:void 0,preferences:"3"===h?{drivingRestrictions:null===t||void 0===t?void 0:t.drivingRestrictions,enableBreaks:null===t||void 0===t?void 0:t.enableBreaks,maxDrivingHours:null===t||void 0===t?void 0:t.maxDrivingHours,preferredZipCodes:null===t||void 0===t?void 0:t.preferredZipCodes,breakDuration:null===t||void 0===t?void 0:t.breakDuration,breakFrequency:null===t||void 0===t?void 0:t.breakFrequency}:void 0});case 1:console.log("values",{locationList:"1"===h?c:void 0,license:"2"===h?{licenseNumber:null===t||void 0===t?void 0:t.licenseNumber,licenseType:null===t||void 0===t?void 0:t.licenseType,experience:null===t||void 0===t?void 0:t.experience,expiryDate:null===t||void 0===t||null===(i=t.expiryDate)||void 0===i?void 0:i.format("MM/DD/YYYY HH:mm:ss")}:void 0,preferences:"3"===h?{drivingRestrictions:null===t||void 0===t?void 0:t.drivingRestrictions,enableBreaks:null===t||void 0===t?void 0:t.enableBreaks,maxDrivingHours:null===t||void 0===t?void 0:t.maxDrivingHours,preferredZipCodes:null===t||void 0===t?void 0:t.preferredZipCodes,breakDuration:null===t||void 0===t?void 0:t.breakDuration,breakFrequency:null===t||void 0===t?void 0:t.breakFrequency}:void 0}),Lt("User updated successfully","success","TOP_CENTER",3e3),A(!1),r();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n,a){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,i){var c=a.locationList,l=a.license,s=a.preferences,r=[];c&&r.push({op:"add",path:"/persistent/static/schoolBus/locationList",value:c}),l&&r.push({op:"add",path:"/persistent/static/schoolBus/license",value:l}),s&&r.push({op:"add",path:"/persistent/static/schoolBus/preferences",value:s}),console.log("update user data",r),o.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,M(t,r),x.UpdateUserBio,n),o.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){e(t)})}))},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),q=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],F=function(e){var t=e.value,n=e.onChange,i=Object(a.useState)(t||[{location:void 0,startTime:void 0,endTime:void 0,days:void 0,timeWindow:10}]),c=Object(u.a)(i,2),o=c[0],l=c[1];Object(a.useEffect)(function(){t&&l(t)},[t]);var s=function(e,t,a){var i=o.map(function(n,i){return i===e?Object(d.a)(Object(d.a)({},n),{},Object(T.a)({},t,a)):n});null===n||void 0===n||n(i)},r=function(e){var t=e.value,n=e.onChange;return Object(oa.jsx)(gi,{placeholder:"Select Time",value:t?H()(t).format("HH:mm"):void 0,onChange:n})};return Object(oa.jsxs)(oa.Fragment,{children:[o.map(function(e,t){var n=q.filter(function(t){var n;return!o.reduce(function(e,t){return t.days?[].concat(Object(C.a)(e),Object(C.a)(t.days)):e},[]).includes(t)||(null===(n=e.days)||void 0===n?void 0:n.includes(t))});return Object(oa.jsxs)(Yn.a,{className:"mb-3",children:[Object(oa.jsx)(Hn.a,{span:22,className:"pr-2",children:Object(oa.jsx)(ei.a.Item,{label:"Operation start Location",name:"location-".concat(t),rules:[{required:!0,message:"Location is required"}],children:Object(oa.jsx)(ai,{placeholder:"Enter Start Location",onChange:function(e){return s(t,"location",e)}})})}),Object(oa.jsx)(Hn.a,{span:2,className:"t-right d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn orange-btn bordered",onClick:function(){return function(e){l(function(t){return t.filter(function(t,n){return n!==e})})}(t)},children:Object(oa.jsx)(na.a,{})})}),Object(oa.jsx)(Hn.a,{span:24,className:"mt-3",children:Object(oa.jsx)(ei.a.Item,{label:"Operation Days",name:"days-".concat(t),rules:[{required:!0,message:"Days selection is required"}],children:Object(oa.jsx)(Gn.a,{placeholder:"Select Days",mode:"multiple",value:e.days,onChange:function(e){return s(t,"days",e)},style:{width:"100%"},children:n.map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})})}),Object(oa.jsx)(Hn.a,{span:12,className:"mt-3",children:Object(oa.jsx)(ei.a.Item,{label:"Start Time",name:"start-time-".concat(t),rules:[{required:!0,message:"Start time is required"}],children:Object(oa.jsx)(r,{onChange:function(e){s(t,"startTime",e)}})})}),Object(oa.jsx)(Hn.a,{span:12,className:"mt-3 pl-2",children:Object(oa.jsx)(ei.a.Item,{label:"End Time",name:"end-time-".concat(t),rules:[{required:!0,message:"End time is required"}],children:Object(oa.jsx)(r,{onChange:function(e){s(t,"endTime",e)}})})})]},"location-".concat(t))}),Object(oa.jsx)(Yn.a,{className:"mt-3 mb-3",children:Object(oa.jsx)(Hn.a,{span:24,className:"d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn yellow-btn bordered",onClick:function(){l(function(e){return[].concat(Object(C.a)(e),[{location:void 0,startTime:void 0,endTime:void 0,days:void 0,timeWindow:10}])})},children:"Add"})})})]})},B=function(e){e.value,e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{label:"License Number",name:"licenseNumber",rules:[{required:!0,message:"Please input the license number"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter license number"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"License Type",name:"licenseType",rules:[{required:!0,message:"Please select a license type"}],children:Object(oa.jsx)(Gn.a,{placeholder:"Select license type",children:["CDL Class A","CDL Class B","CDL Class C"].map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"License Expiry Date",name:"expiryDate",rules:[{required:!0,message:"Please select the license expiry date"}],children:Object(oa.jsx)(Jn.a,{style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Years of Experience",name:"experience",rules:[{required:!0,message:"Please input years of experience"},{pattern:/^[0-9]+$/,message:"The input must be a number"}],children:Object(oa.jsx)(Wn.a,{min:0,max:50,placeholder:"Years of experience",style:{width:"100%"}})})]})},_=function(e){var t,n=e.value,a=e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{label:"Maximum Driving Hours per Day",name:"maxDrivingHours",rules:[{pattern:/^[0-9]+$/,message:"The input must be a number"}],children:Object(oa.jsx)(Wn.a,{min:1,max:24,placeholder:"Driving hours",style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{label:"Preferred ZIP Codes",name:"preferredZipCodes",className:"mt-3",children:Object(oa.jsx)(Gn.a,{mode:"tags",placeholder:"Enter ZIP codes",value:null===n||void 0===n?void 0:n.preferredZipCodes,onChange:function(e){null===a||void 0===a||a(Object(d.a)(Object(d.a)({},n),{},{preferredZipCodes:e}))},onInputKeyDown:function(e){"Enter"===e.key&&e.currentTarget.value&&(null!==n&&void 0!==n&&n.preferredZipCodes.includes(e.currentTarget.value)||null===a||void 0===a||a(Object(d.a)(Object(d.a)({},n),{},{preferredZipCodes:[].concat(Object(C.a)(null===n||void 0===n?void 0:n.preferredZipCodes),[e.currentTarget.value])})),e.currentTarget.value="")},children:null===n||void 0===n||null===(t=n.preferredZipCodes)||void 0===t?void 0:t.map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})}),Object(oa.jsx)(ei.a.Item,{label:"Driving Restrictions",name:"drivingRestrictions",className:"mt-3",children:Object(oa.jsx)(Xn.a.Group,{options:["Cannot drive at night","Requires glasses","No long-distance driving","No highways"]})}),Object(oa.jsx)(ei.a.Item,{name:"enableBreaks",valuePropName:"checked",className:"mt-3",children:Object(oa.jsx)(Xn.a,{onChange:function(e){null===a||void 0===a||a(Object(d.a)(Object(d.a)({},n),{},{enableBreaks:e.target.checked}))},children:"Enable break scheduling"})}),(null===n||void 0===n?void 0:n.enableBreaks)&&Object(oa.jsx)(oa.Fragment,{children:Object(oa.jsxs)(Yn.a,{gutter:16,children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(ei.a.Item,{label:"Break Frequency (stops)",name:"breakFrequency",rules:[{pattern:/^[0-9]+$/,message:"The input must be a number"}],children:Object(oa.jsx)(Wn.a,{min:1,placeholder:"Break after X stops",style:{width:"100%"}})})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(ei.a.Item,{label:"Break Duration (minutes)",name:"breakDuration",rules:[{pattern:/^[0-9]+$/,message:"The input must be a number"}],children:Object(oa.jsx)(Wn.a,{min:1,placeholder:"Break duration in minutes",style:{width:"100%"}})})})]})})]})};return Object(oa.jsx)($n.a,{title:"Edit (".concat((null===l||void 0===l||null===(t=l.live)||void 0===t||null===(n=t.beamIds)||void 0===n?void 0:n[0])||"student",")"),visible:j,onCancel:function(){p(!1),c&&c()},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:S,onFinish:L,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsxs)(Kl.a,{defaultActiveKey:"1",type:"line",onChange:function(e){g(e)},children:[Object(oa.jsx)(Qr,{tab:"Driver Availability & Operation",children:"1"===h&&Object(oa.jsx)(ei.a.Item,{name:"vehicle",children:Object(oa.jsx)(ei.a.Item,{name:"operation",children:Object(oa.jsx)(F,{})})})},"1"),Object(oa.jsx)(Qr,{tab:"Driver License",children:"2"===h&&Object(oa.jsx)(ei.a.Item,{name:"license",children:Object(oa.jsx)(B,{})})},"2"),Object(oa.jsx)(Qr,{tab:"Preferences",children:"3"===h&&Object(oa.jsx)(ei.a.Item,{name:"preferences",children:Object(oa.jsx)(_,{})})},"3")]})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:D,type:"primary",htmlType:"submit",onClick:function(){return w("")},children:"Save"})})})})]})})};Dc.d.register(Dc.a,Dc.j,Dc.e);var Jr,Kr=function(e){var t=e.socket,n=(e.params,e.componentUuid,e.userRole),c=Object(s.c)(function(e){return e.auth}),o=c.selectedPage,l=c.encrypted_token,r=c.projects,d=c.adminUserRoles,v=Object(s.b)(),b=Object(a.useState)([]),j=Object(u.a)(b,2),m=j[0],p=j[1],O=Object(a.useState)([]),f=Object(u.a)(O,2),h=f[0],g=f[1];Object(a.useState)(!1);var x=Object(a.useState)(!1),y=Object(u.a)(x,2),I=y[0],S=y[1];Object(a.useState)(!1);Mn().getUserRequestPayload;var N=Object(a.useRef)(),k=Object(a.useState)(void 0),T=Object(u.a)(k,2),C=T[0],w=T[1],E=Object(a.useRef)(!0),R=Object(a.useState)(window.innerWidth<=768),P=Object(u.a)(R,2),D=P[0],A=P[1];Object(a.useEffect)(function(){var e=function(){return A(window.innerWidth<=768)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[]);var M=function(e,t){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,c="@serviceId:{'".concat(z(null===r||void 0===r?void 0:r.userServiceId),"'}");switch(i&&i.length>2&&(c+=function(e){var t="",n=e.trim().split(" ").filter(function(e){return e.length>2}).map(function(e){return"*"+z(e)+"*"});return 0==n.length?t:(n.forEach(function(e){t+="@firstName:(".concat(e,")|@lastName:(").concat(e,")|")}),t+="@beamIds:{".concat(n.join("|"),"}"),"(".concat(t,")"))}(i)),t){case ac.Dispatcher:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Live:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Live)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Responder:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)});break;case ac.Manager:a=e.filter(function(e){return-1!==e.permissions.indexOf(ic.Cad)&&-1!==e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)})}console.log("selected user roles",a);var o=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),s={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:c,searchOptions:"TIMEOUT 5000"},list:{objectIds:"driver"===n?[null===l||void 0===l?void 0:l.userId]:void 0},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId",schoolBus:"$..schoolBus"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(o.join("||"),")")},anyStatus:!1};S(!0),v(tt({requestData:s,callback:function(e){S(!1);var t=[],n=[{title:"Status",key:"userStatus",dataIndex:"userStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Name",key:"name",dataIndex:"name"},{title:"Custom id",key:"customId",dataIndex:"customId"},{title:"Email",key:"email",dataIndex:"email"},{title:"Phone",key:"phone",dataIndex:"phone"},{title:"Operation start location",key:"operationLocation",dataIndex:"operationLocation"},{title:"License number",key:"licenseNumber",dataIndex:"licenseNumber"},{title:"License type",key:"licenseType",dataIndex:"licenseType"},{title:"License expiry",key:"licenseExpiry",dataIndex:"licenseExpiry"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsx)(Yn.a,{style:{width:135},children:Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),w(e.user)},children:Object(oa.jsx)(wo.a,{})})})})}}];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h,g,x,y,I,S=null===(a=Object.values((null===e||void 0===e||null===(i=e.schoolBus)||void 0===i?void 0:i.locationList)||{}))||void 0===a?void 0:a.find(function(e){return"operationStart"===e.locationType});t.push({key:e.id,userStatus:null===e||void 0===e||null===(c=e.status)||void 0===c?void 0:c.name,name:"".concat(null===e||void 0===e||null===(o=e.live)||void 0===o||null===(l=o.profile)||void 0===l?void 0:l.firstName," ").concat(null===e||void 0===e||null===(s=e.live)||void 0===s||null===(r=s.profile)||void 0===r?void 0:r.lastName),email:null===e||void 0===e||null===(d=e.live)||void 0===d||null===(u=d.alternativeIds)||void 0===u?void 0:u.email,phone:null===e||void 0===e||null===(v=e.live)||void 0===v||null===(b=v.alternativeIds)||void 0===b?void 0:b.phone,customId:null===e||void 0===e||null===(j=e.live)||void 0===j||null===(m=j.alternativeIds)||void 0===m?void 0:m.customId,operationLocation:null===S||void 0===S||null===(p=S.location)||void 0===p||null===(O=p.attributes)||void 0===O?void 0:O.address,licenseNumber:null===e||void 0===e||null===(f=e.schoolBus)||void 0===f||null===(h=f.license)||void 0===h?void 0:h.licenseNumber,licenseType:null===e||void 0===e||null===(g=e.schoolBus)||void 0===g||null===(x=g.license)||void 0===x?void 0:x.licenseType,licenseExpiry:null===e||void 0===e||null===(y=e.schoolBus)||void 0===y||null===(I=y.license)||void 0===I?void 0:I.expiryDate,action:{userId:null===e||void 0===e?void 0:e.id,user:e}})}),N.current=t,g(n),p(t)}}))};Object(a.useEffect)(function(){return E.current=!0,function(){E.current=!1}},[]),Object(a.useEffect)(function(){null!==r&&void 0!==r&&r.adminUserId&&M(d,ac.Responder)},[r]);var L=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],U=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:D?"d-flex flex-column align-items-start":"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Driver"}),Object(oa.jsx)("p",{children:"Home > Driver"})]}),Object(oa.jsx)(Wn.a,{onChange:function(e){var t=e.target.value;Wr&&clearTimeout(Wr),Wr=setTimeout(function(){t.includes("-")&&(t=z(t)),M(d,ac.Responder,t)},500)},style:D?{width:"100%",marginTop:10}:{width:350},placeholder:"Search user",suffix:Object(oa.jsx)(Jl.a,{})})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:I?U:m,columns:I?L:h,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==C&&Object(oa.jsx)(Gr,{socket:t,student:C,onClose:function(){w(void 0)},onAdd:function(){M(d,ac.Responder)}})]})},Zr=(Za.a.Panel,Kl.a.TabPane),Xr=function(e){var t,n=e.onClose,c=e.socket,o=e.student,l=(e.adminRoles,e.onAdd),r=Object(a.useState)(!0),v=Object(u.a)(r,2),b=v[0],j=v[1],p=ei.a.useForm(),O=Object(u.a)(p,1)[0],f=Object(a.useState)(""),h=Object(u.a)(f,2),g=(h[0],h[1]),I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(s.c)(function(e){return e.auth}).projects,C=Mn().updateUserRequestPayloadV2,w=Object(a.useState)("1"),E=Object(u.a)(w,2),R=E[0],P=E[1];Object(a.useEffect)(function(){var e,t,n,a,i,c,l,s,r,u;null!==o&&void 0!==o&&o.static&&O.setFieldsValue(Object(d.a)(Object(d.a)(Object(d.a)({},null===o||void 0===o?void 0:o.static),null===o||void 0===o||null===(e=o.static)||void 0===e?void 0:e.preferences),{},{maintenanceDate:H()(null===o||void 0===o||null===(t=o.static)||void 0===t?void 0:t.maintenanceDate),responder:null!==o&&void 0!==o&&null!==(n=o.static)&&void 0!==n&&null!==(a=n.alternativeIds)&&void 0!==a&&a.userId?{type:"responder",id:null===o||void 0===o||null===(i=o.static)||void 0===i||null===(c=i.alternativeIds)||void 0===c?void 0:c.userId,beamId:null===o||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.alternativeIds)||void 0===s?void 0:s.beamId,valueName:null===o||void 0===o||null===(r=o.static)||void 0===r||null===(u=r.alternativeIds)||void 0===u?void 0:u.beamId}:void 0}))},[]);var D=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,s,r,d,u,v,b,j,m,p,O;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("values",t),n=t.name,a=t.noOfBaggages,i=t.noOfPassengers,c=t.makeAndModel,s=t.mileage,r=t.licensePlate,d=t.vehicleType,u=t.vehicleYear,v=t.maintenanceDate,b=t.vin,j=t.accessibilityOptions,m=t.safetyEquipment,p=t.specialFeatures,O={vehicle:"1"===R?{name:n,noOfBaggages:a,noOfPassengers:i,makeAndModel:c,mileage:s,licensePlate:r,vehicleType:d,vehicleYear:u,maintenanceDate:v.format("MM/DD/YYYY HH:mm:ss"),vin:b}:void 0,preferences:"2"===R?{accessibilityOptions:j,safetyEquipment:m,specialFeatures:p}:void 0},k(!0),e.n=1,A(null===o||void 0===o?void 0:o.id,null===T||void 0===T?void 0:T.userServiceId,O);case 1:Lt("User updated successfully","success","TOP_CENTER",3e3),k(!1),l();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n,a){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,i){var o,l=a.vehicle,s=a.preferences,r=[];l&&(null===(o=Object.keys(l))||void 0===o||o.map(function(e){r.push({op:"add",path:"/persistent/static/asset/".concat(e),value:null===l||void 0===l?void 0:l[e]})}));s&&r.push({op:"add",path:"/persistent/static/asset/preferences",value:s}),console.log("update user data",r),c.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,C(t,r),x.UpdateUserBio,n),c.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){e(t)})}))},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),M=function(e){e.value,e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{label:"Vehicle Name",name:"name",rules:[{required:!0,message:"Please input the vehicle name"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter name"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Vehicle Type",name:"vehicleType",rules:[{required:!0,message:"Please select the vehicle type"}],children:Object(oa.jsx)(Gn.a,{placeholder:"Select vehicle type",children:["School Bus","Mini Bus","Van"].map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Vehicle Make and Model",name:"makeAndModel",rules:[{required:!0,message:"Please enter the vehicle make and model"}],children:Object(oa.jsx)(Wn.a,{placeholder:"e.g., Ford Transit 2021"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Vehicle Year",name:"vehicleYear",rules:[{required:!0,message:"Please enter the vehicle year"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter vehicle year",style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"License Plate Number",name:"licensePlate",rules:[{required:!0,message:"Please enter the license plate number"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter license plate number"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Vehicle Identification Number (VIN)",name:"vin",rules:[{required:!0,message:"Please enter the vehicle identification number (VIN)"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter VIN"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Current Mileage",name:"mileage",rules:[{required:!0,message:"Please enter the current mileage"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter mileage in miles or kilometers",style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Last Maintenance Date",name:"maintenanceDate",rules:[{required:!0,message:"Please select the last maintenance date"}],children:Object(oa.jsx)(Jn.a,{style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Number of passengers",name:"noOfPassengers",rules:[{required:!0,message:"Please input number of passengers"},{pattern:/^[0-9]+$/,message:"The input must be a number"}],children:Object(oa.jsx)(Wn.a,{min:0,max:100,placeholder:"Enter number of passengers",style:{width:"100%"}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Number of baggages",name:"noOfBaggages",rules:[{required:!0,message:"Please input number of baggages"},{pattern:/^[0-9]+$/,message:"The input must be a number"}],children:Object(oa.jsx)(Wn.a,{min:0,max:100,placeholder:"Enter number of baggages",style:{width:"100%"}})})]})},L=function(e){e.value,e.onChange;return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{label:"Special Features",name:"specialFeatures",children:Object(oa.jsx)(Xn.a.Group,{children:["Air Conditioning","Wheelchair Lift","GPS Tracking","Wi-Fi","Emergency Exit Alarm","Seat Belts"].map(function(e){return Object(oa.jsx)(Xn.a,{value:e,children:e},e)})})}),Object(oa.jsx)(ei.a.Item,{label:"Accessibility Options",name:"accessibilityOptions",className:"mt-3",children:Object(oa.jsx)(Xn.a.Group,{children:["Wheelchair Accessible","Child Safety Seat","Ramp Access"].map(function(e){return Object(oa.jsx)(Xn.a,{value:e,children:e},e)})})}),Object(oa.jsx)(ei.a.Item,{label:"Safety Equipment",name:"safetyEquipment",className:"mt-3",children:Object(oa.jsx)(Xn.a.Group,{children:["Fire Extinguisher","First Aid Kit","Emergency Kit","Backup Camera","Seat Belt Alarm"].map(function(e){return Object(oa.jsx)(Xn.a,{value:e,children:e},e)})})})]})};return Object(oa.jsx)($n.a,{title:"Edit (".concat((null===o||void 0===o||null===(t=o.static)||void 0===t?void 0:t.name)||"vehicle",")"),visible:b,onCancel:function(){j(!1),n&&n()},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:O,onFinish:D,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsxs)(Kl.a,{defaultActiveKey:"1",type:"line",onChange:function(e){P(e)},children:[Object(oa.jsx)(Zr,{tab:"Vehicle Information",children:"1"===R&&Object(oa.jsx)(ei.a.Item,{name:"vehicle",children:Object(oa.jsx)(M,{})})},"1"),Object(oa.jsx)(Zr,{tab:"Preferences",children:"2"===R&&Object(oa.jsx)(ei.a.Item,{name:"preferences",children:Object(oa.jsx)(L,{})})},"2")]})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:N,type:"primary",htmlType:"submit",onClick:function(){return g("")},children:"Save"})})})})]})})};Dc.d.register(Dc.a,Dc.j,Dc.e);var ed=function(e){var t=e.socket,n=(e.params,e.componentUuid,Object(s.c)(function(e){return e.auth})),c=n.selectedPage,o=(n.encrypted_token,n.projects),l=n.adminUserRoles,r=Object(s.b)(),d=Object(a.useState)([]),v=Object(u.a)(d,2),b=v[0],j=v[1],m=Object(a.useState)([]),p=Object(u.a)(m,2),O=p[0],f=p[1];Object(a.useState)(!1);var h=Object(a.useState)(!1),g=Object(u.a)(h,2),x=g[0],y=g[1];Object(a.useState)(!1);Mn().getUserRequestPayload;var I=Object(a.useRef)(),S=Object(a.useState)(void 0),N=Object(u.a)(S,2),k=N[0],T=N[1],C=Object(a.useRef)(!0),w=Object(a.useState)(window.innerWidth<=768),E=Object(u.a)(w,2),R=E[0],P=E[1];Object(a.useEffect)(function(){var e=window.matchMedia("(max-width: 768px)"),t=function(e){return P(e.matches)};return e.addEventListener("change",t),function(){return e.removeEventListener("change",t)}},[]);var D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t="@userType:{asset}@serviceId:{'".concat(z(null===o||void 0===o?void 0:o.userServiceId),"'}"),n={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:t,searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",static:"$.persistent.static.asset",type:"$.persistent.static.asset.type",name:"$.persistent.static.asset.name",status:"$.nonpersistent.static.live.status"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@type) && @type=='vehicle' && exists(@name)"+"".concat(e&&""!==e?" && contains(@name, '".concat(e,"')"):"")},anyStatus:!1};y(!0),r(tt({requestData:n,callback:function(e){y(!1),console.log("respons ehere",e);var t=[],n=[{title:"Status",key:"userStatus",dataIndex:"userStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Vehicle name",key:"name",dataIndex:"name"},{title:"Vehicle type",key:"vehicleType",dataIndex:"vehicleType"},{title:"License plate number",key:"licensePlate",dataIndex:"licensePlate"},{title:"Number of passengers",key:"noOfPassengers",dataIndex:"noOfPassengers"},{title:"Number of baggages",key:"noOfBaggages",dataIndex:"noOfBaggages"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsx)(Yn.a,{style:{width:135},children:Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),T(e.user)},children:Object(oa.jsx)(wo.a,{})})})})}}];null===e||void 0===e||e.map(function(e,n){var a,i,c,o,l;t.push({key:e.id,name:null===e||void 0===e||null===(a=e.static)||void 0===a?void 0:a.name,vehicleType:null===e||void 0===e||null===(i=e.static)||void 0===i?void 0:i.vehicleType,licensePlate:null===e||void 0===e||null===(c=e.static)||void 0===c?void 0:c.licensePlate,status:null===e||void 0===e?void 0:e.status,noOfBaggages:null===e||void 0===e||null===(o=e.static)||void 0===o?void 0:o.noOfBaggages,noOfPassengers:null===e||void 0===e||null===(l=e.static)||void 0===l?void 0:l.noOfPassengers,action:{userId:null===e||void 0===e?void 0:e.id,user:e}})}),I.current=t,f(n),j(t)}}))};Object(a.useEffect)(function(){return C.current=!0,function(){C.current=!1}},[]),Object(a.useEffect)(function(){null!==o&&void 0!==o&&o.adminUserId&&D()},[o]);var A=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],M=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,className:R?"d-flex flex-column align-items-start":"d-flex justify-content-space-between align-items-space-between",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Vehicle"}),Object(oa.jsx)("p",{children:"Home > Vehicle"})]}),Object(oa.jsx)(Wn.a,{onChange:function(e){var t=e.target.value;Jr&&clearTimeout(Jr),Jr=setTimeout(function(){t.includes("-")&&(t=z(t)),D(t)},500)},style:R?{width:"100%",marginTop:10}:{width:350},placeholder:"Search vehicle",suffix:Object(oa.jsx)(Jl.a,{})})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:x?M:b,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},columns:x?A:O,scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===c||void 0===c||null===(n=c.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),void 0!==k&&Object(oa.jsx)(Xr,{socket:t,student:k,onClose:function(){T(void 0)},adminRoles:l,onAdd:function(){D()}})]})},td=n(379),nd=(Za.a.Panel,Kl.a.TabPane,function(e){var t,n=e.onClose,c=e.socket,o=e.student,l=e.adminRoles,r=e.onAdd,v=Object(a.useState)(!0),b=Object(u.a)(v,2),j=b[0],m=b[1],p=ei.a.useForm(),O=Object(u.a)(p,1)[0],f=Object(a.useState)(""),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)(!1),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(s.c)(function(e){return e.auth}).projects,T=(Mn().updateUserRequestPayloadV2,Object(s.b)());Object(a.useEffect)(function(){if(null!==o&&void 0!==o&&o.scheduleId){var e,t,n,a,i,c,l,s,r,u,v,b,j,m,p,f,h,g,x=(null===o||void 0===o?void 0:o.data).schoolLocation;O.setFieldsValue(Object(d.a)(Object(d.a)({},null===o||void 0===o?void 0:o.data),{},{schoolLocation:{label:null===x||void 0===x||null===(e=x.attributes)||void 0===e?void 0:e.address,value:{description:null===x||void 0===x||null===(t=x.attributes)||void 0===t?void 0:t.address,place_id:"",coordinates:null===x||void 0===x?void 0:x.coordinates,attributes:null===x||void 0===x?void 0:x.attributes}},holidays:null===(n=Object.values((null===o||void 0===o||null===(a=o.data)||void 0===a?void 0:a.holidays)||{}))||void 0===n?void 0:n.map(function(e){return td(null===e||void 0===e?void 0:e.timestamp)}),driver:null!==o&&void 0!==o&&null!==(i=o.data)&&void 0!==i&&i.driverId?{type:"responder",id:null===o||void 0===o||null===(c=o.data)||void 0===c?void 0:c.driverId,name:null===o||void 0===o||null===(l=o.data)||void 0===l?void 0:l.driverName,beamId:null===o||void 0===o||null===(s=o.data)||void 0===s?void 0:s.driverName,valueName:null===o||void 0===o||null===(r=o.data)||void 0===r?void 0:r.driverName}:void 0,vehicle:{type:"vehicle",value:null===o||void 0===o||null===(u=o.data)||void 0===u?void 0:u.vehicleId,valueName:null===o||void 0===o||null===(v=o.data)||void 0===v?void 0:v.vehicleName,obj:{id:null===o||void 0===o||null===(b=o.data)||void 0===b?void 0:b.vehicleId,name:null===o||void 0===o||null===(j=o.data)||void 0===j?void 0:j.vehicleName,noOfPassengers:null===o||void 0===o||null===(m=o.data)||void 0===m?void 0:m.vehicleCapacity}},project:null===o||void 0===o||null===(p=o.data)||void 0===p?void 0:p.projectId,time:null===o||void 0===o||null===(f=o.data)||void 0===f?void 0:f.scheduleTime,students:null===(h=Object.values((null===o||void 0===o||null===(g=o.data)||void 0===g?void 0:g.students)||{}))||void 0===h?void 0:h.map(function(e){return{id:null===e||void 0===e?void 0:e.userId,beamId:null===e||void 0===e?void 0:e.beamId}})}))}},[]);var w=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,l,s,u,v,b,j,m,p,O,f,h,g,y,I,S,T,C,w,P,D,A,M,L,U,q,F;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("values",t),l=t.name,s=t.daysOfTheWeek,u=t.scheduleType,v=t.time,b=t.project,j=t.vehicle,m=t.students,p=t.driver,O=t.holidays,f=t.schoolLocation,h=t.schoolTime,x(""),!(parseInt(null===j||void 0===j||null===(n=j.obj)||void 0===n?void 0:n.noOfPassengers)<(null===m||void 0===m?void 0:m.length))){e.n=1;break}return x("Students should not exceed maximum vehicle capacity: ".concat(null===j||void 0===j||null===(g=j.obj)||void 0===g?void 0:g.noOfPassengers)),e.a(2);case 1:if(y={name:l,driverId:null===p||void 0===p?void 0:p.id,driverName:null===p||void 0===p?void 0:p.beamId,projectId:b,daysOfTheWeek:s,scheduleTime:v,scheduleType:u,vehicleId:null===j||void 0===j?void 0:j.value,vehicleName:null===j||void 0===j?void 0:j.obj.name,vehicleCapacity:null===j||void 0===j?void 0:j.obj.noOfPassengers,schoolLocation:{coordinates:null===f||void 0===f||null===(a=f.value)||void 0===a?void 0:a.coordinates,attributes:null===f||void 0===f||null===(i=f.value)||void 0===i?void 0:i.attributes},schoolTime:h,holidays:null===O||void 0===O?void 0:O.reduce(function(e,t,n){var a=t.toDate().getTime();return e[a]={timestamp:a,type:"emergency"},e},{}),students:null===m||void 0===m||null===(c=m.map(function(e){return{userId:null===e||void 0===e?void 0:e.id,beamId:null===e||void 0===e?void 0:e.beamId}}))||void 0===c?void 0:c.reduce(function(e,t,n){return e[t.userId]=Object(d.a)({},t),e},{}),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,cudbServiceId:null===k||void 0===k?void 0:k.userServiceId},I=td.tz(v,"MM/DD/YYYY HH:mm",Intl.DateTimeFormat().resolvedOptions().timeZone),S=I.utc().format("MM/DD/YYYY HH:mm"),T=new Date(S),C="".concat(T.getMinutes()," ").concat(T.getHours()," * 0-11 *"),null!==o&&void 0!==o&&o.scheduleId){e.n=4;break}return D={cron:C,topic:"".concat("beamdevlive","/service/scheduler-service/service/dps/createSchoolBusPage"),data:y,info:{},to:0x10000000000000000},console.log("request",D),N(!0),e.n=2,E(D);case 2:return A=e.v,M=null===A||void 0===A||null===(w=A.data)||void 0===w||null===(P=w.id)||void 0===P?void 0:P.toString(),L={objectId:M,changes:[{op:"replace",path:"/partitions",value:["org:".concat(null===k||void 0===k?void 0:k.userServiceId)]}]},e.n=3,R(L);case 3:Lt("Schedule created successfully","success","TOP_CENTER",3e3),e.n=6;break;case 4:return N(!0),q=null===o||void 0===o||null===(U=o.scheduleId)||void 0===U?void 0:U.toString(),F={objectId:q,changes:[{op:"replace",path:"/cron",value:C},{op:"replace",path:"/data",value:y}]},e.n=5,R(F);case 5:Lt("Schedule updated successfully","success","TOP_CENTER",3e3);case 6:N(!1),r();case 7:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){T(bt({request:t,callback:function(t){console.log("create response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){T(mt({request:t,callback:function(t){console.log("create response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),P=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],D=function(e){var t=e.value,n=void 0===t?[]:t,a=e.onChange;return Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Jn.a,{onChange:function(e){if(e&&(null===n||void 0===n||!n.find(function(t){return t.isSame(e,"day")}))){var t=[].concat(Object(C.a)(n),[e]);null===a||void 0===a||a(t)}},disabledDate:function(e){return null===n||void 0===n?void 0:n.some(function(t){return null===t||void 0===t?void 0:t.isSame(e,"day")})},placeholder:"Select date"}),Object(oa.jsx)("div",{style:{marginTop:"16px"},className:"custom-tag",children:null===n||void 0===n?void 0:n.map(function(e){return Object(oa.jsx)(Kn.a,{className:"tag-item",closable:!0,onClose:function(){return function(e){var t=null===n||void 0===n?void 0:n.filter(function(t){return!t.isSame(e,"day")});null===a||void 0===a||a(t)}(e)},closeIcon:Object(oa.jsx)(Ls.a,{}),children:e.format("YYYY-MM-DD")},e.toISOString())})})]})},A=function(e){e.value,e.onChange;var t=function(e){var t=e.value,n=e.onChange;return Object(oa.jsx)(gi,{placeholder:"Select Time",value:t?td(t).format("HH:mm"):void 0,onChange:n})};return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(ei.a.Item,{label:"Schedule Name",name:"name",rules:[{required:!0,message:"Please input the schedule name"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter name"})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Schedule Type",name:"scheduleType",rules:[{required:!0,message:"Please select Pickup or Dropoff"}],children:Object(oa.jsxs)(yi.a.Group,{children:[Object(oa.jsx)(yi.a,{value:"pickup",children:"Pickup"}),Object(oa.jsx)(yi.a,{value:"dropoff",children:"Dropoff"})]})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Schedule Days",name:"daysOfTheWeek",rules:[{required:!0,message:"Days selection is required"}],children:Object(oa.jsx)(Gn.a,{placeholder:"Select Days",mode:"multiple",style:{width:"100%"},children:P.map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3",label:"Schedule Time",name:"time",rules:[{required:!0,message:"Time is required"}],children:Object(oa.jsx)(t,{onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{label:"Holidays",name:"holidays",className:"mt-3",children:Object(oa.jsx)(D,{})}),Object(oa.jsx)(ei.a.Item,{label:"School Location",name:"schoolLocation",rules:[{required:!0,message:"School location is required"}],children:Object(oa.jsx)(ai,{placeholder:"Enter Location",onChange:function(e){}})}),Object(oa.jsx)(ei.a.Item,{className:"mt-3 mb-3",label:"School Time",name:"schoolTime",rules:[{required:!0,message:"Time is required"}],children:Object(oa.jsx)(t,{onChange:function(e){}})})]})};return Object(oa.jsx)($n.a,{title:null!==o&&void 0!==o&&o.scheduleId?"Edit (".concat(null===o||void 0===o||null===(t=o.data)||void 0===t?void 0:t.name,")"):"Add schedule",visible:j,onCancel:function(){m(!1),n&&n()},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:O,onFinish:w,requiredMark:!1,children:[Object(oa.jsxs)("div",{className:"main-cards mt-3",children:[Object(oa.jsx)(ei.a.Item,{name:"schedule",children:Object(oa.jsx)(A,{})}),Object(oa.jsx)(ei.a.Item,{name:"project",label:"Route Project",className:"mt-3",children:Object(oa.jsx)(_i,{placeholder:"Select project",onProjectChange:function(){}})}),Object(oa.jsx)(ei.a.Item,{name:"driver",label:"Driver",className:"mt-3",children:Object(oa.jsx)(fi,{placeholder:"Select driver",adminRoles:l})}),Object(oa.jsx)(ei.a.Item,{name:"vehicle",label:"Vehicle",className:"mt-3",children:Object(oa.jsx)(zc,{placeholder:"Select vehicle",socket:c,vehicleId:!0,onChange:function(e){console.log("vehicle here",e)}})}),Object(oa.jsx)(ei.a.Item,{name:"students",label:"Students",className:"mt-3",children:Object(oa.jsx)(Ur,{placeholder:"Select students",adminRoles:l,multiple:!0})})]}),g&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:g})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:S,type:"primary",htmlType:"submit",onClick:function(){return x("")},children:"Save"})})})})]})})});Dc.d.register(Dc.a,Dc.j,Dc.e);var ad=Kl.a.TabPane,id=function(e){var t,n=e.socket,c=(e.params,e.componentUuid,Object(s.c)(function(e){return e.auth})),o=c.selectedPage,l=(c.encrypted_token,c.projects),r=c.adminUserRoles,d=Object(s.b)(),v=Object(a.useState)([]),b=Object(u.a)(v,2),j=b[0],m=b[1],p=Object(a.useState)([]),O=Object(u.a)(p,2),f=O[0],h=O[1];Object(a.useState)(!1);var g=Object(a.useState)(!1),x=Object(u.a)(g,2),y=x[0],I=x[1];Object(a.useState)(!1);Mn().getUserRequestPayload;var S=Object(a.useRef)(),N=Object(a.useState)(void 0),k=Object(u.a)(N,2),T=k[0],C=k[1],w=Object(a.useState)(void 0),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useRef)(!0),A=function(){var e="@partitions:{'org\\:".concat(z(null===l||void 0===l?void 0:l.userServiceId),"}"),t={select:{index:{searchIndex:"".concat("beamdevlive",":schedule:status"),searchQuery:e,searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",data:"$.data"}},apply:{expression:"",name:""},result:{},filter:{expression:""},anyStatus:!1};I(!0),d(tt({requestData:t,callback:function(e){I(!1),console.log("respons ehere",e);var t=[],n=[{title:"Schedule name",key:"name",dataIndex:"name"},{title:"Schedule type",key:"scheduleType",dataIndex:"scheduleType"},{title:"Driver name",key:"driverName",dataIndex:"driverName"},{title:"Vehicle name",key:"vehicleName",dataIndex:"vehicleName"},{title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn yellow-btn cover",onClick:function(){console.log("action",e),C(e)},children:Object(oa.jsx)(wo.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{style:{boxShadow:"none"},className:"beam-btn icon-btn orange-btn cover",onClick:function(){console.log("action",e),P(e)},children:Object(oa.jsx)(na.a,{})})})]})}}];null===e||void 0===e||e.map(function(e,n){var a,i,c,o;t.push({key:e.id,name:null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.name,scheduleType:null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.scheduleType,driverName:null===e||void 0===e||null===(c=e.data)||void 0===c?void 0:c.driverName,vehicleName:null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.vehicleName,action:{scheduleId:null===e||void 0===e?void 0:e.id,data:null===e||void 0===e?void 0:e.data}})}),S.current=t,h(n),m(t)}}))};Object(a.useEffect)(function(){return D.current=!0,function(){D.current=!1}},[]),Object(a.useEffect)(function(){null!==l&&void 0!==l&&l.adminUserId&&A()},[l]);var M=Zn.a.RangePicker,L=function(){var e=ei.a.useForm(),t=Object(u.a)(e,1)[0];return Object(oa.jsx)("div",{className:"main-column ride-dispatch-panel",children:Object(oa.jsx)("div",{className:"main-cards w-100",children:Object(oa.jsxs)(ei.a,{form:t,layout:"vertical",onFinish:function(e){console.log("Collected Data:",e)},children:[Object(oa.jsx)(ei.a.Item,{name:"optimization_goal",label:"Optimization Goal",children:Object(oa.jsxs)(Gn.a,{children:[Object(oa.jsx)(Gn.a.Option,{value:"minimize_time",children:"Minimize Time"}),Object(oa.jsx)(Gn.a.Option,{value:"minimize_distance",children:"Minimize Distance"}),Object(oa.jsx)(Gn.a.Option,{value:"minimize_cost",children:"Minimize Cost"})]})}),Object(oa.jsx)(ei.a.Item,{name:"cluster_by",label:"Cluster By",className:"mt-3",children:Object(oa.jsxs)(Gn.a,{children:[Object(oa.jsx)(Gn.a.Option,{value:"location",children:"Location"}),Object(oa.jsx)(Gn.a.Option,{value:"grade",children:"Grade"}),Object(oa.jsx)(Gn.a.Option,{value:"school",children:"School"})]})}),Object(oa.jsx)(ei.a.Item,{name:"time_constraint",valuePropName:"checked",className:"mt-3",children:Object(oa.jsx)(Xn.a,{children:"Include Time Constraint"})}),Object(oa.jsx)(ei.a.Item,{name:"max_route_duration",label:"Max Route Duration (Minutes)",className:"mt-3",children:Object(oa.jsx)(Qo.a,{min:1})}),Object(oa.jsx)(ei.a.Item,{name:"max_distance",label:"Max Route Distance (Km)",className:"mt-3",children:Object(oa.jsx)(Qo.a,{min:1})}),Object(oa.jsx)(ei.a.Item,{name:"max_student_rides",label:"Max Students per Vehicle",className:"mt-3",children:Object(oa.jsx)(Qo.a,{min:1})}),Object(oa.jsx)(ei.a.Item,{name:"staggered_pickup_times",valuePropName:"checked",className:"mt-3",children:Object(oa.jsx)(Xn.a,{children:"Allow Staggered Pickup Times"})}),Object(oa.jsx)(ei.a.Item,{name:"allow_multiple_clusters",valuePropName:"checked",className:"mt-3",children:Object(oa.jsx)(Xn.a,{children:"Allow Multiple Clusters"})}),Object(oa.jsx)(ei.a.Item,{name:"fixed_pickup_order",valuePropName:"checked",className:"mt-3",children:Object(oa.jsx)(Xn.a,{children:"Fixed Pickup Order"})}),Object(oa.jsx)(ei.a.Item,{name:"geofence_restrictions",label:"Route Restrictions",className:"mt-3",children:Object(oa.jsxs)(Gn.a,{mode:"multiple",children:[Object(oa.jsx)(Gn.a.Option,{value:"avoid_highways",children:"Avoid Highways"}),Object(oa.jsx)(Gn.a.Option,{value:"no_construction_zones",children:"No Construction Zones"}),Object(oa.jsx)(Gn.a.Option,{value:"no_toll_roads",children:"No Toll Roads"})]})}),Object(oa.jsx)(ei.a.Item,{name:"route_time_window",label:"Route Time Window",className:"mt-3",children:Object(oa.jsx)(M,{format:"HH:mm"})}),Object(oa.jsx)(ei.a.Item,{name:"pickup_time_window",label:"Pickup Time Window",className:"mt-3",children:Object(oa.jsx)(M,{format:"HH:mm"})}),Object(oa.jsx)(ei.a.Item,{name:"dropoff_time_window",label:"Dropoff Time Window",className:"mt-3",children:Object(oa.jsx)(M,{format:"HH:mm"})}),Object(oa.jsx)(ei.a.Item,{name:"route_ordering",label:"Route Ordering",className:"mt-3",children:Object(oa.jsxs)(Gn.a,{children:[Object(oa.jsx)(Gn.a.Option,{value:"shortest_distance",children:"Shortest Distance"}),Object(oa.jsx)(Gn.a.Option,{value:"earliest_pickup",children:"Earliest Pickup"}),Object(oa.jsx)(Gn.a.Option,{value:"priority",children:"Priority"})]})}),Object(oa.jsx)(ei.a.Item,{name:"weather_constraints",label:"Weather Constraints",className:"mt-3",children:Object(oa.jsxs)(Gn.a,{mode:"multiple",children:[Object(oa.jsx)(Gn.a.Option,{value:"avoid_flood_prone_areas",children:"Avoid Flood Prone Areas"}),Object(oa.jsx)(Gn.a.Option,{value:"avoid_snowy_routes",children:"Avoid Snowy Routes"}),Object(oa.jsx)(Gn.a.Option,{value:"avoid_rainy_weather",children:"Avoid Rainy Weather"}),Object(oa.jsx)(Gn.a.Option,{value:"avoid_stormy_conditions",children:"Avoid Stormy Conditions"})]})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover",type:"primary",htmlType:"submit",disabled:!0,children:"Save"})})})})]})})})},U=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,n){d(jt({request:t,callback:function(t){console.log("delete response ehere",t),e(t)}}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),q=[{title:"...",dataIndex:"loading",key:"loading",render:function(){return Object(oa.jsx)(Qn.a,{active:!0,title:!1,paragraph:{rows:7,width:"100%"}})}}],F=Array(1).fill({}).map(function(e,t){return{key:"loading-".concat(t)}});return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,className:"d-flex justify-content-space-between align-items-space-between",children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("h2",{style:{marginBottom:0},children:"Scheduler"}),Object(oa.jsx)("p",{children:"Home > Scheduler"})]})})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table mt-3",style:{display:"grid",marginRight:-20},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsxs)(Kl.a,{defaultActiveKey:"1",type:"line",children:[Object(oa.jsxs)(ad,{tab:"Manual",children:[Object(oa.jsx)(Yn.a,{className:"mb-3",children:Object(oa.jsx)(Hn.a,{span:24,className:"d-flex justify-content-end align-items-end",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn green-btn cover",onClick:function(){C({})},children:"Add"})})}),Object(oa.jsx)(Xi.a,{dataSource:y?F:j,onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){}}},columns:y?q:f,scroll:{x:!0},onChange:function(e){},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===o||void 0===o||null===(n=o.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})]},"1"),Object(oa.jsx)(ad,{tab:"Route optimizer",children:Object(oa.jsx)(L,{})},"2")]})})}),void 0!==T&&Object(oa.jsx)(nd,{socket:n,student:T,onClose:function(){C(void 0)},adminRoles:r,onAdd:function(){A()}}),R&&Object(oa.jsx)(Nr,{onClose:function(){P(void 0)},handleConfirm:Object(_n.a)(Object(Bn.a)().m(function e(){var t;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return console.log("delete here",R),e.n=1,U({objectId:null===R||void 0===R||null===(t=R.scheduleId)||void 0===t?void 0:t.toString()});case 1:P(void 0),Lt("Schedule deleted successfully","success","TOP_CENTER",3e3),A();case 2:return e.a(2)}},e)})),message:"Are you sure you want to delete schedule (".concat(null===R||void 0===R||null===(t=R.data)||void 0===t?void 0:t.name,")?")})]})},cd=n(16),od=n(17);Dc.d.register(Dc.a,Dc.j,Dc.e);var ld=function(){return Object(od.a)(function e(){Object(cd.a)(this,e),this.queue=[]},[{key:"enqueue",value:function(e){this.queue.includes(e)||this.queue.push(e)}},{key:"dequeue",value:function(){return this.queue.shift()}},{key:"isAtTop",value:function(e){return this.queue.length>0&&this.queue[0]===e}},{key:"addOrPop",value:function(e){this.isAtTop(e)?this.dequeue():this.enqueue(e)}},{key:"clear",value:function(){this.queue=[]}},{key:"getQueue",value:function(){return this.queue}}])}(),sd=function(e){var t,n,a,i,c,o=e.avatar,l=e.onClick,s=e.userObj;return Object(oa.jsxs)(Yn.a,{className:"person-item d-flex",style:{height:75,background:"#fff",border:"none"},children:[Object(oa.jsx)(Hn.a,{onClick:l,span:3,children:Object(oa.jsx)("img",{width:"40",style:{cursor:"pointer"},src:o})}),Object(oa.jsx)(Hn.a,{span:18,children:Object(oa.jsx)("h5",{children:s})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn mr-3",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==(t=null===s||void 0===s||null===(n=s.nonpersistent)||void 0===n||null===(a=n.static)||void 0===a||null===(i=a.live)||void 0===i||null===(c=i.status)||void 0===c?void 0:c.name)&&void 0!==t?t:"gray","-icon")})})})]})},rd=function(e){var t=e.socket,n=(e.params,e.componentUuid,e.userRole,Object(s.c)(function(e){return e.auth})),c=n.encrypted_token,o=n.projects,l=(n.adminUserRoles,n.message),r=Object(s.b)(),v=Object(a.useState)([]),b=Object(u.a)(v,2),j=b[0],p=b[1],O=Object(a.useState)([]),f=Object(u.a)(O,2),h=(f[0],f[1]);Object(a.useState)(!1),Object(a.useState)(!1);var g=Object(a.useState)(void 0),x=Object(u.a)(g,2),y=x[0],I=x[1],S=Object(a.useState)([]),N=Object(u.a)(S,2),k=N[0],T=N[1],w=Object(a.useRef)(!0),E=Object(a.useState)(new ld),R=Object(u.a)(E,1)[0];Object(a.useEffect)(function(){if(l&&"barcode"===(null===l||void 0===l?void 0:l.messageType)&&(null===l||void 0===l?void 0:l.pageId)===(null===y||void 0===y?void 0:y.key)){var e=JSON.parse(null===l||void 0===l?void 0:l.message);R.addOrPop(null===e||void 0===e?void 0:e.name),T(Object(C.a)(R.getQueue()))}},[l]);return Object(a.useEffect)(function(){return w.current=!0,function(){w.current=!1}},[]),Object(a.useEffect)(function(){null!==o&&void 0!==o&&o.adminUserId&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=new Date;t.setHours(0),t.setMinutes(1);var n={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===c||void 0===c?void 0:c.userId,"}@rideType:{hail}@pageType:{event}@createdAt:[").concat(t.getTime()-864e5,",+inf]"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{profile:"$..profile",type:"$..persistent.static.metadata.type",title:"$..persistent.static.metadata.title",pageId:"$.objectId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt"}},filter:{expression:""},sortBy:{properties:[{field:"@createdAt",order:"ASC"}],max:1e3},result:{pagination:{offset:e,limit:50}}};r(tt({requestData:n,callback:function(t){console.log("resppnse",t);var n=e>0?Object(C.a)(j):[],a=[{title:"Title",key:"title",dataIndex:"title"}];null===t||void 0===t||t.map(function(e,t){var a,i;Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),n.push({key:null===(a=e.pageId)||void 0===a?void 0:a.toString(),title:e.title,createdAt:null===(i=new Date(null===e||void 0===e?void 0:e.createdAt))||void 0===i?void 0:i.toLocaleString(),action:{pageId:e.pageId,page:Object(d.a)({},e)}})}),a.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){},children:"Chat"})}),(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t;window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(null===c||void 0===c?void 0:c.connectionId,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:"Summary"})})]})}}),h(a),p(n)}}))}()},[o]),Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)(Yn.a,{gutter:30,className:"mt-1",children:[Object(oa.jsx)(Hn.a,{sm:24,md:5,children:Object(oa.jsx)(Yn.a,{className:"main-column search-panel flex-column",style:{height:"100vh",padding:16},children:null===j||void 0===j?void 0:j.map(function(e,n){return Object(oa.jsxs)("div",{className:"search-card yellow-card cursor-pointer ".concat((null===y||void 0===y?void 0:y.key)===(null===e||void 0===e?void 0:e.key)?"active-card":""),onClick:function(){I(e),function(e){var t=W();localStorage.setItem("requestId",t),localStorage.setItem("requestService","summary");var n={select:{index:{searchIndex:"".concat("beamdevlive",":message:createdAt"),searchQuery:"@pageId:{".concat(e.toString(),"}@type:{barcode}"),searchOptions:"TIMEOUT 100"},load:{object:"$"}},result:{pagination:{offset:0,limit:100}},sortBy:{properties:[{field:"@createdAt",order:"ASC"}],max:1e4}};R.clear(),r(tt({requestData:n,callback:function(e){var t=null===e||void 0===e?void 0:e.map(function(e){var t,n,a;return JSON.parse(null===e||void 0===e||null===(t=e.object)||void 0===t||null===(n=t.message)||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.body)});console.log("message response",t),null===t||void 0===t||t.map(function(e){R.addOrPop(e.name)}),T(Object(C.a)(R.getQueue()))}}))}(null===e||void 0===e?void 0:e.key),t.subscribeToEvent(m.SubscribePageTopics,mn(null===e||void 0===e?void 0:e.key))},children:[Object(oa.jsx)("div",{className:"ant-dropdown-trigger colorable mark-icon",children:Object(oa.jsx)("div",{children:Object(oa.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"34",height:"28",viewBox:"0 0 34 28",fill:"none",className:"injected-svg","data-src":"/images/emergency-icon.svg",children:Object(oa.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18.6052 1.07248C18.9798 1.30975 19.2972 1.62714 19.5345 2.00178L33.0834 23.3948C33.9699 24.7946 33.5538 26.648 32.1541 27.5345C31.6739 27.8386 31.1173 28 30.5489 28H3.45106C1.7942 28 0.451057 26.6569 0.451057 25C0.451057 24.4317 0.612504 23.875 0.9166 23.3948L14.4655 2.00178C15.352 0.602038 17.2054 0.185976 18.6052 1.07248ZM16.2233 2.97696L16.1552 3.07188L2.60624 24.465C2.50487 24.625 2.45106 24.8106 2.45106 25C2.45106 25.5128 2.8371 25.9355 3.33444 25.9933L3.45106 26H30.5489C30.7384 26 30.9239 25.9462 31.084 25.8448C31.5173 25.5704 31.6678 25.0181 31.4505 24.5671L31.3938 24.465L17.8448 3.07188C17.7855 2.97822 17.7112 2.8953 17.625 2.82632L17.5351 2.76212C17.1018 2.48772 16.5382 2.58771 16.2233 2.97696ZM17 21C17.5523 21 18 21.4477 18 22C18 22.5523 17.5523 23 17 23C16.4477 23 16 22.5523 16 22C16 21.4477 16.4477 21 17 21ZM17 8.00001C17.5523 8.00001 18 8.44772 18 9.00001V18C18 18.5523 17.5523 19 17 19C16.4477 19 16 18.5523 16 18V9.00001C16 8.44772 16.4477 8.00001 17 8.00001Z",fill:"#91A5C6"})})})}),Object(oa.jsx)("div",{className:"d-flex w-full",children:Object(oa.jsxs)("div",{className:"ml-2",children:[Object(oa.jsx)("h3",{children:null===e||void 0===e?void 0:e.title}),Object(oa.jsx)("div",{className:"ant-row",children:Object(oa.jsx)("div",{className:"ant-col card-info date-info mr-2",children:Object(oa.jsx)("p",{className:"text-black",children:null===e||void 0===e?void 0:e.createdAt})})})]})})]})})})}),y&&Object(oa.jsx)(Hn.a,{sm:24,md:6,children:Object(oa.jsx)("div",{className:"main-column message-panel",style:{height:"100vh"},children:Object(oa.jsxs)("div",{className:"main-content",style:{justifyContent:"flex-start"},children:[Object(oa.jsx)("div",{className:"main-header",children:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)("div",{className:"colorable mark-icon",children:Object(oa.jsx)("div",{children:Object(oa.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"34",height:"28",viewBox:"0 0 34 28",fill:"none",className:"injected-svg","data-src":"/images/emergency-icon.svg",children:Object(oa.jsx)("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18.6052 1.07248C18.9798 1.30975 19.2972 1.62714 19.5345 2.00178L33.0834 23.3948C33.9699 24.7946 33.5538 26.648 32.1541 27.5345C31.6739 27.8386 31.1173 28 30.5489 28H3.45106C1.7942 28 0.451057 26.6569 0.451057 25C0.451057 24.4317 0.612504 23.875 0.9166 23.3948L14.4655 2.00178C15.352 0.602038 17.2054 0.185976 18.6052 1.07248ZM16.2233 2.97696L16.1552 3.07188L2.60624 24.465C2.50487 24.625 2.45106 24.8106 2.45106 25C2.45106 25.5128 2.8371 25.9355 3.33444 25.9933L3.45106 26H30.5489C30.7384 26 30.9239 25.9462 31.084 25.8448C31.5173 25.5704 31.6678 25.0181 31.4505 24.5671L31.3938 24.465L17.8448 3.07188C17.7855 2.97822 17.7112 2.8953 17.625 2.82632L17.5351 2.76212C17.1018 2.48772 16.5382 2.58771 16.2233 2.97696ZM17 21C17.5523 21 18 21.4477 18 22C18 22.5523 17.5523 23 17 23C16.4477 23 16 22.5523 16 22C16 21.4477 16.4477 21 17 21ZM17 8.00001C17.5523 8.00001 18 8.44772 18 9.00001V18C18 18.5523 17.5523 19 17 19C16.4477 19 16 18.5523 16 18V9.00001C16 8.44772 16.4477 8.00001 17 8.00001Z",fill:"#91A5C6"})})})}),Object(oa.jsx)("h3",{className:"ml-3",style:{color:"rgb(80, 138, 250)"},children:null===y||void 0===y?void 0:y.title})]})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:null===k||void 0===k?void 0:k.map(function(e,t){return Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(sd,{onClick:function(){},avatar:"/images/users/user.png",userObj:e})})})})]})})})]})})},dd=function(e){e.socket;var t,n=e.params,i=e.userRole,c=n.screen,o=n.setScreen,l=Object(a.useState)(window.innerWidth<=768),s=Object(u.a)(l,2),r=s[0],d=s[1],v=[{id:nc.Student,key:"student",name:"Student",src:"/images/community-icon.svg",onClick:function(){o(nc.Student)}},{id:nc.Driver,key:"driver",name:"Driver",src:"/images/user1-icon.svg",onClick:function(){o(nc.Driver)}},{id:nc.Vehicle,key:"vehicle",name:"Vehicle",src:"/images/ride-dispatch-icon.svg",cssClass:"settings-icon",onClick:function(){o(nc.Vehicle)}},{id:nc.Scheduler,key:"schedule",name:"Scheduler",src:"/images/setting-icon.svg",cssClass:"settings-icon",onClick:function(){o(nc.Scheduler)}},{id:nc.Dashboard,key:"dashboard",name:"Dashboard",src:"/images/desktop-icon.svg",onClick:function(){o(nc.Dashboard)}}];return Object(a.useEffect)(function(){var e=window.matchMedia("(max-width: 768px)"),t=function(e){return d(e.matches)};return e.addEventListener("change",t),function(){return e.removeEventListener("change",t)}},[]),Object(oa.jsx)("div",{className:"main-column search-panel mr-4",style:{width:r?90:110,position:"fixed",top:75,left:0,height:"122vh"},children:Object(oa.jsx)("div",{className:"sidebar",style:{borderRadius:0},children:Object(oa.jsx)("ul",{children:null===v||void 0===v||null===(t=v.filter(function(e){return"admin"===i||"dashboard"===e.key||i===(null===e||void 0===e?void 0:e.key)}))||void 0===t?void 0:t.map(function(e){return Object(oa.jsx)("li",{className:c===e.id&&"selected",onClick:function(){var t=v.find(function(t){return t.id===e.id});null===t||void 0===t||t.onClick()},children:Object(oa.jsx)("div",{children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)(fa.a,{className:e.cssClass,src:e.src}),Object(oa.jsx)("p",{children:e.name})]})})},"selected-"+e.id)})})})})},ud=n(33),vd=function(e){e.socket;var t,n,c=Object(s.b)(),o=Mn(),r=(o.getUserRequestPayload,o.handleMessages,Object(a.useState)(!1)),v=Object(u.a)(r,2),b=(v[0],v[1],Object(a.useState)(!1)),j=Object(u.a)(b,2),m=(j[0],j[1]),p=Object(a.useState)(!1),O=Object(u.a)(p,2),f=(O[0],O[1]),h=Object(a.useState)({}),g=Object(u.a)(h,2),x=(g[0],g[1],Object(a.useState)("")),y=Object(u.a)(x,2),I=y[0],S=y[1],N=Object(a.useState)(),k=Object(u.a)(N,2),T=(k[0],k[1],Object(a.useState)(!1)),C=Object(u.a)(T,2),w=(C[0],C[1]),E=Object(a.useState)(""),R=Object(u.a)(E,2),P=(R[0],R[1]),D=Object(s.c)(function(e){return e.auth}),A=D.userInfo,M=D.projects,L=D.encrypted_token,U=Object(a.useState)("/images/users/user.png"),q=Object(u.a)(U,2),F=(q[0],q[1]),B=Object(a.useState)(!1),_=Object(u.a)(B,2),$=_[0],Y=_[1],H=Object(s.c)(function(e){return e.auth}),W=(H.isOpenLoginModal,H.isOpenVerifyModal,H.loginSuccessfull,H.isOpenRegisterationModal,H.categories,Object(a.useState)([])),V=Object(u.a)(W,2);V[0],V[1],Object(l.g)().search;Object(a.useEffect)(function(){if(null!==M&&void 0!==M&&M.serviceIds){var e=(null===L||void 0===L?void 0:L.cudbServiceId)||(null===L||void 0===L?void 0:L.serviceId);S(e),Y(!0),console.log("serviceIds",null===M||void 0===M?void 0:M.serviceIds),console.log("encrypted_token",L)}},[null===M||void 0===M?void 0:M.serviceIds]),Object(a.useEffect)(function(){if(A){var e,t,n,a,i=A.firstName||"",c=A.lastName||"";if(!i&&!c)return void P("");P(i+" "+c),F(null!==(e=null===A||void 0===A||null===(t=A.profileImage)||void 0===t||null===(n=t.urls)||void 0===n||null===(a=n.original)||void 0===a?void 0:a.url)&&void 0!==e?e:"/images/users/user.png")}else P("")},[A]);i.a.Fragment,"candidate"===(null===A||void 0===A||null===(t=A.coach)||void 0===t?void 0:t.type)&&fa.a,"coach"===(null===A||void 0===A||null===(n=A.coach)||void 0===n?void 0:n.type)&&fa.a,fa.a,fa.a,fa.a;var z=function(e){S(e),function(e){c(ce({data:{payload:JSON.stringify(Object(d.a)(Object(d.a)({},L),{},{cudbServiceId:null===e||void 0===e?void 0:e[0],serviceId:null===e||void 0===e?void 0:e[0]}))},callback:function(e){var t=new URL(window.location.href);t.searchParams.set("token",e.encryptedPayload),window.location.href=t.toString()}}))}(e)},Q=Object(oa.jsx)("ul",{className:"user-dropdown list",children:Object(oa.jsx)(i.a.Fragment,{children:(null===M||void 0===M?void 0:M.serviceIds)&&(null===M||void 0===M?void 0:M.serviceIds.filter(function(e){return"cudb-live"!==(null===e||void 0===e?void 0:e[0])&&"cudb-root"!==(null===e||void 0===e?void 0:e[0])}).map(function(e){return Object(oa.jsx)("li",{onClick:function(){return z(e)},children:Object(oa.jsxs)("span",{children:[" ",Object(oa.jsx)(Xn.a,{checked:I==e,className:"circular-checkbox custom-checkbox",value:e,children:e})]})},e)}))})});return Object(oa.jsx)("div",{className:"header main-column mobile-responsive",style:{padding:"10px 20px",borderBottom:"1px solid #ddd",height:75,position:"fixed",top:0,left:0,borderRadius:0,zIndex:9999999,width:"131vw"},children:Object(oa.jsxs)(Yn.a,{align:"middle",justify:"space-between",className:"w-full",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(ud.b,{to:"/coach",children:Object(oa.jsx)("img",{src:"/images/logo-icon.svg",alt:"Coach App Icon",style:{height:"40px"}})})}),$&&A&&Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(ni.a,{overlay:Q,placement:"bottomRight",trigger:["click"],children:Object(oa.jsxs)("div",{className:"user-avatar d-flex",children:[Object(oa.jsxs)("p",{className:"mr-1 ml-1",children:["Orgs.",Object(oa.jsxs)("span",{style:{fontSize:16},children:["(",I,")"]})]}),Object(oa.jsx)(aa.a,{style:{fontSize:11}})]})})})]})})},bd=n(1042),jd=n(1068),md=function(){return Object(oa.jsx)("div",{style:{height:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(oa.jsx)(bd.a,{icon:Object(oa.jsx)(jd.a,{style:{fontSize:"150px",color:"#ff5f27"}}),title:"Unauthorized",subTitle:"You do not have permission to access this page."})})},pd=(n(973),function(e){var t=e.onClose,n=e.onVerification,i=e.data,c=(e.typeId,e.root,Object(s.c)(function(e){return e.auth})),o=c.authenticationSuccess,l=c.authenticationFailure,r=c.verificationFailed,d=c.isLoading,v=Object(a.useState)(!0),b=Object(u.a)(v,2),j=b[0],m=b[1],p=ei.a.useForm(),O=Object(u.a)(p,1)[0],f=Object(s.b)(),h=function(){m(!1),t&&t()};Object(a.useEffect)(function(){r&&(f({type:"RESET_REDIRECT_STATE"}),n(!1),h()),l&&(f({type:"RESET_REDIRECT_STATE"}),n(!1))},[r,l]),Object(a.useEffect)(function(){o&&(f({type:"RESET_REDIRECT_STATE"}),n(!0))},[o]);return Object(oa.jsx)($n.a,{title:"Verify Identity",visible:j,onOk:function(){m(!1),t&&t()},onCancel:h,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"confirmation-form",id:"confirmation-form",layout:"vertical",form:O,onFinish:function(e){var t={password:e.password},n=i.email,a=i.phone,c=i.udid;n&&Object.assign(t,{email:n}),a&&Object.assign(t,{phone:a}),c&&Object.assign(t,{udid:c}),f(ie(t))},requiredMark:!1,children:[Object(oa.jsxs)("p",{children:["A verification code was sent to"," ",Object(oa.jsx)("a",{href:"",onClick:function(e){return e.preventDefault()},children:Object(oa.jsx)("small",{children:(null===i||void 0===i?void 0:i.email)||(null===i||void 0===i?void 0:i.phone)||localStorage.getItem("email")||localStorage.getItem("phone")})}),". Please enter the verification code below."]}),Object(oa.jsx)(ei.a.Item,{name:"password",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(Wn.a,{type:"password",placeholder:"Enter Verification Code"})}),Object(oa.jsx)(ei.a.Item,{className:"action-grp mt-4",children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{loading:d,className:"beam-btn green-btn cover w-full",htmlType:"submit",children:"Confirm"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:h,children:"Cancel"})})]})})]})})});gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var Od=function(e){var t=e.socket,n=Object(s.b)(),c=Object(a.useState)(void 0),o=Object(u.a)(c,2),r=o[0],b=o[1],j=Object(a.useState)(),p=Object(u.a)(j,2),O=p[0],f=p[1],g=Object(a.useState)(),I=Object(u.a)(g,2),S=I[0],N=I[1],k=Object(s.c)(function(e){return e.auth}),T=k.encrypted_token,C=k.projects,w=Object(a.useState)(null),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useState)(null),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Object(a.useState)(!1),q=Object(u.a)(U,2),F=q[0],_=q[1],$=Object(a.useState)(!1),Y=Object(u.a)($,2),H=Y[0],V=Y[1],z=Object(a.useState)({all:W(),student:W(),driver:W(),vehicle:W(),schedule:W(),sidebar:W()}),Q=Object(u.a)(z,2),G=Q[0],J=(Q[1],{screen:r,setScreen:b}),K=Object(l.g)().search,Z=Mn().getUserRequestPayload,X=Object(a.useState)(window.innerWidth<=768),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1];Object(a.useEffect)(function(){var e=function(){return ne(window.innerWidth<=768)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}},[]),Object(a.useEffect)(function(){T&&(localStorage.getItem("UUID")?(V(!0),ae()):ie())},[T]);var ae=function(){t.subscribeToEvent(m.SubscribePageTopics,qt(null===T||void 0===T?void 0:T.connectionId)),t.publishToEvent(m.PublishPageTopics,Ft(null===T||void 0===T?void 0:T.connectionId),Dn({userId:null===T||void 0===T?void 0:T.userId,cudbServiceId:(null===T||void 0===T?void 0:T.cudbServiceId)||(null===T||void 0===T?void 0:T.serviceId)}))},ie=function(){t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Z(null===T||void 0===T?void 0:T.userId,"$","$.persistent.static.live"),x.GetUserBio,null===T||void 0===T?void 0:T.serviceId),t.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,a,i=null===e||void 0===e||null===(t=e.data[0][0])||void 0===t?void 0:t.alternativeIds;P(i),null!==(a=Object.keys(i))&&void 0!==a&&a.length?function(e){var t=null===e||void 0===e?void 0:e.email,a=null===e||void 0===e?void 0:e.phone,i={};t&&Object.assign(i,{email:t}),a&&Object.assign(i,{email:a});var c=Object(B.uuid)();L(c),Object.assign(i,{uuid:c,pinVerification:!0}),n(oe(i))}(i):V(!1)})};Object(a.useEffect)(function(){O&&(t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Z(T.userId,"$","$..roleId"),h.GetBio,null===C||void 0===C?void 0:C.userServiceId),t.subscribeToSurvey(m.SurveyTopics,h.GetBio,function(e){var t,n,a,i,c,o,l=O.find(function(t){var n,a;return(null===t||void 0===t?void 0:t._id)===(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n[0])||void 0===a?void 0:a[0])});(null!==l&&void 0!==l&&null!==(t=l.permissions)&&void 0!==t&&t.includes(ic.Admin)||null!==l&&void 0!==l&&null!==(n=l.permissions)&&void 0!==n&&n.includes(ic.Cad))&&N("admin"),null===l||void 0===l||null===(a=l.permissions)||void 0===a||!a.includes(ic.OnMove)||null!==l&&void 0!==l&&null!==(i=l.permissions)&&void 0!==i&&i.includes(ic.Admin)||N("driver"),null===l||void 0===l||null===(c=l.permissions)||void 0===c||!c.includes(ic.Live)||null!==l&&void 0!==l&&null!==(o=l.permissions)&&void 0!==o&&o.includes(ic.Admin)||N("student")}))},[O]),Object(a.useEffect)(function(){S&&b(nc.Dashboard)},[S]),Object(a.useEffect)(function(){var e,n;null!==C&&void 0!==C&&C.adminUserId&&(e=null===C||void 0===C?void 0:C.adminUserId,n=null===C||void 0===C?void 0:C.userServiceId,t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Z(e,"$","$..role"),hn(null===T||void 0===T?void 0:T.connectionId),n),t.subscribeToSurvey(m.SurveyTopics,hn(null===T||void 0===T?void 0:T.connectionId),function(e){var t,n;f(null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0])},G.all))},[C]),Object(a.useEffect)(function(){if(t.client){var e=new URLSearchParams(K),a=e.get("userId"),i=e.get("connectionId"),c=e.get("token");c?function(e){var a=Math.floor(1e4+9e4*Math.random());t.publishToEvent(m.PublishPageTopics,function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/live-api/decrypt")}(null===a||void 0===a?void 0:a.toString()),Dn({payload:e})),t.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/live-api/decrypt/reply")}(null===a||void 0===a?void 0:a.toString()),function(e){var t,a;n({type:"ADD_ENCRYPTED_TOKEN",payload:JSON.parse(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.decryptedPayload)})})}(c):n({type:"ADD_ENCRYPTED_TOKEN",payload:{connectionId:i,userId:a}})}},[K,t.client]);return Object(oa.jsxs)(oa.Fragment,{children:[!H&&!localStorage.getItem("UUID")&&Object(oa.jsx)(pd,{typeId:13,data:Object(d.a)(Object(d.a)({},R),{},{udid:M}),onClose:function(){_(!0)},onVerification:function(e){V(e),e&&(ae(),localStorage.setItem("UUID",M))}}),F&&!H&&Object(oa.jsx)(md,{}),H&&Object(oa.jsxs)(Yn.a,{className:"main-layout",style:{transform:"scale(0.765)",transformOrigin:"0 0",width:"133vw",height:"100vh",paddingTop:100},children:[Object(oa.jsx)(vd,{socket:t}),Object(oa.jsxs)(Hn.a,{span:24,className:"d-flex justify-content-start align-items-start",children:[Object(oa.jsx)("div",{children:void 0!==r?Object(oa.jsx)("div",{style:{width:100},children:Object(oa.jsx)(dd,{socket:t,params:J,userRole:S})}):Object(oa.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}}),Object(oa.jsx)(Qn.a.Button,{shape:"square",style:{width:85,height:85}})]})}),Object(oa.jsxs)(Yn.a,{style:{height:"119vh",overflow:"scroll",width:"100%"},children:[r===nc.Dashboard&&Object(oa.jsxs)(i.a.Fragment,{children:["admin"===S&&Object(oa.jsx)(Hn.a,{sm:7,xs:24,style:te?{marginBottom:30}:{height:"calc((100vh / 0.8) - 50px)",overflow:"scroll"},children:Object(oa.jsx)(Br,{socket:t,params:J,fullScreen:!0,scale:!0,userRole:S})}),Object(oa.jsx)(Hn.a,{sm:"admin"===S?17:24,xs:24,style:te?{}:{height:"calc((100vh / 0.8) - 70px)",overflow:"scroll"},children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:24,className:"ride-container",children:Object(oa.jsx)(Dr,{socket:t,params:J,userRole:S})}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mt-3",style:{padding:0},children:Object(oa.jsx)(Er,{socket:t,filter:!0,componentUuid:G.all,userRole:S})})})})]})})]}),r===nc.Student&&Object(oa.jsx)(Hn.a,{span:24,style:{width:"100%"},children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:te?16:0},children:Object(oa.jsx)(zr,{socket:t,componentUuid:G.student,userRole:S})})})}),r===nc.Driver&&Object(oa.jsx)(Hn.a,{span:24,style:{width:"100%"},children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:te?16:0},children:Object(oa.jsx)(Kr,{socket:t,componentUuid:G.driver,userRole:S})})})}),r===nc.Vehicle&&Object(oa.jsx)(Hn.a,{span:24,style:{width:"100%"},children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:te?16:0},children:Object(oa.jsx)(ed,{socket:t,componentUuid:G.vehicle})})})}),r===nc.Scheduler&&Object(oa.jsx)(Hn.a,{span:24,style:{width:"100%"},children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:te?16:0},children:Object(oa.jsx)(id,{socket:t,componentUuid:G.schedule})})})}),r===nc.Queue&&Object(oa.jsx)(Hn.a,{span:24,style:{width:"100%"},children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout",style:{padding:te?16:0},children:Object(oa.jsx)(rd,{socket:t,componentUuid:G.queue})})})})]})]}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})]})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var fd=function(e){var t=e.socket,n=e.date,i=e.onEventCreated,c=e.selectedCustomerId,o=e.selectedProjectId,r=(Object(l.f)(),Object(s.b)(),Object(a.useState)(void 0)),d=Object(u.a)(r,2),v=(d[0],d[1],Object(a.useState)(!1)),b=Object(u.a)(v,2),j=(b[0],b[1],Object(a.useState)(!1)),m=Object(u.a)(j,2),p=(m[0],m[1],Object(a.useState)({form:!0,map:!1})),O=Object(u.a)(p,2),f=O[0],h={screens:f,setScreens:O[1]};return Object(oa.jsxs)(Yn.a,{className:"main-layout",children:[f.form&&Object(oa.jsx)(Hn.a,{md:f.map?12:24,xs:24,className:"form"===f.active?"active-screen":"",children:f.form&&Object(oa.jsx)(xr,{socket:t,params:h,date:n,selectedCustomerId:c,selectedProjectId:o,onEventCreated:i})}),f.map&&Object(oa.jsx)(Hn.a,{md:12,xs:24,className:"map"===f.active?"active-screen":"",children:Object(oa.jsx)(Nc,{socket:t,params:h})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})};Object(pl.hb)("Mgo+DSMBaFt/QHRqVVhkVFpFdEBBXHxAd1p/VWJYdVt5flBPcDwsT3RfQF5jSn5bdkNhX3xbeH1UQA==;Mgo+DSMBPh8sVXJ0S0J+XE9AflRDX3xKf0x/TGpQb19xflBPallYVBYiSV9jS31TdUVrWXlcdndQT2FZVw==;ORg4AjUWIQA/Gnt2VVhkQlFacldJXGFWfVJpTGpQdk5xdV9DaVZUTWY/P1ZhSXxQdkZjUX9YcnJWQ2lfVEI=;MTI3OTc4NUAzMjMwMmUzNDJlMzBFYkNEeXZCNEppU3FkZkZNYks1V0loTzlaajdjLyttcStERE1Sc0VERlhzPQ==;MTI3OTc4NkAzMjMwMmUzNDJlMzBIdW4xM1NDVm5tcTB1Q2tEdk9NNkVsallXeE9mYU5xWTZXU2lwYkJzMjRzPQ==;NRAiBiAaIQQuGjN/V0Z+WE9EaFtKVmJLYVB3WmpQdldgdVRMZVVbQX9PIiBoS35RdUVgWXdednZTRWZcUkJw;MTI3OTc4OEAzMjMwMmUzNDJlMzBFRGJlZVhDZjJmRE1mYWNsRXZsTkQxeGNlOUtJOWFzU0RORVVhMHJzdFp3PQ==;MTI3OTc4OUAzMjMwMmUzNDJlMzBqNUw3TXlZWUhrTS9VenErVW1qbWgxUjg1R04rSEtYcTgveTRRT3Uvdkw4PQ==;Mgo+DSMBMAY9C3t2VVhkQlFacldJXGFWfVJpTGpQdk5xdV9DaVZUTWY/P1ZhSXxQdkZjUX9YcnJWQGFeVEI=;MTI3OTc5MUAzMjMwMmUzNDJlMzBIL3I3R0FkZU0vbG96eXRFbmhXeTRpZEdiblhEMFdMYi82R1RrUEZxTXFFPQ==;MTI3OTc5MkAzMjMwMmUzNDJlMzBZTlo1YlRXUXBLWnNYYjBaZGtTS2NicTQzbURmSCtybGFlS1psSU85emlRPQ==;MTI3OTc5M0AzMjMwMmUzNDJlMzBFRGJlZVhDZjJmRE1mYWNsRXZsTkQxeGNlOUtJOWFzU0RORVVhMHJzdFp3PQ==");var hd,gd=Gn.a.Option,xd=function(e){e.onClose;var t=e.adminRoles,n=e.onSubmitHandler,i=Object(a.useRef)(),c=Object(a.useRef)(!1),o=Object(l.g)().search,r=(Object(l.f)(),Object(s.c)(function(e){return e.auth.projects},function(e,t){return JSON.stringify(e)===JSON.stringify(t)})),d=Object(a.useRef)({}),u=function(e){var t,n;return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select project",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.project,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].project=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===r||void 0===r||null===(n=r.projects)||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(gd,{value:e.id,children:e.name})})})},v=function(e){var t,n=[{id:"immediate",name:"Immediate"},{id:"schedule",name:"Schedule"},{id:"deadline",name:"Deadline"}];return Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:"Select dispatch type",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.dispatchType,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].dispatchType=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===n||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(gd,{value:e.id,children:e.name})})})},b=function(e){var t;return Object(oa.jsx)(fl,{placeholder:"Select task",rowIndex:null===e||void 0===e?void 0:e.rowIndex,allProjects:d,value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.task,onChange:function(t){var n,a;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].task=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.task)||void 0===n||null===(a=n.id)||void 0===a?void 0:a.toString()},null===e||void 0===e?void 0:e.address)}})},j=function(e){var t;return Object(oa.jsx)("div",{className:"datetime-item",children:Object(oa.jsx)(di,{placeholder:"Select date",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.date,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].date=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)}})})},m=function(e){var t;return Object(oa.jsx)(gi,{name:"Select time",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.time,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].time=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:t},null===e||void 0===e?void 0:e.address)}})},p=function(e){var t;return Object(oa.jsx)(ai,{placeholder:"Select location",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.incidentLocation,onChange:function(t){d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].incidentLocation=t}})},O=function(e){var n;return Object(oa.jsx)(fi,{placeholder:"Select responder",adminRoles:t,value:null===(n=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===n?void 0:n.responder,onChange:function(t){var n,a,i;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].responder=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.responders)||void 0===n||null===(a=n[0])||void 0===a||null===(i=a.id)||void 0===i?void 0:i.toString()},null===e||void 0===e?void 0:e.address)}})},f=function(e){var t;return Object(oa.jsx)(ji,{placeholder:"Select location",value:null===(t=d.current[null===e||void 0===e?void 0:e.rowIndex])||void 0===t?void 0:t.location,onChange:function(t){var n,a,i,c,o,l,s;d.current[null===e||void 0===e?void 0:e.rowIndex]||(d.current[null===e||void 0===e?void 0:e.rowIndex]={}),d.current[null===e||void 0===e?void 0:e.rowIndex].location=t,null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(n=t.asset)||void 0===n?void 0:n.name},null===e||void 0===e?void 0:e.address),null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(a=t.asset)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c[1]},Object(bl.b)(null===e||void 0===e?void 0:e.rowIndex,1)),null===e||void 0===e||e.spreadsheet.current.updateCell({value:null===t||void 0===t||null===(o=t.asset)||void 0===o||null===(l=o.location)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s[0]},Object(bl.b)(null===e||void 0===e?void 0:e.rowIndex,2))}})},h=function(){var e,t,n,a,i,c=new URLSearchParams(o).get("projectId"),l=c&&""!==c?(null===r||void 0===r||null===(e=r.sections)||void 0===e||null===(t=e[1])||void 0===t||null===(n=t[0])||void 0===n?void 0:n[c])||[]:null===r||void 0===r||null===(a=r.sections)||void 0===a||null===(i=a[0])||void 0===i?void 0:i[0],s=[{label:"title"},{label:"location-lat"},{label:"location-long"}];return l.forEach(function(e){e.Rows.forEach(function(e){e.Cols.forEach(function(e){s.push({label:e.name,type:e.type})})})}),s.push({label:"dispatchType",type:"dispatchType"}),s.push({label:"dispatchDate",type:"dispatchDate"}),s.push({label:"dispatchTime",type:"dispatchTime"}),s};return Object(oa.jsx)("div",{className:"control-pane",children:Object(oa.jsx)("div",{className:"control-section spreadsheet-control",children:Object(oa.jsx)(jl.a,{allowDelete:!1,allowOpen:!0,openUrl:"https://ej2services.syncfusion.com/production/web-services/api/spreadsheet/open",openComplete:function(){for(var e=i.current.sheets,t=function(){i.current.sheets[n].name,Object(bl.c)([0,0,e[n].usedRange.rowIndex,e[n].usedRange.colIndex]);var t=h(),a=Object(C.a)(Array(e[n].usedRange.rowIndex-1).keys());t.map(function(e,t){"project"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return u({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"dispatchType"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return v({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"responder"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return O({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"fixed-asset"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return f({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"task-picker"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return b({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"date"===(null===e||void 0===e?void 0:e.type)||"dispatchDate"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return j({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"time"===(null===e||void 0===e?void 0:e.type)||"dispatchTime"===(null===e||void 0===e?void 0:e.type)?a.map(function(e){i.current.updateRange({template:function(){return m({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})}):"incident-location"===(null===e||void 0===e?void 0:e.type)&&a.map(function(e){i.current.updateRange({template:function(){return p({address:Object(bl.b)(e+1,t),spreadsheet:i,rowIndex:e+1})},address:Object(bl.b)(e+1,t)})})}),setTimeout(function(){i.current.setRowsHeight(50),i.current.setColumnsWidth(150),c.current||(i.current.addFileMenuItems([{text:"Insert row",iconCss:"e-icons e-plus"}],"Open"),c.current=!0)},100)},n=0;n<e.length;n++)t()},allowSave:!0,saveUrl:"https://ej2services.syncfusion.com/production/web-services/api/spreadsheet/save",ref:function(e){i.current=e},created:function(){hd&&clearTimeout(hd),hd=setTimeout(function(){i.current.addFileMenuItems([{text:"Submit",iconCss:"e-icons e-save-2"}],"Open")},1e3)},fileMenuItemSelect:function(e){switch(e.item.text){case"Insert row":var t=h(),a=i.current.sheets[0].usedRange.rowIndex;i.current.insertRow(a),t.map(function(e,t){"project"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return u({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"dispatchType"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return v({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"responder"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return O({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"fixed-asset"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return f({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"task-picker"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return b({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"date"===(null===e||void 0===e?void 0:e.type)||"dispatchDate"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return j({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"time"===(null===e||void 0===e?void 0:e.type)||"dispatchTime"===(null===e||void 0===e?void 0:e.type)?i.current.updateRange({template:function(){return m({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)}):"incident-location"===(null===e||void 0===e?void 0:e.type)&&i.current.updateRange({template:function(){return p({address:Object(bl.b)(a,t),spreadsheet:i,rowIndex:a})},address:Object(bl.b)(a,t)})}),setTimeout(function(){i.current.setRowsHeight(53),i.current.setColumnsWidth(150)},100);break;case"Submit":i.current.saveAsJson().then(function(e){var t,a,i,c,o,l=[];console.log("save",e,d);var s=null!==(t=null===e||void 0===e||null===(a=e.jsonObject)||void 0===a||null===(i=a.Workbook)||void 0===i||null===(c=i.sheets)||void 0===c||null===(o=c[0])||void 0===o?void 0:o.rows)&&void 0!==t?t:[],r=h();Object.keys(d.current).map(function(e){var t,n=null===s||void 0===s||null===(t=s[e])||void 0===t?void 0:t.cells,a={};r.map(function(t,i){var c,o,l;if(a[t.label]=null===n||void 0===n||null===(c=n[i])||void 0===c?void 0:c.value,"project"===t.type)a[t.label]=null===(o=d.current)||void 0===o||null===(l=o[e])||void 0===l?void 0:l.project;else if("fixed-asset"===t.type){var s,r;a[t.label]=null===(s=d.current)||void 0===s||null===(r=s[e])||void 0===r?void 0:r.location}else if("responder"===t.type){var u,v;a[t.label]=null===(u=d.current)||void 0===u||null===(v=u[e])||void 0===v?void 0:v.responder}else if("task-picker"===t.type){var b,j;a[t.label]=null===(b=d.current)||void 0===b||null===(j=b[e])||void 0===j?void 0:j.task}else if("date"===t.type){var m,p;a[t.label]=null===(m=d.current)||void 0===m||null===(p=m[e])||void 0===p?void 0:p.date}else if("time"===t.type){var O,f;a[t.label]=null===(O=d.current)||void 0===O||null===(f=O[e])||void 0===f?void 0:f.time}else if("incident-location"===t.type){var h,g;a[t.label]=null===(h=d.current)||void 0===h||null===(g=h[e])||void 0===g?void 0:g.incidentLocation}else if("dispatchType"===t.type){var x,y,I,S,N,k;a.dispatch={value:null===(x=d.current)||void 0===x||null===(y=x[e])||void 0===y?void 0:y.dispatchType,type:"dispatchType",date:null===(I=d.current)||void 0===I||null===(S=I[e])||void 0===S?void 0:S.date,time:null===(N=d.current)||void 0===N||null===(k=N[e])||void 0===k?void 0:k.time}}}),delete a.dispatchDate,delete a.dispatchTime,delete a.dispatchType,l.push(a)}),l.map(function(e){var t=n(e);return console.log("submit",t),t})})}},children:Object(oa.jsx)(ml.b,{children:Object(oa.jsx)(ml.a,{name:"Event form",rowCount:40,colCount:30,showGridLines:!0})})})})})},yd=(Gn.a.Option,function(e){var t=e.onClose,n=e.adminRoles,i=e.onSubmitHandler,c=Object(a.useState)(!0),o=Object(u.a)(c,2),r=o[0],d=o[1],v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=(b[0],b[1]),m=Object(a.useState)(),p=Object(u.a)(m,2),O=p[0],f=(p[1],Object(a.useState)()),h=Object(u.a)(f,2),g=(h[0],h[1],Object(s.c)(function(e){return e.auth})),x=g.projects,y=g.csvToSend,I=(Object(s.c)(function(e){return e.auth}).userBds,Object(a.useState)()),S=Object(u.a)(I,2),N=S[0],k=(S[1],Object(l.g)().search),T=Object(s.b)();return Object(a.useEffect)(function(){j(!1)},[y]),Object(oa.jsx)($n.a,{title:"Bulk creator",visible:r,onOk:function(){var e=new URLSearchParams(k).get("userId"),t={};null===x||void 0===x||x.sections.forEach(function(e){return e.Rows.forEach(function(e){e.Cols.forEach(function(e){"location"===(null===e||void 0===e?void 0:e.type)||null!==e&&void 0!==e&&e.type.includes("location")?(t["".concat(null===e||void 0===e?void 0:e.name,"-lat")]="",t["".concat(null===e||void 0===e?void 0:e.name,"-long")]=""):t[null===e||void 0===e?void 0:e.name]=""})})});var n=new FormData;n.append("file",O),n.append("projectId",JSON.stringify(N)),n.append("dispatcherUserId",JSON.stringify(e)),n.append("isExecute",JSON.stringify(!0)),n.append("adminUser",JSON.stringify({cudbServiceId:null===x||void 0===x?void 0:x.userServiceId})),n.append("basicFieldsName",JSON.stringify({title:"","location-lat":"","location-long":""})),n.append("extendedFieldsName",JSON.stringify(t)),T(Ie({form:n})),j(!0)},onCancel:function(){d(!1),t&&t()},width:"1000px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsx)(xd,{adminRoles:n,onSubmitHandler:i})})});gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");Za.a.Panel;var Id=function(e){var t,n,i=e.socket,c=e.params,o=ei.a.useForm(),r=Object(u.a)(o,1)[0],v=Object(a.useState)(""),b=Object(u.a)(v,2),j=b[0],p=b[1],O=c.screens,h=c.setScreens,g=Object(l.g)().search,x=Object(l.f)(),I=(Object(s.c)(function(e){return e.auth}).messages,Object(s.c)(function(e){return e.auth.projects},function(e,t){return JSON.stringify(e)===JSON.stringify(t)})),S=Object(s.b)(),N=Mn(),k=N.getUserRequestPayload,C=(N.handleMessages,Object(a.useState)()),w=Object(u.a)(C,2),E=w[0],R=(w[1],Object(s.c)(function(e){return e.auth})),P=R.sectionList,D=R.encrypted_token,A=Object(a.useState)(!1),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)([]),F=Object(u.a)(q,2),B=F[0],_=F[1],Y=Object(a.useState)({what:[],account:[],where:[],who:[],when:[],why:[]}),H=Object(u.a)(Y,2),W=H[0],V=H[1],Q=Object(a.useState)(!1),G=Object(u.a)(Q,2),J=G[0],K=G[1],Z=Object(a.useState)(),ee=Object(u.a)(Z,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(),ie=Object(u.a)(ae,2),ce=ie[0],oe=ie[1];Object(a.useEffect)(function(){console.log("encrypted_token",{encrypted_token:D})},[D]),Object(a.useEffect)(function(){var e=new URLSearchParams(g),t=e.get("token");t&&(console.log("token",e.get("token")),S(ct({data:{payload:t},callback:function(e){}})))},[]);var le=function(e,t,n){return new Promise(function(a,i){var c="(exists(@id) && contains(lower(@id),lower('".concat(n,"')))");e&&(c+="|| (exists(@email) && contains(lower(@email),lower('".concat(e,"')))")),t&&(c+="|| (exists(@phone) && contains(lower(@phone),lower('".concat(t,"')))")),console.log("FILTER",c);var o={select:{index:{searchIndex:"".concat("beamdevlive",":custom:id"),searchQuery:"@partitions:{'org\\:".concat(z(null===I||void 0===I?void 0:I.userServiceId),"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",id:"$.info.id",email:"$..info..email",phone:"$..info..phone",objectId:"$.objectId"}},filter:{expression:c}};S(tt({requestData:o,callback:function(e){var t=null===e||void 0===e?void 0:e[0];console.log("customer response",t),a(t)}}))})},se=function(e){return new Promise(function(t,n){var a={select:{index:{searchIndex:"".concat("beamdevlive",":custom:id"),searchQuery:"@partitions:{'org\\:".concat(z(null===I||void 0===I?void 0:I.userServiceId),"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:{info:"$.info",id:"$.info.id",objectId:"$.objectId"}},filter:{expression:"exists(@id) && @id==='".concat(e,"'")}};S(tt({requestData:a,callback:function(e){var n=null===e||void 0===e?void 0:e[0];console.log("customer response",n),t(n)}}))})},re=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,c,o,l,s,r,u,v,b,j,O,f,h,x,y,S,N,k;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(K(!1),u=new URLSearchParams(g),v=(null===D||void 0===D?void 0:D.connectionId)||u.get("connectionId"),b=(null===D||void 0===D?void 0:D.customerId)||u.get("customerId"),console.log("values",t),t[void 0]&&delete(t=Object(d.a)(Object(d.a)({},t[void 0]),t))[void 0],j={},Object.keys(t).map(function(e){var n=X(e,e,t[e],B,W);Array.isArray(n)?null===n||void 0===n||n.map(function(e){$.a.merge(j,e)}):$.a.merge(j,n)}),O={id:"",type:"customer",customer:{}},null!==te&&void 0!==te&&null!==(n=te.value)&&void 0!==n&&n.id&&""!==(null===te||void 0===te||null===(a=te.value)||void 0===a?void 0:a.id)||b){e.n=1;break}return p("**Required customer id"),e.a(2);case 1:return p(void 0),U(!0),e.n=2,se(null===te||void 0===te||null===(c=te.value)||void 0===c?void 0:c.id);case 2:if(f=e.v,!(b&&f&&b!==(null===f||void 0===f||null===(o=f.objectId)||void 0===o?void 0:o.toString())||!b&&f)){e.n=3;break}return p("**customer id must unique"),U(!1),e.a(2);case 3:if(console.log("exist",f),null===j||void 0===j||delete j[(null===te||void 0===te||null===(l=te.itemName)||void 0===l?void 0:l[0])||(null===te||void 0===te||null===(s=te.itemName)||void 0===s?void 0:s[1])],O.id=null===te||void 0===te||null===(r=te.value)||void 0===r?void 0:r.id,O.customer=Object(d.a)({},j),!b){e.n=4;break}i.publishToEvent(m.PublishPageTopics,zt(v),Dn({objectId:b,changes:[{op:"replace",path:"/info",value:O}]})),e.n=7;break;case 4:return console.log("EMAIL",null===(h=t)||void 0===h?void 0:h.email),e.n=5,le(null===(x=t)||void 0===x?void 0:x.email,null===(y=t)||void 0===y?void 0:y.phone,null===(S=t)||void 0===S||null===(N=S.customerId)||void 0===N?void 0:N.id);case 5:if(k=e.v,console.log("EXIST",k),!k){e.n=6;break}return Lt("customer already exists with this email, phone or id","error","TOP_CENTER",3e3),U(!1),e.a(2);case 6:i.publishToEvent(m.PublishPageTopics,Vt(v),Dn({changes:[{op:"add",path:"/partitions",value:["org:".concat(null===I||void 0===I?void 0:I.userServiceId)]},{op:"add",path:"/info",value:O},{op:"add",path:"/createdBy",value:D?"customer":"admin"}]}));case 7:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){null!==I&&void 0!==I&&I.adminUserId&&(i.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,k(null===I||void 0===I?void 0:I.adminUserId,"$","/persistent/static/admin/customer"),f.GetSectionList,null===I||void 0===I?void 0:I.userServiceId),i.subscribeToSurvey(m.SurveyTopics,f.GetSectionList,function(){}))},[I]),Object(a.useEffect)(function(){if(P){console.log("section list",P);var e=P.filter(function(e){return void 0===e.conditional||!1===e.conditional})||[];_(e);var t=Object(d.a)({},W);null===P||void 0===P||P.map(function(e){t.account=null===e||void 0===e?void 0:e.Rows}),console.log("te",t),V(t)}},[P]),Object(a.useEffect)(function(){if(W){var e=new URLSearchParams(g),t=(null===D||void 0===D?void 0:D.connectionId)||e.get("connectionId"),n=(null===D||void 0===D?void 0:D.customerId)||e.get("customerId");n&&i.publishToEvent(m.PublishPageTopics,function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/searchInCustom")}(t),Dn({objectId:n,paths:["$"],returnPaths:["$..info"]}))}},[W]),Object(a.useEffect)(function(){if(ce){var e=Object(d.a)({},null===ce||void 0===ce?void 0:ce.customer);null===W||void 0===W||W.account.forEach(function(t){t.Cols.forEach(function(t){if("location"===(null===t||void 0===t?void 0:t.type)||"incident-location"===(null===t||void 0===t?void 0:t.type)){var n,a,i,c,o;console.log("col loca",t);var l=null!==e&&void 0!==e&&e[t.name]?{type:"location",label:null===e||void 0===e||null===(n=e[t.name])||void 0===n||null===(a=n.attributes)||void 0===a?void 0:a.address,value:{description:null===e||void 0===e||null===(i=e[t.name])||void 0===i||null===(c=i.attributes)||void 0===c?void 0:c.address,place_id:"",coordinates:null===e||void 0===e||null===(o=e[t.name])||void 0===o?void 0:o.coordinates}}:void 0;e[t.name]=l}"customer-search"===(null===t||void 0===t?void 0:t.type)&&(e[t.name]=null===ce||void 0===ce?void 0:ce.id,ne({itemName:[t.name],value:null===ce||void 0===ce?void 0:ce.id}))})}),r.setFieldsValue({undefined:e})}},ce),Object(a.useEffect)(function(){if(i.client){var e=new URLSearchParams(g),t=(null===D||void 0===D?void 0:D.userId)||e.get("userId"),n=(null===D||void 0===D?void 0:D.connectionId)||e.get("connectionId");i.subscribeToEvent(m.SubscribePageTopics,qt(n)),i.subscribeToEvent(m.SubscribePageTopics,$t(n)),i.subscribeToEvent(m.SubscribePageTopics,vn(n)),i.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/createCustom/reply")}(n),function(e){console.log("customer submitted successfully",e),U(!1),Lt("Customer saved successfully","success","TOP_CENTER",1e3),localStorage.removeItem("form"),localStorage.removeItem("active"),setTimeout(function(){r.resetFields()},500),h(Object(d.a)(Object(d.a)({},O),{},{map:!1}));var t=new URLSearchParams(g);t.delete("customerId"),x.replace({search:t.toString()}),S({type:De,payload:!1})}),i.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/updateCustom/reply")}(n),function(e){console.log("customer updated successfully",e),U(!1),Lt("Customer updated successfully","success","TOP_CENTER",1e3)}),i.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat(Ut,"/connection/").concat(e,"/service/custom-bds/searchInCustom/reply")}(n),function(e){var t,n,a;console.log("response here",e,W);var i=null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n||null===(a=n[0])||void 0===a?void 0:a[0];oe(i)}),i.publishToEvent(m.PublishPageTopics,Ft(n),Dn({userId:t}))}},[g,i.client]);var de=function(e){S({type:Pe,payload:e});var t=r.getFieldsValue();Object.keys(t[void 0]||{}).map(function(e){var n,a;"task-picker"===(null===(n=t[void 0])||void 0===n||null===(a=n[e])||void 0===a?void 0:a.type)&&r.setFieldsValue({undefined:Object(d.a)(Object(d.a)({},t[void 0]),{},Object(T.a)({},e,void 0))})})},ue=function(e){S({type:Ae,payload:e}),r.setFieldsValue({incidentType:void 0}),S({type:Pe,payload:void 0})};return Object(oa.jsxs)("div",{className:"main-column ride-dispatch-panel mobile-responsive mr-4",children:[J&&Object(oa.jsx)(yd,{onClose:function(){K(!1)},adminRoles:E,onSubmitHandler:re}),Object(oa.jsx)("div",{className:"main-content",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",initialValues:{},id:"register-form",layout:"vertical",form:r,onFinish:re,requiredMark:!1,onValuesChange:function(e,t){localStorage.setItem("form",JSON.stringify(t))},children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h3",{className:"ml-3",children:"Customer"})}),Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)(fa.a,{src:"/images/map.svg",className:"close-icon mr-3",onClick:function(){h(Object(d.a)(Object(d.a)({},O),{},{map:!0,form:window.innerWidth>=700}))}})})]}),Object(oa.jsx)("div",{className:"main-cards",children:(null===W||void 0===W||null===(t=W.account)||void 0===t?void 0:t.length)>0&&Object(oa.jsx)("div",{className:"",children:null===W||void 0===W||null===(n=W.account)||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3",children:null===e||void 0===e?void 0:e.Cols.map(function(t,n){return Object(oa.jsx)(Hn.a,{span:t.ColSize,className:n!==(null===e||void 0===e?void 0:e.Cols.length)-1&&"pr-2",xs:24,sm:t.ColSize,children:Object(oa.jsx)(dc,{data:t,projects:I,addOtherLocation:ue,onProjectChange:de,onCustomerSearch:function(e){console.log("customer",e),ne(e)},adminRoles:E})},n)})},t)})})}),j&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:j})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:12,xs:24,sm:12,className:"px-2",onClick:function(){setTimeout(function(){localStorage.removeItem("form"),localStorage.removeItem("form"),S({type:De,payload:!1}),r.resetFields(),h(Object(d.a)(Object(d.a)({},O),{},{map:!1}));var e=new URLSearchParams(g);e.delete("customerId"),x.replace({search:e.toString()})})},children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn cover w-full",children:"Clear"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",xs:24,sm:12,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:L,children:"Submit"})})})]})]})})]})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var Sd,Nd=function(e){var t=e.socket,n=(Object(l.f)(),Object(s.b)(),Object(a.useState)(void 0)),i=Object(u.a)(n,2),c=(i[0],i[1],Object(a.useState)(!1)),o=Object(u.a)(c,2),r=(o[0],o[1],Object(a.useState)(!1)),d=Object(u.a)(r,2),v=(d[0],d[1],Object(a.useState)({form:!0,map:!1})),b=Object(u.a)(v,2),j=b[0],m={screens:j,setScreens:b[1]};return Object(oa.jsxs)(Yn.a,{className:"main-layout",children:[j.form&&Object(oa.jsx)(Hn.a,{md:j.map?12:24,xs:24,className:"form"===j.active?"active-screen":"",children:j.form&&Object(oa.jsx)(Id,{socket:t,params:m})}),j.map&&Object(oa.jsx)(Hn.a,{md:12,xs:24,className:"map"===j.active?"active-screen":"",children:Object(oa.jsx)(Nc,{socket:t,params:m})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})},kd=n(554),Td=n(555),Cd=function(e){var t,n,a,i,c,o,l,s=e.avatar,r=e.onClick,d=e.userObj;return Object(oa.jsxs)(Yn.a,{className:"person-item d-flex",children:[Object(oa.jsx)(Hn.a,{onClick:r,children:Object(oa.jsx)("img",{width:"40",style:{cursor:"pointer"},src:s})}),Object(oa.jsxs)(Hn.a,{span:14,children:[Object(oa.jsxs)("h5",{children:[null===d||void 0===d?void 0:d.firstName," ",d.lastName]}),Object(oa.jsxs)("p",{children:["Email: ",null!==(t=null===d||void 0===d?void 0:d.email)&&void 0!==t?t:"N/A"]}),Object(oa.jsxs)("p",{children:["Phone: ",null!==(n=null===d||void 0===d?void 0:d.phone)&&void 0!==n?n:"N/A"]})]}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==(a=null===d||void 0===d||null===(i=d.nonpersistent)||void 0===i||null===(c=i.static)||void 0===c||null===(o=c.live)||void 0===o||null===(l=o.status)||void 0===l?void 0:l.name)&&void 0!==a?a:"gray","-icon")})})})]})},wd=function(e){var t,n,a,i=e.type,c=e.title,o=e.locationObj,l=e.address;return Object(oa.jsxs)(Yn.a,{className:"location-item d-flex",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn inbound icon-btn",children:Object(oa.jsx)(fa.a,{src:"/images/geolocation-icon.svg",className:"".concat(i,"-icon")})})}),Object(oa.jsxs)(Hn.a,{span:20,children:[Object(oa.jsxs)("h5",{children:[c," - ",l||(null===o||void 0===o||null===(t=o.attributes)||void 0===t?void 0:t.address)]}),Object(oa.jsxs)("p",{children:["Lat: ",null===o||void 0===o||null===(n=o.coordinates)||void 0===n?void 0:n.lat,", Long:"," ",null===o||void 0===o||null===(a=o.coordinates)||void 0===a?void 0:a.long]})]})]})},Ed=n(533),Rd=n.n(Ed),Pd=Wn.a.TextArea,Dd=720,Ad=[1,2,5,7,10,15,20,30,50,100],Md=function(e){var t,n,c,o,r,d,v,b,j,p,O,f,h,g,x=e.socket,y=(e.params,Object(l.g)().search),I=Object(s.c)(function(e){return e.auth}),S=I.page,N=I.users,k=I.messages,T=I.requestIds,w=Object(a.useState)([]),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useState)(),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Object(s.b)(),q=Object(a.useState)([]),F=Object(u.a)(q,2),B=F[0],_=F[1],Y=Object(a.useState)({offset:0,limit:Dd,length:0}),V=Object(u.a)(Y,2),G=V[0],J=V[1],K=Object(a.useState)(20),Z=Object(u.a)(K,2),X=Z[0],ee=Z[1],te=Object(a.useState)(!1),ne=Object(u.a)(te,2),ae=ne[0],ie=ne[1],ce=Object(a.useState)(2),oe=Object(u.a)(ce,2),le=oe[0],se=oe[1],re=Object(a.useRef)(null),de=Mn().handleMessages,ue=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=null===k||void 0===k||null===(t=k[0])||void 0===t?void 0:t.createdAt;return H()(a+60*e*1e3).format("".concat(n?"MMM D ":"","hh:mm A"))};Object(a.useEffect)(function(){if(U({type:Qe}),x.client){var e=new URLSearchParams(y),t=e.get("connectionId"),n=e.get("pageId"),a=e.get("cudbServiceId");x.subscribeToEvent(m.SubscribePageTopics,an(t)),x.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat(Ut,"/service/live/page/").concat(e,"/bdsEot/#")}(n)),x.subscribeToEvent(m.SubscribePageTopics,bn(t,a)),x.subscribeToEvent(m.SubscribePageTopics,jn(n,t)),n&&(x.publishToEvent(m.PublishPageTopics,cn(t),Dn({objectId:n,paths:["$"],returnPaths:["$"]},n)),x.subscribeToEvent(m.SubscribePageTopics,mn(n)),function(e){var t=W();localStorage.setItem("requestId",t),localStorage.setItem("requestService","summary");var n={select:{index:{searchIndex:"".concat("beamdevlive",":message:createdAt"),searchQuery:"@pageId:{".concat(e.toString(),"}"),searchOptions:"TIMEOUT 100"},load:{object:"$"}},operations:[{sortBy:{properties:[{field:"@createdAt",order:"DESC"}]}}],result:{pagination:{offset:0,limit:100}},sortBy:{properties:[{field:"@createdAt",order:"DESC"}],max:1e4}};U(tt({requestData:n,callback:function(e){console.log("message response",e),de(t,e)}}))}(n))}},[y,x.client]);Object(a.useEffect)(function(){if(S){var e,t,n,a,i,c,o,l,s,r,d,u,v,b=new URLSearchParams(y),j=b.get("connectionId");if(b.get("pageId")!==S.objectId)return;var p=[],O=null===S||void 0===S||null===(e=S.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.profile;"cad"===O.type?Object.keys(O).map(function(e){var t,n;"string"===typeof O[e]?p.push({name:Q(e),value:O[e]}):"location"!==(null===(t=O[e])||void 0===t?void 0:t.type)&&"incident-location"!==(null===(n=O[e])||void 0===n?void 0:n.type)||L({name:Q(e),value:O[e]})}):p=[{name:"Incident Type",value:"Hail ride"},{name:"First Name",value:"N/A"},{name:"Last Name",value:"N/A"},{name:"Phone",value:"N/A"},{name:"Alternative Phone",value:"N/A"}],p=[].concat(Object(C.a)(p),[{name:"Dispatch Time",value:be(null===S||void 0===S||null===(n=S.persistent)||void 0===n||null===(a=n.static)||void 0===a||null===(i=a.metadata)||void 0===i?void 0:i.createdAt)},{name:"Start Time",value:be(null===S||void 0===S||null===(c=S.persistent)||void 0===c||null===(o=c.static)||void 0===o||null===(l=o.metadata)||void 0===l?void 0:l.createdAt)},{name:"Stop Time",value:"N/A"}]),P(p);var f=null!==(s=null===S||void 0===S||null===(r=S.persistent)||void 0===r||null===(d=r.static)||void 0===d||null===(u=d.metadata)||void 0===u||null===(v=u.members)||void 0===v?void 0:v.users)&&void 0!==s?s:{};x.subscribeToEvent(m.SubscribePageTopics,yn(j)),function(e){var t=new URLSearchParams(y),n=t.get("cudbServiceId"),a=t.get("connectionId"),i={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(n),"'}"),searchOptions:"TIMEOUT 5000"},list:{objectIds:e},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live"}},apply:{expression:"",name:""},result:{},filter:{expression:""},anyStatus:!1};x.publishToEvent(m.PublishPageTopics,xn(a),Dn(i,T.user))}(Object.keys(f))}},[S]),Object(a.useEffect)(function(){if(N&&x.client){var e=new URLSearchParams(y).get("cudbServiceId");N.map(function(t){x.subscribeToEvent(m.SubscribePageTopics,function(e,t){return"".concat("beamdevlive","/service/").concat(e,"/user/").concat(t,"/bdsEot/#")}(e,t.id))})}},[N,x.client]);var ve=function(e){switch(e.messageType){case"place":return{icon:"Place-icon",color:"purple"};case"video-call":case"sound-recording":return{icon:"Audio-icon",color:"green"};case"b2t-call":return{icon:"B2T-icon",color:"green"};case"beam-assist":return{icon:"Incident-icon",color:"orange"};case"capture":return{icon:"Capture-icon",color:"gray"};case"alert":return{icon:"Alert-icon",color:"yellow"};case"gps":case"gps-stop":return{icon:"iot_blue",color:"purple"};case"gps-report":return{icon:"IoT File-icon",color:"green"};case"media":return{icon:"Image-icon",color:"blue"};case"rsvp":case"rsvp-response":return{icon:"RSVP-icon",color:"yellow"};case"video-recording":return{icon:"Video-icon",color:"blue"};case"event":return{icon:"Event-icon",color:"orange"}}},be=function(e){var t=new Date(e);return t?"".concat(t.toLocaleDateString()," ").concat(t.toLocaleTimeString()):"N/A"};return Object(a.useEffect)(function(){if(k&&k.length>0){var e,t,n=null===k||void 0===k||null===(e=k[0])||void 0===e?void 0:e.createdAt,a=null===k||void 0===k||null===(t=k[k.length-1])||void 0===t?void 0:t.createdAt,i=[];k.map(function(e){var t=ve(e);i.push({time:Math.floor((e.createdAt-n)/1e3/60),name:null===t||void 0===t?void 0:t.icon,icon:null===t||void 0===t?void 0:t.color,type:e.messageType.toUpperCase(),id:e.id})});var c=(a-n)/1e3/60;_(i),0===G.offset?J({offset:0,limit:720,length:c}):J({offset:G.offset,limit:G.limit,length:c})}},[k]),Object(a.useEffect)(function(){ae?(Sd&&clearInterval(Sd),Sd=setInterval(function(e){re.current.scrollLeft<re.current.scrollWidth-re.current.clientWidth&&(re.current.scrollLeft+=Ad[e])},10,le)):Sd&&clearInterval(Sd)},[ae,le]),Object(oa.jsx)($n.a,{title:"",visible:!0,width:"100%",className:"beam-modal analytics-summary-modal",footer:[],destroyOnClose:!0,children:S&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsxs)(Hn.a,{span:12,className:"pr-3",children:[Object(oa.jsxs)(Yn.a,{className:"d-flex",children:[Object(oa.jsxs)(Hn.a,{children:[Object(oa.jsx)("h3",{className:"mb-1",children:null===S||void 0===S||null===(t=S.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(c=n.metadata)||void 0===c?void 0:c.title}),Object(oa.jsx)("h4",{children:"Incidents information"})]}),Object(oa.jsxs)(Hn.a,{children:[Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==(o=null===S||void 0===S||null===(r=S.nonpersistent)||void 0===r||null===(d=r.static)||void 0===d||null===(v=d.live)||void 0===v||null===(b=v.status)||void 0===b?void 0:b.name)&&void 0!==o?o:"gray","-icon")})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/iot-icon.svg"})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){Rd()(document.getElementsByClassName("ant-modal-content")[0],{jsPDF:{format:"a4"},html2canvas:{scrollX:0,scrollY:-window.scrollY},imageType:"image/jpeg",output:"./pdf/generate.pdf"})},children:Object(oa.jsx)(fa.a,{src:"/images/export-pdf.svg",className:"export-svg"})})]})]}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("ul",{className:"incident-information mt-2",children:R.map(function(e,t){return Object(oa.jsx)("li",{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.name})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.value})})]})},t)})})})})]}),Object(oa.jsxs)(Hn.a,{span:12,className:"pl-3 mt-3",children:[Object(oa.jsx)("h4",{className:"mt-3",children:"Locations"}),Object(oa.jsx)(Yn.a,{className:"locations mt-2",children:Object(oa.jsxs)(Hn.a,{span:24,children:["cad"===(null===S||void 0===S||null===(j=S.persistent)||void 0===j||null===(p=j.static)||void 0===p?void 0:p.profile.type)&&M&&Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(wd,{type:"green",title:M.name,locationObj:M.value})}),"cad"!==(null===S||void 0===S||null===(O=S.persistent)||void 0===O||null===(f=O.static)||void 0===f?void 0:f.profile.type)&&Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(wd,{type:"green",title:"Incident location",locationObj:null===S||void 0===S||null===(h=S.persistent)||void 0===h||null===(g=h.static)||void 0===g?void 0:g.live.location})})]})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Pd,{autoSize:{minRows:3,maxRows:3},placeholder:"Protocals"})})}),Object(oa.jsxs)(Yn.a,{className:"d-flex px-3",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("p",{children:"Optional"})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("p",{children:"max. 500 character"})})]}),Object(oa.jsxs)(Yn.a,{className:"d-flex mt-3",children:[Object(oa.jsx)(Hn.a,{span:8,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full",children:"Survey"})}),Object(oa.jsx)(Hn.a,{span:8,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full",children:"NCIC"})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full",children:"NFIRS"})})]}),Object(oa.jsx)(Yn.a,{className:"d-flex mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full green-btn cover",children:"End Event"})})})]})]}),Object(oa.jsx)(Yn.a,{className:"mb-3",children:Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("h4",{className:"mt-3",children:"People On Page"})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:N.map(function(e,t){return Object(oa.jsx)(Hn.a,{span:12,className:t%2===0?"pr-3":"",children:Object(oa.jsx)(Cd,{onClick:function(){},avatar:"/images/users/user.png",userObj:e})})})}),Object(oa.jsxs)("div",{className:"mt-4 timeline-zoom-options",children:[!ae&&Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn mr-2",onClick:function(){ie(!0)},children:Object(oa.jsx)(Xl.a,{})}),ae&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn mr-2",onClick:function(){ie(!1)},children:Object(oa.jsx)(es.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn mr-2",onClick:function(){le>0&&se(le-1)},children:Object(oa.jsx)(ia.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn mr-2",onClick:function(){le<Ad.length-1&&se(le+1)},children:Object(oa.jsx)(ca.a,{})})]}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn mr-2",onClick:function(){var e=re.current.scrollWidth;ee(X+20),setTimeout(function(){var t=(re.current.scrollWidth-e)/e+1;re.current.scrollLeft=re.current.scrollLeft*t+20},100)},children:Object(oa.jsx)(kd.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){X>20&&ee(X-20)},children:Object(oa.jsx)(Td.a,{})})]}),Object(oa.jsx)(Yn.a,{className:"timeline mt-2",ref:re,style:{overflow:"scroll"},onScroll:function(e){e.target.scrollLeft===e.target.scrollWidth-e.target.clientWidth?G.length>G.limit?(J({offset:G.offset+Dd,limit:G.limit+Dd,length:G.length}),e.target.scrollLeft=5):ie(!1):0===e.target.scrollLeft&&0!==G.offset&&(J({offset:G.offset-Dd,limit:G.limit-Dd,length:G.length}),e.target.scrollLeft=e.target.scrollWidth-e.target.clientWidth-5)},children:Object(oa.jsx)("div",{style:{position:"relative"},children:Object(oa.jsx)("div",{className:"main-bar",children:$.a.range(G.offset,G.limit).map(function(e){var t,n=null,a=null,c=function(e){var t=B.filter(function(t){return t.time===e});return t.length>0?t:null}(e-1);return(e-1)%5===0&&(n=Object(oa.jsx)("h6",{children:ue(e-1,!0)})),c&&c.length>0&&(a=Object(oa.jsx)(i.a.Fragment,{children:c.map(function(e,t){return Object(oa.jsxs)("div",{className:"break-point",style:{paddingLeft:10*t},children:[Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){var t=new URLSearchParams(y).get("connectionId");x.publishToEvent(m.PublishPageTopics,pn(null===S||void 0===S?void 0:S.objectId,t),{messageId:e.id})},children:Object(oa.jsx)("img",{src:"/images/".concat(e.name,".png"),alt:""})}),1===c.length&&Object(oa.jsx)("h5",{className:"mt-2",children:e.type}),t==Math.floor(c.length/2)&&Object(oa.jsx)("p",{className:"mt-1",children:ue(t-1)})]})})})),null!=n||null!=a?Object(oa.jsxs)("div",{className:"time-point mark-time ".concat(a?(null===c||void 0===c||null===(t=c[c.length-1])||void 0===t?void 0:t.icon)+"-icon break":""),style:{width:X},children:[n,a]},e):Object(oa.jsx)("div",{className:"time-point",style:{width:X}},e)})})})}),Object(oa.jsx)(Yn.a,{className:"custom-table mt-4",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsxs)(Yn.a,{className:"header",children:[Object(oa.jsx)(Hn.a,{span:5,children:"Event"}),Object(oa.jsx)(Hn.a,{span:4,children:"Flag"}),Object(oa.jsx)(Hn.a,{span:4,children:"User"}),Object(oa.jsx)(Hn.a,{span:4,children:"Time"}),Object(oa.jsx)(Hn.a,{span:4,children:"Status"}),Object(oa.jsx)(Hn.a,{span:3,children:"Location"})]}),k&&k.map(function(e,t){var n,a,i,c,o,l,s,r,d,u,v;return Object(oa.jsxs)(Yn.a,{className:"table-row d-flex",children:[Object(oa.jsxs)(Hn.a,{span:5,className:"event-column",children:[Object(oa.jsx)("div",{style:{cursor:"pointer"},onClick:function(){var t=new URLSearchParams(y).get("connectionId");x.publishToEvent(m.PublishPageTopics,pn(null===S||void 0===S?void 0:S.objectId,t),{messageId:e.id})},children:Object(oa.jsx)("img",{src:"/images/".concat(null!==(n=null===(a=ve(e))||void 0===a?void 0:a.icon)&&void 0!==n?n:"text-icon",".png"),alt:""})}),Object(oa.jsx)("span",{children:e.messageType.toUpperCase()})]}),Object(oa.jsx)(Hn.a,{span:4,children:(null===e||void 0===e||null===(i=e.status)||void 0===i?void 0:i.onMoveEvent)&&Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==(c=null===e||void 0===e||null===(o=e.status)||void 0===o?void 0:o.color)&&void 0!==c?c:"gray","-icon")})}),Object(oa.jsx)(Hn.a,{span:4,children:null!==(l=null===(s=N.find(function(t){return t.id===e.senderId}))||void 0===s?void 0:s.fullName)&&void 0!==l?l:"user # ".concat(e.senderId)}),Object(oa.jsx)(Hn.a,{span:4,children:be(e.createdAt)}),Object(oa.jsx)(Hn.a,{span:4,children:e.status&&Object(oa.jsx)("label",{className:"".concat((null===e||void 0===e||null===(r=e.status)||void 0===r?void 0:r.color)||"gray","-icon"),children:e.status.name})}),Object(oa.jsx)(Hn.a,{span:3,children:((null===e||void 0===e||null===(d=e.data)||void 0===d?void 0:d.coordinates)||(null===e||void 0===e||null===(u=e.data)||void 0===u||null===(v=u.location)||void 0===v?void 0:v.coordinates))&&Object(oa.jsx)("button",{type:"button",className:"ant-btn beam-btn icon-btn",onClick:function(){var t,n,a,i,c,o,l,s,r,d;window.open("https://maps.google.com/?q="+((null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.lat)||(null===e||void 0===e||null===(a=e.data)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat))+","+((null===e||void 0===e||null===(o=e.data)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l.long)||(null===e||void 0===e||null===(s=e.data)||void 0===s||null===(r=s.location)||void 0===r||null===(d=r.coordinates)||void 0===d?void 0:d.long)))},children:Object(oa.jsx)("img",{src:"/images/location.png",alt:""})})})]})})]})})]})})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var Ld=n(974),Ud={imperial:"miles",metric:"km"},qd=function(e){var t,n,c,o,r,v,b,j,p,O,f,h,g,x,y,I,S,N,k,T,w,E,R,P,D,A,M,L,U,q=e.socket,F=(e.params,Object(l.g)().search),B=Object(s.c)(function(e){return e.auth}),_=B.page,$=B.messages,Y=B.gps,H=Object(a.useState)([]),V=Object(u.a)(H,2),z=V[0],G=V[1],J=Object(a.useState)([]),K=Object(u.a)(J,2),Z=K[0],X=K[1],ee=Object(a.useState)([]),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ie=Object(a.useState)({arr:[]}),ce=Object(u.a)(ie,2),oe=ce[0],le=ce[1],se=Object(s.b)(),re=Object(a.useState)(),de=Object(u.a)(re,2),ue=de[0],ve=de[1],be=Object(a.useState)(""),je=Object(u.a)(be,2),me=je[0],pe=je[1],Oe=Object(a.useState)(""),fe=Object(u.a)(Oe,2),he=fe[0],ge=fe[1],xe=Mn().handleMessages,ye=function(e,t){gc.a.fromLatLng(e.lat,e.long).then(function(e){t(e.results[0].formatted_address)},function(e){console.error(e)})};Object(a.useEffect)(function(){if(se({type:Qe}),q.client){var e=new URLSearchParams(F),t=e.get("connectionId")||"0",n=e.get("pageId");q.subscribeToEvent(m.SubscribePageTopics,an(t)),n&&(q.publishToEvent(m.PublishPageTopics,cn(t),Dn({objectId:n,paths:["$"],returnPaths:["$"]},n)),q.subscribeToEvent(m.SubscribePageTopics,"".concat("beamdevlive","/service/live/service/liveStorage/searchMessage/reply")))}},[F,q.client]),Object(a.useEffect)(function(){if($&&$.length>0){var e,t,n,a={filter:"ecosystem=".concat("beamdevlive"," iotUdid=").concat(null===$||void 0===$||null===(e=$[0].data)||void 0===e?void 0:e.iotUdid," userId=").concat(null===$||void 0===$?void 0:$[0].senderId," iotUserId=").concat(null===$||void 0===$?void 0:$[0].data.iotUserId," page=true"),fromTimestamp:new Date(null===$||void 0===$||null===(t=$[0].data)||void 0===t?void 0:t.startIotAt).getTime(),toTimestamp:new Date(null===$||void 0===$||null===(n=$[0].data)||void 0===n?void 0:n.endIotAt).getTime(),options:{withLabels:!0}};se({type:"GET_HISTORICAL_GPS",payload:{requestData:a}})}},[$]),Object(a.useEffect)(function(){if(Y){var e,t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h,g,x,y,I,S=[];null===Y||void 0===Y||null===(e=Y.points)||void 0===e||e.map(function(e){var t,n,a,i;S.push([null===e||void 0===e||null===(t=e.dataset)||void 0===t||null===(n=t.locationGps)||void 0===n?void 0:n.lat,null===e||void 0===e||null===(a=e.dataset)||void 0===a||null===(i=a.locationGps)||void 0===i?void 0:i.long])});var N=Ld.encode(S),k=(null===_||void 0===_||null===(t=_.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.profile)||void 0===a||null===(i=a.pickupLocation)||void 0===i?void 0:i.coordinates)||(null===_||void 0===_||null===(c=_.persistent)||void 0===c||null===(o=c.static)||void 0===o||null===(l=o.dashboard)||void 0===l||null===(s=l.pickupLocation)||void 0===s?void 0:s.coordinates)||(null===_||void 0===_||null===(r=_.persistent)||void 0===r||null===(d=r.static)||void 0===d||null===(u=d.live)||void 0===u||null===(v=u.location)||void 0===v?void 0:v.coordinates);console.log("origin",k);var T=(null===_||void 0===_||null===(b=_.persistent)||void 0===b||null===(j=b.static)||void 0===j||null===(m=j.profile)||void 0===m||null===(p=m.tripDetails)||void 0===p||null===(O=p.end)||void 0===O?void 0:O.location)||(null===_||void 0===_||null===(f=_.persistent)||void 0===f||null===(h=f.static)||void 0===h||null===(g=h.meter)||void 0===g||null===(x=g.tripDetails)||void 0===x||null===(y=x.end)||void 0===y||null===(I=y.location)||void 0===I?void 0:I.coordinates),C=k.lat+","+k.long,w=T.lat+","+T.long,E=[];E.push("markers=color:green|"+C),E.push("markers=color:blue|"+w),E=E.join("&"),ve("https://maps.googleapis.com/maps/api/staticmap?size=1000x1000&maptype=roadmap&path=enc:"+encodeURIComponent(N)+"&"+E+"&key=AIzaSyBPbm_leF-HO_IYt7_gp9noPOCem14bEtY")}},[Y]);var Ie=function(e,t,n){switch(e){case"movingDistance":return n;case"unit":return"";case"waitTime":return"hh:mm:ss";default:return t}};Object(a.useEffect)(function(){if(_){var e,t,n,a,i,c,o,l,s,r,u,v,b,j,m,p,O,f,h,g,x,y,I,S,N,k,T,w,E,R,P,D,A,M,L,U,q,B,$,Y,H,V,z,J,K,Z,ee,te,ne,ie,ce,oe,re,de,ue,ve,be,je,me,Oe,fe,he,Ne,ke,Te,Ce,we,Ee,Re,Pe,De;console.log("page",_);var Ae=new URLSearchParams(F).get("pageId");if(Ae!==_.objectId)return;!function(e){new URLSearchParams(F).get("connectionId");var t=W();localStorage.setItem("requestId",t),localStorage.setItem("requestService","summary");var n={select:{index:{searchIndex:"".concat("beamdevlive",":message:createdAt"),searchQuery:"@pageId:{".concat(e.toString(),"}@type:{'gps\\-report'}"),searchOptions:"TIMEOUT 100"},load:{object:"$"}},operations:[{sortBy:{properties:[{field:"@createdAt",order:"DESC"}]}}],result:{pagination:{offset:0,limit:1}},sortBy:{properties:[{field:"@createdAt",order:"DESC"}],max:1e4}};se(tt({requestData:n,callback:function(e){console.log("message response",e),xe(t,e)}}))}(Ae);var Me=[],Le=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===_||void 0===_||null===(e=_.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.profile)||{}),(null===_||void 0===_||null===(n=_.persistent)||void 0===n||null===(a=n.static)||void 0===a?void 0:a.ride)||{}),(null===_||void 0===_||null===(i=_.persistent)||void 0===i||null===(c=i.dynamic)||void 0===c?void 0:c.ride)||{}),(null===_||void 0===_||null===(o=_.persistent)||void 0===o||null===(l=o.static)||void 0===l?void 0:l.dashboard)||{}),(null===_||void 0===_||null===(s=_.persistent)||void 0===s||null===(r=s.static)||void 0===r?void 0:r.meter)||{}),Ue=Le.type;delete Le.summary,delete Le.type,Me="cad"===Ue?[{name:"Ride ID ",value:Ae},{name:"Ride Type",value:"CAD"}]:[{name:"Ride ID ",value:Ae},{name:"Ride Type",value:"Hail ride"},{name:"First Name",value:"N/A"},{name:"Last Name",value:"N/A"},{name:"Phone",value:"N/A"},{name:"Alternative Phone",value:"N/A"}],Object.keys(Le).map(function(e){"string"===typeof Le[e]&&Me.push({name:Q(e),value:Le[e]})}),Me=[].concat(Object(C.a)(Me),[{name:"Start Time",value:Se(null===_||void 0===_||null===(u=_.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.metadata)||void 0===b?void 0:b.createdAt)},{name:"Stop Time",value:Se((null===_||void 0===_||null===(j=_.persistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.profile)||void 0===p||null===(O=p.tripDetails)||void 0===O||null===(f=O.end)||void 0===f?void 0:f.time)||(null===_||void 0===_||null===(h=_.persistent)||void 0===h||null===(g=h.static)||void 0===g||null===(x=g.meter)||void 0===x||null===(y=x.tripDetails)||void 0===y||null===(I=y.end)||void 0===I?void 0:I.time))}]),G(Me);var qe=[],Fe=[],Be={logo:void 0,arr:[],comment:""},_e=(null===_||void 0===_||null===(S=_.persistent)||void 0===S||null===(N=S.static)||void 0===N||null===(k=N.profile)||void 0===k?void 0:k.tripDetails)||(null===_||void 0===_||null===(T=_.persistent)||void 0===T||null===(w=T.static)||void 0===w||null===(E=w.meter)||void 0===E?void 0:E.tripDetails)||{},$e=(null===_||void 0===_||null===(R=_.persistent)||void 0===R||null===(P=R.static)||void 0===P||null===(D=P.profile)||void 0===D?void 0:D.meterDetails)||(null===_||void 0===_||null===(A=_.persistent)||void 0===A||null===(M=A.static)||void 0===M||null===(L=M.meter)||void 0===L?void 0:L.meterDetails)||{},Ye=$e.currency;if(delete $e.waitIndex,delete $e.movingIndex,delete $e.currency,$e.waitTime){var He=new Date(1e3*$e.waitTime).toISOString().slice(11,19);$e.waitTime="".concat(He)}$e.tip&&($e.tip=Math.round($e.tip)),$e.movingDistance="".concat($e.movingDistance.toFixed(1)),$e.amount="".concat($e.amount);var We=(null===_||void 0===_||null===(U=_.persistent)||void 0===U||null===(q=U.static)||void 0===q||null===(B=q.profile)||void 0===B?void 0:B.fleetDetails)||(null===_||void 0===_||null===($=_.persistent)||void 0===$||null===(Y=$.static)||void 0===Y||null===(H=Y.meter)||void 0===H?void 0:H.fleetDetailsCopy)||{};Be.logo=null===We||void 0===We||null===(V=We.logoImage)||void 0===V||null===(z=V.urls)||void 0===z||null===(J=z.original)||void 0===J?void 0:J.url,Be.comment=(null===We||void 0===We?void 0:We.comment)||"",console.log("fleet details",We),Be.arr.push({name:"Company name",value:null!==(K=null===We||void 0===We?void 0:We.companyName)&&void 0!==K?K:"N/A"}),Be.arr.push({name:"Company address",value:null!==(Z=null===We||void 0===We||null===(ee=We.location)||void 0===ee||null===(te=ee.attributes)||void 0===te?void 0:te.address)&&void 0!==Z?Z:"N/A"}),Object.keys(_e).map(function(e){"string"!==typeof _e[e]&&"number"!==typeof _e[e]||qe.push({name:Q(e),value:_e[e]})}),Object.keys($e).map(function(e){"string"!==typeof $e[e]&&"number"!==typeof $e[e]||Fe.push({name:Q(e),value:$e[e],unit:Ie(e,Ye,Ud[$e.unit])})}),ae(qe),X(Fe),le(Be),ye((null===_||void 0===_||null===(ne=_.persistent)||void 0===ne||null===(ie=ne.static)||void 0===ie||null===(ce=ie.profile)||void 0===ce||null===(oe=ce.pickupLocation)||void 0===oe?void 0:oe.coordinates)||(null===_||void 0===_||null===(re=_.persistent)||void 0===re||null===(de=re.static)||void 0===de||null===(ue=de.dashboard)||void 0===ue||null===(ve=ue.pickupLocation)||void 0===ve?void 0:ve.coordinates)||(null===_||void 0===_||null===(be=_.persistent)||void 0===be||null===(je=be.static)||void 0===je||null===(me=je.live)||void 0===me||null===(Oe=me.location)||void 0===Oe?void 0:Oe.coordinates),function(e){pe(e)}),ye((null===_||void 0===_||null===(fe=_.persistent)||void 0===fe||null===(he=fe.static)||void 0===he||null===(Ne=he.profile)||void 0===Ne||null===(ke=Ne.tripDetails)||void 0===ke||null===(Te=ke.end)||void 0===Te?void 0:Te.location)||(null===_||void 0===_||null===(Ce=_.persistent)||void 0===Ce||null===(we=Ce.static)||void 0===we||null===(Ee=we.meter)||void 0===Ee||null===(Re=Ee.tripDetails)||void 0===Re||null===(Pe=Re.end)||void 0===Pe||null===(De=Pe.location)||void 0===De?void 0:De.coordinates),function(e){ge(e)})}},[_]);var Se=function(e){var t=new Date(e);return t?"".concat(t.toLocaleDateString()," ").concat(t.toLocaleTimeString()):"N/A"};return Object(oa.jsx)($n.a,{title:"",visible:!0,width:"100%",className:"beam-modal analytics-summary-modal",footer:[],destroyOnClose:!0,children:_&&Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsxs)(Hn.a,{sm:12,xs:24,className:"".concat(window.innerWidth>700?"pr-3":""),children:[Object(oa.jsxs)(Yn.a,{className:"d-flex",children:[Object(oa.jsxs)(Hn.a,{children:[Object(oa.jsx)("h3",{className:"mb-1",children:null===_||void 0===_||null===(t=_.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(c=n.metadata)||void 0===c?void 0:c.title}),Object(oa.jsx)("h4",{children:"Ride information"})]}),Object(oa.jsxs)(Hn.a,{children:[Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==(o=null===_||void 0===_||null===(r=_.nonpersistent)||void 0===r||null===(v=r.static)||void 0===v||null===(b=v.live)||void 0===b||null===(j=b.status)||void 0===j?void 0:j.name)&&void 0!==o?o:"gray","-icon")})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/iot-icon.svg"})})]})]}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("ul",{className:"incident-information mt-2",children:z.map(function(e,t){return Object(oa.jsx)("li",{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.name})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.value})})]})},t)})})})}),Object(oa.jsx)(Yn.a,{className:"d-flex mt-3",children:Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("h4",{children:"Travel information"})})}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("ul",{className:"incident-information mt-2",children:ne.map(function(e,t){return Object(oa.jsx)("li",{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.name})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.value})})]})},t)})})})}),Object(oa.jsx)(Yn.a,{className:"d-flex mt-3",children:Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("h4",{children:"Fare breakdown"})})}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("ul",{className:"incident-information mt-2",children:Z.map(function(e,t){return Object(oa.jsx)("li",{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)("p",{children:e.name})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)("p",{children:e.unit})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)("p",{children:e.value})})]})},t)})})})})]}),Object(oa.jsxs)(Hn.a,{sm:12,xs:24,className:"mt-3 ".concat(window.innerWidth>700?"pl-3":""),children:[Object(oa.jsx)("h4",{className:"mt-3",children:"Locations"}),ue&&Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,className:"mt-2 incident-information",children:Object(oa.jsx)("img",{src:ue,width:"100%",alt:""})})}),Object(oa.jsx)(Yn.a,{className:"locations mt-2",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(wd,{type:"green",title:"Pickup location",locationObj:(null===_||void 0===_||null===(p=_.persistent)||void 0===p||null===(O=p.static)||void 0===O||null===(f=O.profile)||void 0===f?void 0:f.pickupLocation)||(null===_||void 0===_||null===(h=_.persistent)||void 0===h||null===(g=h.static)||void 0===g||null===(x=g.dashboard)||void 0===x?void 0:x.pickupLocation)||(null===_||void 0===_||null===(y=_.persistent)||void 0===y||null===(I=y.static)||void 0===I||null===(S=I.live)||void 0===S?void 0:S.location),address:me}),Object(oa.jsx)(wd,{type:"blue",title:"Dropoff location",locationObj:{coordinates:(null===_||void 0===_||null===(N=_.persistent)||void 0===N||null===(k=N.static)||void 0===k||null===(T=k.profile)||void 0===T||null===(w=T.tripDetails)||void 0===w||null===(E=w.end)||void 0===E?void 0:E.location)||(null===_||void 0===_||null===(R=_.persistent)||void 0===R||null===(P=R.static)||void 0===P||null===(D=P.meter)||void 0===D||null===(A=D.tripDetails)||void 0===A||null===(M=A.end)||void 0===M||null===(L=M.location)||void 0===L?void 0:L.coordinates)},address:he})]})})}),Object(oa.jsx)(Yn.a,{className:"d-flex mt-3",children:Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("h4",{children:"Fleet information"})})}),Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)("ul",{className:"incident-information mt-2",children:[(null===oe||void 0===oe?void 0:oe.logo)&&Object(oa.jsx)("li",{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:"Company logo"})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("img",{src:null===oe||void 0===oe?void 0:oe.logo,width:100,alt:""})})]})},-1),null===oe||void 0===oe||null===(U=oe.arr)||void 0===U?void 0:U.map(function(e,t){return Object(oa.jsx)("li",{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.name})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.value})})]})},t)})]})}),(null===oe||void 0===oe?void 0:oe.comment)&&""!==(null===oe||void 0===oe?void 0:oe.comment)&&Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("span",{children:null===oe||void 0===oe?void 0:oe.comment})})]})]})]})})})},Fd=function(e){var t=e.socket;Object(l.f)(),Object(s.b)();return Object(oa.jsx)($n.a,{title:"",visible:!0,width:"100%",className:"beam-modal analytics-summary-modal",footer:[],destroyOnClose:!0,closable:!1,children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mr-4",style:{padding:0},children:Object(oa.jsx)(mo,{socket:t})})})};Dc.d.register(Dc.c,Dc.g,Dc.b,Dc.i,Dc.j,Dc.e,Dc.h,Dc.f);var Bd=function(e){var t=e.update,n=Object(a.useState)({labels:[],datasets:[{label:"Heart rate",data:[],borderColor:"rgba(64, 204, 82, 1)",borderWidth:2,pointRadius:0}]}),i=Object(u.a)(n,2),c=i[0],o=i[1];return Object(a.useEffect)(function(){var e;t&&(console.log("update",t),function(e){var t=(new Date).toLocaleTimeString();o(function(n){return{labels:[].concat(Object(C.a)(n.labels),[t]).slice(-10),datasets:[Object(d.a)(Object(d.a)({},n.datasets[0]),{},{data:[].concat(Object(C.a)(n.datasets[0].data),[e]).slice(-10)})]}})}(null===t||void 0===t||null===(e=t.dataset)||void 0===e?void 0:e.heartRateRx))},[t]),Object(oa.jsx)(so.b,{data:c,options:{animation:{duration:0}}})};Dc.d.register(Dc.c,Dc.g,Dc.b,Dc.i,Dc.j,Dc.e,Dc.h,Dc.f);var _d=function(e){var t=e.update,n=Object(a.useState)({labels:[],datasets:[{label:"Systolic Pressure",data:[],borderColor:"rgba(80, 138, 250, 1)",borderWidth:2,pointRadius:0},{label:"Diastolic Pressure",data:[],borderColor:"rgba(70, 59, 189, 1)",borderWidth:2,pointRadius:0}]}),i=Object(u.a)(n,2),c=i[0],o=i[1];return Object(a.useEffect)(function(){var e,n;t&&function(e){var t=(new Date).toLocaleTimeString();o(function(n){return{labels:[].concat(Object(C.a)(n.labels),[t]).slice(-10),datasets:[Object(d.a)(Object(d.a)({},n.datasets[0]),{},{data:[].concat(Object(C.a)(n.datasets[0].data),[e.systolic]).slice(-10)}),Object(d.a)(Object(d.a)({},n.datasets[1]),{},{data:[].concat(Object(C.a)(n.datasets[1].data),[e.diastolic]).slice(-10)})]}})}({systolic:null===t||void 0===t||null===(e=t.dataset)||void 0===e?void 0:e.bloodpressureHighRx,diastolic:null===t||void 0===t||null===(n=t.dataset)||void 0===n?void 0:n.bloodpressureLowRx})},[t]),Object(oa.jsx)(so.b,{data:c,options:{animation:{duration:0}}})},$d=function(e){var t=e.onClose,n=e.socket,i=e.columns,c=e.tableHideList,o=e.onChange,r=(Object(s.b)(),Object(a.useState)(!1)),d=Object(u.a)(r,2),v=(d[0],d[1],Object(a.useState)([])),b=Object(u.a)(v,2),j=(b[0],b[1],Object(a.useState)()),m=Object(u.a)(j,2),p=m[0],O=m[1];Object(s.c)(function(e){return e.auth}).encrypted_token,Object(l.g)().search;Object(a.useEffect)(function(){n.client},[n.client]);return Object(a.useEffect)(function(){O(null===i||void 0===i?void 0:i.filter(function(e){return-1===(null===c||void 0===c?void 0:c.indexOf(e.key))}).map(function(e){return e.key}))},[]),Object(oa.jsxs)($n.a,{title:"Filter columns",visible:!0,onOk:function(e){},onCancel:function(){t()},width:"480px",className:"beam-modal scrollable",footer:[],destroyOnClose:!0,closable:!0,children:[Object(oa.jsx)(Yn.a,{className:"scrollable-body mt-4",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Xn.a.Group,{className:"plain-radios w-100",onChange:function(e){O(e)},value:p,children:i&&i.map(function(e,t){return Object(oa.jsxs)(Yn.a,{className:"person-item",children:[Object(oa.jsx)(Hn.a,{span:21,children:Object(oa.jsx)("h5",{children:null===e||void 0===e?void 0:e.title})}),Object(oa.jsx)(Hn.a,{span:3,className:"d-block t-right",children:Object(oa.jsx)(Xn.a,{value:null===e||void 0===e?void 0:e.key,className:"green-radio"})})]},t)})})})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-4 sticky-footer",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){var e=[];null===i||void 0===i||i.map(function(t){-1===(null===p||void 0===p?void 0:p.indexOf(t.key))&&e.push(t.key)}),o(e)},children:"Save"})})})]})};n(977);Dc.d.register(Dc.a,Dc.j,Dc.e);var Yd,Hd,Wd,Vd=function(e){var t=e.socket,n=Object(l.g)().search,c=Object(s.c)(function(e){return e.auth}),o=c.projects,r=c.gps,d=Object(s.b)(),v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=b[0],p=b[1],O=Object(a.useState)(),f=Object(u.a)(O,2),h=f[0],g=f[1],x=Object(a.useState)(),I=Object(u.a)(x,2),S=I[0],N=I[1],k=Object(a.useState)(),T=Object(u.a)(k,2),w=T[0],E=T[1],R=Object(a.useState)([]),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Object(a.useState)([]),L=Object(u.a)(M,2),U=L[0],q=L[1],F=Object(a.useState)(!1),B=Object(u.a)(F,2),_=B[0],$=B[1],Y=Object(a.useState)([]),H=Object(u.a)(Y,2),W=H[0],V=H[1],z=Mn().getUserRequestPayload;Object(a.useEffect)(function(){if(h){var e=Object(C.a)(D);e.length;null===h||void 0===h||h.map(function(t,n){var a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;e.unshift({key:t.timestamp,datetime:new Date(t.timestamp).toLocaleString(),oxygen:null!==(a=null===t||void 0===t||null===(i=t.dataset)||void 0===i?void 0:i.bloodOxygenRx)&&void 0!==a?a:"N/A",heartRate:null!==(c=null===t||void 0===t||null===(o=t.dataset)||void 0===o||null===(l=o.heartRateRx)||void 0===l?void 0:l.toFixed(0))&&void 0!==c?c:"N/A",temperature:null!==(s=null===t||void 0===t||null===(r=t.dataset)||void 0===r||null===(d=r.bodyTempRx)||void 0===d?void 0:d.toFixed(1))&&void 0!==s?s:"N/A",bloodPressure:null!==t&&void 0!==t&&null!==(u=t.dataset)&&void 0!==u&&u.bloodpressureHighRx?"".concat(null===t||void 0===t||null===(v=t.dataset)||void 0===v?void 0:v.bloodpressureHighRx,"/").concat(null===t||void 0===t||null===(b=t.dataset)||void 0===b?void 0:b.bloodpressureLowRx):"N/A",calories:null!==(j=null===t||void 0===t||null===(m=t.dataset)||void 0===m||null===(p=m.calRx)||void 0===p?void 0:p.toFixed(0))&&void 0!==j?j:"N/A",steps:null!==(O=null===t||void 0===t||null===(f=t.dataset)||void 0===f?void 0:f.stepsRx)&&void 0!==O?O:"N/A",status:"N/A"})}),A(e.slice(0,100))}},[h]),Object(a.useEffect)(function(){if(r){var e,t=[];null===r||void 0===r||null===(e=r.samples)||void 0===e||e.map(function(e,n){var a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;t.push({key:e.timestamp,datetime:new Date(e.timestamp).toLocaleString(),oxygen:null!==(a=null===e||void 0===e||null===(i=e.dataset)||void 0===i?void 0:i.bloodOxygenRx)&&void 0!==a?a:"N/A",heartRate:null!==(c=null===e||void 0===e||null===(o=e.dataset)||void 0===o||null===(l=o.heartRateRx)||void 0===l?void 0:l.toFixed(0))&&void 0!==c?c:"N/A",temperature:null!==(s=null===e||void 0===e||null===(r=e.dataset)||void 0===r||null===(d=r.bodyTempRx)||void 0===d?void 0:d.toFixed(1))&&void 0!==s?s:"N/A",bloodPressure:null!==e&&void 0!==e&&null!==(u=e.dataset)&&void 0!==u&&u.bloodpressureHighRx?"".concat(null===e||void 0===e||null===(v=e.dataset)||void 0===v?void 0:v.bloodpressureHighRx,"/").concat(null===e||void 0===e||null===(b=e.dataset)||void 0===b?void 0:b.bloodpressureLowRx):"N/A",calories:null!==(j=null===e||void 0===e||null===(m=e.dataset)||void 0===m||null===(p=m.calRx)||void 0===p?void 0:p.toFixed(0))&&void 0!==j?j:"N/A",steps:null!==(O=null===e||void 0===e||null===(f=e.dataset)||void 0===f?void 0:f.stepsRx)&&void 0!==O?O:"N/A",status:"N/A"})}),q([{title:"Timestamp",key:"datetime",dataIndex:"datetime"},{title:"Temperature (celcius)",key:"temperature",dataIndex:"temperature"},{title:"Heart rate (bpm)",key:"heartRate",dataIndex:"heartRate"},{title:"Oxygen (%)",key:"oxygen",dataIndex:"oxygen"},{title:"Blood pressure (mmHg)",key:"bloodPressure",dataIndex:"bloodPressure"},{title:"Calories (kcal)",key:"calories",dataIndex:"calories"},{title:"Steps",key:"steps",dataIndex:"steps"},{title:"Status",key:"status",dataIndex:"status"}]),A(t.reverse().slice(0,100)),p(!1)}},[r]);var Q=function(){var e=new URLSearchParams(n),t=e.get("iotUdid"),a=e.get("iotUserId"),i={filter:"ecosystem=".concat("beamdevlive"," iotUdid=").concat(t," userId=").concat("103706"," iotUserId=").concat(a," page=true"),fromTimestamp:(new Date).getTime()-9e5,toTimestamp:(new Date).getTime(),options:{withLabels:!0}};d({type:"GET_HISTORICAL_GPS",payload:{requestData:i}})};Object(a.useEffect)(function(){if(t.client){var e=new URLSearchParams(n),a=e.get("userId"),i=e.get("connectionId"),c=e.get("videoToken"),o=e.get("iotUdid"),l=e.get("iotUserId");t.subscribeToEvent(m.SubscribePageTopics,qt(i)),t.publishToEvent(m.PublishPageTopics,Ft(i),Dn({userId:a})),t.subscribeToEvent(m.SubscribePageTopics,"".concat("beamdevlive","/device/").concat(o,"/user/103706/iotAppend/").concat(l,"/#"),function(e){console.log("iot updated",e),g(null===e||void 0===e?void 0:e.samples)}),p(!0),E(c),Q(),V(JSON.parse(localStorage.getItem("tableHideList"))||[])}},[n,t.client]),Object(a.useEffect)(function(){if(o){var e=new URLSearchParams(n).get("userId");null!==o&&void 0!==o&&o.userServiceId&&function(e,a){var i=new URLSearchParams(n).get("connectionId");t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,z(e,"$","$"),hn(i),a),t.subscribeToSurvey(m.SurveyTopics,hn(i),function(e){var t,n,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h,g,x,y,I,S,k,T,C,w,E,R,P,D,A=null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0];N({name:"".concat(null!==(i=null===A||void 0===A||null===(c=A.persistent)||void 0===c||null===(o=c.static)||void 0===o||null===(l=o.live)||void 0===l||null===(s=l.profile)||void 0===s?void 0:s.firstName)&&void 0!==i?i:""," ").concat(null!==(r=null===A||void 0===A||null===(d=A.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.profile)||void 0===b?void 0:b.lastName)&&void 0!==r?r:""),email:null===A||void 0===A||null===(j=A.persistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.live)||void 0===p||null===(O=p.alternativeIds)||void 0===O?void 0:O.email,phone:null===A||void 0===A||null===(f=A.persistent)||void 0===f||null===(h=f.static)||void 0===h||null===(g=h.live)||void 0===g||null===(x=g.alternativeIds)||void 0===x?void 0:x.phone,customId:null===A||void 0===A||null===(y=A.persistent)||void 0===y||null===(I=y.static)||void 0===I||null===(S=I.live)||void 0===S||null===(k=S.alternativeIds)||void 0===k?void 0:k.customId,beamId:null===A||void 0===A||null===(T=A.persistent)||void 0===T||null===(C=T.static)||void 0===C||null===(w=C.live)||void 0===w||null===(E=w.beamIds)||void 0===E?void 0:E[0],bio:null===A||void 0===A||null===(R=A.persistent)||void 0===R||null===(P=R.static)||void 0===P||null===(D=P[a])||void 0===D?void 0:D.extendedBio})})}(e,null===o||void 0===o?void 0:o.userServiceId)}},[o]);var G=function(e,t){var n;return Object.keys((null===e||void 0===e?void 0:e.bio)||{}).map(function(a){var i,c,o,l;(null===e||void 0===e||null===(i=e.bio)||void 0===i||null===(c=i[a])||void 0===c?void 0:c.name)===t&&(n=null===e||void 0===e||null===(o=e.bio)||void 0===o||null===(l=o[a])||void 0===l?void 0:l.value)}),n};return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)("div",{className:"profile-container",children:[Object(oa.jsxs)("div",{children:[Object(oa.jsxs)("div",{className:"client-info",children:[Object(oa.jsxs)("div",{className:"info-block",children:[Object(oa.jsx)("div",{className:"client-name-label",children:"Client name"}),Object(oa.jsx)("div",{className:"client-name",children:(null===S||void 0===S?void 0:S.name)||"N/A"})]}),Object(oa.jsx)("div",{className:"contact-info",children:Object(oa.jsxs)("div",{className:"info-block",children:[Object(oa.jsx)("div",{className:"label",children:null!==S&&void 0!==S&&S.phone?"Phone":"CustomeId"}),Object(oa.jsx)("div",{className:"value",children:(null===S||void 0===S?void 0:S.phone)||(null===S||void 0===S?void 0:S.customId)||"N/A"})]})}),Object(oa.jsx)("div",{className:"contact-info",children:Object(oa.jsxs)("div",{className:"info-block",children:[Object(oa.jsx)("div",{className:"label",children:"Email"}),Object(oa.jsx)("div",{className:"value",children:(null===S||void 0===S?void 0:S.email)||"N/A"})]})})]}),Object(oa.jsx)("div",{className:"medical-summary",children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full green-btn cover",children:"Medical History"})})]}),Object(oa.jsx)("div",{className:"divider"}),Object(oa.jsxs)("div",{className:"additional-info",children:[Object(oa.jsxs)("div",{className:"info-section",children:[Object(oa.jsxs)("div",{className:"info-card",children:[Object(oa.jsx)("div",{className:"label",children:"Beam ID"}),Object(oa.jsx)("div",{className:"value",children:(null===S||void 0===S?void 0:S.beamId)||"N/A"})]}),Object(oa.jsxs)("div",{className:"info-card",children:[Object(oa.jsx)("div",{className:"label green",children:"Weight"}),Object(oa.jsxs)("div",{className:"value green",children:[G(S,"weight")||"N/A"," kg"]})]}),Object(oa.jsxs)("div",{className:"info-card",children:[Object(oa.jsx)("div",{className:"label blue",children:"Height"}),Object(oa.jsxs)("div",{className:"value blue",children:[G(S,"height")||"N/A"," cm"]})]}),Object(oa.jsxs)("div",{className:"info-card",children:[Object(oa.jsx)("div",{className:"label orange",children:"Gender"}),Object(oa.jsx)("div",{className:"value orange",children:G(S,"gender")||"N/A"})]}),Object(oa.jsxs)("div",{className:"info-card",children:[Object(oa.jsx)("div",{className:"label light-blue",children:"Date of Birth"}),Object(oa.jsx)("div",{className:"value light-blue",children:G(S,"dateOfBirth")||"N/A"})]}),Object(oa.jsxs)("div",{className:"info-card wide",children:[Object(oa.jsx)("div",{className:"label bright-blue",children:"BMI (body mass index)"}),Object(oa.jsx)("div",{className:"value bright-blue",children:G(S,"bmi")||"N/A"})]})]}),Object(oa.jsxs)("div",{className:"medical-history-section",children:[Object(oa.jsxs)("div",{className:"medical-history-card",children:[Object(oa.jsx)("div",{className:"label orange",children:"Allergies"}),Object(oa.jsx)("div",{className:"value orange",children:G(S,"allergies")||"N/A"})]}),Object(oa.jsxs)("div",{className:"medical-history-card",children:[Object(oa.jsx)("div",{className:"label bright-blue",children:"Mobility"}),Object(oa.jsx)("div",{className:"value bright-blue",children:G(S,"mobility")||"N/A"})]}),Object(oa.jsxs)("div",{className:"medical-history-card",children:[Object(oa.jsx)("div",{className:"label blue",children:"Medication"}),Object(oa.jsx)("div",{className:"value blue",children:G(S,"medication")||"N/A"})]})]})]})]}),Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)(Yn.a,{className:"map-chart mt-4",children:[Object(oa.jsx)(Hn.a,{xs:24,sm:12,md:8,children:Object(oa.jsx)("div",{className:"main-column message-panel mr-4",children:Object(oa.jsxs)("div",{className:"main-content p-0",children:[Object(oa.jsxs)("div",{className:"main-header pt-3 pr-5 pl-4 border-bottom-0",children:[Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h4",{className:"ml-3",style:{color:"#000"},children:"Video call"})}),Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/expand-icon.svg",className:"close-icon mr-4"}),Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon"})]})]}),w&&Object(oa.jsx)("iframe",{title:"Video call",style:{height:"100%",width:"100%",border:"none"},allow:"camera; microphone",src:"https://video.staging.beam.live/room/".concat(w)})]})})}),Object(oa.jsx)(Hn.a,{xs:24,sm:12,md:8,children:Object(oa.jsx)("div",{className:"main-column message-panel mr-4",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h3",{className:"ml-3",style:{color:"#000"},children:"Max Heart Rate (bpm)"})}),Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/expand-icon.svg",className:"close-icon mr-4"}),Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon"})]})]}),Object(oa.jsx)(Bd,{update:null===h||void 0===h?void 0:h[0]})]})})}),Object(oa.jsx)(Hn.a,{xs:24,sm:12,md:8,children:Object(oa.jsx)("div",{className:"main-column message-panel",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h3",{className:"ml-3",style:{color:"#000"},children:"Blood pressure (mmHg)"})}),Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/expand-icon.svg",className:"close-icon mr-4"}),Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon"})]})]}),Object(oa.jsx)(_d,{update:null===h||void 0===h?void 0:h[0]})]})})})]})}),Object(oa.jsx)(Yn.a,{gutter:20,className:"mt-4 scrollable-table",children:Object(oa.jsxs)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:[Object(oa.jsxs)("div",{className:"d-flex justify-content-space-between",children:[Object(oa.jsx)("h3",{children:"Analytics table"}),Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{margin:"10px 10px 10px 0"},onClick:function(){$(!0)},children:Object(oa.jsx)(Rc.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{margin:"10px 10px 10px 0"},loading:j,onClick:function(){p(!0),Q()},children:!j&&Object(oa.jsx)(Pc.a,{})})]})]}),Object(oa.jsx)(Xi.a,{dataSource:D,onRow:function(e){return{onDoubleClick:function(){var a,i,c=new URLSearchParams(n).get("userId");t.publishToEvent(m.PublishPageTopics,On(null===e||void 0===e||null===(a=e.action)||void 0===a?void 0:a.pageId,c),{page:null===e||void 0===e||null===(i=e.action)||void 0===i?void 0:i.page})}}},columns:null===U||void 0===U?void 0:U.filter(function(e){return-1===(null===W||void 0===W?void 0:W.indexOf(e.key))}),scroll:{x:!0}}),_&&Object(oa.jsx)($d,{socket:t,tableHideList:W,onChange:function(e){V(e),localStorage.setItem("tableHideList",JSON.stringify(e)),$(!1)},columns:U,onClose:function(){$(!1)}})]})})]})},zd=function(e){var t=e.socket;Object(l.f)(),Object(s.b)();return Object(oa.jsx)($n.a,{title:"",visible:!0,width:"100%",className:"beam-modal analytics-summary-modal",footer:[],destroyOnClose:!0,closable:!1,children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mr-4",style:{padding:0},children:Object(oa.jsx)(Vd,{socket:t})})})},Qd=n(552),Gd=n(180),Jd=n(1069),Kd=n(1070),Zd=n(1071),Xd=n(1072),eu=n(1073),tu=n(540),nu=(n(978),function(e){var t=e.onClose,n=e.socket,i=e.workerSid,c=Object(s.b)(),o=Object(a.useState)(!1),r=Object(u.a)(o,2),d=r[0],v=(r[1],Object(a.useState)([])),b=Object(u.a)(v,2),j=b[0],m=b[1],p=Object(a.useState)(),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(s.c)(function(e){return e.auth}),x=g.encrypted_token,y=g.projects;Object(l.g)().search;Object(a.useEffect)(function(){n.client&&I()},[n.client]);var I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=null===x||void 0===x?void 0:x.userId,n={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{".concat(t,"}")},load:{objectId:"$.objectId",title:"$.persistent.static.metadata.title",updatedAt:"$.persistent.dynamic.updatedAt"}},sortBy:{properties:[{field:"@updatedAt",order:"DESC"}],max:1e5},filter:{expression:""!==e?"exists(@title) && contains(@title, '".concat(e,"')"):""},result:{pagination:{offset:0,limit:30}}};h(void 0),c(nt({requestData:n,callback:function(e){m(e)}}))};return Object(oa.jsxs)($n.a,{title:"Save recording",visible:!0,onOk:function(e){},onCancel:function(){},width:"480px",className:"beam-modal scrollable",footer:[],destroyOnClose:!0,closable:!1,children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Wn.a,{name:"title",onChange:function(e){var t=e.target.value;Yd&&clearTimeout(Yd),Yd=setTimeout(function(){console.log("e here",t),I(t)},500)},placeholder:"Search page"})})}),Object(oa.jsx)(Yn.a,{className:"scrollable-body mt-4",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsxs)(Yn.a,{className:"d-flex mb-4",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("h5",{children:"Select page"})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70",onClick:function(){I()},children:"Refresh"})})]}),Object(oa.jsx)(yi.a.Group,{className:"plain-radios w-100",onChange:function(e){h(e.target.value)},value:f,children:j&&j.map(function(e,t){return Object(oa.jsxs)(Yn.a,{className:"person-item",children:[Object(oa.jsx)(Hn.a,{span:4,children:Object(oa.jsx)(fa.a,{src:"/images/community-blue-icon.svg",className:"colorable mark-icon"})}),Object(oa.jsx)(Hn.a,{span:13,children:Object(oa.jsx)("h5",{children:(null===e||void 0===e?void 0:e.title)||"Page ".concat(e.objectId)})}),Object(oa.jsx)(Hn.a,{span:7,className:"d-block t-right",children:Object(oa.jsx)(yi.a,{value:e.objectId,className:"green-radio"})})]},t)})})]})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-4 sticky-footer",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:d,disabled:void 0===f,onClick:function(){var e=null===x||void 0===x?void 0:x.connectionId,n=null===x||void 0===x?void 0:x.userId,a={connectionId:e,workerSid:i,userId:n,pageId:f.toString(),userServiceId:null===y||void 0===y?void 0:y.userServiceId};c(St({requestData:a,callback:function(e){console.log("save recording response",e)}})),t()},children:"Save"})})})]})}),au=(Za.a.Panel,function(e){var t=e.onClose,n=e.message,i=Object(a.useState)(!0),c=Object(u.a)(i,2),o=(c[0],c[1],ei.a.useForm()),l=Object(u.a)(o,1)[0],s=Object(a.useState)(!1),r=Object(u.a)(s,2),d=r[0];r[1];return Object(oa.jsx)($n.a,{title:"Welcome to inStore call center",visible:!0,onCancel:function(){},width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,closable:!1,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"confirmation-form",id:"confirmation-form",layout:"vertical",form:l,requiredMark:!1,children:[Object(oa.jsx)(ei.a.Item,{name:"password",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(Jc.a,{children:n||"Are you sure you want to continue?"})}),Object(oa.jsx)(ei.a.Item,{className:"action-grp mt-4",children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{loading:d,className:"beam-btn green-btn cover w-full",onClick:function(){t&&t()},children:"Confirm"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:function(){window.close()},children:"Cancel"})})]})})]})})}),iu=function(e){var t=e.onClose,n=e.phoneNumber,c=e.setPhoneNumber,o=e.handleChange,l=e.callOutgoing,s=Object(a.useState)(!0),r=Object(u.a)(s,2),d=(r[0],r[1],ei.a.useForm()),v=(Object(u.a)(d,1)[0],Object(a.useState)(!1)),b=Object(u.a)(v,2);b[0],b[1];return Object(oa.jsx)($n.a,{title:"Call Dialer",visible:!0,onCancel:function(){},width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,closable:!1,children:Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"d-flex mt-4 w-100",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Wn.a,{className:"beam-input",value:n,onChange:function(e){null===e.target.value.match(/^[0-9+]+$/)&&""!==e.target.value||c(e.target.value)}})})}),Object(oa.jsx)(Yn.a,{className:"d-flex mt-4 w-100",children:$.a.times(9,function(e){return Object(oa.jsx)(Hn.a,{span:8,className:"d-flex mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn m-auto mb-4",style:{minWidth:50,minHeight:50},onClick:function(){return o(e+1)},children:e+1},e)})})}),Object(oa.jsxs)(Yn.a,{className:"d-flex w-100",children:[Object(oa.jsx)(Hn.a,{span:8,className:"d-flex mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn m-auto mb-4",onClick:function(){return o("+")},style:{minWidth:50,minHeight:50},children:"+"})}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn m-auto mb-4",style:{minWidth:50,minHeight:50},onClick:function(){return o("0")},children:"0"})}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn m-auto mb-4",style:{minWidth:50,minHeight:50},onClick:function(){return o("#")},children:"#"})})]}),Object(oa.jsxs)(Yn.a,{className:"d-center mt-3 w-100",children:[Object(oa.jsx)(Hn.a,{span:8,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn m-auto",style:{minWidth:50,minHeight:50},onClick:function(){c(""),t()},children:Object(oa.jsx)(pa.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn cover call-btn m-auto",style:{minWidth:50,minHeight:50},onClick:function(){l({output:{activeCallerPhoneNumber:n}}),c(""),t()},children:Object(oa.jsx)(fa.a,{src:"/images/call-icon.svg"})})}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn m-auto",style:{minWidth:50,minHeight:50},onClick:function(){return o(null)},children:Object(oa.jsx)(Eo.a,{})})})]})]})})},cu=n(534),ou=function(){var e=Object(cu.useStopwatch)({autoStart:!0}),t=e.seconds,n=e.minutes,a=e.hours;return Object(oa.jsxs)("div",{style:{textAlign:"center"},className:"mt-3",children:[Object(oa.jsxs)("span",{children:[0===a?"0":"",a]}),":",Object(oa.jsxs)("span",{children:[0===n?"0":"",n]}),":",Object(oa.jsxs)("span",{children:[t<10?"0":"",t]})]})},lu=n(979),su=[{sheet:"Call logs",columns:[{label:"Timestamp",value:"timestamp"},{label:"From",value:"from"},{label:"Call taker",value:"calltaker"},{label:"Duration",value:"duration"},{label:"Type",value:"type"}],content:[]}],ru={fileName:"callLogs",extraLength:3,writeOptions:{}},du=Jn.a.RangePicker,uu=function(e){var t,n,c,o,r=e.socket,b=(e.params,Object(l.g)().search),j=Object(s.c)(function(e){return e.auth}),p=j.projects,O=j.userRequests,f=j.requestIds,h=j.encrypted_token,g=Object(s.b)(),x=Object(a.useRef)(null),I=Object(a.useRef)(null),S=Object(a.useState)("in-queue"),N=Object(u.a)(S,2),T=N[0],w=N[1],E=Object(a.useRef)("in-queue"),R=Object(a.useState)({}),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Object(a.useState)(),L=Object(u.a)(M,2),U=L[0],q=L[1],F=Object(a.useState)(),B=Object(u.a)(F,2),_=B[0],Y=B[1],H=Object(a.useState)(!1),W=Object(u.a)(H,2),V=W[0],Q=W[1],G=Object(a.useState)(!1),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)(!1),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(!1),ie=Object(u.a)(ae,2),ce=ie[0],oe=ie[1],le=Object(a.useState)(),se=Object(u.a)(le,2),re=se[0],de=se[1],ue=Object(a.useState)(),ve=Object(u.a)(ue,2),be=ve[0],je=ve[1],me=Object(a.useState)([]),pe=Object(u.a)(me,2),Oe=pe[0],fe=pe[1],he=Object(a.useRef)([]),ge=Object(a.useState)(!1),xe=Object(u.a)(ge,2),ye=xe[0],Ie=xe[1],Se=Object(a.useState)(!0),Ne=Object(u.a)(Se,2),ke=Ne[0],Te=Ne[1],Ce=Object(a.useState)(!1),we=Object(u.a)(Ce,2),Ee=we[0],Re=we[1],Pe=Mn().getUserRequestPayload,De=Object(a.useState)(""),Ae=Object(u.a)(De,2),Me=Ae[0],Le=Ae[1],Ue=Object(a.useState)(!1),qe=Object(u.a)(Ue,2),Fe=qe[0],Be=qe[1],_e=Object(a.useRef)([]),$e=Object(a.useState)([]),Ye=Object(u.a)($e,2),He=Ye[0],We=Ye[1],Ve=function(e){Le(e?"".concat(Me).concat(e):Me.slice(0,-1))},ze=Object(a.useRef)(!1),Qe=Object(a.useRef)(!1),Ge=Object(a.useState)(!1),Je=Object(u.a)(Ge,2),Ke=Je[0],Ze=Je[1],Xe=Object(a.useState)(!1),tt=Object(u.a)(Xe,2),nt=tt[0],at=tt[1],it=Object(a.useRef)();Object(a.useEffect)(function(){if(null!==p&&void 0!==p&&p.adminUserId){var e=null===h||void 0===h?void 0:h.connectionId;r.subscribeToEvent(m.SubscribePageTopics,yn(e)),function(){var e=null===h||void 0===h?void 0:h.connectionId,t={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===p||void 0===p?void 0:p.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",admin:"$.persistent.static.admin",workerSid:"$..admin.profile.workerSid"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@workerSid) && @workerSid !== ''"},anyStatus:!1};r.publishToEvent(m.PublishPageTopics,xn(e),Dn(t,f.user))}(),function(){null===h||void 0===h||h.connectionId;var e={userId:null===h||void 0===h?void 0:h.userId,serviceId:null===p||void 0===p?void 0:p.userServiceId};g(yt({requestData:e,callback:function(e){var t;q(null!==(t=null===e||void 0===e?void 0:e.status)&&void 0!==t?t:"grey")}}))}(),ot("task.created")}},[p]),Object(a.useEffect)(function(){if(h&&null!==h&&void 0!==h&&h.userId&&null!==h&&void 0!==h&&h.connectionId){r.subscribeToEvent(m.SubscribePageTopics,qt(null===h||void 0===h?void 0:h.connectionId)),r.publishToEvent(m.PublishPageTopics,Ft(null===h||void 0===h?void 0:h.connectionId),Dn({userId:null===h||void 0===h?void 0:h.userId,cudbServiceId:(null===h||void 0===h?void 0:h.cudbServiceId)||(null===h||void 0===h?void 0:h.serviceId)})),r.subscribeToEvent(m.SubscribePageTopics,(n=null===h||void 0===h?void 0:h.connectionId,"".concat(Ut,"/connection/").concat(n,"/service/twilio/getWorkerToken/reply")),function(e){var t,n,a,i,c;(console.log("token payload here",e),null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.client_token)&&(c=null===e||void 0===e||null===(a=e.response)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.client_token,x.current=new tu.a(c,{allowIncomingWhileBusy:!0}),x.current.register(),x.current.on("incoming",function(e){e.on("accept",function(e){console.log("connection on accept"),I.current=e}),console.log("incoming here",e),e.accept(),Q(!0),ze.current=!0,Ze(!1)}),x.current.on("destroyed",function(e){console.log("destroyed",e)}),x.current.on("error",function(e){console.log("error",e)}))}),r.subscribeToSurvey(m.SurveyTopics,wn(null===h||void 0===h?void 0:h.connectionId),function(e){var t,n,a,i;"pending"===(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n||null===(a=n[0])||void 0===a||null===(i=a.lastTask)||void 0===i?void 0:i.status)&&Ie(!0)});var e=new Audio("/audio/ring-normal.wav");e.loop=!0,de(e);var t=new Audio("/audio/beep-06.mp3");je(t)}var n},[h]),Object(a.useEffect)(function(){if(r.client){var e=new URLSearchParams(b),t=e.get("token"),n=e.get("connectionId"),a=e.get("userId");g(t?ct({data:{payload:t},callback:function(e){}}):{type:"ADD_ENCRYPTED_TOKEN",payload:{connectionId:n,userId:a}}),document.title="Call center - Beam"}},[b,r.client]);var ot=function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||fe([]),he.current=[];var t={select:{index:{searchIndex:"".concat("beamdevlive",":workflow:startedAt"),searchQuery:"@configId:{".concat("10278","}@partitions:{'org\\:").concat(z(null===p||void 0===p?void 0:p.userServiceId),"'}")},load:{objectId:"$.objectId",output:"$.dataset.output",startedAt:"$.flow.startedAt",status:"$.dataset.output.callStatus"}},sortBy:{properties:[{field:"@startedAt",order:"DESC"}],max:1e5},filter:{expression:"exists(@status) && @status == '".concat(e,"'")},result:{pagination:{offset:0,limit:50}}};g(et({requestData:t,callback:function(e){fe(e),he.current=e||[],"missed"===E.current&&Be(!1)}}))};Object(a.useEffect)(function(){if(O&&r.client){var e=null===h||void 0===h?void 0:h.userId,t=null===h||void 0===h?void 0:h.connectionId;if(null!==O&&void 0!==O&&O["".concat(f.user)]){var n,a,i,c,o,l,s,d,u=null===O||void 0===O?void 0:O["".concat(f.user)].find(function(t){return t.id===e});if(u&&JSON.stringify(_e.current)!==JSON.stringify(null===O||void 0===O?void 0:O["".concat(f.user)]))if(A(u),"pending"===(null===u||void 0===u||null===(n=u.admin)||void 0===n||null===(a=n.lastTask)||void 0===a?void 0:a.status)&&Ie(!0),r.publishToEvent(m.PublishPageTopics,function(e){return"".concat(Ut,"/connection/").concat(e,"/service/twilio/getWorkerToken")}(t),Dn({userId:null===u||void 0===u||null===(i=u.admin)||void 0===i||null===(c=i.profile)||void 0===c?void 0:c.workerSid,serviceId:null===p||void 0===p?void 0:p.userServiceId})),null!==u&&void 0!==u&&null!==(o=u.admin)&&void 0!==o&&null!==(l=o.profile)&&void 0!==l&&l.workerSid)v=null===u||void 0===u||null===(s=u.admin)||void 0===s||null===(d=s.profile)||void 0===d?void 0:d.workerSid,r.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/service/+/user/").concat(e,"/twilioReservationCreated")}(v),function(e){Qe.current||(Y(null===e||void 0===e?void 0:e.data),Q(!1),ze.current=!1,Ze(!1),Hd&&clearTimeout(Hd),Hd=setTimeout(function(){ze.current||(Y(void 0),Q(!1),ze.current=!1,null===re||void 0===re||re.pause())},18e3),null===re||void 0===re||re.play())}),r.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/service/+/user/").concat(e,"/twilioReservationTimeout")}(v),function(e){Qe.current||(Y(void 0),Q(!1),ze.current=!1,null===re||void 0===re||re.pause())}),r.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/service/+/user/").concat(e,"/twilioReservationCancelled")}(v),function(e){Qe.current||(Y(void 0),Q(!1),ze.current=!1,null===re||void 0===re||re.pause())}),r.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/service/+/user/").concat(e,"/taskCreated/#")}(v),function(e){if("in-queue"===E.current){var t,n,a,i=Object(C.a)(he.current);i.unshift({output:{activeCallSId:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.callSid,activeCallTimestamp:parseInt(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.timestamp),activeCallerPhoneNumber:null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.from,callStatus:"task.created"},status:"task.created"}),fe(i),he.current=i}}),r.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/service/+/user/").concat(e,"/twilioRecordingSaved")}(v),function(e){switch(E.current){case"completed":ot("task.complete",!0);break;case"missed":ot("task.no-answer",!0)}}),r.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/service/+/user/").concat(e,"/eventUserStatusUpdated")}(v),function(e){var t,n;(null===h||void 0===h?void 0:h.userId)===(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.userId)&&q(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.status);var a,i,c=Object(C.a)(_e.current||[]),o=c.findIndex(function(t){var n;return t.id===(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.userId)});-1!==o&&(c[o].nonpersistent.static.live.status={name:null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.status,color:null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.status}),We(c)}),r.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/service/+/user/").concat(e,"/taskCancelled/#")}(v),function(e){if("missed"===E.current){var t,n,a,i,c=Object(C.a)(he.current);c.unshift({output:{objectId:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.objectId,activeCallSId:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.callSid,activeCallTimestamp:parseInt(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.timestamp),activeCallerPhoneNumber:null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.from,callStatus:"task.no-answer"},status:"task.no-answer"}),fe(c),he.current=c}else if("in-queue"===E.current){var o=Object(C.a)(he.current),l=o.findIndex(function(t){var n;return t.output.activeCallSId===(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.callSid)});-1!==l&&(o.splice(l,1),fe(o),he.current=o)}Be(!0),be.play()}),r.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/service/+/user/").concat(e,"/taskCompleted/#")}(v),function(e){if("completed"===E.current){var t,n,a,i,c,o=Object(C.a)(he.current);o.unshift({output:{activeCallSId:null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.reservation)||void 0===n?void 0:n.callSid,activeCallTimestamp:(new Date).getTime(),activeCallerPhoneNumber:null===e||void 0===e||null===(a=e.data)||void 0===a||null===(i=a.reservation)||void 0===i?void 0:i.phoneNumber,activeDispatcherId:null===e||void 0===e||null===(c=e.data)||void 0===c?void 0:c.workerSid,callStatus:"task.completed"},status:"task.completed"}),fe(o),he.current=o}else if("in-queue"===E.current){var l=Object(C.a)(he.current),s=l.findIndex(function(t){var n,a;return t.output.activeCallSId===(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.reservation)||void 0===a?void 0:a.callSid)});-1!==s&&(l.splice(s,1),fe(l),he.current=l)}});We((null===O||void 0===O?void 0:O["".concat(f.user)])||[]),_e.current=null===O||void 0===O?void 0:O["".concat(f.user)]}}var v},[O,r.client]);var lt=function(e){var t=null===O||void 0===O?void 0:O["".concat(f.user)].find(function(t){var n,a;return(null===t||void 0===t||null===(n=t.admin)||void 0===n||null===(a=n.profile)||void 0===a?void 0:a.workerSid)===e});return(null===t||void 0===t?void 0:t.fullName)||e},st=function(e){null===h||void 0===h||h.connectionId;var t={userId:null===h||void 0===h?void 0:h.userId,serviceId:null===p||void 0===p?void 0:p.userServiceId,status:e};g(It({requestData:t,callback:function(e){var t;q(null!==(t=null===e||void 0===e?void 0:e.status)&&void 0!==t?t:"grey")}}))},rt=function(){var e,t;I.current&&I.current.disconnect();var n=Object(d.a)(Object(d.a)({},_),{},{dispatcherId:null===D||void 0===D||null===(e=D.admin)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.workerSid});g(xt({requestData:n,callback:function(e){}})),null===He||void 0===He||He.map(function(e,t){var n,a,i,c,o,l;r.publishToEvent(m.PublishPageTopics,(o=null===_||void 0===_?void 0:_.callSid,l=null===e||void 0===e||null===(n=e.admin)||void 0===n||null===(a=n.profile)||void 0===a?void 0:a.workerSid,"".concat("beamdevlive","/service/twilio/user/").concat(l,"/taskCompleted/").concat(o)),Dn({reservation:_,workerSid:null===D||void 0===D||null===(i=D.admin)||void 0===i||null===(c=i.profile)||void 0===c?void 0:c.workerSid}))}),Q(!1),Y(!1),oe(!1),ze.current=!1,Qe.current=!1,Wd&&clearTimeout(Wd),function(e){console.log("validate current user task");var t=null===h||void 0===h?void 0:h.connectionId;r.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Pe(e,"$","$..admin"),wn(t),null===p||void 0===p?void 0:p.userServiceId)}(null===D||void 0===D?void 0:D.id)},dt=function(e,t){var n,a,i,c=null===(n=I.current)||void 0===n||null===(a=n.parameters)||void 0===a||null===(i=a.CallSid)||void 0===i?void 0:i.toString();if(c&&c.startsWith("CA")){var o,l;Y({phoneNumber:e,callSid:c,outgoing:!0});var s={callSid:c,workerSid:null===D||void 0===D||null===(o=D.admin)||void 0===o||null===(l=o.profile)||void 0===l?void 0:l.workerSid,phoneNumber:e,workflowId:t,userServiceId:null===p||void 0===p?void 0:p.userServiceId};g(Tt({requestData:s,callback:function(e){}}))}else Wd&&clearTimeout(Wd),Wd=setTimeout(function(){dt(e,t)},1e3)},ut=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(n=t.output.activeCallerPhoneNumber,!ze.current){e.n=1;break}return e.a(2);case 1:return e.n=2,x.current.connect({params:{To:n,ServiceId:null===p||void 0===p?void 0:p.userServiceId}});case 2:I.current=e.v,null===re||void 0===re||re.pause(),Y({phoneNumber:n,outgoing:!0}),Q(!0),Qe.current=!0,Hd&&clearTimeout(Hd),null!==t&&void 0!==t&&t.objectId&&dt(n,null===t||void 0===t||null===(a=t.objectId)||void 0===a?void 0:a.toString());case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),vt=Object(oa.jsxs)("ul",{className:"user-dropdown",children:[Object(oa.jsxs)("li",{onClick:function(){st("green")},children:[Object(oa.jsx)("div",{className:"status-badge green"}),Object(oa.jsx)("span",{className:"ml-4",children:"Online"})]}),Object(oa.jsxs)("li",{onClick:function(){st("amber")},children:[Object(oa.jsx)("div",{className:"status-badge orange"}),Object(oa.jsx)("span",{className:"ml-4",children:"Away"})]}),Object(oa.jsxs)("li",{onClick:function(){st("red")},children:[Object(oa.jsx)("div",{className:"status-badge red"}),Object(oa.jsx)("span",{className:"ml-4",children:"Busy"})]}),Object(oa.jsxs)("li",{onClick:function(){st("grey")},children:[Object(oa.jsx)("div",{className:"status-badge grey"}),Object(oa.jsx)("span",{className:"ml-4",children:"Offline"})]})]});return Object(oa.jsxs)($n.a,{title:"",visible:!0,width:"100%",className:"beam-modal analytics-summary-modal",footer:[],destroyOnClose:!0,children:[Object(oa.jsxs)(v.a,{className:"main-layout exec-layout",children:[Object(oa.jsxs)("div",{className:"header-panel mr-4",style:{justifyContent:"start"},children:[Object(oa.jsx)(fa.a,{src:"/images/logo-icon.svg",className:"logo-icon"}),Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)(ni.a,{overlay:vt,placement:"bottomRight",trigger:["click"],children:Object(oa.jsxs)("div",{className:"user-avatar d-flex",children:[Object(oa.jsx)("img",{width:"40",src:"/images/users/user.png",alt:""}),Object(oa.jsx)("p",{className:"mx-2",children:null!==(t=null===D||void 0===D?void 0:D.fullName)&&void 0!==t?t:""}),Object(oa.jsx)("div",{className:"status-badge ".concat(U," position-absolute")}),Object(oa.jsx)(aa.a,{style:{fontSize:14}})]})})})]}),Object(oa.jsxs)(Yn.a,{gutter:30,children:[Object(oa.jsx)(Hn.a,{className:"gutter-row card-max-height",sm:24,md:8,children:Object(oa.jsx)(Cc.a,{className:"filter-card",children:Object(oa.jsx)(Yn.a,{className:"mt-3",children:null===He||void 0===He?void 0:He.map(function(e,t){return Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Cd,{onClick:function(){},avatar:"/images/users/user.png",userObj:e})})})})})}),Object(oa.jsx)(Hn.a,{className:"gutter-row card-max-height",sm:24,md:_?8:16,children:Object(oa.jsxs)(Cc.a,{className:"filter-card main-card",children:[Object(oa.jsxs)(Yn.a,{className:"mt-3 w-100 d-fles",style:{justifyContent:"space-between"},children:[Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn cover call-btn",style:{minWidth:40,minHeight:40},onClick:function(){Re(!0)},children:Object(oa.jsx)(fa.a,{src:"/images/call-icon.svg"})}),Object(oa.jsxs)("div",{children:[Object(oa.jsx)(du,{className:"mr-3",onChange:function(e){it.current=e}}),Object(oa.jsx)(Vn.a,{className:"beam-btn",style:{minWidth:40},loading:nt,onClick:function(){!function(){var e,t,n,a,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"task.complete";if(it.current){var c=null===(e=it.current)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.toDate(),o=null===(n=it.current)||void 0===n||null===(a=n[1])||void 0===a?void 0:a.toDate();c.setHours(0,0,0),o.setHours(24,0,0),su[0].content=[],at(!0);var l={select:{index:{searchIndex:"".concat("beamdevlive",":workflow:startedAt"),searchQuery:"@configId:{".concat("10278","}")},load:{objectId:"$.objectId",output:"$.dataset.output",startedAt:"$.flow.startedAt",status:"$.dataset.output.callStatus"}},sortBy:{properties:[{field:"@startedAt",order:"DESC"}],max:1e5},filter:{expression:"exists(@status) && @status == '".concat(i,"' && exists(@startedAt) && @startedAt > ").concat(c.getTime()," &&  @startedAt < ").concat(o.getTime())}};g(et({requestData:l,callback:function(e){at(!1);var t,n=Object(k.a)(e);try{for(n.s();!(t=n.n()).done;){var a,i=t.value;i.output.activeDispatcherId&&""!==i.output.activeDispatcherId&&su[0].content.push({timestamp:new Date(i.output.activeCallTimestamp).toLocaleString(),from:i.output.activeCallerPhoneNumber,type:i.output.callType,calltaker:null!==(a=lt(i.output.activeDispatcherId))&&void 0!==a?a:"",duration:i.output.callDuration})}}catch(c){n.e(c)}finally{n.f()}lu(su,ru)}}))}}()},children:Object(oa.jsx)(Qd.a,{})})]})]}),Object(oa.jsxs)(Yn.a,{className:"mt-3 w-100",children:[Object(oa.jsxs)(Yn.a,{gutter:16,className:"d-flex px-1 flex-wrap w-100",children:[Object(oa.jsx)(Hn.a,{sm:4,children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)(Hn.a,{sm:5,onClick:function(){w("in-queue"),E.current="in-queue",ot("task.created")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("in-queue"===T?"green-btn cover":""),children:"In Queue"})}),Object(oa.jsx)(Hn.a,{sm:5,onClick:function(){w("completed"),E.current="completed",ot("task.complete")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("completed"===T?"green-btn cover":""),children:"Completed"})}),Object(oa.jsx)(Hn.a,{sm:5,onClick:function(){w("missed"),E.current="missed",ot("task.no-answer")},children:Object(oa.jsxs)(Vn.a,{className:"beam-btn w-70 ".concat("missed"===T?"green-btn cover":""),children:["Missed",Fe&&Object(oa.jsx)("div",{className:"status-badge red position-absolute"})]})})]}),Object(oa.jsx)(Yn.a,{className:"custom-table mt-4 w-100",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsxs)(Yn.a,{className:"header",children:[Object(oa.jsx)(Hn.a,{span:4,children:"Time"}),Object(oa.jsx)(Hn.a,{span:3,children:"Call type"}),Object(oa.jsx)(Hn.a,{span:4,children:"Caller phone"}),Object(oa.jsx)(Hn.a,{span:3,children:"Call duration"}),Object(oa.jsx)(Hn.a,{span:3,children:"Status"}),Object(oa.jsx)(Hn.a,{span:3,children:"Call taker"}),Object(oa.jsx)(Hn.a,{span:4,children:"Action"})]}),null===Oe||void 0===Oe?void 0:Oe.map(function(e,t){var n,a,c;return Object(oa.jsxs)(Yn.a,{className:"table-row",style:{alignItems:"baseline"},children:[Object(oa.jsx)(Hn.a,{span:4,children:new Date(e.output.activeCallTimestamp).toLocaleString()}),Object(oa.jsx)(Hn.a,{span:3,children:null!==(n=e.output.callType)&&void 0!==n?n:"N/A"}),Object(oa.jsx)(Hn.a,{span:4,children:e.output.activeCallerPhoneNumber}),Object(oa.jsx)(Hn.a,{span:3,children:null!==(a=null===e||void 0===e||null===(c=e.output)||void 0===c?void 0:c.callDuration)&&void 0!==a?a:"N/A"}),Object(oa.jsx)(Hn.a,{span:3,children:e.status}),Object(oa.jsx)(Hn.a,{span:3,children:e.output.activeDispatcherId?lt(e.output.activeDispatcherId):"N/A"}),Object(oa.jsxs)(Hn.a,{span:3,children:["missed"===T&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Vn.a,{className:"beam-btn cover mr-2",style:{minWidth:50,minHeight:50},onClick:function(){!function(e){var t,n,a=null===h||void 0===h?void 0:h.connectionId,i=Object(C.a)(he.current),c=i.findIndex(function(t){return t.objectId.toString()===e});-1!==c&&(i.splice(c,1),fe(i),he.current=i),r.publishToEvent(m.PublishPageTopics,function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/twilio/completeCall")}(a),Dn({workerSid:null===D||void 0===D||null===(t=D.admin)||void 0===t||null===(n=t.profile)||void 0===n?void 0:n.workerSid,workflowId:e,serviceId:null===p||void 0===p?void 0:p.userServiceId}))}(e.objectId.toString())},children:Object(oa.jsx)(Gd.a,{color:"#40CC52"})}),Object(oa.jsx)(Vn.a,{className:"beam-btn green1-btn cover m-auto",style:{minWidth:50,minHeight:50},onClick:function(){ut(e)},children:Object(oa.jsx)(Jd.a,{})})]}),"completed"===T&&e.output.pageId&&Object(oa.jsx)(Vn.a,{className:"beam-btn cover mr-2",style:{minWidth:50,minHeight:50},onClick:function(){window.open("".concat("https://live.staging.beam.live","/page/").concat(e.output.pageId),"_blank")},children:Object(oa.jsx)(wc.a,{color:"#40CC52"})})]})]})})]})})]})]})}),_&&Object(oa.jsx)(Hn.a,{className:"gutter-row card-max-height",sm:24,md:8,children:Object(oa.jsx)(Cc.a,{className:"filter-card",children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{sm:24,className:"d-flex flex-row justify-content-end",children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover",style:{minWidth:40,minHeight:40},onClick:function(){var e,t;r.publishToEvent(m.PublishPageTopics,En(null===D||void 0===D?void 0:D.id),Dn({reservation:_,workerSid:null===D||void 0===D||null===(e=D.admin)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.workerSid}))},children:Object(oa.jsx)(Kd.a,{color:"#40CC52"})})}),Object(oa.jsxs)(Hn.a,{sm:24,className:"mt-3 d-flex flex-column justify-content-space-between",style:{height:"67vh"},children:[!K&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)("div",{className:"text-center",children:[Object(oa.jsx)("h2",{children:null!==_&&void 0!==_&&_.outgoing?"Outgoing call":"Incoming Call"}),Object(oa.jsx)("h4",{children:null!==(n=null===_||void 0===_?void 0:_.phoneNumber)&&void 0!==n?n:""}),V&&Object(oa.jsx)("h4",{children:Object(oa.jsx)(ou,{})})]}),Object(oa.jsx)("img",{src:"https://cdn3.iconfinder.com/data/icons/avatar-set-2/512/Avata_09-512.png",height:200,width:200,alt:""}),V?Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)(Yn.a,{className:"d-center mt-3 w-100",style:{width:"100%"},children:[Object(oa.jsx)(Hn.a,{span:6,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn m-auto",style:{minWidth:50,minHeight:50},onClick:function(){Z(!0)},children:Object(oa.jsx)(Zd.a,{})})}),Object(oa.jsx)(Hn.a,{span:6,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn cover m-auto",style:{minWidth:50,minHeight:50},onClick:function(){rt()},children:Object(oa.jsx)(Jd.a,{})})}),Object(oa.jsx)(Hn.a,{span:6,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn m-auto",style:{minWidth:50,minHeight:50},onClick:function(){!function(e){var t,n={taskSid:null===_||void 0===_||null===(t=_.twilioReservation)||void 0===t?void 0:t.taskSid,hold:e,outgoing:Qe.current,callSid:null===_||void 0===_?void 0:_.callSid,userServiceId:null===p||void 0===p?void 0:p.userServiceId};g(Nt({requestData:n,callback:function(e){}})),oe(e)}(!ce)},children:ce?Object(oa.jsx)(Xl.a,{}):Object(oa.jsx)(es.a,{})})}),Object(oa.jsx)(Hn.a,{span:6,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn m-auto",style:{minWidth:50,minHeight:50},onClick:function(){var e;ne(!te),null===(e=I.current)||void 0===e||e.mute(!te)},children:te?Object(oa.jsx)(Xd.a,{}):Object(oa.jsx)(eu.a,{})})})]})}):Object(oa.jsxs)(Yn.a,{className:"d-center mt-3 w-100",style:{width:"100%"},children:[Object(oa.jsx)(Hn.a,{span:8,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green1-btn cover m-auto",style:{minWidth:50,minHeight:50},loading:Ke,onClick:function(){!function(){var e,t,n,a,i=Object(d.a)(Object(d.a)({},_),{},{dispatcherId:null===D||void 0===D||null===(e=D.admin)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.workerSid});g(ht({requestData:i,callback:function(e){}})),r.publishToEvent(m.PublishPageTopics,En(null===D||void 0===D?void 0:D.id),Dn({reservation:_,workerSid:null===D||void 0===D||null===(n=D.admin)||void 0===n||null===(a=n.profile)||void 0===a?void 0:a.workerSid})),Ze(!0),setTimeout(function(){ze.current||Ze(!1)},5e3),null===re||void 0===re||re.pause(),Hd&&clearTimeout(Hd)}()},children:Object(oa.jsx)(Jd.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex"}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn cover m-auto",style:{minWidth:50,minHeight:50},onClick:function(){!function(){var e,t,n=Object(d.a)(Object(d.a)({},_),{},{dispatcherId:null===D||void 0===D||null===(e=D.admin)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.workerSid});g(gt({requestData:n,callback:function(e){}})),Y(!1),null===re||void 0===re||re.pause(),Hd&&clearTimeout(Hd)}()},children:Object(oa.jsx)(Jd.a,{})})})]})]}),K&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"d-flex mt-1 mb-4",children:Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("h2",{children:"Add participant"})})}),Object(oa.jsx)(Yn.a,{className:"d-flex mt-4 w-100",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Wn.a,{className:"beam-input",value:Me,onChange:function(e){null===e.target.value.match(/^[0-9+]+$/)&&""!==e.target.value||Le(e.target.value)}})})}),Object(oa.jsx)(Yn.a,{className:"d-flex mt-4 w-100",children:$.a.times(9,function(e){return Object(oa.jsx)(Hn.a,{span:8,className:"d-flex mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn m-auto mb-4",style:{minWidth:50,minHeight:50},onClick:function(){return Ve(e+1)},children:e+1},e)})})}),Object(oa.jsxs)(Yn.a,{className:"d-flex w-100",children:[Object(oa.jsx)(Hn.a,{span:8,className:"d-flex mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn m-auto mb-4",onClick:function(){return Ve("+")},style:{minWidth:50,minHeight:50},children:"+"})}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn m-auto mb-4",style:{minWidth:50,minHeight:50},onClick:function(){return Ve("0")},children:"0"})}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn m-auto mb-4",style:{minWidth:50,minHeight:50},onClick:function(){return Ve("#")},children:"#"})})]}),Object(oa.jsxs)(Yn.a,{className:"d-center mt-3 w-100",children:[Object(oa.jsx)(Hn.a,{span:8,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn m-auto",style:{minWidth:50,minHeight:50},onClick:function(){Z(!1),Le("")},children:Object(oa.jsx)(pa.a,{})})}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn round-btn cover green-btn call-btn m-auto",style:{minWidth:50,minHeight:50},onClick:function(){!function(){var e,t=Me;-1===t.indexOf("+")&&(t="+1"+t);var n={taskSid:null===_||void 0===_||null===(e=_.twilioReservation)||void 0===e?void 0:e.taskSid,to:t,outgoing:Qe.current,callSid:null===_||void 0===_?void 0:_.callSid,userServiceId:null===p||void 0===p?void 0:p.userServiceId};g(kt({requestData:n,callback:function(e){}})),Z(!1),Le("")}()},children:Object(oa.jsx)(fa.a,{src:"/images/call-icon.svg"})})}),Object(oa.jsx)(Hn.a,{span:8,className:"d-flex",children:Object(oa.jsx)(Vn.a,{className:"beam-btn m-auto",style:{minWidth:50,minHeight:50},onClick:function(){return Ve(null)},children:Object(oa.jsx)(Eo.a,{})})})]})]})]})]})})})]})]}),ye&&Object(oa.jsx)(nu,{socket:r,onClose:function(){Ie(!1)},workerSid:null===D||void 0===D||null===(c=D.admin)||void 0===c||null===(o=c.profile)||void 0===o?void 0:o.workerSid}),ke&&Object(oa.jsx)(au,{message:"Are you sure you want to continue?",onClose:function(){Te(!1)}}),Ee&&Object(oa.jsx)(iu,{phoneNumber:Me,setPhoneNumber:Le,handleChange:Ve,onClose:function(){Re(!1)},callOutgoing:ut})]})},vu=n(549),bu=(n(140),Za.a.Panel,function(e){e.lastSetupIntent;var t=e.onClose,n=(e.onAdd,Object(s.b)(),Object(a.useState)(!0)),i=Object(u.a)(n,2),c=i[0],o=(i[1],Object(a.useState)(!1)),l=Object(u.a)(o,2),r=l[0],d=l[1],v=Object(b.useStripe)(),j=Object(b.useElements)(),m=function(){t&&t()},p=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),v&&j){e.n=1;break}return e.a(2);case 1:return d(!0),e.n=2,v.confirmSetup({elements:j,confirmParams:{return_url:window.location.href}});case 2:n=e.v,(a=n.error)&&(console.log("error message",a.message),d(!1),Lt(a.message,"error","TOP_CENTER",3e3));case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return Object(oa.jsx)($n.a,{title:"New card",visible:c,onOk:function(){t&&t()},onCancel:m,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)("form",{onSubmit:p,children:[Object(oa.jsx)("div",{className:"mt-2",style:{height:500},children:Object(oa.jsx)(b.PaymentElement,{})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:r,children:"Save"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:m,children:"Cancel"})})]})]})})}),ju={$:"USD","\xa3":"GBP","\u20ac":"EUR"},mu=function(e){var t,n,c,o,l,r,v,p,O,f,h=e.onClose,g=e.socket,x=e.pay,y=e.disableClose,I=Object(s.b)(),S=Object(a.useState)(!0),N=Object(u.a)(S,2),k=N[0],T=N[1],C=Object(a.useState)(!1),w=Object(u.a)(C,2),E=w[0],R=w[1],P=Object(s.c)(function(e){return e.auth}),D=P.userInfo,A=P.project,M=P.projects,L=Object(a.useRef)(),U=Object(a.useState)(void 0),q=Object(u.a)(U,2),F=q[0],B=q[1],_=Object(a.useState)(),$=Object(u.a)(_,2),Y=$[0],H=$[1],W=Object(a.useState)(!1),V=Object(u.a)(W,2),z=V[0],Q=V[1],G=Object(a.useState)(),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)(void 0),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(void 0),ie=Object(u.a)(ae,2),ce=ie[0],oe=ie[1],le=Object(a.useState)(),se=Object(u.a)(le,2),re=se[0],de=se[1],ue=Object(j.a)("pk_live_51MyyRYCFnkD3M6HjXbfzl6NpmEK2rc0RZzyiIhfD3A65zcqf7oEkszPqn8m8qykKN8dqxTeEURAhWhq1ACjmvytL00k1LMsAxw");Object(a.useEffect)(function(){console.log({project:A,projects:M})},[A,M]),Object(a.useEffect)(function(){if(A){var e,t=null===M||void 0===M||null===(e=M.projects)||void 0===e?void 0:e.find(function(e){return e.id===A});console.log("selected project",t),oe(null===t||void 0===t?void 0:t.payment)}},[A]),Object(a.useEffect)(function(){var e,t,n,a;(je(),ve(),console.log("user info",D),g.subscribeToEvent(m.SubscribePageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/service/dps/createRecurringPaymentSchedule/reply"),function(e){var t;Q(!1);var n,a=null===(t=JSON.parse(e.message))||void 0===t?void 0:t.response;null!==a&&void 0!==a&&a.status?(de(void 0),Lt("Payment subscription successfull","success","TOP_CENTER",1e3)):Lt(null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.details,"error","TOP_CENTER",3e3);I(vt())}),g.subscribeToEvent(m.SubscribePageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/service/dps/cancelRecurringPayment/reply"),function(e){Q(!1),Lt("Payment subscription cancelled","success","TOP_CENTER",1e3),I(vt())}),null!==D&&void 0!==D&&null!==(e=D.stripe)&&void 0!==e&&e.subscription)&&(ne(Object(d.a)({},null===D||void 0===D||null===(t=D.stripe)||void 0===t?void 0:t.subscription)),de(null===D||void 0===D||null===(n=D.stripe)||void 0===n||null===(a=n.subscription)||void 0===a?void 0:a.expiresAt));console.log("payment options",M),oe(null===M||void 0===M?void 0:M.paymentSettings)},[]);var ve=function(){Oe({userId:localStorage.getItem("RID"),cudbServiceId:localStorage.getItem("coachServiceId"),op:"retrieveSetupIntent"},function(e){var t,n;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.lastSetupIntentId?Z(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.response):be()})},be=function(){Oe({userId:localStorage.getItem("RID"),cudbServiceId:localStorage.getItem("coachServiceId"),op:"getSetupIntent"},function(e){var t,n,a;console.log("get setupIntent workflow response",e),Z(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.response),me(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.response)||void 0===a?void 0:a.id),console.log("=============",{userInfo:D})})},je=function(){Oe({userId:localStorage.getItem("RID"),cudbServiceId:localStorage.getItem("coachServiceId"),op:"listPaymentMethods"},function(e){var t,n;console.log("list payment methods workflow response",e);var a=(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.response)||void 0===n?void 0:n.data)||[],i=[];a.map(function(e){var t,n,a,c;i.push({id:e.id,type:null===e||void 0===e||null===(t=e.card)||void 0===t||null===(n=t.brand)||void 0===n?void 0:n.toLowerCase(),last4:null===e||void 0===e||null===(a=e.card)||void 0===a?void 0:a.last4,expiry:null===e||void 0===e||null===(c=e.card)||void 0===c?void 0:c.exp_year})}),H(i)})},me=function(e){I(dt(Object(d.a)(Object(d.a)({},D),{},{lastSetupIntentId:e,silentRequest:!0})))},pe=function(e,t){Q(!0);var n=Dn({userId:localStorage.getItem("RID"),timestamp:(new Date).getTime(),amount:t,scheduleType:e,userServiceId:localStorage.getItem("coachServiceId")||"cudb-live"});g.publishToEvent(m.PublishPageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/service/dps/createRecurringPaymentSchedule"),n)},Oe=function(e,t){var n={changes:[],configId:"10241",request:Object(d.a)({},e),timeout:1e4};I(lt({request:n,callback:function(e){t&&t(e)}}))},fe=function(){Q(!0),function(e){var t,n,a,i=Dn({request:{op:"charge",charge:null===x||void 0===x||null===(t=x.data)||void 0===t?void 0:t.amount,currency:ju[null===x||void 0===x||null===(n=x.data)||void 0===n?void 0:n.currency],customerId:D.stripeCustomerId,source:F,description:null===x||void 0===x||null===(a=x.data)||void 0===a?void 0:a.description}});g.publishToEvent(m.PublishPageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/workflow/").concat(e,"/requestWorkflow"),i)}(L.current)};return Object(oa.jsxs)($n.a,{title:x?"Select card":"Saved card",visible:y||k,onOk:fe,onCancel:function(){T(!1),h&&h()},width:"480px",className:"beam-modal payment-layout",footer:[],destroyOnClose:!0,closable:!y,wrapClassName:y?"payment-modal-wrap":"",mask:!y,children:[Object(oa.jsxs)(Yn.a,{children:[null===Y||void 0===Y?void 0:Y.map(function(e,t){return Object(oa.jsxs)("div",{className:"credit-card ".concat(e.type," ").concat(F===e.id?"selected":"selectable"),onClick:function(){x&&B(e.id)},children:[Object(oa.jsx)("div",{className:"credit-card-last4",children:e.last4}),Object(oa.jsx)("div",{className:"credit-card-expiry",children:e.expiry}),Object(oa.jsx)("div",{className:"delete",children:Object(oa.jsx)(na.a,{onClick:function(t){var n;t.preventDefault(),t.stopPropagation(),1==window.confirm("Are you sure you want to delete payment method?")&&(n=e.id,Oe({userId:localStorage.getItem("RID"),cudbServiceId:localStorage.getItem("coachServiceId"),op:"detachPaymentMethod",paymentMethodId:n},function(e){console.log("deattach response",e),je(),be(),Lt("Payment method deleted successfully","success","TOP_CENTER",1e3)}))}})})]})}),K&&Y&&0===Y.length&&Object(oa.jsx)("div",{className:"credit-card new selectable",onClick:function(){R(!0)},children:Object(oa.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Object(oa.jsx)(fa.a,{src:"/images/plus-icon.svg"}),Object(oa.jsx)("h4",{className:"mt-3",children:"Add new card"})]})})]}),x&&Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:fe,disabled:!F,loading:z,children:"Charge"})})}),E&&Object(oa.jsx)(b.Elements,{stripe:ue,options:{clientSecret:K.client_secret},children:Object(oa.jsx)(bu,{lastSetupIntent:K,onClose:function(){return R(!1)},onAdd:function(e){}})}),!y&&Object(oa.jsxs)(i.a.Fragment,{children:["recurring"===(null===ce||void 0===ce?void 0:ce.type)&&Object(oa.jsxs)("div",{className:"mt-3",children:[Object(oa.jsx)("h5",{children:"Choose your plan"}),re&&Object(oa.jsxs)("p",{children:["Expires on: ",null===(t=new Date(re))||void 0===t?void 0:t.toLocaleDateString()]}),null===ce||void 0===ce||null===(n=ce.info)||void 0===n||null===(c=n.recurringDetails)||void 0===c?void 0:c.map(function(e){return Object(oa.jsxs)(Yn.a,{className:"person-item d-flex mt-2",style:{border:"2px solid ".concat((null===te||void 0===te?void 0:te.scheduleType)===e.billingCycle?"#40CC52":"#d9d9d9"),cursor:"pointer",boxShadow:"0px 0px 15px 0px rgba(223, 229, 238, 1)"},onClick:function(){ne({scheduleType:e.billingCycle,amount:e.amount})},children:[Object(oa.jsxs)(Hn.a,{span:14,children:[Object(oa.jsx)("h5",{children:e.name}),Object(oa.jsxs)("p",{children:["$ ",e.amount,"/",e.billingCycle]})]}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",checked:(null===te||void 0===te?void 0:te.scheduleType)===e.billingCycle})})]})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:null===D||void 0===D||null===(o=D.stripe)||void 0===o||null===(l=o.subscription)||void 0===l||null===(r=l.schedule)||void 0===r||!r.id||re&&re<(new Date).getTime()?Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){pe(null===te||void 0===te?void 0:te.scheduleType,null===te||void 0===te?void 0:te.amount)},loading:z,children:"Subscribe"}):Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn cover w-full",onClick:function(){!function(){Q(!0);var e=Dn({userId:localStorage.getItem("RID")});g.publishToEvent(m.PublishPageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/service/dps/cancelRecurringPayment"),e)}()},loading:z,children:"Cancel subscription"})})})]}),"fixed"===(null===ce||void 0===ce?void 0:ce.type)&&Object(oa.jsxs)("div",{className:"mt-3",children:[Object(oa.jsx)("h5",{children:"Fixed plan"}),Object(oa.jsxs)(Yn.a,{className:"person-item d-flex mt-2",style:{border:"2px solid ".concat((null===te||void 0===te?void 0:te.scheduleType)===(null===ce||void 0===ce?void 0:ce.type)?"#40CC52":"#d9d9d9"),cursor:"pointer",boxShadow:"0px 0px 15px 0px rgba(223, 229, 238, 1)"},onClick:function(){var e;ne({scheduleType:null===ce||void 0===ce?void 0:ce.type,amount:null===ce||void 0===ce||null===(e=ce.info)||void 0===e?void 0:e.amount})},children:[Object(oa.jsxs)(Hn.a,{span:14,children:[Object(oa.jsx)("h5",{children:null===ce||void 0===ce||null===(v=ce.info)||void 0===v?void 0:v.name}),Object(oa.jsxs)("p",{children:["$ ",null===ce||void 0===ce||null===(p=ce.info)||void 0===p?void 0:p.amount]})]}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",checked:(null===te||void 0===te?void 0:te.scheduleType)===(null===ce||void 0===ce?void 0:ce.type)})})]}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:!(null!==D&&void 0!==D&&null!==(O=D.stripe)&&void 0!==O&&null!==(f=O.subscription)&&void 0!==f&&f.expiresAt)&&Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){pe(null===te||void 0===te?void 0:te.scheduleType,null===te||void 0===te?void 0:te.amount)},loading:z,children:"Pay"})})})]})]})]})};n(981);var pu=function(e){e.socket;var t=e.disableClose,n=e.onClose,i=Object(s.b)(),c=Object(l.f)(),o=Object(a.useState)(""),r=Object(u.a)(o,2),d=(r[0],r[1],Object(a.useState)(!0)),v=Object(u.a)(d,2),b=(v[0],v[1],ei.a.useForm()),j=Object(u.a)(b,1)[0],m=Object(s.c)(function(e){return e.auth}),p=m.loginSuccessfull,O=m.registrationSuccess,f=m.registeredEmail,h=m.isLoading,g=(m.decryptedToken,Object(l.g)().search);return Object(a.useEffect)(function(){var e=new URLSearchParams(g).get("serviceId");e&&localStorage.setItem("serviceId",e||"cudb-live")},[]),Object(a.useEffect)(function(){O&&f&&i({type:D})},[O]),Object(a.useEffect)(function(){if(p){var e=new URLSearchParams(g).get("redirect");e&&""!==e?c.push("/".concat(e)):c.push("/coach")}},[p]),Object(oa.jsx)($n.a,{visible:!0,onOk:function(){},onCancel:function(){n(!0)},width:"480px",className:"auth-layout",footer:null,destroyOnClose:!0,closable:!t,maskClosable:!t,children:Object(oa.jsxs)(ei.a,{className:"auth-form",form:j,onFinish:function(e){var t,n={email:null===e||void 0===e||null===(t=e.username)||void 0===t?void 0:t.toLowerCase(),password:e.pin+"",phoneNumber:"+923123322112"};i(ve(n))},onFinishFailed:function(e){console.log("Failed:",e)},layout:"vertical",children:[Object(oa.jsx)("h3",{children:"Sign in"}),Object(oa.jsx)("p",{children:"Please enter your data here"}),Object(oa.jsx)(ei.a.Item,{name:"username",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:"Phone or email"})}),Object(oa.jsx)(ei.a.Item,{name:"pin",className:"pin-input",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a.Password,{placeholder:"5-Digit Security PIN"})}),Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"btn",loading:h,type:"primary",htmlType:"submit",children:"Sign in"})}),Object(oa.jsx)(ei.a.Item,{className:"mb-0",children:Object(oa.jsxs)("p",{className:"option-text",children:["New to Beam? ",Object(oa.jsx)(ud.b,{to:"/auth/register",children:"Sign Up"})]})})]})})},Ou=(n(982),function(e){e.socket;var t=e.disableClose,n=e.onClose,i=Object(a.useState)(""),c=Object(u.a)(i,2),o=c[0],r=c[1],d=ei.a.useForm(),v=Object(u.a)(d,1)[0],b=(Object(l.f)(),Object(s.b)()),j=Object(s.c)(function(e){return e.auth}),m=j.registeredEmail,p=j.registeredPhone,O=j.registrationPayload,f=j.loginSuccessfull,h=j.isLoading;Object(a.useEffect)(function(){f&&b({type:L})},[f]);return Object(oa.jsx)($n.a,{visible:!0,onOk:function(){},onCancel:function(){n(!0)},width:"480px",className:"auth-layout",footer:null,destroyOnClose:!0,closable:!t,maskClosable:!t,children:Object(oa.jsx)("div",{className:"page-container auth-page",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"resend-form",id:"resend-form",layout:"vertical",form:v,onFinish:function(e){var t={registerRequest:!0,password:e.verificationCode,registrationPayload:O},n=m,a=p;n&&(t.email=n),a&&(t.phone=a,t.verificationCodePhone=e.verificationCodePhone);var i=localStorage.getItem("TYPE"),c=localStorage.getItem("CID");"nonBeamer"===i&&c?(console.log("here non beamer verification"),b(se(t))):b(le(t))},requiredMark:!1,children:[Object(oa.jsx)("h3",{children:"Verify Code"}),Object(oa.jsxs)("span",{children:["Please enter code you received on"," ",m&&Object(oa.jsx)("a",{href:"",onClick:function(e){return e.preventDefault()},children:m})]}),Object(oa.jsx)(ei.a.Item,{className:"mt-2",name:"verificationCode",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:p?"Email Verification Code":"Verification Code"})}),p&&Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsxs)("span",{children:["Please enter code you received on"," ",p&&Object(oa.jsx)("a",{href:"",onClick:function(e){return e.preventDefault()},children:p})]}),Object(oa.jsx)(ei.a.Item,{className:"mt-2",name:"verificationCodePhone",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:"Number Verification Code"})})]}),o&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:o})}),Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"btn",loading:h,type:"primary",htmlType:"submit",onClick:function(){return r("")},children:"Verify"})})]})})})});n(983);var fu=function(e){var t=e.socket,n=e.disableClose,i=e.onClose,c=Object(s.b)(),o=Mn().updateUserRequestPayloadV2,l=Object(a.useState)(""),r=Object(u.a)(l,2),d=r[0],v=r[1],b=ei.a.useForm(),j=Object(u.a)(b,1)[0],p=Object(s.c)(function(e){return e.auth}),O=(p.registrationSuccess,p.registeredEmail,p.isLoading),f=Object(a.useState)(!1),h=Object(u.a)(f,2),g=h[0],I=h[1],S=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n,a,i){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,c){var l=i.email,s=i.phone,r=i.beamIds,d=i.firstName,u=i.lastName,v=[];l&&(v.push({op:"add",path:"/persistent/static/live/alternativeIds/email",value:l}),v.push({op:"add",path:"/persistent/static/metadata/notificationChannels/emails",value:[l]})),s&&(v.push({updatedUserData:"add",path:"/persistent/static/live/alternativeIds/phone",value:s}),v.push({op:"add",path:"/persistent/static/metadata/notificationChannels/phones",value:[s]}));var b=localStorage.getItem("userType");if(b){var j="coach"===b?localStorage.getItem("coachRoleId"):localStorage.getItem("candidateRoleId");v.push({op:"add",path:"/persistent/static/coach/type",value:b}),v.push({op:"add",path:"/persistent/static/admin/profile/roleId",value:j}),localStorage.removeItem("userType"),localStorage.removeItem("coachRoleId"),localStorage.removeItem("candidateRoleId")}r&&v.push({op:"add",path:"/persistent/static/live/beamIds",value:[r]}),d&&v.push({op:"add",path:"/persistent/static/live/profile/firstName",value:d}),u&&v.push({op:"add",path:"/persistent/static/live/profile/lastName",value:u}),t.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,o(n,v),x.UpdateUserBio,a),t.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){e(t)})}))},e)}));return function(t,n,a){return e.apply(this,arguments)}}();return Object(oa.jsx)($n.a,{visible:!0,onOk:function(){},onCancel:function(){i(!0)},width:"480px",className:"auth-layout",footer:null,destroyOnClose:!0,closable:!n,maskClosable:!n,children:Object(oa.jsx)("div",{className:"page-container auth-page",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:j,onFinish:function(e){var t=e.email,n=e.pin,a=e.phone,o=e.firstname,l=e.lastname;if(v(""),t||a){var s={email:null===t||void 0===t?void 0:t.toLowerCase(),password:n,phoneNumber:a,firstName:o,lastName:l},r={email:null===s||void 0===s?void 0:s.email,phone:null===s||void 0===s?void 0:s.phone,beamIds:"".concat(null===s||void 0===s?void 0:s.firstName,".").concat(null===s||void 0===s?void 0:s.lastName),firstName:null===s||void 0===s?void 0:s.firstName,lastName:null===s||void 0===s?void 0:s.lastName};localStorage.getItem("TYPE"),localStorage.getItem("CID");localStorage.setItem("userType",j.getFieldValue("type"));var d=localStorage.getItem("coachServiceId")||"cudb-live",u=[];t&&u.push({email:null===s||void 0===s?void 0:s.email}),a&&u.push({phone:null===s||void 0===s?void 0:s.phoneNumber});var b,m,p={name:"registerUserByAdmin",changes:[],timeout:1e4,request:{data:{cudbServiceId:d,userIds:u,deviceIds:[{udid:Object(B.uuid)()}],authTypeParams:[{typeId:2,force1FR:!1,forceDeviceIndependent:!1,param:{password:n,useMultiOtp:!0,verificationChannels:u}}]}}};c({type:E}),b=p,m=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,o,l,s,u;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(null===t||void 0===t||null===(n=t.data)||void 0===n||null===(a=n[0])||void 0===a||!a.userId){e.n=3;break}return e.n=1,S(null===t||void 0===t||null===(o=t.data)||void 0===o||null===(l=o[0])||void 0===l?void 0:l.userId,d,r);case 1:if(c({type:A}),c({type:R}),"cudb-live"===d){e.n=2;break}return e.n=2,S(null===t||void 0===t||null===(s=t.data)||void 0===s||null===(u=s[0])||void 0===u?void 0:u.userId,"cudb-live",r);case 2:Lt("User registered successfully.","success","TOP_CENTER",2e3),i(!0),e.n=4;break;case 3:Lt("Something went wrong","error","TOP_CENTER",3e3);case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),c(st({request:b,callback:function(e){m&&m(e)}}))}else v("Either email or phone is required to complete registration")},requiredMark:!1,children:[Object(oa.jsx)("h3",{children:"Sign up"}),Object(oa.jsx)("p",{children:"Please enter your data here"}),Object(oa.jsx)(ei.a.Item,{name:"email",rules:[{type:"email",message:"The input is not a valid email!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n||t("phone")?Promise.resolve():Promise.reject(new Error("Either email or phone is required!"))}}}],children:Object(oa.jsx)(Wn.a,{type:"email",placeholder:"Email"})}),Object(oa.jsx)(ei.a.Item,{className:"mb-1",name:"phone",rules:[function(e){var t=e.getFieldValue;return{validator:function(e,n){return n||t("email")?Promise.resolve():Promise.reject(new Error("Either email or phone is required!"))}}}],children:Object(oa.jsx)(Fi.a,{placeholder:"Phone number",onChange:function(e){},style:{height:50}})}),Object(oa.jsx)(ei.a.Item,{name:"firstname",children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:"First name"})}),Object(oa.jsx)(ei.a.Item,{name:"lastname",children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:"Last name"})}),Object(oa.jsx)(ei.a.Item,{name:"organization",children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:"Organization"})}),Object(oa.jsx)(ei.a.Item,{className:"mb-1 pin-input",name:"pin",hasFeedback:!0,rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{type:"password",placeholder:"5-Digit Security PIN"})}),Object(oa.jsx)(ei.a.Item,{className:"mb-1 pin-input",name:"confirm-pin",dependencies:["pin"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your pin!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("pin")!==n?Promise.reject(new Error("The two pins that you entered do not match!")):Promise.resolve()}}}],children:Object(oa.jsx)(Wn.a,{type:"password",style:{width:"100%"},placeholder:"Confirm PIN"})}),Object(oa.jsx)(ei.a.Item,{name:"type",label:"Register as:",rules:[{required:!0,message:"Please select a user type!"}],children:Object(oa.jsxs)(yi.a.Group,{children:[Object(oa.jsx)(yi.a,{value:"candidate",children:"Candidate"}),Object(oa.jsx)(yi.a,{value:"coach",children:"Coach"})]})}),Object(oa.jsx)(ei.a.Item,{className:"mb-0",children:Object(oa.jsx)(Xn.a,{onChange:function(e){I(e.target.checked)},className:"w-100",children:Object(oa.jsxs)("p",{className:"option-text",children:["I accept the ",Object(oa.jsx)(ud.b,{to:"/privacy-policy",children:"Terms & conditions"})]})})}),d&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:d})}),Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"btn",loading:O,type:"primary",disabled:!g,htmlType:"submit",onClick:function(){return v("")},children:"Register"})}),Object(oa.jsxs)(ei.a.Item,{className:"mb-0",children:[Object(oa.jsxs)("p",{className:"option-text",children:["Already have an account? ",Object(oa.jsx)(ud.b,{to:"/auth/login",children:"Login"})]}),Object(oa.jsxs)("p",{className:"option-text",children:["Didn't get verification code?"," ",Object(oa.jsx)(ud.b,{to:"/auth/pin/resend",children:"Resend"})]})]})]})})})},hu=function(e){var t=e.isBio,n=e.onClose,i=Object(a.useState)(!0),c=Object(u.a)(i,2),o=c[0],l=c[1],r=Object(a.useState)([]),d=Object(u.a)(r,2),v=d[0],b=d[1],j=Object(a.useState)(),m=Object(u.a)(j,2),p=(m[0],m[1]),O=(Object(s.c)(function(e){return e.auth}).userBds,Object(a.useState)(!1)),f=Object(u.a)(O,2),h=f[0],g=f[1],x=(Object(s.c)(function(e){return e.auth}).fileToSend,Object(a.useRef)(0),Object(s.c)(function(e){return e.auth}).userInfo,function(){l(!1),n&&n()}),y=Object(s.b)(),I=function(){v.map(function(e){var n=new FormData;n.append("file",e),n.append("info",JSON.stringify({})),console.log("selected item",e),y(ye({form:n,isBio:t}))}),g(!0)};Object(a.useEffect)(function(){S()},[]);var S=function(){return new Promise(function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,n;p({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,long:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude})}):t("Geolocation is not supported by this browser.")})};return Object(a.useEffect)(function(){S()},[]),Object(oa.jsxs)($n.a,{title:"Upload a file",visible:o,onOk:I,onCancel:x,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:[Object(oa.jsx)(ma.a,{maxCount:10,multiple:!0,beforeUpload:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return b([].concat(Object(C.a)(v),Object(C.a)(n))),e.a(2,!1)},e)}));return function(t,n){return e.apply(this,arguments)}}(),children:Object(oa.jsx)("div",{children:"Drop your file here (or click)"})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:I,loading:h,disabled:0===v.length,children:"Upload"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:x,children:"Cancel"})})]})]})},gu=(n(984),n(1031)),xu=n(156),yu=n.n(xu),Iu=["image"],Su=xs.a.Title,Nu=xs.a.Text,ku=Gn.a.Option,Tu=Kl.a.TabPane,Cu=function(e){var t=e.onClose,n=e.socket,c=e.coach,o=e.onAdd,l=e.categoriesList,r=Object(a.useState)(!0),v=Object(u.a)(r,2),b=v[0],j=v[1],p=ei.a.useForm(),O=Object(u.a)(p,1)[0],f=Object(a.useState)(""),h=Object(u.a)(f,2),g=(h[0],h[1]),I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1],w=(Object(s.c)(function(e){return e.auth}).projects,Mn().updateUserRequestPayloadV2);Object(a.useEffect)(function(){var e,t,n,a,i,o,l,s,r,d,u,v,b,j;c?O.setFieldsValue({categories:null===c||void 0===c?void 0:c.categories,bio:(null===c||void 0===c?void 0:c.bio)||{title:"",education:"",experience:"",descriptionHeading:"",description:"",dailyRate:70,hourlyRate:20,link:"",image:{url:"",mediumId:""},location:{label:null===c||void 0===c||null===(e=c.bio)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.label,value:{description:null===c||void 0===c||null===(n=c.bio)||void 0===n||null===(a=n.location)||void 0===a||null===(i=a.attributes)||void 0===i?void 0:i.address,place_id:"",coordinates:null===c||void 0===c||null===(o=c.bio)||void 0===o||null===(l=o.location)||void 0===l?void 0:l.coordinates}}},location:{label:null===c||void 0===c||null===(s=c.bio)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.label,value:{description:null===c||void 0===c||null===(d=c.bio)||void 0===d||null===(u=d.location)||void 0===u||null===(v=u.attributes)||void 0===v?void 0:v.address,place_id:"",coordinates:null===c||void 0===c||null===(b=c.bio)||void 0===b||null===(j=b.location)||void 0===j?void 0:j.coordinates}},assignAvailability:null===c||void 0===c?void 0:c.assignAvailability}):O.setFieldsValue({categories:[{name:"",subcategories:[]}],bio:{title:"",education:"",experience:"",descriptionHeading:"",description:"",dailyRate:70,hourlyRate:20,link:"",image:{url:"",mediumId:""},location:{}},location:{},assignAvailability:{}})},[c]);var E=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return k(!0),n=localStorage.getItem("coachServiceId")||"",a=localStorage.getItem("RID")||"",e.n=1,R(a,n,{categories:null===t||void 0===t?void 0:t.categories,bio:null===t||void 0===t?void 0:t.bio,assignAvailability:null===t||void 0===t?void 0:t.assignAvailability});case 1:Lt("User updated successfully","success","TOP_CENTER",3e3),k(!1),o();case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,a,i){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,c){var o=i.categories,l=i.bio,s=i.assignAvailability,r=[];if(o&&r.push({op:"add",path:"/persistent/static/coach/categories",value:Object(C.a)(o)}),l){var u=l.image,v=Object(Ka.a)(l,Iu);r.push({op:"add",path:"/persistent/static/coach/bio",value:v}),r.push({op:"add",path:"/persistent/static/live/profile/profileImage/urls/original",value:Object(d.a)({},u)})}s&&r.push({op:"add",path:"/persistent/static/coach/assignAvailability",value:s}),n.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,w(t,r),x.UpdateUserBio,a),n.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){e(t)})}))},e)}));return function(t,n,a){return e.apply(this,arguments)}}(),P=function(e){var t=e.value,n=e.onChange,i=e.categoriesList,c=Object(a.useState)(t||[{name:"",subcategories:[],pricingPlans:[]}]),o=Object(u.a)(c,2),l=o[0],s=o[1],r=Object(a.useState)({}),v=Object(u.a)(r,2),b=v[0],j=v[1];Object(a.useEffect)(function(){t&&s(t)},[t]);var m=function(e,t){var a=Object(C.a)(l);a[e]={name:t,subcategories:[],pricingPlans:[]},s(a),n(a)},p=function(e,t,a){var i=Object(C.a)(l);a?i[e].subcategories.push(t):i[e].subcategories=i[e].subcategories.filter(function(e){return e!==t}),s(i),n(i)},O=function(e,t){var a=Object(C.a)(l);a[e].pricingPlans=t,s(a),n(a)};return Object(oa.jsxs)("div",{className:"categories-box",children:[Object(oa.jsx)(Su,{level:4,children:"Manage Categories and Subcategories"}),l.map(function(e,t){var a,c;return Object(oa.jsxs)("div",{className:"categories-container",style:{marginBottom:"16px"},children:[Object(oa.jsx)(Hn.a,{span:18,children:Object(oa.jsx)(Gn.a,{placeholder:"Select a category",value:e.name||void 0,onChange:function(e){return m(t,e)},style:{width:"100%",marginBottom:"8px"},children:i.map(function(e){return Object(oa.jsx)(ku,{value:e.name,children:e.name},e.name)})})}),Object(oa.jsx)(Hn.a,{span:4,className:"text-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full ml-1",type:"link",icon:Object(oa.jsx)(na.a,{}),onClick:function(){return function(e){var t=l.filter(function(t,n){return n!==e});s(t),n(t)}(t)}})}),Object(oa.jsxs)("div",{className:"categories-box subcategories-box",children:[Object(oa.jsx)(Su,{level:5,style:{marginTop:"8px"},children:"Subcategories"}),Object(oa.jsx)("div",{className:"categories-container",children:null===(a=i.find(function(t){return t.name===e.name}))||void 0===a?void 0:a.subcategories.map(function(n){return Object(oa.jsx)(yu.a,{checked:e.subcategories.includes(n),onChange:function(e){return p(t,n,e)},className:"subcategory-tag",children:n},n)})})]}),null===e||void 0===e||null===(c=e.pricingPlans)||void 0===c?void 0:c.map(function(a,i){return Object(oa.jsxs)(Yn.a,{className:"mb-4 plan-row w-100",children:[Object(oa.jsx)(Hn.a,{span:20,children:Object(oa.jsx)(ei.a.Item,{label:"Plan Title",rules:[{required:!0,message:"Plan title is required"}],children:Object(oa.jsx)(Wn.a,{placeholder:"Enter Plan Title (e.g., Basic)",value:a.title,onChange:function(n){return O(t,[].concat(Object(C.a)(e.pricingPlans.slice(0,i)),[Object(d.a)(Object(d.a)({},a),{},{title:n.target.value})],Object(C.a)(e.pricingPlans.slice(i+1))))},className:"category-input",style:{marginBottom:"8px",width:"100%"}})})}),Object(oa.jsx)(Hn.a,{span:4,className:"text-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full ml-1",type:"link",icon:Object(oa.jsx)(na.a,{}),onClick:function(){return function(e,t){var a=Object(C.a)(l);a[e].pricingPlans.splice(t,1),s(a),n(a)}(t,i)}})}),Object(oa.jsx)(Hn.a,{span:22,className:"mt-1",children:Object(oa.jsx)(ei.a.Item,{label:"Plan Price",rules:[{required:!0,message:"Plan price is required"}],children:Object(oa.jsx)(la,{placeholder:"Enter Plan Price",value:null===a||void 0===a?void 0:a.price,onChange:function(n){return O(t,[].concat(Object(C.a)(e.pricingPlans.slice(0,i)),[Object(d.a)(Object(d.a)({},a),{},{price:n})],Object(C.a)(e.pricingPlans.slice(i+1))))}})})}),Object(oa.jsx)(Hn.a,{span:22,className:"mt-1",children:Object(oa.jsxs)(ei.a.Item,{label:"Plan Features",children:[Object(oa.jsx)(Wn.a,{placeholder:"Add a feature and press Enter",value:b["".concat(t,"-").concat(i)]||"",onChange:function(e){return function(e,t,n){j(function(a){return Object(d.a)(Object(d.a)({},a),{},Object(T.a)({},"".concat(e,"-").concat(t),n))})}(t,i,e.target.value)},onPressEnter:function(e){e.preventDefault(),function(e,t){var a,i="".concat(e,"-").concat(t),c=null===(a=b[i])||void 0===a?void 0:a.trim();if(c){var o=Object(C.a)(l);o[e].pricingPlans[t].features.push(c),s(o),n(o),j(function(e){return Object(d.a)(Object(d.a)({},e),{},Object(T.a)({},i,""))})}}(t,i)},className:"category-input",style:{marginBottom:"8px",width:"100%"}}),Object(oa.jsx)(zn.b,{className:"list",dataSource:a.features,renderItem:function(n,c){return Object(oa.jsx)(zn.b.Item,{className:"feature-item",actions:[Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn w-full",type:"link",icon:Object(oa.jsx)(na.a,{}),onClick:function(){return O(t,[].concat(Object(C.a)(e.pricingPlans.slice(0,i)),[Object(d.a)(Object(d.a)({},a),{},{features:a.features.filter(function(e,t){return t!==c})})],Object(C.a)(e.pricingPlans.slice(i+1))))}})],children:"".concat(c+1,". ").concat(n)})}})]})})]},"plan-".concat(t,"-").concat(i))}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,className:"text-right",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn yellow-btn bordered",onClick:function(){return function(e){var t=Object(C.a)(l);t[e].pricingPlans.push({title:"",price:void 0,features:[]}),s(t),n(t)}(t)},icon:Object(oa.jsx)(ca.a,{}),children:"Add Plan"})})})]},t)}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,className:"text-right",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn yellow-btn bordered",onClick:function(){var e={name:"",subcategories:[],pricingPlans:[]};s([].concat(Object(C.a)(l),[e])),n([].concat(Object(C.a)(l),[e]))},icon:Object(oa.jsx)(ca.a,{}),children:"Add Category"})})})]})},D=function(){for(var e=[],t=0;t<30;t++){var n=new Date;n.setDate(n.getDate()+t),e.push({dayName:Object(gu.a)(n,"EEE"),date:Object(gu.a)(n,"MMM dd"),fullDate:n,id:t})}return e}(),A=function(e){var t,n,i=e.value,c=e.onChange,o=Object(a.useState)(null),l=Object(u.a)(o,2),s=l[0],r=l[1],v=Object(a.useState)(null),b=Object(u.a)(v,2),j=b[0],m=b[1],p=Object(a.useState)(i||{}),O=Object(u.a)(p,2),f=O[0],h=O[1];return Object(oa.jsxs)("div",{className:"day-time-slot-manager",children:[Object(oa.jsx)(Su,{level:2,children:"Manage Time Slots"}),Object(oa.jsx)(Nu,{children:"Select a day and add time slots for appointments"}),Object(oa.jsxs)("div",{className:"schedule-card",children:[Object(oa.jsxs)("div",{className:"day-selection-container",children:[Object(oa.jsx)(Su,{level:4,children:"Available Days"}),Object(oa.jsx)(Yn.a,{gutter:[16,16],className:"day-selection mt-2",children:D.map(function(e){return Object(oa.jsx)(Hn.a,{xs:12,sm:6,md:4,className:"ml-2",children:Object(oa.jsxs)(Cc.a,{bordered:j===e.id,className:"day-card ".concat(j===e.id?"selected":f[e.fullDate]?"has-slots":""),onClick:function(){return function(e){var t=tc()(e.fullDate).format("YYYY-MM-DD");r(t),m(null===e||void 0===e?void 0:e.id)}(e)},hoverable:!0,children:[Object(oa.jsx)(Yn.a,{className:"day-text",children:Object(oa.jsx)(Nu,{strong:!0,className:"slot",style:{fontSize:"18px"},children:e.dayName})}),Object(oa.jsx)(Yn.a,{className:"day-text",children:Object(oa.jsx)(Nu,{className:"slot",children:e.date})})]})},e.fullDate.toString())})})]}),s&&Object(oa.jsxs)("div",{className:"time-slot-creator",children:[Object(oa.jsx)(Su,{level:4,children:"Add Time Slots"}),Object(oa.jsx)(Zn.a,{use12Hours:!0,format:"h:mm A",onChange:function(e){if(s&&e){var t=e.format("h:mm A"),n=Object(d.a)(Object(d.a)({},f),{},Object(T.a)({},s,[].concat(Object(C.a)(f[s]||[]),[t])));h(n),null===c||void 0===c||c(n)}},className:"time-picker"}),Object(oa.jsx)(Su,{level:5,children:"Current Time Slots"}),Object(oa.jsxs)("div",{className:"time-slot-list mt-1",children:[null===(t=f[s])||void 0===t?void 0:t.map(function(e){return Object(oa.jsxs)("div",{className:"time-slot",children:[Object(oa.jsx)(Nu,{children:e}),Object(oa.jsx)(Vn.a,{size:"small",type:"link",danger:!0,onClick:function(){return function(e){if(s){var t=Object(d.a)(Object(d.a)({},f),{},Object(T.a)({},s,f[s].filter(function(t){return t!==e})));h(t),null===c||void 0===c||c(t)}}(e)},children:"Remove"})]},e)}),0===(null===(n=f[s])||void 0===n?void 0:n.length)&&Object(oa.jsx)(Nu,{children:"No time slots added yet"})]})]})]})]})},M=function(e){var t=e.value,n=e.onChange,c=(Object(s.b)(),Object(a.useState)(!1)),o=Object(u.a)(c,2),l=o[0],r=o[1],v=Object(s.c)(function(e){return e.auth}).fileToSend,b=Object(a.useState)(null===t||void 0===t?void 0:t.image),j=Object(u.a)(b,2),m=j[0],p=j[1];return Object(a.useEffect)(function(){if(v){var e,a,i,c,o={url:null===v||void 0===v||null===(e=v.media)||void 0===e||null===(a=e.urls)||void 0===a||null===(i=a.original)||void 0===i?void 0:i.url,mediumId:null===v||void 0===v||null===(c=v.media)||void 0===c?void 0:c.objectId};p(Object(d.a)({},o)),null===n||void 0===n||n(Object(d.a)(Object(d.a)({},t),{},{image:Object(d.a)({},o)}))}},[v]),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"text-center mb-2",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{required:!0,children:Object(oa.jsx)("img",{src:(null===m||void 0===m?void 0:m.url)||"/images/scene.png",alt:"",className:"profileImage cursor-pointer",onClick:function(){r(!0)}})})})}),Object(oa.jsx)(ei.a.Item,{label:"Title",required:!0,children:Object(oa.jsx)(Wn.a,{placeholder:"Enter Title",value:null===t||void 0===t?void 0:t.title,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{title:e.target.value}))}})}),Object(oa.jsx)(ei.a.Item,{label:"Education",required:!0,className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter Education",value:null===t||void 0===t?void 0:t.education,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{education:e.target.value}))}})}),Object(oa.jsx)(ei.a.Item,{label:"Linkedin Profile Url",required:!0,className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter Linkedin Url",value:null===t||void 0===t?void 0:t.link,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{link:e.target.value}))}})}),Object(oa.jsx)(ei.a.Item,{label:"Description Heading",required:!0,className:"mt-3",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter Description Heading",value:null===t||void 0===t?void 0:t.descriptionHeading,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{descriptionHeading:e.target.value}))}})}),Object(oa.jsx)(ei.a.Item,{label:"Description",required:!0,className:"mt-3",children:Object(oa.jsx)(Wn.a.TextArea,{value:null===t||void 0===t?void 0:t.description,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{description:e.target.value}))},autoSize:{minRows:2,maxRows:6},placeholder:"Enter Description"})}),Object(oa.jsx)(ei.a.Item,{required:!0,label:"Experience",className:"mt-3",children:Object(oa.jsx)(la,{value:null===t||void 0===t?void 0:t.experience,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{experience:e}))}})}),Object(oa.jsx)(ei.a.Item,{required:!0,label:"Daily Rate",className:"mt-3",children:Object(oa.jsx)(la,{value:null===t||void 0===t?void 0:t.dailyRate,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{dailyRate:e}))}})}),Object(oa.jsx)(ei.a.Item,{required:!0,label:"Hourly Rate",className:"mt-3",children:Object(oa.jsx)(la,{value:null===t||void 0===t?void 0:t.hourlyRate,onChange:function(e){return null===n||void 0===n?void 0:n(Object(d.a)(Object(d.a)({},t),{},{hourlyRate:e}))}})}),Object(oa.jsx)(ei.a.Item,{name:"location",rules:[{required:!0,message:"**Required Field"}],label:"Location",className:"mt-3",children:Object(oa.jsx)(ai,{placeholder:"Location",onChange:function(e){var a,i,c={label:e.label,attributes:null===e||void 0===e||null===(a=e.value)||void 0===a?void 0:a.attributes,coordinates:null===e||void 0===e||null===(i=e.value)||void 0===i?void 0:i.coordinates};null===n||void 0===n||n(Object(d.a)(Object(d.a)({},t),{},{location:c}))}})}),l&&Object(oa.jsx)(hu,{onClose:function(){return r(!1)},isBio:!0})]})};return Object(oa.jsx)($n.a,{title:"Edit Profile",visible:b,onCancel:function(){j(!1),t&&t()},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:O,onFinish:E,requiredMark:!1,children:[Object(oa.jsx)("div",{className:"main-cards mt-3",children:Object(oa.jsxs)(Kl.a,{defaultActiveKey:"1",type:"line",children:[Object(oa.jsx)(Tu,{tab:"Categories",children:Object(oa.jsx)(ei.a.Item,{name:"categories",children:Object(oa.jsx)(P,{categoriesList:l})})},"1"),Object(oa.jsx)(Tu,{tab:"Bio",children:Object(oa.jsx)(ei.a.Item,{name:"bio",children:Object(oa.jsx)(M,{})})},"2"),Object(oa.jsx)(Tu,{tab:"Assign Availability",children:Object(oa.jsx)(ei.a.Item,{name:"assignAvailability",children:Object(oa.jsx)(A,{})})},"3")]})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:N,type:"primary",htmlType:"submit",onClick:function(){return g("")},children:"Save"})})})})]})})},wu=n(1074),Eu=(n(985),n(1044)),Ru=(n(986),function(e){var t=e.onClose,n=e.onSubmit,i=Object(a.useState)(!0),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)(null),r=Object(u.a)(s,2),d=r[0],v=r[1],b=Object(a.useState)(""),j=Object(u.a)(b,2),m=j[0],p=j[1],O=Object(a.useState)(!1),f=Object(u.a)(O,2),h=f[0],g=f[1];return Object(oa.jsx)($n.a,{title:"Ratings and Review",visible:o,onCancel:function(){l(!1),t()},className:"beam-modal",width:"400px",footer:null,destroyOnClose:!0,children:h?Object(oa.jsxs)("div",{style:{textAlign:"center",padding:"40px 0"},children:[Object(oa.jsx)(Wi.a,{twoToneColor:"#52c41a",style:{fontSize:"64px"}}),Object(oa.jsx)("h2",{style:{marginTop:"16px"},children:"Thank you for your feedback!"})]}):Object(oa.jsxs)("div",{children:[Object(oa.jsx)("div",{style:{marginBottom:"16px",textAlign:"center",background:"#e1e4ea"},children:Object(oa.jsx)(Eu.a,{tooltips:["terrible","bad","normal","good","wonderful"],style:{fontSize:35},allowHalf:!0,onChange:function(e){return v(e)},value:d})}),Object(oa.jsxs)("div",{style:{marginBottom:"16px"},children:[Object(oa.jsx)("h5",{children:"Your review:"}),Object(oa.jsx)(Wn.a.TextArea,{autoSize:{minRows:4,maxRows:6},placeholder:"Write your review here...",onChange:function(e){return p(e.target.value)},value:m})]}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",type:"primary",onClick:function(){n({rating:d,review:m}),g(!0)},disabled:!d&&!m.trim(),children:"Submit"})})]})})}),Pu=(n(987),xs.a.Title),Du=xs.a.Text,Au=function(){for(var e=[],t=0;t<30;t++){var n=new Date;n.setDate(n.getDate()+t),e.push({dayName:Object(gu.a)(n,"EEE"),date:Object(gu.a)(n,"MMM dd"),fullDate:Object(gu.a)(n,"yyyy-MM-dd")})}return e}(),Mu=function(e){var t=e.onClose,n=e.onSelect,i=e.assignAvailability,c=e.date,o=e.time,l=e.bookedSlots,s=Object(a.useState)(c||null),r=Object(u.a)(s,2),d=r[0],v=r[1],b=Object(a.useState)(o||null),j=Object(u.a)(b,2),m=j[0],p=j[1],O=Object(a.useState)(!0),f=Object(u.a)(O,2),h=f[0],g=f[1];return Object(oa.jsx)($n.a,{title:"",visible:h,onCancel:function(){g(!1),t()},className:"beam-modal rescheduling-modal",width:"800px",footer:null,destroyOnClose:!0,children:Object(oa.jsxs)("div",{className:"rescheduling-component",children:[Object(oa.jsx)(Pu,{level:2,children:"Reschedule your Session"}),Object(oa.jsx)(Du,{children:"Select a day and time slot for your session"}),Object(oa.jsxs)("div",{className:"schedule-card",children:[Object(oa.jsxs)("div",{className:"day-selection-container",children:[Object(oa.jsx)(Pu,{level:4,children:"Available Days"}),Object(oa.jsx)(Yn.a,{gutter:[16,16],className:"day-selection",children:Au.map(function(e){var t;return Object(oa.jsx)(Hn.a,{xs:12,sm:6,md:4,className:"mr-2",children:Object(oa.jsxs)(Cc.a,{bordered:d===e.fullDate,className:"day-card ".concat(d===e.fullDate?"selected":""," ").concat(null!==(t=i[e.fullDate])&&void 0!==t&&t.length?"":"no-time-slots"),onClick:function(){var t;null!==(t=i[e.fullDate])&&void 0!==t&&t.length&&function(e){v(e),p(null)}(e.fullDate)},hoverable:!0,children:[Object(oa.jsx)(Du,{className:"slot",strong:!0,style:{display:"block",fontSize:"18px"},children:e.dayName}),Object(oa.jsx)(Du,{className:"slot",style:{display:"block"},children:e.date})]})},e.fullDate.toString())})})]}),Object(oa.jsx)(Ms.a,{}),d&&Object(oa.jsxs)("div",{className:"time-selection-container",children:[Object(oa.jsx)(Pu,{level:4,children:"Available Time Slots"}),!i[d]&&Object(oa.jsx)(Yn.a,{style:{display:"flex",placeContent:"center",height:"100px"},children:Object(oa.jsx)(Pu,{level:5,children:" No Time Slot Available"})}),i[d]&&Object(oa.jsx)(Yn.a,{gutter:[16,16],className:"time-selection",children:i[d].map(function(e){return Object(oa.jsx)(Hn.a,{xs:12,sm:6,md:4,className:"assign-avail",children:Object(oa.jsx)(Sl.a,{title:l["".concat(d,":").concat(e)]===e?"This time slot is already booked":"",children:Object(oa.jsx)(Cc.a,{bordered:m===e,className:"time-card ".concat(m===e?"selected":""," ").concat(l["".concat(d,":").concat(e)]===e?"no-time-slots":""),onClick:function(){l["".concat(d,":").concat(e)]!==e&&function(e){p(e)}(e)},hoverable:!0,children:Object(oa.jsx)(Du,{className:"slot",children:e})})})},e)})})]}),d&&m&&Object(oa.jsx)("div",{className:"confirm-button-container",children:Object(oa.jsx)(Vn.a,{onClick:function(){n({day:d,time:m})},className:"beam-btn green-btn cover w-40",children:"Confirm Reschedule"})})]})]})})};Dc.d.register(Dc.a,Dc.j,Dc.e);var Lu=function(e){return e.Assigned="assigned",e.Started="started",e.Completed="completed",e.Escalated="escalated",e.Cancelled="cancelled",e.Processed="processed",e}({}),Uu={green:Lu.Completed,amber:Lu.Assigned,red:Lu.Escalated,blue:Lu.Started,black:Lu.Cancelled,gray:Lu.Processed},qu=function(e){var t=e.socket,n=e.filter,c=e.selected,o=(e.componentUuid,e.onClose),l=Object(s.c)(function(e){return e.auth}),r=(l.userRequests,l.projects),v=l.selectedPage,b=(l.encrypted_token,l.searchByPhone),j=(l.adminUserRoles,Object(s.b)()),p=Object(a.useState)("project"),O=Object(u.a)(p,2),f=(O[0],O[1],Object(a.useState)("state")),h=Object(u.a)(f,2),g=h[0],I=(h[1],Object(a.useState)(!1)),S=Object(u.a)(I,2),N=S[0],k=S[1],w=Object(a.useState)(void 0),E=Object(u.a)(w,2),R=(E[0],E[1],Object(a.useState)(void 0)),P=Object(u.a)(R,2),D=(P[0],P[1],Object(a.useState)(!1)),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Object(a.useState)(!1),q=Object(u.a)(U,2),F=(q[0],q[1]),B=Object(a.useState)([]),_=Object(u.a)(B,2),$=(_[0],_[1],Object(a.useState)([])),Y=Object(u.a)($,2),V=(Y[0],Y[1]),Q=Object(a.useState)([]),G=Object(u.a)(Q,2),J=(G[0],G[1]),K=Object(a.useState)([]),Z=Object(u.a)(K,2),X=(Z[0],Z[1]),ee=(Object(a.useRef)(W()),Object(a.useRef)(void 0),Object(a.useRef)(void 0),Object(a.useRef)(0)),te=Object(a.useRef)(void 0),ne=Object(a.useRef)(!1),ae=Object(a.useState)(),ie=Object(u.a)(ae,2),ce=ie[0],oe=(ie[1],Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0})),le=Object(u.a)(oe,2),se=le[0],re=le[1],de=Object(a.useState)(0),ue=Object(u.a)(de,2),ve=ue[0],be=ue[1],je=Object(a.useState)([]),me=Object(u.a)(je,2),pe=me[0],Oe=me[1],fe=Object(a.useRef)(void 0),he=Object(a.useRef)(void 0),ge=Object(a.useState)([]),xe=Object(u.a)(ge,2),ye=xe[0],Ie=xe[1],Se=Object(a.useState)(!1),Ne=Object(u.a)(Se,2),ke=Ne[0],Te=Ne[1],Ce=Object(a.useState)([]),we=Object(u.a)(Ce,2),Ee=(we[0],we[1],Object(a.useState)(void 0)),Re=Object(u.a)(Ee,2),Pe=Re[0],De=Re[1],Ae=Object(a.useRef)({project:void 0,user:void 0,area:void 0,time:void 0}),Me=Object(a.useRef)({status:void 0,time:void 0,phone:void 0}),Le=(Object(a.useRef)({}),Object(a.useRef)()),Ue=Mn().getUserRequestPayload,qe=Object(a.useRef)([]),Fe=Object(a.useState)(!0),Be=Object(u.a)(Fe,2),_e=Be[0],$e=Be[1],Ye=Object(a.useState)(!1),He=Object(u.a)(Ye,2),We=He[0],Ve=He[1],ze=Object(a.useState)(!1),Qe=Object(u.a)(ze,2),Ge=Qe[0],Je=Qe[1],Ke=Object(a.useState)(!1),Ze=Object(u.a)(Ke,2),Xe=Ze[0],et=Ze[1],nt=Object(a.useState)(null),at=Object(u.a)(nt,2),it=at[0],ct=at[1],ot=Object(a.useState)(null),lt=Object(u.a)(ot,2),st=lt[0],rt=lt[1],dt=Object(a.useState)([]),ut=Object(u.a)(dt,2),vt=(ut[0],ut[1],Object(a.useState)([])),bt=Object(u.a)(vt,2),jt=bt[0],mt=bt[1],pt=Object(a.useState)({}),Ot=Object(u.a)(pt,2),ft=Ot[0],ht=Ot[1],gt=Object(a.useState)({}),xt=Object(u.a)(gt,2),yt=xt[0],It=xt[1],St=Object(a.useState)({}),Nt=Object(u.a)(St,2),kt=Nt[0],Tt=Nt[1],Ct=Mn().updateUserRequestPayloadV2,wt=Object(s.c)(function(e){return e.auth}).userInfo,Et=Object(a.useCallback)(Object(Ac.a)(2e3,function(){console.log("debounce"),Ft()},{atBegin:!0}),[]),Rt=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,o,l,s,r,u,v;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return c=t.rating,o=t.review,l=kt.pageId,s=kt.coachId,r=localStorage.getItem("coachServiceId")||"",u=localStorage.getItem("RID")||"",v={userId:u,email:null===wt||void 0===wt?void 0:wt.email,firstName:null===wt||void 0===wt?void 0:wt.firstName,lastName:null===wt||void 0===wt?void 0:wt.lastName,image:(null===wt||void 0===wt||null===(n=wt.profileImage)||void 0===n||null===(a=n.urls)||void 0===a||null===(i=a.original)||void 0===i?void 0:i.url)||""},e.n=1,Pt(s,l,r,{rating:c,review:o,userInfo:Object(d.a)({},v)});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Pt=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n,a,i,c){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,o){var l=[];l.push({op:"add",path:"/persistent/static/coach/bio/ratings/".concat(a),value:Object(d.a)({},c)}),t.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,Ct(n,l),x.UpdateUserBio,i),t.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){e(t)})}))},e)}));return function(t,n,a,i){return e.apply(this,arguments)}}(),Dt=function(e){Me.current.status=e?"@rideStatus:{".concat(Uu[e],"}"):void 0,Me.current.phone=void 0,L(!0),te.current=e,De(e),Bt()};Object(a.useEffect)(function(){var e;b&&(e=null===b||void 0===b?void 0:b.phone,Me.current.phone=e?"@passengerPhoneNumber:{".concat(z(e),"}"):void 0,L(!0),Me.current.status=void 0,te.current="lime",De("lime"),Bt())},[b]);var At=function(e){var t=e.split(":").map(Number),n=Object(u.a)(t,2),a=n[0],i=n[1],c=a>=12?"PM":"AM";return"".concat(a=a%12||12,":").concat(i.toString().padStart(2,"0")," ").concat(c)},Mt=function(e){var n,a,i,c,o,l,s,r,v,b,j,p=e.day,O=e.time,f=function(e){var t=e.split(" "),n=Object(u.a)(t,2),a=n[0],i=n[1],c=a.split(":").map(Number),o=Object(u.a)(c,2),l=o[0],s=o[1];return"PM"===i&&12!==l?l+=12:"AM"===i&&12===l&&(l=0),"".concat(l.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"))}(O),h="".concat(p," ").concat(O),g=H()(h,"YYYY-MM-DD hh:mm A").valueOf(),x=new Date(g).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),y={pageId:null===yt||void 0===yt?void 0:yt.pageId,userId:localStorage.getItem("RID"),attributes:Object(d.a)(Object(d.a)({},null===yt||void 0===yt?void 0:yt.profile),{},{scheduleDate:p,scheduleTime:f,caseVisitSchedule:{type:"event",dateTime:g,description:"Name: ".concat(null===yt||void 0===yt||null===(n=yt.profile)||void 0===n?void 0:n.name,"\nEmail: ").concat(null===wt||void 0===wt?void 0:wt.email,"\nCategories: ").concat(null===yt||void 0===yt||null===(a=yt.profile)||void 0===a?void 0:a.categories,"\nPlan: ").concat(null===yt||void 0===yt||null===(i=yt.profile)||void 0===i?void 0:i.plan,"\nSchedule date: ").concat(p,"\nSchedule time: ").concat(f,"\n"),repeat:!1,title:x,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},shareCustomerLink:!0}),responders:[{type:"responder",value:"".concat(null===yt||void 0===yt||null===(c=yt.profile)||void 0===c||null===(o=c.coach)||void 0===o?void 0:o.id),id:"".concat(null===yt||void 0===yt||null===(l=yt.profile)||void 0===l||null===(s=l.coach)||void 0===s?void 0:s.id),name:null===yt||void 0===yt||null===(r=yt.profile)||void 0===r||null===(v=r.coach)||void 0===v?void 0:v.name,beamId:null===yt||void 0===yt||null===(b=yt.profile)||void 0===b||null===(j=b.coach)||void 0===j?void 0:j.beamId}],assets:[],connectionId:localStorage.getItem("CID"),submitted:!0,unstructuredAttributes:{},title:x,invitation:!1,createdAt:g,cudbServiceId:localStorage.getItem("coachServiceId")};t.publishToEvent(m.PublishPageTopics,Wt(localStorage.getItem("CID")),Dn(Object(d.a)({},y))),t.subscribeToEvent(m.SubscribePageTopics,Ht(localStorage.getItem("CID")),function(t){var n;null!==t&&void 0!==t&&null!==(n=t.response)&&void 0!==n&&n.status?(qt(e),Lt("Appointment rescheduled successfully !","success","TOP_CENTER",3e3),Bt()):Lt("Appointment rescheduled failed !","error","TOP_CENTER",3e3)}),console.log("request",y)},Ut=function(){var e;t.publishToEvent(m.PublishPageTopics,(e=localStorage.getItem("CID"),"".concat("beamdevlive","/connection/").concat(e,"/service/dps/cancelCoachPage")),Dn({userId:localStorage.getItem("RID"),pageId:null===yt||void 0===yt?void 0:yt.pageId})),t.subscribeToEvent(m.SubscribePageTopics,function(e){return"".concat("beamdevlive","/connection/").concat(e,"/service/dps/cancelCoachPage/reply")}(localStorage.getItem("CID")),function(e){var t;et(!1),null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&t.status?(Lt("Your session has been cancelled successfully","success","TOP_CENTER",3e3),Bt()):Lt("Session cancelled failed !","error","TOP_CENTER",3e3)})},qt=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(n){var a,i,c,o,l;return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return c=n.day,o=n.time,l=null===yt||void 0===yt||null===(a=yt.profile)||void 0===a||null===(i=a.coach)||void 0===i?void 0:i.id,console.log({coachId:l}),e.a(2,new Promise(function(e,n){var a=[];c&&o&&(a.push({op:"add",path:"/persistent/static/coach/bookedSlots/".concat(c,":").concat(o),value:o},{op:"remove",path:"/persistent/static/coach/bookedSlots/".concat(it,":").concat(st),value:{}}),console.log({updatedUserData:a}),t.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,Ct(l,a),x.UpdateUserBio,localStorage.getItem("coachServiceId")),t.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){e(t)}))}))},e)}));return function(t){return e.apply(this,arguments)}}(),Ft=function(){var e,t=[],n="";if(Me.current.time)n+=Me.current.time;else{var a=new Date;a.setHours(0),a.setMinutes(1),n+="@createdAt:[".concat(a.getTime(),",+inf]")}Ae.current&&Object.keys(Ae.current).map(function(e){var n,a;null!==(n=Ae.current)&&void 0!==n&&n[e]&&t.push(null===(a=Ae.current)||void 0===a?void 0:a[e])});var i={};qe.current&&qe.current.map(function(e){i[e.key]=e.value});var c={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{'".concat(null===Le||void 0===Le||null===(e=Le.current)||void 0===e?void 0:e.userId,"'}").concat(ne.current?"":"(-@rideType:{hail})","@pageType:{event}").concat(n),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)({profile:"$..profile",rideType:"$..profile.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",status:"$.nonpersistent.static.live.status.name",vehicleProjectId:"$..profile.vehicleProjectId"},i)},groupBy:{properties:["@status"],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:t.join("&&")}};j(tt({requestData:c,callback:function(e){var t=0,n={amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0};e.map(function(e){n[e.status]=e.count,t+=e.count}),re(Object(d.a)({all:t,live:t},n))}}))};Object(a.useEffect)(function(){se&&be(ve+1)},[JSON.stringify(se)]),Object(a.useEffect)(function(){if(ce){var e,t,n,a,i,c,o,l,s,u,v,b,j,m,p,O,f,h,g,x,y,I,S,N,k,T,w,E,R,P,D,A,M,L,U,q,F,B,_,$,Y,H,W,V,z=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===ce||void 0===ce||null===(e=ce.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.profile)||{}),(null===ce||void 0===ce||null===(n=ce.persistent)||void 0===n||null===(a=n.static)||void 0===a?void 0:a.dashboard)||{}),(null===ce||void 0===ce||null===(i=ce.persistent)||void 0===i||null===(c=i.static)||void 0===c?void 0:c.ride)||{}),(null===ce||void 0===ce||null===(o=ce.persistent)||void 0===o||null===(l=o.dynamic)||void 0===l?void 0:l.ride)||{}),Q=null===ce||void 0===ce||null===(s=ce.nonpersistent)||void 0===s||null===(u=s.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.status)||void 0===b?void 0:b.name,G=null===ce||void 0===ce||null===(j=ce.persistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.profile)||void 0===p?void 0:p.type,J=null===ce||void 0===ce||null===(O=ce.persistent)||void 0===O||null===(f=O.static)||void 0===f||null===(h=f.metadata)||void 0===h?void 0:h.type;if(!ne.current&&"hail"===G||"event"!==J)return;var K=Object(C.a)(pe),Z=K.findIndex(function(e){return e.key===ce.pageId});if(Et(),te.current&&te.current!==Q)return void(-1!==Z&&(K.splice(Z,1),Oe(K),fe.current=K));var ee={};Object.keys(z).map(function(e){"string"===typeof z[e]&&(ee[e]=z[e])});var ae,ie,oe,le,se,re=(null===(g=he.current)||void 0===g||null===(x=g.find(function(e){var t,n,a;return e.id===(null===ce||void 0===ce||null===(t=ce.nonpersistent)||void 0===t||null===(n=t.dynamic)||void 0===n||null===(a=n.ride)||void 0===a?void 0:a.dispatchRequestBy)}))||void 0===x?void 0:x.beamId)||"",de=(null===(y=he.current)||void 0===y||null===(I=y.find(function(e){var t,n,a,i;return e.id===(null===(t=Object.keys((null===ce||void 0===ce||null===(n=ce.nonpersistent)||void 0===n||null===(a=n.dynamic)||void 0===a||null===(i=a.ride)||void 0===i?void 0:i.manualUsers)||{}))||void 0===t?void 0:t[0])||""}))||void 0===I?void 0:I.beamId)||"";if(null===(S=Object.keys((null===ce||void 0===ce||null===(N=ce.persistent)||void 0===N||null===(k=N.static)||void 0===k||null===(T=k.payment)||void 0===T?void 0:T.stripe)||{}))||void 0===S||S.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===ce||void 0===ce||null===(t=ce.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"succeeded"===(null===ce||void 0===ce||null===(o=ce.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(ae=null===ce||void 0===ce||null===(u=ce.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])}),!ae)null===(ie=Object.keys((null===ce||void 0===ce||null===(oe=ce.persistent)||void 0===oe||null===(le=oe.static)||void 0===le||null===(se=le.payment)||void 0===se?void 0:se.stripe)||{}))||void 0===ie||ie.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===ce||void 0===ce||null===(t=ce.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"requires_capture"===(null===ce||void 0===ce||null===(o=ce.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(ae=null===ce||void 0===ce||null===(u=ce.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])});var ue,ve,be=Object(d.a)(Object(d.a)({key:null===(w=ce.pageId)||void 0===w?void 0:w.toString(),pageStatus:null===ce||void 0===ce||null===(E=ce.nonpersistent)||void 0===E||null===(R=E.static)||void 0===R||null===(P=R.live)||void 0===P||null===(D=P.status)||void 0===D?void 0:D.name,requestedBy:re,requestedAt:new Date(null===ce||void 0===ce||null===(A=ce.persistent)||void 0===A||null===(M=A.static)||void 0===M||null===(L=M.metadata)||void 0===L?void 0:L.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:de,name:null===ce||void 0===ce||null===(U=ce.persistent)||void 0===U||null===(q=U.static)||void 0===q||null===(F=q.metadata)||void 0===F?void 0:F.title,action:{pageId:ce.pageId,page:Object(d.a)(Object(d.a)({},ce),{},{profile:z}),summary:ee.summary,cudbServiceId:null===r||void 0===r?void 0:r.userServiceId,stripe:ae}},ee),{},{address:null!==ee&&void 0!==ee&&ee.address&&""!==(null===ee||void 0===ee?void 0:ee.adress)?null===ee||void 0===ee?void 0:ee.address:null===z||void 0===z||null===(B=z.pickupLocation)||void 0===B||null===(_=B.attributes)||void 0===_?void 0:_.address,dropoffAddress:null!==ee&&void 0!==ee&&ee.dropoffAddress&&""!==(null===ee||void 0===ee?void 0:ee.dropoffAddress)?null===ee||void 0===ee?void 0:ee.dropoffAddress:null===z||void 0===z||null===($=z.dropoffLocation)||void 0===$||null===(Y=$.attributes)||void 0===Y?void 0:Y.address,driverName:null===z||void 0===z||null===(H=z.responder)||void 0===H?void 0:H.name,vehicleName:null===z||void 0===z||null===(W=z.vehicle)||void 0===W||null===(V=W.obj)||void 0===V?void 0:V.name});if(-1!==Z)K[Z]=Object(d.a)(Object(d.a)({},be),{},{invited:null===fe||void 0===fe||null===(ue=fe.current)||void 0===ue||null===(ve=ue[Z])||void 0===ve?void 0:ve.invited});else K.unshift(be);X(null===K||void 0===K?void 0:K.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;return{lat:null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(i=a.static)||void 0===i||null===(c=i.live)||void 0===c||null===(o=c.location)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l.lat,lng:null===e||void 0===e||null===(s=e.action)||void 0===s||null===(r=s.page)||void 0===r||null===(d=r.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.location)||void 0===b?void 0:b.coordinates.long,title:null===e||void 0===e||null===(j=e.action)||void 0===j||null===(m=j.page)||void 0===m||null===(p=m.persistent)||void 0===p||null===(O=p.static)||void 0===O||null===(f=O.metadata)||void 0===f?void 0:f.title}})),Oe(K),fe.current=K}},[ce]);var Bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=[],a="";"advance"===c?(te.current="brown",n.push("exists(@status) && @status === 'brown'")):"dispatch"===c?(te.current="purple",n.push("exists(@status) && @status === 'purple'")):Ae.current&&Object.keys(Ae.current).map(function(e){var t,a;null!==(t=Ae.current)&&void 0!==t&&t[e]&&n.push(null===(a=Ae.current)||void 0===a?void 0:a[e])}),Me.current.status&&n.push("exists(@status) && @status === '".concat(te.current,"'")),Me.current.phone&&(a=Me.current.phone);var i={};qe.current&&qe.current.map(function(e){i[e.key]=e.value}),ee.current=e;var o={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(localStorage.getItem("RID"),"}").concat(ne.current?"":"(-@rideType:{hail})","@pageType:{event}").concat("").concat("").concat(a),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",ride:"$.persistent.static.ride",type:"$..persistent.static.metadata.type",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",rideType:"$..profile.type",phone:"$..profile.studentPhone",vehicleProjectId:"$..profile.vehicleProjectId"},g,"$..profile.".concat(g)),i)},filter:{expression:n.join("&&")},sortBy:{properties:["advance"===c?{field:"@createdAt",order:"ASC"}:{field:"@updatedAt",order:"DESC"}],max:1e3},result:Me.current.phone?{pagination:{offset:e,limit:50}}:{}};j(tt({requestData:o,callback:function(n){J(n),ee.current=ee.current+30;var a=e>0?Object(C.a)(pe):[],i=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Confirmation #",key:"key",dataIndex:"key"},{title:"Schedule Date",key:"scheduleDate",dataIndex:"scheduleDate"},{title:"Schedule Time",key:"scheduleTime",dataIndex:"scheduleTime"},{title:"Coach Name",key:"coachName",dataIndex:"coachName"},{title:"Coach Beam Id",key:"coachBeamId",dataIndex:"coachBeamId"},{title:"Schedule Type",key:"scheduleType",dataIndex:"scheduleType"},{title:"Amount",key:"amount",dataIndex:"amount"}];null===n||void 0===n||n.map(function(e,t){var n,i,c,o,l,s,u,v,b,j,m,p,O,f,h,g,x,y,I=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),S={};Object.keys(I).map(function(e){"string"===typeof I[e]&&(S[e]=I[e])});var N,k,T=he.current||JSON.parse(localStorage.getItem("rideUsers")||"[]"),C=(null===T||void 0===T||null===(n=T.find(function(t){var n;return t.id===(null===e||void 0===e||null===(n=e.requestedBy)||void 0===n?void 0:n.toString())}))||void 0===n?void 0:n.beamId)||"",w=(null===T||void 0===T||null===(i=T.find(function(t){var n;return t.id===(null===(n=Object.keys((null===e||void 0===e?void 0:e.manualUsers)||{}))||void 0===n?void 0:n[0])||""}))||void 0===i?void 0:i.beamId)||"";(null===(c=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===c||c.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"succeeded"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(N=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}),N)||(null===(k=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===k||k.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"requires_capture"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(N=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}));var E={coachName:null===e||void 0===e||null===(o=e.profile)||void 0===o||null===(l=o.coach)||void 0===l?void 0:l.name,coachBeamId:null===e||void 0===e||null===(s=e.profile)||void 0===s||null===(u=s.coach)||void 0===u?void 0:u.beamId,scheduleType:null===e||void 0===e||null===(v=e.profile)||void 0===v||null===(b=v.payment)||void 0===b?void 0:b.scheduleType,amount:null===e||void 0===e||null===(j=e.profile)||void 0===j||null===(m=j.payment)||void 0===m?void 0:m.amount},R=new Date("".concat(null===I||void 0===I?void 0:I.scheduleDate,"T").concat(null===I||void 0===I?void 0:I.scheduleTime,":00")),P=new Date>R||"black"===e.status,D=new Date<R||"black"===e.status;a.push(Object(d.a)(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:I}),summary:S.summary,cudbServiceId:null===r||void 0===r?void 0:r.userServiceId,stripe:N,isDisabledActions:P,isDisabledReviewActions:D}},E),S),{},{address:null!==S&&void 0!==S&&S.address&&""!==(null===S||void 0===S?void 0:S.adress)?null===S||void 0===S?void 0:S.address:null===I||void 0===I||null===(p=I.pickupLocation)||void 0===p||null===(O=p.attributes)||void 0===O?void 0:O.address,dropoffAddress:null!==S&&void 0!==S&&S.dropoffAddress&&""!==(null===S||void 0===S?void 0:S.dropoffAddress)?null===S||void 0===S?void 0:S.dropoffAddress:null===I||void 0===I||null===(f=I.dropoffLocation)||void 0===f||null===(h=f.attributes)||void 0===h?void 0:h.address,invited:"",driverName:null===I||void 0===I||null===(g=I.responder)||void 0===g?void 0:g.name,vehicleName:null===I||void 0===I||null===(x=I.vehicle)||void 0===x||null===(y=x.obj)||void 0===y?void 0:y.name,requestedBy:C,requestedAt:"".concat(new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleDateString()," - ").concat(new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})),assigned:w}))}),a.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===i.findIndex(function(t){return t.key===e})&&t[e]})}),i.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:200},children:[Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn order-btn",onClick:function(){var t="".concat("https://live.staging.beam.live","/page/").concat(null===e||void 0===e?void 0:e.pageId);window.open(t,"_blank")},children:Object(oa.jsx)(wu.a,{style:{color:"#90a5c5"}})})}),Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn order-btn",disabled:null===e||void 0===e?void 0:e.isDisabledReviewActions,onClick:function(){var t,n;console.log({action:e});var a=e.page,i={pageId:null===a||void 0===a?void 0:a.pageId,coachId:null===a||void 0===a||null===(t=a.profile)||void 0===t||null===(n=t.coach)||void 0===n?void 0:n.id};Tt(i),Ve(!0)},children:Object(oa.jsx)(Zc.a,{style:{color:"#90a5c5"}})})}),Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn order-btn",disabled:null===e||void 0===e?void 0:e.isDisabledActions,onClick:function(){var n,a;console.log({action:e});var i=e.page;console.log({page:i});null===i||void 0===i||i.pageId,null===i||void 0===i||null===(n=i.profile)||void 0===n||null===(a=n.coach)||void 0===a||a.id;It(i),function(e){var n,a,i,c,o=null===e||void 0===e||null===(n=e.profile)||void 0===n||null===(a=n.coach)||void 0===a?void 0:a.id,l=null===e||void 0===e||null===(i=e.profile)||void 0===i?void 0:i.scheduleDate,s=At(null===e||void 0===e||null===(c=e.profile)||void 0===c?void 0:c.scheduleTime);console.log({userId:o,id:localStorage.getItem("coachServiceId")}),t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Ue(o,"$","$..persistent.static.coach"),hn(localStorage.getItem("userId")),localStorage.getItem("coachServiceId")),t.subscribeToSurvey(m.SurveyTopics,hn(localStorage.getItem("userId")),function(e){if(console.log({response:e}),e){var t;console.log({response:e});var n=null===e||void 0===e||null===(t=e.data[0])||void 0===t?void 0:t[0];n&&(ht(null===n||void 0===n?void 0:n.bookedSlots),mt(null===n||void 0===n?void 0:n.assignAvailability),ct(l),rt(s),Je(!0))}})}(i)},children:Object(oa.jsx)(wo.a,{style:{color:"#90a5c5"}})})}),Object(oa.jsx)(Hn.a,{span:6,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn order-btn",disabled:null===e||void 0===e?void 0:e.isDisabledActions,onClick:function(){var t,n;console.log({action:e});var a=e.page;null===a||void 0===a||a.pageId,null===a||void 0===a||null===(t=a.profile)||void 0===t||null===(n=t.coach)||void 0===n||n.id;et(!0)},children:Object(oa.jsx)(Ls.a,{style:{color:"#90a5c5"}})})}),(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t,n="".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(localStorage.getItem("CID"),"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId);window.open(n,"_blank")},children:Object(oa.jsx)(Ec.a,{})})})]})}}),Ie(i),Oe(a),fe.current=a,X(null===n||void 0===n?void 0:n.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),L(!1),k(!1),F(!1)}})),Et()};return Object(a.useEffect)(function(){Bt(),function(e){F(!0);var t={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(localStorage.getItem("RID"),"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(T.a)({},e,"$.persistent.static.profile.".concat(e))},groupBy:{properties:["@".concat(e)],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:""}};j(tt({requestData:t,callback:function(e){F(!1);var t=[];null===e||void 0===e||e.map(function(e){e[Object.keys(e)[0]]&&t.push({label:e[Object.keys(e)[0]],value:e[Object.keys(e)[0]]})}),V(t)}}))}("state")},[]),Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)($n.a,{title:"Orders",visible:_e,onCancel:function(){$e(!1),o&&o()},width:"800px",className:"beam-modal",footer:[],destroyOnClose:!0,children:[Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid"},children:Object(oa.jsxs)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:[n&&Object(oa.jsxs)(Yn.a,{className:"d-flex mb-2",children:[Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat(void 0===Pe?"status-selected":""),onClick:function(){Dt(void 0)},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"All"}),Object(oa.jsx)("h4",{children:se.live})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("purple"===Pe?"status-selected":""),onClick:function(){Dt("purple")},children:Object(oa.jsxs)("div",{className:"purple",children:[Object(oa.jsx)("span",{children:"Pending"}),Object(oa.jsx)("h4",{children:se.purple})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("amber"===Pe?"status-selected":""),onClick:function(){Dt("amber")},children:Object(oa.jsxs)("div",{className:"amber",children:[Object(oa.jsx)("span",{children:"Assigned"}),Object(oa.jsx)("h4",{children:se.amber})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("blue"===Pe?"status-selected":""),onClick:function(){Dt("blue")},children:Object(oa.jsxs)("div",{className:"blue",children:[Object(oa.jsx)("span",{children:"Started"}),Object(oa.jsx)("h4",{children:se.blue})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("red"===Pe?"status-selected":""),onClick:function(){Dt("red")},children:Object(oa.jsxs)("div",{className:"red",children:[Object(oa.jsx)("span",{children:"Escalated"}),Object(oa.jsx)("h4",{children:se.red})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("green"===Pe?"status-selected":""),onClick:function(){Dt("green")},children:Object(oa.jsxs)("div",{className:"green",children:[Object(oa.jsx)("span",{children:"Completed"}),Object(oa.jsx)("h4",{children:se.green})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("grey"===Pe?"status-selected":""),onClick:function(){Dt("grey")},children:Object(oa.jsxs)("div",{className:"grey",children:[Object(oa.jsx)("span",{children:"Processed"}),Object(oa.jsx)("h4",{children:se.grey})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("black"===Pe?"status-selected":""),onClick:function(){Dt("black")},children:Object(oa.jsxs)("div",{className:"black",children:[Object(oa.jsx)("span",{children:"Cancelled"}),Object(oa.jsx)("h4",{children:se.black})]})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0 10px 0"},onClick:function(){Te(!ke)},children:Object(oa.jsx)(Rc.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 10px 10px 0"},loading:N||M,onClick:function(){k(!0),Bt()},children:!N&&!M&&Object(oa.jsx)(Pc.a,{})})]}),Object(oa.jsx)(Xi.a,{dataSource:pe,className:(null===pe||void 0===pe?void 0:pe.length)>0?"":"table-empty",onRow:function(e){return{onDoubleClick:function(){var t;j({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e||null===(t=e.action)||void 0===t?void 0:t.page}})},onClick:function(){}}},columns:ye,scroll:{x:!0},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===v||void 0===v||null===(n=v.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})]})}),We&&Object(oa.jsx)(Ru,{onClose:function(){return Ve(!1)},onSubmit:Rt}),Ge&&Object(oa.jsx)(Mu,{onClose:function(){return Je(!1)},onSelect:function(e){Mt(e)},date:null,time:null,bookedSlots:ft,assignAvailability:jt}),Xe&&Object(oa.jsx)(Fo,{onClose:function(){et(!1)},handleConfirm:Object(_n.a)(Object(Bn.a)().m(function e(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:Ut();case 1:return e.a(2)}},e)})),message:"Are you sure you want to cancel your session ?"})]})})},Fu=["type"],Bu=function(e){var t,n,c=e.socket,o=Object(s.b)(),r=Mn(),v=r.getUserRequestPayload,b=(r.handleMessages,Object(a.useState)(!1)),j=Object(u.a)(b,2),p=j[0],O=j[1],f=Object(a.useState)(!1),h=Object(u.a)(f,2),g=h[0],x=h[1],I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(a.useState)({}),C=Object(u.a)(T,2),w=C[0],E=C[1],R=Object(a.useState)(),P=Object(u.a)(R,2),D=(P[0],P[1]),F=Object(a.useState)(!1),_=Object(u.a)(F,2),$=_[0],Y=_[1],H=Object(a.useState)(""),W=Object(u.a)(H,2),V=W[0],z=W[1],Q=Object(s.c)(function(e){return e.auth}).userInfo,G=Object(a.useState)("/images/users/user.png"),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)(!1),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(s.c)(function(e){return e.auth}),ie=ae.isOpenLoginModal,oe=ae.isOpenVerifyModal,le=ae.loginSuccessfull,se=ae.isOpenRegisterationModal,re=ae.categories,ue=Object(a.useState)([]),ve=Object(u.a)(ue,2),be=ve[0],je=ve[1],me=Object(l.g)().search;Object(a.useEffect)(function(){var e;if(null!==re&&void 0!==re&&null!==(e=re.categories)&&void 0!==e&&e.length){var t=re.categories.map(function(e){return{name:e,subcategories:re.subcategories[e]||[]}});je(t)}},[re]),Object(a.useEffect)(function(){if(null!==Q&&void 0!==Q&&Q.coach){var e,t,n,a,i=null===Q||void 0===Q?void 0:Q.coach,c=(i.type,Object(Ka.a)(i,Fu));E(Object(d.a)(Object(d.a)({},c),{},{categories:null===c||void 0===c||null===(e=c.categories)||void 0===e?void 0:e.map(function(e){return Object(d.a)(Object(d.a)({},e),{},{pricingPlans:(null===e||void 0===e?void 0:e.pricingPlans)||[]})}),bio:Object(d.a)(Object(d.a)({},null===Q||void 0===Q||null===(t=Q.coach)||void 0===t?void 0:t.bio),{},{image:null===Q||void 0===Q||null===(n=Q.profileImage)||void 0===n||null===(a=n.urls)||void 0===a?void 0:a.original})}))}},[Q]),Object(a.useEffect)(function(){var e=new URLSearchParams(me),t=e.get("serviceId"),n=e.get("adminUserId"),a=e.get("connectionId");a&&localStorage.setItem("CID",a),localStorage.getItem("UUID")||localStorage.setItem("UUID",Object(B.uuid)()),t&&localStorage.setItem("coachServiceId",t||"cudb-live"),n&&localStorage.setItem("adminUserId",n),n&&t&&pe(n,t)},[c.client]);var pe=function(e,t){c.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,v(e,"$","$..role"),hn(localStorage.getItem("CID")),t),c.subscribeToSurvey(m.SurveyTopics,hn(localStorage.getItem("CID")),function(e){var t,n;D(null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0])})};Object(a.useEffect)(function(){(le||localStorage.getItem("TOKEN"))&&(o(vt()),ne(!0))},[le]),Object(a.useEffect)(function(){if(Q){var e,t,n,a,i=Q.firstName||"",c=Q.lastName||"";if(!i&&!c)return void z("");z(i+" "+c),Z(null!==(e=null===Q||void 0===Q||null===(t=Q.profileImage)||void 0===t||null===(n=t.urls)||void 0===n||null===(a=n.original)||void 0===a?void 0:a.url)&&void 0!==e?e:"/images/users/user.png")}else z("")},[Q]);var Oe=Object(oa.jsx)("ul",{className:"user-dropdown",children:Object(oa.jsxs)(i.a.Fragment,{children:["candidate"===(null===Q||void 0===Q||null===(t=Q.coach)||void 0===t?void 0:t.type)&&Object(oa.jsxs)("li",{onClick:function(){return x(!0)},children:[Object(oa.jsx)(fa.a,{src:"/images/payment.svg",className:"drop-icon "}),Object(oa.jsx)("span",{className:"ml-3",children:"Payment"})]}),"coach"===(null===Q||void 0===Q||null===(n=Q.coach)||void 0===n?void 0:n.type)&&Object(oa.jsxs)("li",{onClick:function(){return k(!0)},children:[Object(oa.jsx)(fa.a,{src:"/images/person.svg"}),Object(oa.jsx)("span",{className:"ml-3",children:"Profile"})]}),Object(oa.jsxs)("li",{onClick:function(){o(ce({data:{payload:JSON.stringify({userId:localStorage.getItem("RID"),connectionId:"".concat(localStorage.getItem("CID")),cudbServiceId:"".concat(localStorage.getItem("coachServiceId")),configUserId:"".concat(localStorage.getItem("adminUserId"))})},callback:function(e){window.location.href="".concat("https://live.staging.beam.live","/auth/login?token=").concat(e.encryptedPayload)}}))},children:[Object(oa.jsx)(fa.a,{src:"/images/chat.svg"}),Object(oa.jsx)("span",{className:"ml-3",children:"Chat"})]}),Object(oa.jsxs)("li",{onClick:function(){return Y(!0)},children:[Object(oa.jsx)(fa.a,{className:"ml-2",src:"/images/desktop-icon.svg"}),Object(oa.jsx)("span",{className:"ml-3",children:"Order"})]}),Object(oa.jsxs)("li",{onClick:function(){ne(!1),o({type:de})},children:[Object(oa.jsx)(fa.a,{className:"ml-2",src:"/images/logout.svg"}),Object(oa.jsx)("span",{className:"ml-2",children:"Logout"})]})]})});return Object(oa.jsxs)("div",{className:"header main-column mobile-responsive",style:{padding:"10px 20px",borderBottom:"1px solid #ddd"},children:[Object(oa.jsxs)(Yn.a,{align:"middle",justify:"space-between",className:"w-full",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(ud.b,{to:"/coach",children:Object(oa.jsx)("img",{src:"/images/logo-icon.svg",alt:"Coach App Icon",style:{height:"40px"}})})}),te&&Q&&Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(ni.a,{overlay:Oe,placement:"bottomRight",trigger:["click"],onVisibleChange:function(e){return O(e)},children:Object(oa.jsxs)("div",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[Object(oa.jsx)("img",{src:K,alt:"User Profile",style:{height:"40px",width:"40px",borderRadius:"50%",marginRight:"8px"}}),Object(oa.jsx)("p",{className:"mr-1 ml-1",children:V}),p?Object(oa.jsx)(vu.a,{style:{fontSize:"10px"}}):Object(oa.jsx)(aa.a,{style:{fontSize:"10px"}})]})})}),!te&&Object(oa.jsxs)(Hn.a,{style:{marginLeft:"auto",display:"flex",gap:"10px"},children:[Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-50",onClick:function(){o({type:A})},children:"Login"}),Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-50",onClick:function(){o({type:U})},children:"Register"})]})]}),g&&Object(oa.jsx)(mu,{socket:c,onClose:function(){x(!g)},disableClose:!1}),ie&&Object(oa.jsx)(pu,{socket:c,onClose:function(){o({type:M})},disableClose:!1}),N&&Object(oa.jsx)(Cu,{socket:c,coach:w,categoriesList:be,onClose:function(){k(void 0)},onAdd:function(){o(vt())}}),oe&&Object(oa.jsx)(Ou,{socket:c,onClose:function(){o({type:L})},disableClose:!1}),$&&Object(oa.jsx)(qu,{socket:c,onClose:function(){Y(!1)}}),se&&Object(oa.jsx)(fu,{socket:c,onClose:function(){o({type:q})},disableClose:!1})]})},_u=function(e){var t=e.color,n=void 0===t?"#91A5C6":t,i=Object(a.useState)(!1),c=Object(u.a)(i,2),o=c[0],l=c[1];return Object(oa.jsx)("svg",{onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)},width:"20",height:"19",viewBox:"0 0 20 19",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Object(oa.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.7795 0C18.8841 0 19.7795 0.89543 19.7795 2C19.7795 2.46168 19.6198 2.90915 19.3275 3.26648L13.4521 10.4475C13.1598 10.8048 13 11.2522 13 11.7139V15.5585C13 16.4193 12.4492 17.1836 11.6325 17.4558L9.63249 18.1225C8.5846 18.4718 7.45196 17.9055 7.10267 16.8576C7.03469 16.6537 7.00003 16.4401 7.00003 16.2251V11.7139C7.00003 11.2522 6.8403 10.8048 6.54795 10.4475L0.672605 3.26648C-0.0268505 2.41159 0.099154 1.15154 0.954044 0.452085C1.31137 0.159729 1.75883 0 2.22052 0H17.7795ZM17.7795 2H2.22052L8.09586 9.18097C8.63185 9.83607 8.94495 10.6427 8.99341 11.4838L9.00003 11.7139V16.225L11 15.5585V11.7139C11 10.8675 11.2685 10.045 11.7636 9.36331L11.9042 9.18097L17.7795 2Z",fill:o?"#508AFA":n||"#91A5C6"})})},$u=(Gn.a.Option,function(e){var t,n,i=e.isModalVisible,c=e.setIsModalVisible,o=e.onChange,l=e.filterOptions,r=Object(a.useState)({yearsOfExperience:(null===l||void 0===l?void 0:l.yearsOfExperience)||{min:0,max:100},hourlyRate:(null===l||void 0===l?void 0:l.hourlyRate)||{min:0,max:500},dailyRate:(null===l||void 0===l?void 0:l.dailyRate)||{min:0,max:5e3},availabilityDays:(null===l||void 0===l?void 0:l.availabilityDays)||["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],timeFilter:(null===l||void 0===l?void 0:l.timeFilter)||void 0}),v=Object(u.a)(r,2),b=v[0],j=v[1],m=Object(a.useState)(null===l||void 0===l||null===(t=l.timeFilter)||void 0===t?void 0:t.value),p=Object(u.a)(m,2),O=p[0],f=p[1],h=Object(a.useState)((null===l||void 0===l||null===(n=l.timeFilter)||void 0===n?void 0:n.key)||void 0),g=Object(u.a)(h,2),x=g[0],y=g[1],I=Object(a.useState)([]),S=Object(u.a)(I,2),N=S[0],k=S[1],w=Object(a.useState)(!1),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(s.b)(),A=function(e){x!==e&&(f(void 0),k([]),M(e),y(e))},M=function(e){var t="@serviceId:{'".concat(z(localStorage.getItem("coachServiceId")||"cudb-live"),"'}");P(!0);var n={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:t,searchOptions:"TIMEOUT 5000"},load:Object(T.a)({id:"$.objectId",roleId:"$..admin.profile.roleId",coach:"$..persistent.static.coach",type:"$..persistent.static.coach.type"},e,"$..persistent.static.coach.bio.location.attributes.".concat(e))},apply:{expression:"",name:""},groupBy:{properties:["@".concat(e)],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:"exists(@roleId) && (@roleId === '".concat(localStorage.getItem("coachRoleId"),"') && exists(@type) && (@type === 'coach') && exists(@").concat(e,")")},anyStatus:!1};D(tt({requestData:n,callback:function(e){var t=[];null===e||void 0===e||e.map(function(e){e[Object.keys(e)[0]]&&t.push({label:e[Object.keys(e)[0]],value:e[Object.keys(e)[0]]})}),k(t),P(!1)}}))},L=function(){c(!1),o(b)},U=function(e,t){return j(function(n){return Object(d.a)(Object(d.a)({},n),{},Object(T.a)({},e,t))})};return Object(oa.jsx)($n.a,{title:"Filter Coaches",visible:i,onOk:L,onCancel:function(){return c(!1)},width:"450px",className:"beam-modal",footer:null,destroyOnClose:!0,children:Object(oa.jsxs)("div",{className:"ml-2 mr-2",children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("h5",{children:"Years of Experience"}),Object(oa.jsx)(ea.a,{range:!0,max:100,value:[b.yearsOfExperience.min,b.yearsOfExperience.max],onChange:function(e){return U("yearsOfExperience",{min:e[0],max:e[1]})}})]})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("h5",{children:"Hourly Rate"}),Object(oa.jsx)(ea.a,{range:!0,max:100,value:[b.hourlyRate.min,b.hourlyRate.max],onChange:function(e){return U("hourlyRate",{min:e[0],max:e[1]})}})]})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("h5",{children:"Daily Rate"}),Object(oa.jsx)(ea.a,{range:!0,max:500,value:[b.dailyRate.min,b.dailyRate.max],onChange:function(e){return U("dailyRate",{min:e[0],max:e[1]})}})]})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("h5",{children:"Availability Days"}),Object(oa.jsx)("div",{className:"days-container",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(function(e){return Object(oa.jsx)(yu.a,{checked:b.availabilityDays.includes(e),onChange:function(t){var n=t?[].concat(Object(C.a)(b.availabilityDays),[e]):b.availabilityDays.filter(function(t){return t!==e});U("availabilityDays",n)},className:"day-tag",children:e},e)})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row-1",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card-coach mt-2",children:[Object(oa.jsxs)(Yn.a,{className:"d-flex flex-wrap mt-3",id:"filters",children:[Object(oa.jsx)("div",{onClick:function(){A("state")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("state"===x?"green-btn cover":""),children:"State"})}),Object(oa.jsx)("div",{onClick:function(){A("city")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("city"===x?"green-btn cover":""),children:"City"})}),Object(oa.jsx)("div",{onClick:function(){A("county")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("county"===x?"green-btn cover":""),children:"County"})}),Object(oa.jsx)("div",{onClick:function(){A("zip")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("zip"===x?"green-btn cover":""),children:"Zip"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{xs:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:R,allowClear:!0,options:N,value:O,onChange:function(e){f(e),U("timeFilter",{key:x,value:e})}})})})]})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:function(){return j({expertise:void 0,yearsOfExperience:{min:0,max:100},hourlyRate:{min:0,max:500},dailyRate:{min:0,max:5e3},availabilityDays:[],timeFilter:void 0})},children:"Reset"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:L,children:"Save"})})]})]})})}),Yu=function(e){var t=e.onChange,n=e.filterOptions,i=Object(a.useState)(!1),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)({}),r=Object(u.a)(s,2),v=r[0],b=r[1],j=Object(a.useState)(""),m=Object(u.a)(j,2),p=m[0],O=m[1];return Object(oa.jsxs)("div",{className:"filter-container",children:[Object(oa.jsx)(Wn.a,{className:"beam-input",value:p,onChange:function(e){var n=e.target.value;O(n);var a=Object(d.a)(Object(d.a)({},v),{},{name:n});b(a),t(a)},placeholder:"Search Coaches",suffix:Object(oa.jsx)(Jl.a,{style:{fontSize:23}})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",onClick:function(){return l(!o)},children:Object(oa.jsx)(_u,{})}),o&&Object(oa.jsx)($u,{isModalVisible:o,setIsModalVisible:l,onChange:function(e){var n=Object(d.a)(Object(d.a)({},v),e);b(n),t(n)},filterOptions:n})]})},Hu=xs.a.Title,Wu=function(e){var t=e.categoriesInfo,n=e.onChange,i=Object(a.useState)([]),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)({}),r=Object(u.a)(s,2),v=r[0],b=r[1];Object(a.useEffect)(function(){var e;null!==t&&void 0!==t&&null!==(e=t.categories)&&void 0!==e&&e.length&&(l(Object(C.a)(null===t||void 0===t?void 0:t.categories)),b(null===t||void 0===t?void 0:t.subcategories))},[t]);var j=Object(a.useState)([]),m=Object(u.a)(j,2),p=m[0],O=m[1],f=Object(a.useState)({}),h=Object(u.a)(f,2),g=h[0],x=h[1];return Object(a.useEffect)(function(){n({selectedCategories:p,selectedSubcategories:g})},[p,g,n]),Object(oa.jsxs)("div",{children:[Object(oa.jsxs)("div",{className:"categories-box",children:[Object(oa.jsx)(Hu,{level:4,children:"Select Categories"}),Object(oa.jsx)("div",{className:"categories-container",children:o.map(function(e){return Object(oa.jsx)(yu.a,{checked:p.includes(e),onChange:function(t){return function(e,t){O(function(n){var a=t?[].concat(Object(C.a)(n),[e]):n.filter(function(t){return t!==e});return x(function(n){var a=Object(d.a)({},n);return t||delete a[e],a}),a})}(e,t)},className:"category-tag",children:e},e)})})]}),p.length>0&&Object(oa.jsxs)("div",{className:"categories-box subcategories-box",children:[Object(oa.jsx)(Hu,{level:4,children:"Select Subcategories"}),Object(oa.jsx)("div",{className:"categories-container",children:p.flatMap(function(e){return(v[e]||[]).map(function(t){var n;return Object(oa.jsx)(yu.a,{checked:null===(n=g[e])||void 0===n?void 0:n.includes(t),onChange:function(n){return function(e,t,n){x(function(a){var i=Object(d.a)(Object(d.a)({},a),{},Object(T.a)({},e,n?[].concat(Object(C.a)(a[e]||[]),[t]):(a[e]||[]).filter(function(e){return e!==t})));return 0===i[e].length&&delete i[e],i})}(e,t,n)},className:"subcategory-tag",children:t},t)})})})]})]})},Vu=(n(550),n(1075),xs.a.Title),zu=xs.a.Text,Qu=xs.a.Link,Gu=function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m=e.profile,p=e.remove;return Object(oa.jsx)(ud.b,{to:"/coach/".concat(null===m||void 0===m?void 0:m.id),className:"profile-card-link",children:Object(oa.jsxs)("div",{className:"profile-card",children:[Object(oa.jsxs)("div",{className:"profile-section",children:[Object(oa.jsx)("div",{className:"profile-image",children:Object(oa.jsx)("img",{src:(null===m||void 0===m?void 0:m.image)||"/images/users/user.png",alt:"".concat(null===m||void 0===m?void 0:m.name," profile")})}),Object(oa.jsx)("div",{className:"profile-details",children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Vu,{level:4,children:null===m||void 0===m?void 0:m.name}),Object(oa.jsxs)(zu,{children:[" ",Object(oa.jsxs)("strong",{children:[null===m||void 0===m||null===(t=m.bio)||void 0===t?void 0:t.title," "]})]}),Object(oa.jsx)("br",{}),Object(oa.jsx)(zu,{children:Object(oa.jsx)("strong",{children:null===m||void 0===m||null===(n=m.bio)||void 0===n?void 0:n.education})}),Object(oa.jsx)("br",{}),Object(oa.jsxs)(zu,{children:[(null===m||void 0===m||null===(a=m.bio)||void 0===a?void 0:a.experience)+" years of experience"," "]}),Object(oa.jsx)(Eu.a,{style:{fontSize:20},disabled:!0,allowHalf:!0,value:(null===m||void 0===m?void 0:m.ratings.totalRatings)||0}),Object(oa.jsx)("strong",{children:" ".concat((null===m||void 0===m||null===(i=m.ratings)||void 0===i?void 0:i.totalRatings)||0," (").concat((null===m||void 0===m||null===(c=m.ratings)||void 0===c?void 0:c.totalNoOfRatings)||0," reviews)")})]})})]}),Object(oa.jsxs)("div",{children:[Object(oa.jsxs)("div",{className:"mt-2",style:{minHeight:"322px"},children:[Object(oa.jsxs)(zu,{className:"description",children:[(b=null===m||void 0===m||null===(o=m.bio)||void 0===o?void 0:o.description,j=300,b?b.length>j?"".concat(b.substring(0,j),"..."):b:""),Object(oa.jsx)("br",{}),Object(oa.jsx)(Qu,{href:null===m||void 0===m||null===(l=m.bio)||void 0===l?void 0:l.link,target:"_blank",children:null===m||void 0===m||null===(s=m.bio)||void 0===s?void 0:s.link})]}),Object(oa.jsxs)("div",{className:"rates",children:[Object(oa.jsxs)(zu,{children:[Object(oa.jsx)("strong",{children:"Hourly Rate:"})," $",null===m||void 0===m||null===(r=m.bio)||void 0===r?void 0:r.hourlyRate]}),Object(oa.jsx)("br",{}),Object(oa.jsxs)(zu,{children:[Object(oa.jsx)("strong",{children:"Daily Rate:"})," $",null===m||void 0===m||null===(d=m.bio)||void 0===d?void 0:d.dailyRate]}),Object(oa.jsx)("br",{}),Object(oa.jsx)("br",{}),Object(oa.jsx)(zu,{children:Object(oa.jsx)("strong",{children:"Days:"})}),Object(oa.jsxs)("div",{className:"days-container",children:[(null===m||void 0===m||null===(u=m.days)||void 0===u?void 0:u.length)>0&&m.days.map(function(e){return Object(oa.jsx)(Kn.a,{className:"day-tag",children:e},e)}),0===(null===m||void 0===m||null===(v=m.days)||void 0===v?void 0:v.length)&&Object(oa.jsx)(zu,{children:"n/a"})]}),Object(oa.jsx)("br",{})]})]}),Object(oa.jsxs)("div",{className:"card-buttons",children:[Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",children:"Connect"}),Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn cover w-full",children:"Schedule"}),Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:function(e){e.preventDefault(),p(m.id)},disabled:!0,children:"Remove"})]})]})]})})},Ju=n(311),Ku=(Object(B.uuid)(),Object(B.uuid)(),Object(B.uuid)(),Object(B.uuid)(),Object(B.uuid)(),Object(B.uuid)(),function(e){var t=e.coachList,n=e.currentCoachPage,i=e.totalCount,c=void 0===i?0:i,o=e.defaultPageSize,l=void 0===o?10:o,s=e.onChange,r=Object(a.useState)(t),d=Object(u.a)(r,2),v=d[0],b=d[1],j=Object(a.useState)(n),m=Object(u.a)(j,2),p=m[0],O=m[1],f=function(e){O(e),s(e)},h=function(e){var t=v.filter(function(t){return t.id!==e});b(Object(C.a)(t)),Lt("Coach removed from search successfully","successs","TOP_CENTER",1e3)};return Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsx)("div",{className:"profile-list",children:t.map(function(e,t){return Object(oa.jsx)(Gu,{profile:e,remove:h},t)})}),Object(oa.jsx)("div",{className:"pagination",children:Object(oa.jsx)(Ju.a,{current:p,total:c,pageSize:l,onChange:function(e){return f(e)},showSizeChanger:!1})})]})}),Zu=n(1045),Xu=(n(511),xs.a.Title),ev=xs.a.Text,tv=function(e){var t=e.onSelect,n=e.pricingPlans,i=e.data,c=Object(a.useState)(i||""),o=Object(u.a)(c,2),l=o[0],s=o[1],r=Object(a.useState)(n||[]),d=Object(u.a)(r,2),v=d[0],b=d[1];Object(a.useEffect)(function(){if(n){var e=null===n||void 0===n?void 0:n.filter(function(e){return e.features.length&&(null===e||void 0===e?void 0:e.title)});b(Object(C.a)(e))}},n);return Object(oa.jsxs)("div",{className:"pricing-plans",children:[Object(oa.jsxs)("div",{className:"pricing-header",children:[Object(oa.jsx)(Xu,{level:1,children:"Pricing"}),Object(oa.jsxs)(ev,{children:[" ",Object(oa.jsx)("strong",{children:"Choose a plan to schdule your Coach !"})]})]}),Object(oa.jsxs)("div",{style:{display:"flex",placeContent:"center"},children:[0===(null===v||void 0===v?void 0:v.length)&&Object(oa.jsx)(ev,{children:"No Plan available"}),0!==(null===v||void 0===v?void 0:v.length)&&Object(oa.jsx)(Yn.a,{className:"pricing",gutter:[24,24],justify:"center",children:v.map(function(e,n){return Object(oa.jsx)(Hn.a,{xs:24,sm:12,md:8,style:{width:"150%",minWidth:"230px"},children:Object(oa.jsxs)("div",{style:{position:"relative",display:"inline-block",width:"100%",minWidth:"160px"},children:[(null===e||void 0===e?void 0:e.recommended)&&Object(oa.jsxs)(Kn.a,{color:"#FBAE16",style:{position:"absolute",top:"10px",left:"10px",zIndex:1,display:"flex",alignItems:"center",gap:"4px"},children:[Object(oa.jsx)(Sr.a,{})," Recommended"]}),Object(oa.jsxs)(Cc.a,{bordered:l===e.title,className:"pricing-card ".concat(l===e.title?"selected":""),title:Object(oa.jsx)(Xu,{level:3,children:e.title}),onClick:function(){return t=e.title,void s(t);var t},hoverable:!0,style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",minHeight:"450px",minWidth:"180px"},children:[Object(oa.jsxs)("div",{children:[Object(oa.jsxs)(Xu,{level:2,children:["$",null===e||void 0===e?void 0:e.price]}),Object(oa.jsx)(Ms.a,{}),Object(oa.jsx)("ul",{className:"plan-features",style:{maxHeight:"350px",overflowY:"auto",padding:"30px 10px 30px"},children:e.features.map(function(t,n){return Object(oa.jsxs)("li",{children:[Object(oa.jsx)(Sr.a,{style:{color:l===e.title?"#FBAE16":"#1890ff",marginRight:"8px"}})," ",t]},"".concat(t,"-").concat(n))})})]}),Object(oa.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"20px"},children:Object(oa.jsx)(Vn.a,{onClick:function(){return function(e){t(e)}(e.title)},className:"beam-btn green-btn cover w-5",children:"Schedule"})})]})]})},"".concat(e.title,"-").concat(n))})})]})]})},nv=(n(988),xs.a.Title),av=xs.a.Text,iv=function(){for(var e=[],t=0;t<30;t++){var n=new Date;n.setDate(n.getDate()+t),e.push({dayName:Object(gu.a)(n,"EEE"),date:Object(gu.a)(n,"MMM dd"),fullDate:Object(gu.a)(n,"yyyy-MM-dd")})}return e}(),cv=function(e){var t=e.onSelect,n=e.assignAvailability,i=e.date,c=e.time,o=e.bookedSlots,l=Object(a.useState)(i||null),s=Object(u.a)(l,2),r=s[0],d=s[1],v=Object(a.useState)(c||null),b=Object(u.a)(v,2),j=b[0],m=b[1];return Object(oa.jsxs)("div",{className:"scheduling-component",children:[Object(oa.jsx)(nv,{level:2,children:"Schedule Your Session"}),Object(oa.jsx)(av,{children:"Select a day and time slot for your session"}),Object(oa.jsxs)("div",{className:"schedule-card",children:[Object(oa.jsxs)("div",{className:"day-selection-container",children:[Object(oa.jsx)(nv,{level:4,children:"Available Days"}),Object(oa.jsx)(Yn.a,{gutter:[16,16],className:"day-selection",children:iv.map(function(e){var t;return Object(oa.jsx)(Hn.a,{xs:12,sm:6,md:4,children:Object(oa.jsxs)(Cc.a,{bordered:r===e.fullDate,className:"day-card ".concat(r===e.fullDate?"selected":""," ").concat(null!==(t=n[e.fullDate])&&void 0!==t&&t.length?"":"no-time-slots"),onClick:function(){var t;null!==(t=n[e.fullDate])&&void 0!==t&&t.length&&function(e){d(e),m(null)}(e.fullDate)},hoverable:!0,children:[Object(oa.jsx)(av,{className:"slot",strong:!0,style:{display:"block",fontSize:"18px"},children:e.dayName}),Object(oa.jsx)(av,{className:"slot",style:{display:"block"},children:e.date})]})},e.fullDate.toString())})})]}),Object(oa.jsx)(Ms.a,{}),r&&Object(oa.jsxs)("div",{className:"time-selection-container",children:[Object(oa.jsx)(nv,{level:4,children:"Available Time Slots"}),!n[r]&&Object(oa.jsx)(Yn.a,{style:{display:"flex",placeContent:"center",height:"100px"},children:Object(oa.jsx)(nv,{level:5,children:" No Time Slot Available"})}),n[r]&&Object(oa.jsx)(Yn.a,{gutter:[16,16],className:"time-selection",children:n[r].map(function(e){return Object(oa.jsx)(Hn.a,{xs:12,sm:6,md:4,children:Object(oa.jsx)(Sl.a,{title:o["".concat(r,":").concat(e)]===e?"This time slot is already booked":"",children:Object(oa.jsx)(Cc.a,{bordered:j===e,className:"time-card ".concat(j===e?"selected":""," ").concat(o["".concat(r,":").concat(e)]===e?"no-time-slots":""),onClick:function(){o["".concat(r,":").concat(e)]!==e&&function(e){m(e)}(e)},hoverable:!0,children:Object(oa.jsx)(av,{className:"slot",children:e})})})},e)})})]}),r&&j&&Object(oa.jsx)("div",{className:"confirm-button-container",children:Object(oa.jsx)(Vn.a,{onClick:function(){t({day:r,time:j})},className:"beam-btn green-btn cover w-40",children:"Confirm Schedule"})})]})]})},ov=(Za.a.Panel,function(e){e.lastSetupIntent;var t=e.onClose,n=e.onAdd,i=(Object(s.b)(),Object(a.useState)(!0)),c=Object(u.a)(i,2),o=(c[0],c[1],Object(a.useState)(!1)),l=Object(u.a)(o,2),r=l[0],d=l[1],v=Object(b.useStripe)(),j=Object(b.useElements)(),m=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var a,i;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(t.preventDefault(),v&&j){e.n=1;break}return e.a(2);case 1:return d(!0),n(),e.n=2,v.confirmSetup({elements:j,confirmParams:{return_url:window.location.href}});case 2:a=e.v,(i=a.error)&&(console.log("error message",i.message),d(!1),Lt(i.message,"error","TOP_CENTER",3e3));case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return Object(oa.jsx)(oa.Fragment,{children:Object(oa.jsxs)("form",{onSubmit:m,children:[Object(oa.jsx)("div",{className:"mt-2",style:{height:500},children:Object(oa.jsx)(b.PaymentElement,{})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:r,children:"Save"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:function(){t&&t()},children:"Cancel"})})]})]})})}),lv={$:"USD","\xa3":"GBP","\u20ac":"EUR"},sv=function(e){e.onClose;var t,n,c,o,l,r,v,p,O,f,h=e.socket,g=e.pay,x=e.disableClose,y=e.onSaveState,I=e.paymentChargeRequest,S=Object(s.b)(),N=Object(a.useState)(!0),k=Object(u.a)(N,2),T=(k[0],k[1],Object(a.useState)(!1)),C=Object(u.a)(T,2),w=C[0],E=C[1],R=Object(s.c)(function(e){return e.auth}),P=R.userInfo,D=R.project,A=R.projects,M=Object(a.useRef)(),L=Object(a.useState)(void 0),U=Object(u.a)(L,2),q=U[0],F=U[1],B=Object(a.useState)(),_=Object(u.a)(B,2),$=_[0],Y=_[1],H=Object(a.useState)(!1),W=Object(u.a)(H,2),V=W[0],z=W[1],Q=Object(a.useState)(),G=Object(u.a)(Q,2),J=G[0],K=G[1],Z=Object(a.useState)(void 0),X=Object(u.a)(Z,2),ee=X[0],te=X[1],ne=Object(a.useState)(void 0),ae=Object(u.a)(ne,2),ie=ae[0],ce=ae[1],oe=Object(a.useState)(),le=Object(u.a)(oe,2),se=le[0],re=le[1],de=Object(j.a)("pk_live_51MyyRYCFnkD3M6HjXbfzl6NpmEK2rc0RZzyiIhfD3A65zcqf7oEkszPqn8m8qykKN8dqxTeEURAhWhq1ACjmvytL00k1LMsAxw");Object(a.useEffect)(function(){if(D){var e,t=null===A||void 0===A||null===(e=A.projects)||void 0===e?void 0:e.find(function(e){return e.id===D});console.log("selected project",t),ce(null===t||void 0===t?void 0:t.payment)}},[D]),Object(a.useEffect)(function(){var e,t,n,a;(be(),ue(),console.log("user info",P),h.subscribeToEvent(m.SubscribePageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/service/dps/createRecurringPaymentSchedule/reply"),function(e){var t;z(!1);var n,a=null===(t=JSON.parse(e.message))||void 0===t?void 0:t.response;null!==a&&void 0!==a&&a.status?(re(void 0),Lt("Payment subscription successfull","success","TOP_CENTER",1e3)):Lt(null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.details,"error","TOP_CENTER",3e3);S(vt())}),h.subscribeToEvent(m.SubscribePageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/service/dps/cancelRecurringPayment/reply"),function(e){z(!1),Lt("Payment subscription cancelled","success","TOP_CENTER",1e3),S(vt())}),null!==P&&void 0!==P&&null!==(e=P.stripe)&&void 0!==e&&e.subscription)&&(te(Object(d.a)({},null===P||void 0===P||null===(t=P.stripe)||void 0===t?void 0:t.subscription)),re(null===P||void 0===P||null===(n=P.stripe)||void 0===n||null===(a=n.subscription)||void 0===a?void 0:a.expiresAt));console.log("payment options",A),ce(null===A||void 0===A?void 0:A.paymentSettings)},[]);var ue=function(){pe({userId:localStorage.getItem("RID"),cudbServiceId:localStorage.getItem("coachServiceId"),op:"retrieveSetupIntent"},function(e){var t,n;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.lastSetupIntentId?K(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.response):ve()})},ve=function(){pe({userId:localStorage.getItem("RID"),cudbServiceId:localStorage.getItem("coachServiceId"),op:"getSetupIntent"},function(e){var t,n,a;console.log("get setupIntent workflow response",e),K(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.response),je(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(a=n.response)||void 0===a?void 0:a.id)})},be=function(){pe({userId:localStorage.getItem("RID"),cudbServiceId:localStorage.getItem("coachServiceId"),op:"listPaymentMethods"},function(e){var t,n;console.log("list payment methods workflow response",e);var a=(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.response)||void 0===n?void 0:n.data)||[],i=[];a.map(function(e){var t,n,a,c;i.push({id:e.id,type:null===e||void 0===e||null===(t=e.card)||void 0===t||null===(n=t.brand)||void 0===n?void 0:n.toLowerCase(),last4:null===e||void 0===e||null===(a=e.card)||void 0===a?void 0:a.last4,expiry:null===e||void 0===e||null===(c=e.card)||void 0===c?void 0:c.exp_year})}),Y(i)})},je=function(e){S(dt(Object(d.a)(Object(d.a)({},P),{},{lastSetupIntentId:e,silentRequest:!0})))},me=function(e,t){z(!0);var n=Dn({userId:localStorage.getItem("RID"),timestamp:(new Date).getTime(),amount:t,scheduleType:e,userServiceId:localStorage.getItem("coachServiceId")||"cudb-live"});h.publishToEvent(m.PublishPageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/service/dps/createRecurringPaymentSchedule"),n)},pe=function(e,t){var n={changes:[],configId:"10241",request:Object(d.a)({},e),timeout:1e4};S(lt({request:n,callback:function(e){t&&t(e)}}))},Oe=xs.a.Title,fe=xs.a.Text;return Object(oa.jsxs)("div",{className:"pricing-plans",children:[Object(oa.jsxs)("div",{className:"pricing-header",children:[Object(oa.jsx)(Oe,{level:1,children:"Payment"}),Object(oa.jsxs)(fe,{children:[" ",Object(oa.jsx)("strong",{children:"Manage your Payment"})]})]}),Object(oa.jsxs)("div",{className:"pricing",children:[Object(oa.jsxs)(Yn.a,{style:{display:"flex",placeContent:"center",flexDirection:"column",alignItems:"center"},children:[null===$||void 0===$?void 0:$.map(function(e,t){return Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsxs)("div",{className:"credit-card ".concat(e.type," ").concat(q===e.id?"selected":"selectable"),children:[Object(oa.jsx)("div",{className:"credit-card-last4",children:e.last4}),Object(oa.jsx)("div",{className:"credit-card-expiry",children:e.expiry}),Object(oa.jsx)("div",{className:"delete",children:Object(oa.jsx)(na.a,{onClick:function(t){var n;t.preventDefault(),t.stopPropagation(),1==window.confirm("Are you sure you want to delete payment method?")&&(n=e.id,pe({userId:localStorage.getItem("RID"),cudbServiceId:localStorage.getItem("coachServiceId"),op:"detachPaymentMethod",paymentMethodId:n},function(e){console.log("deattach response",e),be(),ve(),Lt("Payment method deleted successfully","success","TOP_CENTER",1e3)}))}})})]}),Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover mt-3",style:{width:100},onClick:function(){I(),g&&F(e.id)},children:"Charge"})]})}),!w&&J&&$&&0===$.length&&Object(oa.jsx)("div",{className:"credit-card new selectable",onClick:function(){E(!0)},children:Object(oa.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[Object(oa.jsx)(fa.a,{src:"/images/plus-icon.svg"}),Object(oa.jsx)("h4",{className:"mt-3",children:"Add new card"})]})})]}),g&&Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){z(!0),function(e){var t,n,a,i=Dn({request:{op:"charge",charge:null===g||void 0===g||null===(t=g.data)||void 0===t?void 0:t.amount,currency:lv[null===g||void 0===g||null===(n=g.data)||void 0===n?void 0:n.currency],customerId:P.stripeCustomerId,source:q,description:null===g||void 0===g||null===(a=g.data)||void 0===a?void 0:a.description}});h.publishToEvent(m.PublishPageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/workflow/").concat(e,"/requestWorkflow"),i)}(M.current)},disabled:!q,loading:V,children:"Charge"})})}),w&&Object(oa.jsx)(b.Elements,{stripe:de,options:{clientSecret:J.client_secret},children:Object(oa.jsx)(ov,{lastSetupIntent:J,onClose:function(){return E(!1)},onAdd:function(e){y()}})}),!x&&Object(oa.jsxs)(i.a.Fragment,{children:["recurring"===(null===ie||void 0===ie?void 0:ie.type)&&Object(oa.jsxs)("div",{className:"mt-3",children:[Object(oa.jsx)("h5",{children:"Choose your plan"}),se&&Object(oa.jsxs)("p",{children:["Expires on: ",null===(t=new Date(se))||void 0===t?void 0:t.toLocaleDateString()]}),null===ie||void 0===ie||null===(n=ie.info)||void 0===n||null===(c=n.recurringDetails)||void 0===c?void 0:c.map(function(e){return Object(oa.jsxs)(Yn.a,{className:"person-item d-flex mt-2",style:{border:"2px solid ".concat((null===ee||void 0===ee?void 0:ee.scheduleType)===e.billingCycle?"#40CC52":"#d9d9d9"),cursor:"pointer",boxShadow:"0px 0px 15px 0px rgba(223, 229, 238, 1)"},onClick:function(){te({scheduleType:e.billingCycle,amount:e.amount})},children:[Object(oa.jsxs)(Hn.a,{span:14,children:[Object(oa.jsx)("h5",{children:e.name}),Object(oa.jsxs)("p",{children:["$ ",e.amount,"/",e.billingCycle]})]}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",checked:(null===ee||void 0===ee?void 0:ee.scheduleType)===e.billingCycle})})]})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:null===P||void 0===P||null===(o=P.stripe)||void 0===o||null===(l=o.subscription)||void 0===l||null===(r=l.schedule)||void 0===r||!r.id||se&&se<(new Date).getTime()?Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){me(null===ee||void 0===ee?void 0:ee.scheduleType,null===ee||void 0===ee?void 0:ee.amount)},loading:V,children:"Subscribe"}):Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn cover w-full",onClick:function(){!function(){z(!0);var e=Dn({userId:localStorage.getItem("RID")});h.publishToEvent(m.PublishPageTopics,"".concat("beamdevlive","/connection/").concat(localStorage.getItem("CID"),"/service/dps/cancelRecurringPayment"),e)}()},loading:V,children:"Cancel subscription"})})})]}),"fixed"===(null===ie||void 0===ie?void 0:ie.type)&&Object(oa.jsxs)("div",{className:"mt-3",children:[Object(oa.jsx)("h5",{children:"Fixed plan"}),Object(oa.jsxs)(Yn.a,{className:"person-item d-flex mt-2",style:{border:"2px solid ".concat((null===ee||void 0===ee?void 0:ee.scheduleType)===(null===ie||void 0===ie?void 0:ie.type)?"#40CC52":"#d9d9d9"),cursor:"pointer",boxShadow:"0px 0px 15px 0px rgba(223, 229, 238, 1)"},onClick:function(){var e;te({scheduleType:null===ie||void 0===ie?void 0:ie.type,amount:null===ie||void 0===ie||null===(e=ie.info)||void 0===e?void 0:e.amount})},children:[Object(oa.jsxs)(Hn.a,{span:14,children:[Object(oa.jsx)("h5",{children:null===ie||void 0===ie||null===(v=ie.info)||void 0===v?void 0:v.name}),Object(oa.jsxs)("p",{children:["$ ",null===ie||void 0===ie||null===(p=ie.info)||void 0===p?void 0:p.amount]})]}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Xn.a,{className:"mb-2 ml-0",checked:(null===ee||void 0===ee?void 0:ee.scheduleType)===(null===ie||void 0===ie?void 0:ie.type)})})]}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:!(null!==P&&void 0!==P&&null!==(O=P.stripe)&&void 0!==O&&null!==(f=O.subscription)&&void 0!==f&&f.expiresAt)&&Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){me(null===ee||void 0===ee?void 0:ee.scheduleType,null===ee||void 0===ee?void 0:ee.amount)},loading:V,children:"Pay"})})})]})]})]})]})},rv=(n(989),xs.a.Title,xs.a.Text),dv=(xs.a.Link,function(e){var t=e.onClose,n=e.reviews,i=Object(a.useState)(!0),c=Object(u.a)(i,2),o=c[0],l=c[1],s=Object(a.useState)(null),r=Object(u.a)(s,2),d=(r[0],r[1],Object(a.useState)("")),v=Object(u.a)(d,2),b=(v[0],v[1],Object(a.useState)(!1)),j=Object(u.a)(b,2);j[0],j[1];return Object(oa.jsx)($n.a,{title:"Ratings and Review",visible:o,onCancel:function(){l(!1),t()},className:"beam-modal ratings-modal",width:"600px",footer:null,destroyOnClose:!0,children:Object(oa.jsx)("div",{className:"review-list",children:n.length>0?Object(oa.jsx)(zn.b,{itemLayout:"horizontal",dataSource:n,renderItem:function(e,t){var n,a,i,c;return Object(oa.jsx)(zn.b.Item,{children:Object(oa.jsxs)(Hn.a,{children:[Object(oa.jsxs)("div",{style:{display:"flex",placeContent:"flex-start"},children:[Object(oa.jsx)("div",{className:"profile-image mr-2",children:Object(oa.jsx)("img",{src:(null===e||void 0===e||null===(n=e.userInfo)||void 0===n?void 0:n.image)||"/images/users/user.png",alt:"".concat(null===e||void 0===e||null===(a=e.userInfo)||void 0===a?void 0:a.firstame," profile")})}),Object(oa.jsx)(rv,{className:"mt-1",children:Object(oa.jsx)("strong",{children:(null===e||void 0===e||null===(i=e.userInfo)||void 0===i?void 0:i.firstName)+" "+(null===e||void 0===e||null===(c=e.userInfo)||void 0===c?void 0:c.lastName)})})]}),Object(oa.jsxs)("div",{className:"review-item ml-1 mr-2",children:[Object(oa.jsx)(Eu.a,{style:{fontSize:20},disabled:!0,allowHalf:!0,value:e.rating||0}),Object(oa.jsx)("p",{children:e.review})]})]})})}}):Object(oa.jsx)("p",{className:"no-reviews",children:"No reviews available."})})})}),uv=xs.a.Title,vv=xs.a.Text,bv=function(e){var t=e.onSelect,n=e.categoriesPricingPlans,i=e.data,c=Object(a.useState)(i||""),o=Object(u.a)(c,2),l=o[0],s=(o[1],Object(a.useState)(n||[])),r=Object(u.a)(s,2),d=r[0],v=r[1];Object(a.useEffect)(function(){if(n){var e=null===n||void 0===n?void 0:n.filter(function(e){return(null===e||void 0===e?void 0:e.name)&&e.pricingPlans.length});v(Object(C.a)(e))}},[n]);return Object(oa.jsxs)("div",{className:"pricing-plans",children:[Object(oa.jsxs)("div",{className:"pricing-header",children:[Object(oa.jsx)(uv,{level:1,children:"Catrgeories"}),Object(oa.jsxs)(vv,{children:[" ",Object(oa.jsx)("strong",{children:"Choose a category to schedule your Coach !"})]})]}),Object(oa.jsxs)("div",{style:{display:"flex",placeContent:"center"},children:[0===(null===d||void 0===d?void 0:d.length)&&Object(oa.jsx)(vv,{children:"No Data available"}),0!==(null===d||void 0===d?void 0:d.length)&&Object(oa.jsx)(Yn.a,{className:"pricing",style:{display:"flex",flexDirection:"column",placeContent:"center"},children:d.map(function(e,n){return Object(oa.jsx)(Hn.a,{className:"mb-2",style:{width:"50%"},children:Object(oa.jsx)("div",{style:{display:"flex",justifyContent:"center",margin:"10px",width:"100%",minWidth:"15vh",maxWidth:"60vh"},children:Object(oa.jsx)(Vn.a,{"aria-selected":!0,onClick:function(){t(e)},className:"beam-btn green-btn w-100 ".concat(l===(null===e||void 0===e?void 0:e.name)?"selected":""),children:null===e||void 0===e?void 0:e.name})})},n)})})]})]})},jv=xs.a.Title,mv=xs.a.Text,pv=xs.a.Link,Ov=Zu.a.Step,fv=function(e){var t,n=e.socket,i=e.coach,c=Object(s.b)(),o=Object(s.c)(function(e){return e.auth}).userInfo,r=Mn().updateUserRequestPayloadV2,v=Object(a.useState)({}),b=Object(u.a)(v,2),j=b[0],p=b[1],O=Object(a.useState)([]),f=Object(u.a)(O,2),h=f[0],g=f[1],I=Object(a.useState)([]),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(a.useState)([]),w=Object(u.a)(T,2),E=w[0],R=w[1],P=Object(a.useState)([]),D=Object(u.a)(P,2),M=D[0],L=D[1],U=Object(a.useState)({}),q=Object(u.a)(U,2),F=q[0],B=q[1],_=Object(a.useState)({totalRatings:0,totalNoOfRatings:0,ratings:[]}),$=Object(u.a)(_,2),Y=$[0],W=$[1],V=Object(a.useState)({}),z=Object(u.a)(V,2),Q=z[0],G=z[1],J=Object(a.useState)(!0),K=Object(u.a)(J,2),Z=K[0],X=K[1],ee=Object(a.useState)(0),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ie=Object(a.useState)(!1),ce=Object(u.a)(ie,2),oe=ce[0],le=ce[1],se=function(){ae(function(e){return e+1})},re=function(){ae(function(e){return e-1})};Object(a.useEffect)(function(){i&&de()},[i]);Object(a.useEffect)(function(){j&&null!==h&&void 0!==h&&h.length&&M&&o&&X(!1)},[j,h,E,M,o]);var de=function(){var e=i.ratings,t=i.bio,n=i.categories,a=(i.pricingPlans,i.assignAvailability),c=i.bookedSlots;if(W(Object(d.a)({},e)),p(Object(d.a)({},t)),null!==n&&void 0!==n&&n.length){var o=n.reduce(function(e,t){return e.push.apply(e,Object(C.a)(t.subcategories)),e},[]),l=Object(C.a)(new Set(o));g(l);var s=n.filter(function(e){return null===e||void 0===e?void 0:e.pricingPlans});k(Object(C.a)(s))}a&&L(a),c&&B(c)},ue=Object(l.g)();Object(a.useEffect)(function(){if(new URLSearchParams(ue.search).get("setup_intent")){var e=localStorage.getItem("userSelectedData");if(e){console.log("Retrieved userData:",JSON.parse(e));var t=JSON.parse(e);ae(null===t||void 0===t?void 0:t.currentStep),G(Object(d.a)({},t)),localStorage.removeItem("userSelectedData")}}},[ue.search]);var ve=Object(l.h)("/coach/:id"),be=null===ve||void 0===ve||null===(t=ve.params)||void 0===t?void 0:t.id,je=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var a,i;return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return a=t.day,i=t.time,e.a(2,new Promise(function(e,t){var c=[];a&&i&&(c.push({op:"add",path:"/persistent/static/coach/bookedSlots/".concat(a,":").concat(i),value:i}),console.log({updatedUserData:c}),n.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,r(be,c),x.UpdateUserBio,localStorage.getItem("coachServiceId")),n.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){e(t)}))}))},e)}));return function(t){return e.apply(this,arguments)}}();return Object(oa.jsxs)(oa.Fragment,{children:[Z&&Object(oa.jsx)("div",{className:"loader-container",children:Object(oa.jsx)(Ic.a,{type:"TailSpin",color:"#007bff",height:50,width:100})}),!Z&&Object(oa.jsxs)("div",{className:"coach-profile-page",children:[Object(oa.jsxs)("div",{className:"coach-profile",children:[Object(oa.jsxs)("div",{className:"profile-image profile-image-section mt-1",children:[Object(oa.jsx)("img",{src:(null===i||void 0===i?void 0:i.image)||"/images/scene.png",alt:"".concat(null===i||void 0===i?void 0:i.name," profile")}),Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-5 mt-4",htmlType:"submit",onClick:function(){null!==j&&void 0!==j&&j.link&&window.open(j.link,"_blank")},children:"Connect"})]}),Object(oa.jsxs)("div",{children:[Object(oa.jsx)(jv,{level:4,children:"".concat(null===i||void 0===i?void 0:i.name)}),Object(oa.jsxs)(mv,{children:[" ",Object(oa.jsxs)("strong",{children:[null===j||void 0===j?void 0:j.title," "]})]}),Object(oa.jsx)("br",{}),Object(oa.jsx)(mv,{children:Object(oa.jsx)("strong",{children:null===j||void 0===j?void 0:j.education})}),Object(oa.jsx)("br",{}),Object(oa.jsx)(mv,{children:(null===j||void 0===j?void 0:j.experience)+" years of experience"}),Object(oa.jsxs)("div",{onClick:function(){le(!0)},style:{cursor:"pointer"},children:[Object(oa.jsx)(Eu.a,{style:{fontSize:20},disabled:!0,allowHalf:!0,value:Y.totalRatings||0}),Object(oa.jsxs)("strong",{children:["\xa0\xa0","".concat((null===Y||void 0===Y?void 0:Y.totalRatings)||0," (").concat((null===Y||void 0===Y?void 0:Y.totalNoOfRatings)||0," reviews)")]})]}),Object(oa.jsx)(mv,{children:Object(oa.jsx)(pv,{href:null===j||void 0===j?void 0:j.link,target:"_blank",children:null===j||void 0===j?void 0:j.link})})]})]}),oe&&Object(oa.jsx)(dv,{onClose:function(){return le(!1)},reviews:(null===Y||void 0===Y?void 0:Y.ratings)||[]}),Object(oa.jsx)(Ms.a,{}),Object(oa.jsxs)("div",{className:"profile-details profile-details-section",children:[Object(oa.jsx)(jv,{level:5,children:null===j||void 0===j?void 0:j.descriptionHeading}),Object(oa.jsx)("br",{}),Object(oa.jsxs)(mv,{className:"description",children:[null===j||void 0===j?void 0:j.description,Object(oa.jsx)("br",{})]}),Object(oa.jsx)(Ms.a,{})]}),Object(oa.jsxs)("div",{className:"expertise-box",children:[Object(oa.jsx)(jv,{level:4,children:"Expertise In"}),Object(oa.jsx)("div",{className:"categories-container",children:h.map(function(e){return Object(oa.jsx)(yu.a,{checked:!0,className:"expertise-tag",children:e},e)})})]}),Object(oa.jsx)(Ms.a,{}),Object(oa.jsxs)(Zu.a,{current:ne,className:"stepper",children:[Object(oa.jsx)(Ov,{title:"Category"}),Object(oa.jsx)(Ov,{title:"Pricing"}),Object(oa.jsx)(Ov,{title:"Scheduling"}),Object(oa.jsx)(Ov,{title:"Payment"})]}),Object(oa.jsxs)("div",{className:"step-content",children:[0===ne&&Object(oa.jsx)("div",{style:{display:"flex",placeContent:"center"},children:Object(oa.jsx)(bv,{onSelect:function(e){var t,n;null!==e&&void 0!==e&&null!==(t=e.pricingPlans)&&void 0!==t&&t.length&&R(Object(C.a)(null===e||void 0===e?void 0:e.pricingPlans)),se(),n=null===e||void 0===e?void 0:e.name,G(Object(d.a)(Object(d.a)({},Q),{},{category:n}))},categoriesPricingPlans:N,data:null===Q||void 0===Q?void 0:Q.category})}),1===ne&&Object(oa.jsxs)("div",{children:[Object(oa.jsx)(tv,{onSelect:function(e){var t,n;null!==(t=Object.keys(o))&&void 0!==t&&t.length?(se(),n=e,G(Object(d.a)(Object(d.a)({},Q),{},{plan:n}))):c({type:A})},pricingPlans:E,data:null===Q||void 0===Q?void 0:Q.plan}),Object(oa.jsx)("div",{className:"step-button-container",children:Object(oa.jsx)(Vn.a,{onClick:re,style:{marginRight:"10px"},children:"Previous Step"})})]}),2===ne&&Object(oa.jsxs)("div",{children:[Object(oa.jsx)(cv,{onSelect:function(e){se(),function(e){var t=e.day,n=e.time;G(Object(d.a)(Object(d.a)({},Q),{},{day:t,time:n}))}(e)},assignAvailability:M,bookedSlots:F,date:null===Q||void 0===Q?void 0:Q.day,time:null===Q||void 0===Q?void 0:Q.time}),Object(oa.jsx)("div",{className:"step-button-container",children:Object(oa.jsx)(Vn.a,{onClick:re,style:{marginRight:"10px"},children:"Previous Step"})})]}),3===ne&&Object(oa.jsxs)("div",{children:[Object(oa.jsx)(sv,{socket:n,onClose:function(){},onSaveState:function(){var e,t=Object(d.a)(Object(d.a)({},Q),{},{currentStep:ne});G(Object(d.a)({},t)),null===(e=localStorage)||void 0===e||e.setItem("userSelectedData",JSON.stringify(t))},disableClose:!1,paymentChargeRequest:function(){var e,t=(null===o||void 0===o||null===(e=o.coach)||void 0===e?void 0:e.categories.flatMap(function(e){return e.subcategories}).join(", "))||"",a=function(e){var t=e.split(" "),n=Object(u.a)(t,2),a=n[0],i=n[1],c=a.split(":").map(Number),o=Object(u.a)(c,2),l=o[0],s=o[1];return"PM"===i&&12!==l?l+=12:"AM"===i&&12===l&&(l=0),"".concat(l.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"))}(null===Q||void 0===Q?void 0:Q.time),c=null===E||void 0===E?void 0:E.find(function(e){return(null===e||void 0===e?void 0:e.title)===(null===Q||void 0===Q?void 0:Q.plan)}),l="".concat(null===o||void 0===o?void 0:o.firstName," ").concat(null===o||void 0===o?void 0:o.lastName),s="".concat(null===Q||void 0===Q?void 0:Q.day," ").concat(null===Q||void 0===Q?void 0:Q.time),r=H()(s,"YYYY-MM-DD hh:mm A").valueOf(),v=new Date(r).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),b={userId:localStorage.getItem("RID"),attributes:{name:l,phone:null===o||void 0===o?void 0:o.phone,email:null===o||void 0===o?void 0:o.email,categories:t,plan:null===Q||void 0===Q?void 0:Q.plan,coach:{id:"".concat(null===i||void 0===i?void 0:i.id),name:null===i||void 0===i?void 0:i.name,beamId:null===i||void 0===i?void 0:i.beamId},payment:{type:"payment",scheduleType:"fixed",amount:null===c||void 0===c?void 0:c.price},scheduleDate:null===Q||void 0===Q?void 0:Q.day,scheduleTime:a,caseVisitSchedule:{type:"event",dateTime:r,description:"Name: ".concat(l,"\nEmail: ").concat(null===o||void 0===o?void 0:o.email,"\nCategories: ").concat(t,"\nPlan: ").concat(null===Q||void 0===Q?void 0:Q.plan,"\nSchedule date: ").concat(null===Q||void 0===Q?void 0:Q.day,"\nSchedule time: ").concat(a,"\n"),repeat:!1,title:v,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},shareCustomerLink:!0},responders:[{type:"responder",value:"".concat(null===i||void 0===i?void 0:i.id),id:"".concat(null===i||void 0===i?void 0:i.id),name:null===i||void 0===i?void 0:i.name,beamId:null===i||void 0===i?void 0:i.beamId}],assets:[],connectionId:localStorage.getItem("CID"),submitted:!0,unstructuredAttributes:{},title:v,invitation:!1,createdAt:r,cudbServiceId:localStorage.getItem("coachServiceId")};n.publishToEvent(m.PublishPageTopics,Wt(localStorage.getItem("CID")),Dn(Object(d.a)({},b))),n.subscribeToEvent(m.SubscribePageTopics,Ht(localStorage.getItem("CID")),function(e){var t,n,a;null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.pageId&&null!==e&&void 0!==e&&null!==(a=e.response)&&void 0!==a&&a.status?(Lt("Appointment scheduled successfully !","success","TOP_CENTER",3e3),je(Q),G(void 0),ae(0)):Lt("Appointment scheduled failed !","error","TOP_CENTER",3e3)}),console.log("request",b),console.log("user reques data",Q)}}),Object(oa.jsx)("div",{className:"step-button-container",children:Object(oa.jsx)(Vn.a,{onClick:re,style:{marginRight:"10px"},children:"Previous Step"})})]})]})]})]})},hv=function(e){var t,n=e.socket,i=Mn().getUserRequestPayload,c=Object(s.b)(),o=Object(a.useState)(),r=Object(u.a)(o,2),v=r[0],b=r[1],j=Object(s.c)(function(e){return e.auth}),p=j.coaches,O=j.userInfo,f=Object(a.useState)(1),h=Object(u.a)(f,2),g=h[0],x=h[1],I=Object(a.useState)(0),S=Object(u.a)(I,2),N=S[0],k=S[1],w=Object(a.useState)({}),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useState)([]),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Object(a.useState)([]),q=Object(u.a)(U,2),F=q[0],B=q[1],_=Object(a.useState)(!0),$=Object(u.a)(_,2),Y=$[0],H=$[1],W=Object(a.useState)(!0),V=Object(u.a)(W,2),Q=V[0],G=V[1],J=Object(a.useState)({yearsOfExperience:{min:0,max:500},dailyRate:{min:0,max:5e3},hourlyRate:{min:0,max:500},name:"",availabilityDays:[],timeFilter:void 0}),K=Object(u.a)(J,2),Z=K[0],X=K[1],ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],n=new Date;return n.setHours(0,0,0,0),Array.from(new Set(Object.keys(e).filter(function(e){var t=new Date(e);return t.setHours(0,0,0,0),t>=n}).map(function(e){return t[new Date(e).getDay()]})))},te=function(){n.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,i(localStorage.getItem("adminUserId"),"$","$..persistent.static.admin.role"),hn(localStorage.getItem("CID")),localStorage.getItem("coachServiceId")),n.subscribeToSurvey(m.SurveyTopics,hn(localStorage.getItem("CID")),function(e){if(e){var t,n,a,i,o,l,s,r,u,v,j=null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n||null===(a=n[0])||void 0===a?void 0:a.filter(function(e){return e.permissions.includes(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)}),m=null===(i=e.data)||void 0===i||null===(o=i[0])||void 0===o||null===(l=o[0])||void 0===l?void 0:l.filter(function(e){return 1===e.permissions.length&&-1===e.permissions.indexOf(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)&&e.permissions.includes(ic.Live)});if(localStorage.setItem("candidateRoleId",null===(s=m[0])||void 0===s?void 0:s._id),localStorage.setItem("coachRoleId",null===(r=j[0])||void 0===r?void 0:r._id),b(j),ce(j,Z),null!==j&&void 0!==j&&j.length&&null!==(u=j[0])&&void 0!==u&&null!==(v=u.extendedBio)&&void 0!==v&&v.length){var p,O,f,h=null===(p=j[0])||void 0===p||null===(O=p.extendedBio)||void 0===O?void 0:O.find(function(e){return"category"===(null===e||void 0===e?void 0:e.type)}),g={categories:[],subcategories:{}};null===h||void 0===h||null===(f=h.options)||void 0===f||f.forEach(function(e){var t=null===e||void 0===e?void 0:e.name,n=(null===e||void 0===e?void 0:e.subCategories)||[];t&&(g.categories.push(t),g.subcategories[t]=n)}),P(g),c({type:ge,payload:Object(d.a)({},g)}),H(!1)}}})};Object(a.useEffect)(function(){n.client&&(H(!0),te())},[n.client]),Object(a.useEffect)(function(){var e;null!==(e=Object.keys(O))&&void 0!==e&&e.length&&(H(!0),te())},[O]);var ne=Object(l.h)("/coach/:id"),ae=null===ne||void 0===ne||null===(t=ne.params)||void 0===t?void 0:t.id;Object(a.useEffect)(function(){if(ae&&null!==M&&void 0!==M&&M.length){var e=null===M||void 0===M?void 0:M.find(function(e){return(null===e||void 0===e?void 0:e.id)==ae});e&&B(e)}},[ae,M]);var ie=function(e){var t="",n=e.trim().split(" ").filter(function(e){return e.length>2}).map(function(e){return"*"+z(e)+"*"});return 0==n.length?t:(n.forEach(function(e){t+="@firstName:(".concat(e,")|@lastName:(").concat(e,")|")}),t+="@beamIds:{".concat(n.join("|"),"}"),"(".concat(t,")"))},ce=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g;!function(e,t){var n=t.yearsOfExperience,a=t.dailyRate,i=t.hourlyRate,o=t.availabilityDays,l=t.name,s=void 0===l?"":l,r=t.timeFilter,u=void 0===r?void 0:r;G(!0);var v="@serviceId:{'".concat(z(localStorage.getItem("coachServiceId")||"cudb-live"),"'}");s&&s.length>2&&(v+=ie(s));var b=e.filter(function(e){return e.permissions.includes(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)}).map(function(e){return"@roleId === '".concat(e._id,"'")}),j="exists(@roleId) && (".concat(b.join("||"),") && exists(@type) && (@type === 'coach') && (exists(@hourlyRate) && @hourlyRate<=").concat(i.max," && @hourlyRate>=").concat(i.min,") && (exists(@dailyRate) && @dailyRate<=").concat(a.max," && @dailyRate>=").concat(a.min,") && (exists(@experience) && @experience<=").concat(n.max," && @experience>=").concat(n.min,")");u&&(j+="&& exists(@".concat(u.key,") && (@").concat(u.key," === '").concat(u.value,"')"));var m={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:v,searchOptions:"TIMEOUT 5000"},load:Object(d.a)({id:"$.objectId",roleId:"$..admin.profile.roleId",type:"$..persistent.static.coach.type",coach:"$..persistent.static.coach",dailyRate:"$..persistent.static.coach.bio.dailyRate",experience:"$..persistent.static.coach.bio.experience",hourlyRate:"$..persistent.static.coach.bio.hourlyRate",createdAt:"$.persistent.static.metadata.createdAt"},u&&Object(T.a)({},u.key,"$..persistent.static.coach.bio.location.attributes.".concat(u.key)))},apply:{expression:"",name:""},filter:{expression:j},anyStatus:!1};c(tt({requestData:m,callback:function(e){var t,n,a=(null===e||void 0===e||null===(t=e.map(function(e){var t;return Object(d.a)({id:null===e||void 0===e?void 0:e.id,days:ee(null===e||void 0===e||null===(t=e.coach)||void 0===t?void 0:t.assignAvailability)},null===e||void 0===e?void 0:e.coach)}))||void 0===t||null===(n=t.filter(function(e){return(null===e||void 0===e?void 0:e.bio)&&(!o.length||o.some(function(t){return null===e||void 0===e?void 0:e.days.includes(t)}))}))||void 0===n?void 0:n.length)||0;k(a)}}))}(e,t);var a=t.yearsOfExperience,i=t.dailyRate,o=t.hourlyRate,l=t.availabilityDays,s=t.name,r=void 0===s?"":s,u=t.timeFilter,v=void 0===u?void 0:u;G(!0);var b="@serviceId:{'".concat(z(localStorage.getItem("coachServiceId")||"cudb-live"),"'}");r&&r.length>2&&(b+=ie(r));var j=e.filter(function(e){return e.permissions.includes(ic.OnMove)&&-1===e.permissions.indexOf(ic.Admin)}).map(function(e){return"@roleId === '".concat(e._id,"'")}),m="exists(@roleId) && (".concat(j.join("||"),") && exists(@type) && (@type === 'coach') && (exists(@hourlyRate) && @hourlyRate<=").concat(o.max," && @hourlyRate>=").concat(o.min,") && (exists(@dailyRate) && @dailyRate<=").concat(i.max," && @dailyRate>=").concat(i.min,") && (exists(@experience) && @experience<=").concat(a.max," && @experience>=").concat(a.min,")");v&&(m+="&& exists(@".concat(v.key,") && (@").concat(v.key," === '").concat(v.value,"')"));var p={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:b,searchOptions:"TIMEOUT 5000"},load:Object(d.a)({id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId",coach:"$..persistent.static.coach",type:"$..persistent.static.coach.type",dailyRate:"$..persistent.static.coach.bio.dailyRate",experience:"$..persistent.static.coach.bio.experience",hourlyRate:"$..persistent.static.coach.bio.hourlyRate",createdAt:"$.persistent.static.metadata.createdAt"},v&&Object(T.a)({},v.key,"$..persistent.static.coach.bio.location.attributes.".concat(v.key)))},apply:{expression:"",name:""},sortBy:{properties:[{field:"@createdAt",order:"DESC"}],max:1e3},result:{pagination:{offset:9*(n-1),limit:9}},filter:{expression:m},anyStatus:!1};c(tt({requestData:p,callback:function(e){var t,n=null===e||void 0===e||null===(t=e.map(function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m,p,O,f,h,g=(null===e||void 0===e||null===(t=e.live)||void 0===t||null===(n=t.profile)||void 0===n||null===(a=n.profileImage)||void 0===a||null===(i=a.urls)||void 0===i||null===(c=i.original)||void 0===c?void 0:c.url)||"/images/users/user.png",x=null!==e&&void 0!==e&&null!==(o=e.coach)&&void 0!==o&&null!==(l=o.bio)&&void 0!==l&&l.ratings?function(e){var t=e,n=Object.values(t),a=n.length,i=n.reduce(function(e,t){return e+t.rating},0)/a;return{totalRatings:parseFloat(i.toFixed(1)),totalNoOfRatings:a,ratings:n}}(null===e||void 0===e||null===(s=e.coach)||void 0===s||null===(r=s.bio)||void 0===r?void 0:r.ratings):{totalRatings:0,totalNoOfRatings:0,ratings:[]};return Object(d.a)(Object(d.a)({id:null===e||void 0===e?void 0:e.id,beamId:"".concat(null===e||void 0===e||null===(u=e.live)||void 0===u||null===(v=u.profile)||void 0===v?void 0:v.firstName,".").concat(null===e||void 0===e||null===(b=e.live)||void 0===b||null===(j=b.profile)||void 0===j?void 0:j.lastName),name:"".concat(null===e||void 0===e||null===(m=e.live)||void 0===m||null===(p=m.profile)||void 0===p?void 0:p.firstName," ").concat(null===e||void 0===e||null===(O=e.live)||void 0===O||null===(f=O.profile)||void 0===f?void 0:f.lastName),image:g,days:ee(null===e||void 0===e||null===(h=e.coach)||void 0===h?void 0:h.assignAvailability)},null===e||void 0===e?void 0:e.coach),{},{ratings:x})}))||void 0===t?void 0:t.filter(function(e){return(null===e||void 0===e?void 0:e.bio)&&(!l.length||l.some(function(t){return null===e||void 0===e?void 0:e.days.includes(t)}))});L(Object(C.a)(n)),c({type:xe,payload:Object(C.a)(n)}),G(!1),H(!1)}}))},oe=Object(a.useCallback)(function(e){var t=e.selectedSubcategories;if(t&&0!==Object.keys(t).length){var n=p.filter(function(e){return e.categories.some(function(e){var n=t[e.name];return!(!n||0!==n.length)||n&&n.some(function(t){return e.subcategories.includes(t)})})});L(Object(C.a)(n))}else L(Object(C.a)(p))},[p]);return Object(oa.jsxs)("div",{className:"layout coach-app",children:[Object(oa.jsx)(Bu,{socket:n}),Y?Object(oa.jsx)("div",{className:"loader-container",children:Object(oa.jsx)(Ic.a,{type:"TailSpin",color:"#007bff",height:50,width:100})}):ne?Object(oa.jsx)(fv,{socket:n,coach:F}):Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsx)(Yu,{onChange:function(e){var t=e.yearsOfExperience,n=void 0===t?{min:0,max:500}:t,a=e.dailyRate,i=void 0===a?{min:0,max:5e3}:a,c=e.hourlyRate,o=void 0===c?{min:0,max:500}:c,l=e.name,s=void 0===l?"":l,r=e.availabilityDays,d=void 0===r?[]:r,u=e.timeFilter,b=void 0===u?void 0:u;X({name:s,yearsOfExperience:n,dailyRate:i,hourlyRate:o,availabilityDays:d,timeFilter:b}),ce(v,{name:s,yearsOfExperience:n,dailyRate:i,hourlyRate:o,availabilityDays:d,timeFilter:b},g)},filterOptions:Z}),!Y&&Object(oa.jsxs)(oa.Fragment,{children:[Object(oa.jsx)(Wu,{categoriesInfo:R,onChange:oe}),Q?Object(oa.jsx)("div",{className:"loader-container",children:Object(oa.jsx)(Ic.a,{type:"TailSpin",color:"#007bff",height:50,width:100})}):Object(oa.jsx)(Ku,{coachList:M,currentCoachPage:g,totalCount:N,defaultPageSize:9,onChange:function(e){x(e),ce(v,Z,e)}})]})]})]})},gv=(n(990),function(e){var t=e.socket,n=Object(a.useState)(H()()),c=Object(u.a)(n,2),o=c[0],l=c[1],r=Object(a.useState)(null),v=Object(u.a)(r,2),b=v[0],j=v[1],p=Object(a.useState)(null),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(a.useState)(""),I=Object(u.a)(g,2),S=I[0],N=I[1],k=Object(a.useState)(""),T=Object(u.a)(k,2),w=T[0],E=T[1],R=Object(a.useState)([]),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Object(a.useState)(!1),L=Object(u.a)(M,2),U=L[0],q=L[1],F=Object(a.useState)([]),B=Object(u.a)(F,2),_=B[0],$=B[1],Y=Object(a.useState)([]),W=Object(u.a)(Y,2),V=W[0],Q=W[1],G=Object(a.useState)(!1),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)(!1),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(null),ie=Object(u.a)(ae,2),ce=ie[0],oe=ie[1],le=Object(a.useRef)([]),se=Object(s.b)(),re=Mn().getUserRequestPayload,de=new URLSearchParams(window.location.search),ue=Object(s.c)(function(e){return e.auth}),ve=ue.encrypted_token,be=ue.page,je=de.get("userId")||(null===ve||void 0===ve?void 0:ve.userId),me=de.get("connectionId")||(null===ve||void 0===ve?void 0:ve.connectionId),pe=de.get("pageId")||(null===ve||void 0===ve?void 0:ve.pageId),Oe=de.get("serviceId")||(null===ve||void 0===ve?void 0:ve.cudbServiceId),fe=function(e){if(e){Z(!0);var t=de.get("serviceId")||(null===ve||void 0===ve?void 0:ve.cudbServiceId),n=z(e),a="(exists(@id) && contains(lower(@id),lower('".concat(n,"')))"),i={select:{index:{searchIndex:"".concat("beamdevlive",":custom:id"),searchQuery:"@partitions:{'org\\:".concat(z(t),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$..info.id",objectId:"$.objectId",name:"$..info..name",email:"$..info..email",phone:"$..info..phone"}},filter:{expression:a}};se(tt({requestData:i,callback:function(t){if(Z(!1),(null===t||void 0===t?void 0:t.length)>0){var n=t[0];(null===n||void 0===n?void 0:n.id)===e?(N((null===n||void 0===n?void 0:n.name)||""),E(null===n||void 0===n?void 0:n.id),ne(!0)):(ne(!1),ts.b.warning("Please enter the exact Beam ID."))}else ne(!1),ts.b.warning("User not found. Please check the Beam ID.")}}))}else ne(!1)};Object(a.useEffect)(function(){if(null!==t&&void 0!==t&&t.client){var e=de.get("userId"),n=de.get("serviceId");de.get("token")&&(n=null===ve||void 0===ve?void 0:ve.cudbServiceId,e=null===ve||void 0===ve?void 0:ve.userId),t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,re(e,"$","$.persistent.static.admin.project"),x.GetUserBio,n),t.subscribeToSurvey(m.SurveyTopics,x.GetUserBio,function(e){var t,n,a=Object.values((null===e||void 0===e||null===(t=e.data[0][0])||void 0===t?void 0:t.items)||{})||[],i=(null===e||void 0===e||null===(n=e.data[0][0])||void 0===n?void 0:n.types)||[];Q(a),$(i)})}},[null===t||void 0===t?void 0:t.client]),Object(a.useEffect)(function(){pe&&null!==t&&void 0!==t&&t.client&&me&&(t.subscribeToEvent(m.SubscribePageTopics,an(me)),t.publishToEvent(m.PublishPageTopics,cn(me),Dn({objectId:pe,paths:["$"],returnPaths:["$"]},pe)))},[pe,me,null===t||void 0===t?void 0:t.client]),Object(a.useEffect)(function(){if(be&&pe){var e,t,n,a,i;if(pe!==be.objectId)return;var c=null===be||void 0===be||null===(e=be.persistent)||void 0===e||null===(t=e.static)||void 0===t||null===(n=t.profile)||void 0===n||null===(a=n.unstructuredAttributes)||void 0===a||null===(i=a.serviceForm)||void 0===i?void 0:i[0];if(c){var o;N(c.name||""),E(c.beamId||"");var l=(null===(o=c.services)||void 0===o?void 0:o.map(function(e){return e.projectName}))||[];A(l),c.beamId&&fe(c.beamId)}}},[be,pe]),Object(a.useEffect)(function(){var e=setInterval(function(){l(H()())},1e3);return function(){return clearInterval(e)}},[]);var he=_.reduce(function(e,t){var n=V.filter(function(e){return e.typeId===t._id}).map(function(e){return e.name});return n.length>0&&(e[t.name]=n),e},{});return Object(oa.jsx)($n.a,{visible:!0,width:"100%",className:"service-form-modal",footer:null,closable:!0,centered:!1,style:{top:20},bodyStyle:{padding:0},children:Object(oa.jsxs)("div",{className:"service-form-container",children:[Object(oa.jsx)(Yn.a,{className:"header",justify:"space-between",align:"middle",children:Object(oa.jsxs)("div",{className:"date-time-cards",children:[Object(oa.jsxs)("div",{className:"card",children:[Object(oa.jsx)("div",{className:"label",children:"Date"}),Object(oa.jsx)("div",{className:"value",children:o.format("DD-MMM-YYYY")})]}),Object(oa.jsxs)("div",{className:"card time-card",children:[Object(oa.jsx)("div",{className:"label",children:"Time"}),Object(oa.jsx)("div",{className:"value",children:o.format("h:mm:ss A")})]})]})}),Object(oa.jsx)(Yn.a,{justify:"center",className:"welcome-section",children:Object(oa.jsxs)(Hn.a,{children:[Object(oa.jsx)("h2",{children:"Welcome to The Lighthouse"}),Object(oa.jsx)("h3",{children:"How can we help you today?"})]})}),Object(oa.jsx)("div",{className:"services-section",children:Object.entries(he).map(function(e,t,n){var a=Object(u.a)(e,2),c=a[0],o=a[1];return Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)("div",{className:"category-row",children:[Object(oa.jsx)("div",{className:"category-label",children:c}),Object(oa.jsx)("div",{className:"projects-list",children:o.map(function(e){return Object(oa.jsx)(Vn.a,{className:D.includes(e)?"selected":"",onClick:function(){return function(e){A(function(t){return t.includes(e)?t.filter(function(t){return t!==e}):[].concat(Object(C.a)(t),[e])})}(e)},children:e},e)})})]}),t<n.length-1&&Object(oa.jsx)(Ms.a,{})]},c)})}),Object(oa.jsxs)("div",{className:"schedule-section",children:[Object(oa.jsxs)("div",{className:"schedule-box",children:[Object(oa.jsx)("div",{className:"label",children:"Schedule Date"}),Object(oa.jsx)(Jn.a,{value:b,onChange:function(e){return j(e)},format:"DD-MMM-YYYY",placeholder:"Select date",className:"schedule-picker",disabledDate:function(e){return e&&e<H()().startOf("day")}})]}),Object(oa.jsxs)("div",{className:"schedule-box",children:[Object(oa.jsx)("div",{className:"label",children:"Schedule Time"}),Object(oa.jsx)(Zn.a,{value:f,onChange:function(e){return h(e)},format:"hh:mm A",placeholder:"Select time",className:"schedule-picker",minuteStep:15,use12Hours:!0})]})]}),Object(oa.jsxs)("div",{className:"user-info-section",children:[Object(oa.jsxs)("div",{className:"info-box",children:[Object(oa.jsx)("div",{className:"label",children:"Name"}),Object(oa.jsx)(Wn.a,{value:S,onChange:function(e){var t=e.target.value;N(t)},placeholder:"Enter Name",size:"large",className:"ant-input-lg ".concat(te?"valid-input":""),disabled:U||te})]}),Object(oa.jsxs)("div",{className:"info-box",children:[Object(oa.jsx)("div",{className:"label",children:"Beam ID"}),Object(oa.jsx)(Wn.a,{value:w,onChange:function(e){var t=e.target.value;E(t),ne(!1),Z(!1),ce&&clearTimeout(ce);var n=setTimeout(function(){t?fe(t):ne(!1)},1e3);oe(n)},placeholder:"Enter Beam ID",disabled:U,size:"large",className:"ant-input-lg ".concat(te?"valid-input":"")})]}),K&&Object(oa.jsx)("div",{className:"validating-message",children:"Validating user..."}),te&&Object(oa.jsxs)("div",{className:"valid-user-message",children:[Object(oa.jsx)(Wi.a,{twoToneColor:"#52c41a"}),Object(oa.jsx)("span",{children:"Valid user"})]})]}),Object(oa.jsx)(Yn.a,{justify:"center",className:"submit-section",children:Object(oa.jsx)(Vn.a,{type:"primary",onClick:function(){var e;if(S&&w)if(te)if(0!==D.length){var n=H()(),a=b&&f?H()(b).set({hour:f.hour(),minute:f.minute(),second:f.second()}):n;le.current=[],D.forEach(function(e){var t=_.find(function(t){return V.find(function(n){return n.typeId===t._id&&n.name===e})}),i=V.find(function(n){return n.typeId===(null===t||void 0===t?void 0:t._id)&&n.name===e}),c={name:S,beamId:w,serviceName:e,categoryName:null===t||void 0===t?void 0:t.name,projectId:null===i||void 0===i?void 0:i._id,scheduleDate:a.format("YYYY-MM-DD"),scheduleTime:a.format("HH:mm")},o=Object.entries(c).map(function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return"".concat(n,": ").concat(a)}).join("\n");le.current.push({userId:je,attributes:Object(d.a)({serviceEvent:{type:"event",dateTime:n.valueOf(),description:o,repeat:!1,title:"".concat(e," ").concat(n.format("YYYY-MM-DD HH:mm"))},shareCustomerLink:!0},c),responders:[],assets:[],connectionId:me,pageId:pe,submitted:!0,unstructuredAttributes:{serviceForm:[{categoryId:null===t||void 0===t?void 0:t._id,categoryName:null===t||void 0===t?void 0:t.name,name:S,beamId:w,scheduleDate:n.format("YYYY-MM-DD"),scheduleTime:n.format("HH:mm"),services:[{projectId:null===i||void 0===i?void 0:i._id,projectName:e}]}]},title:"".concat(e," ").concat(n.format("YYYY-MM-DD HH:mm")),invitation:!0,assistPageId:void 0,createdAt:n.valueOf(),cudbServiceId:Oe,url:window.location.href})}),null===(e=le.current)||void 0===e||e.map(function(e){t.publishToEvent(m.PublishPageTopics,Wt(me),Dn(e))}),q(!0),setTimeout(function(){q(!1),N(""),E(""),A([]),Lt("Services submitted successfully","success","TOP_CENTER",1e3)},1e3)}else ts.b.error("Please select at least one service");else ts.b.error("Please enter valid user details");else ts.b.error("Please enter both Name and Beam ID")},className:"submit-button",loading:U,disabled:!te,children:"SUBMIT"})})]})})}),xv=(Za.a.Panel,function(e){var t=e.onClose,n=e.handleConfirm,i=e.message,c=Object(a.useState)(!0),o=Object(u.a)(c,2),l=o[0],s=o[1],r=ei.a.useForm(),d=Object(u.a)(r,1)[0],v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=b[0],m=b[1],p=function(){s(!1),t&&t()};return Object(oa.jsx)($n.a,{title:"Please Confirm",visible:l,onCancel:p,width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"confirmation-form",id:"confirmation-form",layout:"vertical",form:d,requiredMark:!1,children:[Object(oa.jsx)(ei.a.Item,{name:"password",rules:[{required:!0,message:"**Required Field"}],className:"mt-3",children:Object(oa.jsx)(Jc.a,{children:i||"Are you sure you want to continue?"})}),Object(oa.jsx)(ei.a.Item,{className:"action-grp mt-4",children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:14,className:"pr-2",children:Object(oa.jsx)(Vn.a,{loading:j,className:"beam-btn green-btn cover w-full",onClick:function(){m(!0),n()},children:"Confirm"})}),Object(oa.jsx)(Hn.a,{span:10,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:p,children:"Cancel"})})]})})]})})});n(381),Za.a.Panel;Dc.d.register(Dc.a,Dc.j,Dc.e);Gn.a.Option;var yv=function(e){e.socket,e.params,e.filter;var t=e.selected,n=(e.componentUuid,e.onClose),c=e.phone,o=(Object(l.g)().search,Object(s.c)(function(e){return e.auth})),r=(o.userRequests,o.projects),v=(o.pageAggregateBds,o.selectedPage),b=o.encrypted_token,j=(o.searchByPhone,Object(s.b)()),m=Object(a.useState)(!0),p=Object(u.a)(m,2),O=p[0],f=p[1],h=Object(a.useState)("project"),g=Object(u.a)(h,2),x=(g[0],g[1],Object(a.useState)("state")),y=Object(u.a)(x,2),I=(y[0],y[1],Object(a.useState)(!1)),S=Object(u.a)(I,2),N=(S[0],S[1]),k=Object(a.useState)(void 0),T=Object(u.a)(k,2),w=(T[0],T[1],Object(a.useState)(void 0)),E=Object(u.a)(w,2),R=(E[0],E[1],Object(a.useState)(!1)),P=Object(u.a)(R,2),D=(P[0],P[1]),A=Object(a.useState)(!1),M=Object(u.a)(A,2),L=(M[0],M[1]),U=Object(a.useState)([]),q=Object(u.a)(U,2),F=(q[0],q[1]),B=Object(a.useState)([]),_=Object(u.a)(B,2),$=(_[0],_[1],Object(a.useState)([])),Y=Object(u.a)($,2),H=(Y[0],Y[1]),Q=Object(a.useState)([]),G=Object(u.a)(Q,2),J=(G[0],G[1]),K=(Object(a.useRef)(W()),Object(a.useRef)(W()),Object(a.useRef)(void 0),Object(a.useRef)(void 0),Object(a.useRef)(0)),Z=Object(a.useRef)(void 0),X=Object(a.useState)(),ee=Object(u.a)(X,2),te=(ee[0],ee[1],Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0})),ne=Object(u.a)(te,2),ae=(ne[0],ne[1],Object(a.useState)(0)),ie=Object(u.a)(ae,2),ce=(ie[0],ie[1],Object(a.useState)([])),oe=Object(u.a)(ce,2),le=oe[0],se=oe[1],re=Object(a.useRef)(void 0),de=(Object(a.useRef)(void 0),Object(a.useState)([])),ue=Object(u.a)(de,2),ve=ue[0],be=ue[1],je=Object(a.useState)(!1),me=Object(u.a)(je,2),pe=(me[0],me[1],Object(a.useState)([])),Oe=Object(u.a)(pe,2),fe=(Oe[0],Oe[1],Object(a.useState)(void 0)),he=Object(u.a)(fe,2),ge=(he[0],he[1]),xe=(Mn().getUserRequestPayload,Object(a.useRef)(void 0),Object(a.useRef)({project:void 0,user:void 0,status:void 0,area:void 0,time:void 0,phone:void 0})),ye=(Object(a.useRef)({}),Object(a.useRef)()),Ie=Object(a.useRef)([]),Se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n={};Ie.current&&Ie.current.map(function(e){n[e.key]=e.value}),K.current=e;var a={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{'".concat(null===b||void 0===b?void 0:b.userId,"'}(-@rideType:{hail})@pageType:{event}@passengerPhoneNumber:{").concat(z(xe.current.phone),"}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)({profile:"$..profile",dashboard:"$..dashboard",ride:"$.persistent.static.ride",dynamic:"$.persistent.dynamic.ride",rideType:"$..profile.type",pageId:"$.objectId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",phone:"$..dashboard.passengerPhoneNumber"},n)},filter:{expression:[].join("&&")},sortBy:{properties:["advance"===t?{field:"@createdAt",order:"ASC"}:{field:"@updatedAt",order:"DESC"}],max:1e3},result:xe.current.phone?{pagination:{offset:e,limit:50}}:{}};j(tt({requestData:a,callback:function(t){console.log("resppnse",t),H(t),K.current=K.current+30;var n=e>0?Object(C.a)(le):[],a=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Pickup Address",key:"address",dataIndex:"address"},{title:"Dropoff Address",key:"dropoffAddress",dataIndex:"dropoffAddress"},{title:"Passenger Name",key:"passengerName",dataIndex:"passengerName"},{title:"Passenger Phone",key:"passengerPhoneNumber",dataIndex:"passengerPhoneNumber"},{title:"Driver Name",key:"driverName",dataIndex:"driverName"},{title:"Vehicle Name",key:"vehicleName",dataIndex:"vehicleName"},{title:"Fixed Fare",key:"fixedFare",dataIndex:"fixedFare"}];null===t||void 0===t||t.map(function(e,t){var a,i,c,o,l=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),s={};Object.keys(l).map(function(e){"string"===typeof l[e]&&(s[e]=l[e])}),n.push(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:l}),summary:s.summary,cudbServiceId:null===r||void 0===r?void 0:r.userServiceId}},s),{},{address:null!==s&&void 0!==s&&s.address&&""!==(null===s||void 0===s?void 0:s.adress)?null===s||void 0===s?void 0:s.address:null===l||void 0===l||null===(a=l.pickupLocation)||void 0===a||null===(i=a.attributes)||void 0===i?void 0:i.address,dropoffAddress:null!==s&&void 0!==s&&s.dropoffAddress&&""!==(null===s||void 0===s?void 0:s.dropoffAddress)?null===s||void 0===s?void 0:s.dropoffAddress:null===l||void 0===l||null===(c=l.dropoffLocation)||void 0===c||null===(o=c.attributes)||void 0===o?void 0:o.address,invited:""}))}),console.log("source data",n),n.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===a.findIndex(function(t){return t.key===e})&&t[e]})}),a.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:90},children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){V("".concat("https://live.staging.beam.live","/page/").concat(null===e||void 0===e?void 0:e.pageId),"BeamLive",.7*window.innerWidth,.9*window.innerHeight)},children:Object(oa.jsx)(Zc.a,{})})}),Object(oa.jsx)(Hn.a,{span:12,children:(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t;window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(null===b||void 0===b?void 0:b.connectionId,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:Object(oa.jsx)(Ec.a,{})})})]})}}),be(a),console.log("set source date",n),se(n),re.current=n,J(null===t||void 0===t?void 0:t.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),D(!1),N(!1),L(!1)}}))};Object(a.useEffect)(function(){var e;b&&(ye.current=b,N(!0),e=c,xe.current.phone=e,D(!0),xe.current.status=void 0,Z.current="lime",ge("lime"),Se())},[b]),Object(a.useEffect)(function(){if(r){var e,t=[];null===r||void 0===r||null===(e=r.projects)||void 0===e||e.map(function(e){t.push({label:e.name,value:e.id})}),F(t)}},[r]);return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)($n.a,{title:"Search",visible:O,onCancel:function(){f(!1),n&&n()},width:"1000px",bodyStyle:{height:600},className:"beam-modal analytics-summary-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid",transformOrigin:"0px 0px",transform:"scale(0.8)",width:"125%"},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:le,className:(null===le||void 0===le?void 0:le.length)>0?"":"table-empty-1",onRow:function(e){return{onDoubleClick:function(){console.log("on double click row",e)},onClick:function(){var t;j({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e||null===(t=e.action)||void 0===t?void 0:t.page,ignorePage:!0}})}}},columns:ve,scroll:{x:!0},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===v||void 0===v||null===(n=v.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})})})})},Iv=(Wn.a.TextArea,function(e){var t=e.onClose,n=e.socket,i=Object(a.useState)(!0),c=Object(u.a)(i,2),o=c[0],l=c[1],r=Object(a.useState)(""),d=Object(u.a)(r,2),v=(d[0],d[1],ei.a.useForm()),b=Object(u.a)(v,1)[0],j=Object(a.useState)(""),p=Object(u.a)(j,2),O=p[0],f=p[1],h=Object(a.useState)(!1),g=Object(u.a)(h,2),x=g[0],y=(g[1],Object(a.useState)("email")),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(s.c)(function(e){return e.auth}),T=k.encrypted_token,C=k.projects,w=(Object(s.b)(),function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(a){var i,c,o,s;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(i=a.email,c=a.phone,o=a.nickname,f(""),i||c){e.n=1;break}return f("Please enter email or phone number"),e.a(2);case 1:s=[],i&&s.push({email:i}),c&&s.push({phone:c}),n.publishToEvent(m.PublishPageTopics,Zt(null===T||void 0===T?void 0:T.connectionId),Dn({userId:null===T||void 0===T?void 0:T.userId,notificationChannels:{email:i,phone:c},nickname:o,cudbServiceId:null===C||void 0===C?void 0:C.userServiceId})),l(!1),t&&t(),Lt("Link shared successfully","success","TOP_CENTER",1e3);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());return Object(oa.jsx)($n.a,{title:"Share dispatch",visible:o,onCancel:function(){l(!1),t&&t()},width:"480px",className:"beam-modal",footer:[],destroyOnClose:!0,children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:b,onFinish:w,requiredMark:!1,children:[Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{onClick:function(){N("email")},className:"beam-btn ".concat("email"===S?"green-btn cover":""),children:"Email"})}),Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{onClick:function(){N("phone")},className:"beam-btn ".concat("phone"===S?"green-btn cover":""),children:"Phone"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-4 mb-4",children:Object(oa.jsxs)(Hn.a,{span:24,children:["email"===S&&Object(oa.jsx)(ei.a.Item,{name:"email",rules:[{type:"email",message:"The input is not valid Email!"},{required:!0,message:"**Required field"}],children:Object(oa.jsx)(Wn.a,{type:"email",placeholder:"Email"})}),"phone"===S&&Object(oa.jsx)(ei.a.Item,{name:"phone",rules:[{required:!0,message:"**Required field"}],children:Object(oa.jsx)(Wn.a,{type:"text",placeholder:"Phone number (include +)"})}),O&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:O})})]})}),Object(oa.jsx)(Yn.a,{className:"action-grp",children:Object(oa.jsx)(Hn.a,{span:24,className:"pr-2",children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:x,type:"primary",htmlType:"submit",onClick:function(){return f("")},children:"Invite"})})})})]})})});gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var Sv=Wn.a.TextArea,Nv=function(e){var t,n,c,o,r,v,b=e.socket,j=e.params,p=e.fullScreen,O=e.scale,f=(e.componentUuids,ei.a.useForm()),h=Object(u.a)(f,1)[0],g=Object(a.useState)(""),x=Object(u.a)(g,2),y=x[0],I=x[1],S=j.screens,N=j.setScreens,k=Object(l.g)().search,T=Object(l.f)(),C=Object(s.c)(function(e){return e.auth}),w=C.projects,E=(C.accounts,Object(s.b)()),R=Object(s.c)(function(e){return e.auth}),P=R.selectedResponders,D=R.submitted,A=R.page,M=R.encrypted_token,L=R.selectedPickup,U=R.standLocations,q=R.selectedPage,F=Object(a.useState)(!1),B=Object(u.a)(F,2),_=B[0],Y=B[1],H=Object(a.useState)(!1),V=Object(u.a)(H,2),Q=V[0],G=(V[1],Object(a.useState)(void 0)),J=Object(u.a)(G,2),K=J[0],Z=J[1],ee=Object(a.useState)(void 0),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ie=(Mn().getUserRequestPayload,Object(a.useRef)(void 0),Object(a.useRef)(W())),ce=Object(a.useState)(),oe=Object(u.a)(ce,2),le=(oe[0],oe[1]),se=Object(a.useState)(),re=Object(u.a)(se,2),de=(re[0],re[1],Object(a.useState)()),ue=Object(u.a)(de,2),ve=(ue[0],ue[1],Object(a.useState)()),be=Object(u.a)(ve,2),je=be[0],me=(be[1],Object(a.useState)(void 0)),pe=Object(u.a)(me,2),Oe=(pe[0],pe[1]),fe=Object(a.useState)(void 0),he=Object(u.a)(fe,2),ge=he[0],xe=he[1],ye=Object(a.useState)(!1),Ie=Object(u.a)(ye,2),Se=Ie[0],Ne=Ie[1],ke=Object(a.useState)(),Te=Object(u.a)(ke,2),Ce=Te[0],we=Te[1],Ee=Object(a.useState)(!1),Re=Object(u.a)(Ee,2),Pe=Re[0],Me=Re[1],Le=Object(a.useRef)(!0),Fe=Object(a.useRef)(void 0),Be=Object(a.useState)(!1),_e=Object(u.a)(Be,2),$e=_e[0],Ye=_e[1],He=Object(a.useRef)({pickup:void 0,dropoff:void 0}),We=Object(a.useState)(!1),Ve=Object(u.a)(We,2),ze=Ve[0],Qe=(Ve[1],Object(a.useState)(!1)),Ge=Object(u.a)(Qe,2),Je=Ge[0],Ke=Ge[1],Ze=Object(a.useState)(25),Xe=Object(u.a)(Ze,2),et=Xe[0],nt=Xe[1],at=Object(a.useState)([]),it=Object(u.a)(at,2),ot=it[0],lt=it[1],st=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,o,l,s,r,u;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(!((null===U||void 0===U?void 0:U.length)>0)){e.n=1;break}return e.a(2);case 1:return n=null===M||void 0===M?void 0:M.userId,a=K,i=null===M||void 0===M?void 0:M.connectionId,c=P.map(function(e){return{id:e.id,beamId:e.title}}),t[void 0]&&(t=t[void 0]),t.pickupLocation.type="incident-location",o={},Object.keys(t).map(function(e){var n=X(e,e,t[e],[],{});Array.isArray(n)?null===n||void 0===n||n.map(function(e){$.a.merge(o,e)}):$.a.merge(o,n)}),I(void 0),Y(!0),l=Object(d.a)(Object(d.a)({},o),{},{sharePassengerLink:t.sharePassengerLink},$e?{sharePassengerLink:!0}:{}),console.log("sorted attributes",l),Object.keys(l).map(function(e){var t,n;"vehicle"===(null===l||void 0===l||null===(t=l[e])||void 0===t?void 0:t.type)&&(s=null===l||void 0===l||null===(n=l[e])||void 0===n?void 0:n.value)}),s&&c.push({id:s,beamId:""}),r=[],e.n=2,Promise.all(Object.keys(l).map(function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(o){var s,v,b,j,m,p,O,f,h,g,x;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:"dispatchType"===(null===l||void 0===l||null===(s=l[o])||void 0===s?void 0:s.type)&&(m=Object(d.a)({},l),l?(m.scheduleDate=null===m||void 0===m||null===(p=m[o])||void 0===p?void 0:p.date,m.scheduleTime=null===m||void 0===m||null===(O=m[o])||void 0===O?void 0:O.time,g=new Date(null===m||void 0===m||null===(f=m[o])||void 0===f?void 0:f.dateTimestamp),x=new Date(null===m||void 0===m||null===(h=m[o])||void 0===h?void 0:h.timeTimestamp),g.setHours(x.getHours()),g.setMinutes(x.getMinutes()),u=g.getTime()<(new Date).getTime()?{type:"immediate"}:{utcDateTime:new Date(g.getTime()).toUTCString(),rideDateTime:new Date(g.getTime()).toUTCString(),ridelocalDateTime:g.getTime(),type:"schedule"}):u={type:"immediate"},r.push({userId:n,rideRequestAttributes:Object(d.a)(Object(d.a)({},m),{},{drivers:c,pickupAddress:null===m||void 0===m||null===(v=m.pickupLocation)||void 0===v||null===(b=v.attributes)||void 0===b?void 0:b.address,cudbServiceId:null===w||void 0===w?void 0:w.userServiceId}),drivers:c,connectionId:i,unstructuredAttributes:Object(d.a)({},t),pageId:Le.current?a:void 0,title:"".concat(m.scheduleDate," ").concat(m.scheduleTime),dispatch:u,createdAt:(null===(j=u)||void 0===j?void 0:j.ridelocalDateTime)||(new Date).getTime(),cudbServiceId:null===w||void 0===w?void 0:w.userServiceId}));case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()));case 2:r.map(function(e){b.publishToEvent(m.PublishPageTopics,Gt(i),Dn(e))}),console.log("event requests",r);case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();Object(a.useEffect)(function(){var e,t,n,a,i,c,o,l,s;q&&(console.log("selected page",q),dt(Object(d.a)(Object(d.a)({},null===q||void 0===q?void 0:q.page),{},{persistent:{static:{profile:null===q||void 0===q||null===(e=q.page)||void 0===e?void 0:e.profile}}})),null!==q&&void 0!==q&&q.ignorePage?(Z(void 0),ae(void 0)):(Z(null===q||void 0===q||null===(t=q.page)||void 0===t||null===(n=t.pageId)||void 0===n?void 0:n.toString()),ae((null===q||void 0===q||null===(a=q.page)||void 0===a?void 0:a.status)||(null===q||void 0===q||null===(i=q.page)||void 0===i||null===(c=i.nonpersistent)||void 0===c||null===(o=c.static)||void 0===o||null===(l=o.live)||void 0===l||null===(s=l.status)||void 0===s?void 0:s.name))))},[q]);var rt=function(e,t){var n=new Date(e),a=new Date(n);a.setHours(0,0,0,0);var i=new Date(n);i.setHours(23,59,59,999);var c=["exists(@type)","@type==='event'","exists(@createdAt) && @createdAt > ".concat(a.getTime()," && @createdAt < ").concat(i.getTime()),"exists(@pageStatus) && (@pageStatus === 'amber' || @pageStatus === 'purple')"],o={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===w||void 0===w?void 0:w.adminUserId,"'}@partitions:{'org\\:").concat(z(null===w||void 0===w?void 0:w.userServiceId)),searchOptions:"VERBATIM TIMEOUT 10000"},load:{pageId:"$.objectId",type:"$.persistent.static.metadata.type",createdAt:"$.persistent.static.metadata.createdAt",pageStatus:"$..status.name"}},filter:{expression:c.join("&&")},sortBy:{properties:[],max:1e3},result:{}};console.log("page request",o),E(tt({requestData:o,callback:function(e){console.log("page resppnse",e);var t=null===e||void 0===e?void 0:e.map(function(e){return ut(new Date(e.createdAt))});console.log("exclude timeslots",t),lt(t)}}))};Object(a.useEffect)(function(){if(L){var e,t;console.log("set pickup",L);var n={type:"incident-location",label:null===(e=L.location.attributes)||void 0===e?void 0:e.address,value:{description:null===L||void 0===L||null===(t=L.location.attributes)||void 0===t?void 0:t.address,place_id:"",coordinates:null===L||void 0===L?void 0:L.location.coordinates}};h.setFieldsValue({pickupLocation:n}),n&&(vt({pickupLocation:n}),N(Object(d.a)(Object(d.a)({},S),{},{map:!0})),E({type:Ue,payload:void 0}),E({type:qe,payload:[]}))}},[L]);var dt=function(e){var t,n,a,i,c,o,l,s,r,u,v,b;(h.resetFields(),E({type:De,payload:!1}),console.log("page check here",e),h.setFieldsValue(Object(d.a)({},null!==(t=null===e||void 0===e||null===(n=e.persistent)||void 0===n||null===(a=n.static)||void 0===a||null===(i=a.profile)||void 0===i?void 0:i.unstructuredAttributes)&&void 0!==t?t:{})),null!==e&&void 0!==e&&null!==(c=e.persistent)&&void 0!==c&&null!==(o=c.static)&&void 0!==o&&null!==(l=o.profile)&&void 0!==l&&null!==(s=l.unstructuredAttributes)&&void 0!==s&&s.pickupLocation)&&vt({pickupLocation:null===e||void 0===e||null===(r=e.persistent)||void 0===r||null===(u=r.static)||void 0===u||null===(v=u.profile)||void 0===v||null===(b=v.unstructuredAttributes)||void 0===b?void 0:b.pickupLocation})};Object(a.useEffect)(function(){A&&dt(A)},[JSON.stringify(null!==(t=null===A||void 0===A||null===(n=A.persistent)||void 0===n||null===(c=n.static)||void 0===c?void 0:c.profile)&&void 0!==t?t:{})]),Object(a.useEffect)(function(){if(D)if(console.log("submitted here",D),Y(!1),D.status)Lt("Ride request submitted","success","TOP_CENTER",1e3),E({type:De,payload:!1}),bt();else if(!1===D.status){var e;Lt((null===D||void 0===D||null===(e=D.data)||void 0===e?void 0:e.details)||"Ride request failed","error","TOP_CENTER",3e3),E({type:De,payload:!1})}},[E,T,h,Q,S,k,_,N,D]);Object(a.useEffect)(function(){if(null!==w&&void 0!==w&&w.adminUserId){console.log("test",w);var e=null===M||void 0===M?void 0:M.connectionId,t=null===M||void 0===M?void 0:M.userId;b.subscribeToEvent(m.SubscribePageTopics,yn(e)),b.subscribeToEvent(m.SubscribePageTopics,bn(e,null===w||void 0===w?void 0:w.userServiceId)),b.subscribeToEvent(m.SubscribePageTopics,En(t),function(e){console.log("response",e),Oe(null===e||void 0===e?void 0:e.data)}),Ke(!0)}},[w]);var ut=function(e){var t=e.getHours(),n=e.getMinutes(),a=t>=12?"PM":"AM";t=(t%=12)||12;var i=String(n).padStart(2,"0");return"".concat(t,":").concat(i," ").concat(a)};Object(a.useEffect)(function(){Je&&(console.log("loaded true",Je),function(){var e=null===M||void 0===M?void 0:M.connectionId,t={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===w||void 0===w?void 0:w.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",firstName:"$..profile.firstName"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@firstName)"},anyStatus:!1};b.publishToEvent(m.PublishPageTopics,xn(e),Dn(t,ie.current))}(),b.publishToEvent(m.PublishPageTopics,Nn(null===M||void 0===M?void 0:M.connectionId),Dn({userId:null===M||void 0===M?void 0:M.userId,cudbServiceId:null===w||void 0===w?void 0:w.userServiceId})),rt(new Date))},[Je]),Object(a.useEffect)(function(){if(M){var e=new URLSearchParams(k),t=e.get("token"),n=e.get("setup_intent_client_secret");if(t&&n){console.log("re submit here");var a=JSON.parse(localStorage.getItem("formValues"));console.log("form here",a),a&&h.setFieldsValue(Object(d.a)({},a))}b.subscribeToEvent(m.SubscribePageTopics,qt(null===M||void 0===M?void 0:M.connectionId)),b.subscribeToEvent(m.SubscribePageTopics,Bt(null===M||void 0===M?void 0:M.connectionId)),b.subscribeToEvent(m.SubscribePageTopics,$t(null===M||void 0===M?void 0:M.connectionId)),b.subscribeToEvent(m.SubscribePageTopics,vn(null===M||void 0===M?void 0:M.connectionId)),b.subscribeToEvent(m.SubscribePageTopics,(i=null===M||void 0===M?void 0:M.connectionId,"".concat(Ut,"/connection/").concat(i,"/service/dps/createShuttleBusPage/reply"))),b.subscribeToEvent(m.SubscribePageTopics,fn(null===M||void 0===M?void 0:M.userId),function(e){var t,n,a;dt(Object(d.a)(Object(d.a)({},null===e||void 0===e?void 0:e.page),{},{persistent:{static:{profile:null===e||void 0===e||null===(t=e.page)||void 0===t?void 0:t.profile}}})),Z(null===e||void 0===e||null===(n=e.page)||void 0===n||null===(a=n.pageId)||void 0===a?void 0:a.toString())}),b.subscribeToEvent(m.SubscribePageTopics,nn(null===M||void 0===M?void 0:M.connectionId),function(e){Lt("Ride cancelled successfully","success","TOP_CENTER",1e3),E({type:De,payload:!1}),bt()}),b.subscribeToEvent(m.SubscribePageTopics,an(null===M||void 0===M?void 0:M.connectionId)),b.publishToEvent(m.PublishPageTopics,Ft(null===M||void 0===M?void 0:M.connectionId),Dn({userId:null===M||void 0===M?void 0:M.userId,cudbServiceId:(null===M||void 0===M?void 0:M.cudbServiceId)||(null===M||void 0===M?void 0:M.serviceId)})),b.publishToEvent(m.PublishPageTopics,_t(null===M||void 0===M?void 0:M.connectionId),Dn({userId:null===M||void 0===M?void 0:M.userId,cudbServiceId:(null===M||void 0===M?void 0:M.cudbServiceId)||(null===M||void 0===M?void 0:M.serviceId)})),b.subscribeToEvent(m.SubscribePageTopics,Tn(null===M||void 0===M?void 0:M.connectionId),function(e){var t,n,a,i,c,o,l,s=e.response;console.log("fixed rate response",s);var r,u=null===s||void 0===s||null===(t=s.data)||void 0===t||null===(n=t.fixedRate)||void 0===n?void 0:n.priceConfig,v=h.getFieldValue("numberOfPeople"),b=null===u||void 0===u?void 0:u.find(function(e){return(null===e||void 0===e?void 0:e.numberOfPassengers)===v});(b||(null===u||void 0===u||u.sort(function(e,t){return parseFloat(t.price)-parseFloat(e.price)}),b=null===u||void 0===u?void 0:u[0]),console.log("selected price",b),null!==(a=b)&&void 0!==a&&a.price&&null!==s&&void 0!==s&&null!==(i=s.data)&&void 0!==i&&null!==(c=i.fixedRate)&&void 0!==c&&c[Fe.current])&&h.setFieldsValue({fareType:Object(d.a)({type:"fareType",value:"fixed",fare:null===(r=b)||void 0===r?void 0:r.price},b)});He.current[Fe.current]=u,null!==(o=He.current)&&void 0!==o&&o.pickup||null!==(l=He.current)&&void 0!==l&&l.dropoff||h.setFieldsValue({fareType:{type:"fareType",value:"variable"}})}),b.subscribeToEvent(m.SubscribePageTopics,Cn(null===M||void 0===M?void 0:M.connectionId),function(e){var t,n,a,i,c,o=e.response;(console.log("blocked area response",o),null!==o&&void 0!==o&&null!==(t=o.data)&&void 0!==t&&t.blockedArea)?(E({type:Ue,payload:null===o||void 0===o||null===(n=o.data)||void 0===n||null===(a=n.blockedArea)||void 0===a?void 0:a.geofence}),E({type:qe,payload:null===o||void 0===o||null===(i=o.data)||void 0===i||null===(c=i.blockedArea)||void 0===c?void 0:c.pois})):(E({type:Ue,payload:void 0}),E({type:qe,payload:[]}))}),b.subscribeToEvent(m.SubscribePageTopics,kn(null===M||void 0===M?void 0:M.connectionId),function(e){var t,n,a=null===e||void 0===e?void 0:e.response;if(console.log("estimation",null===a||void 0===a?void 0:a.data),(null===a||void 0===a||null===(t=a.data)||void 0===t?void 0:t.leadTime)>-1&&h.setFieldsValue({leadTime:Math.ceil(null===a||void 0===a?void 0:a.data.leadTime)}),(null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.roundTripLeadTime)>-1&&h.setFieldsValue({roundTripLeadTime:Math.ceil(null===a||void 0===a?void 0:a.data.roundTripLeadTime)}),null!==a&&void 0!==a&&a.data.estimate){var i=[];i.push({label:"Estimate",value:"".concat(null===a||void 0===a?void 0:a.data.estimate," ").concat(null===a||void 0===a?void 0:a.data.currency)}),i.push({label:"Distance",value:"".concat(((null===a||void 0===a?void 0:a.data.distance)/1e3*.6214).toFixed(2)," miles")}),i.push({label:"Duration",value:"".concat(((null===a||void 0===a?void 0:a.data.duration)/60).toFixed(2)," mins")}),i.push({label:"Wait time",value:"".concat(((null===a||void 0===a?void 0:a.data.waitTime)/60).toFixed(2)," mins")}),le(i)}}),null!==M&&void 0!==M&&M.pageId&&b.publishToEvent(m.PublishPageTopics,cn(null===M||void 0===M?void 0:M.connectionId),Dn({objectId:null===M||void 0===M?void 0:M.pageId,paths:["$"],returnPaths:["$"]},null===M||void 0===M?void 0:M.pageId)),Ye(void 0!==(null===M||void 0===M?void 0:M.cudbServiceId))}var i},[M]),Object(a.useEffect)(function(){if(b.client){console.log("subscribe here");var e=new URLSearchParams(k),t=e.get("userId"),n=e.get("connectionId"),a=e.get("pageId"),i=e.get("token");Z(a),i?(console.log("decry"),E(ct({data:{payload:i},callback:function(e){}}))):E({type:"ADD_ENCRYPTED_TOKEN",payload:{connectionId:n,userId:t,pageId:a}})}},[k,b.client]);var vt=function(e){E({type:Ae,payload:e})},bt=function(){setTimeout(function(){var e=new URLSearchParams(k);e.delete("pageId"),e.delete("sessionId"),T.replace({search:e.toString()}),localStorage.removeItem("form"),localStorage.removeItem("formValues"),localStorage.removeItem("active"),E({type:De,payload:!1}),E({type:"SET_SELECTED_PAGE",payload:{page:void 0}}),h.resetFields(),h.setFieldsValue({}),nt(25),le(void 0),Z(void 0),we(void 0)})},jt=function(){for(var e=[],t=5,n=0;t<=6||7===t&&0===n;){var a="".concat(t,":").concat(String(n).padStart(2,"0")," ").concat("PM");e.push(a),60===(n+=15)&&(n=0,t+=1)}return e}();return Object(oa.jsxs)("div",{className:"main-column ride-dispatch-panel mr-4",style:O?{height:"auto"}:{},children:[Object(oa.jsx)("div",{className:"main-content",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",initialValues:{rideType:{type:"rideType",value:"oneWay"},fareType:{type:"fareType",value:"variable"},payType:{type:"payType",value:"meter"}},id:"register-form",layout:"vertical",form:h,onFinish:st,requiredMark:!1,onValuesChange:function(e,t){localStorage.setItem("form",JSON.stringify(t))},style:p?{}:{height:"48vh"},children:[Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h3",{className:"ml-3",children:K&&A?"".concat(null===A||void 0===A||null===(o=A.persistent)||void 0===o||null===(r=o.static)||void 0===r||null===(v=r.metatdata)||void 0===v?void 0:v.title):"Shuttle booking"})}),Object(oa.jsx)("div",{className:"d-flex",children:M&&!$e&&Object(oa.jsx)($i.a,{style:{color:"#869cbd",fontSize:21,cursor:"pointer"},onClick:function(){Ne(!0)}})})]}),Object(oa.jsxs)("div",{className:"main-cards",style:{maxHeight:O?"calc(100vh)":"calc(100vh - 200px)"},children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"passengerName",children:Object(oa.jsx)(Wn.a,{placeholder:"Passenger name",autoComplete:"on"})})})}),Object(oa.jsxs)(Yn.a,{className:"mt-3",children:[Object(oa.jsx)(Hn.a,{span:M&&!$e?21:24,className:"",children:Object(oa.jsx)(ei.a.Item,{name:"passengerPhoneNumber",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Fi.a,{placeholder:"Phone number",defaultCountry:"US",onChange:function(e){if(console.log("phone",e),e&&Object(Fi.b)(e)){var t=h.getFieldValue("passengerPhoneNumber"),n=h.getFieldValue("passengerEmail");we({phone:t,email:n})}else we(void 0)}})})}),M&&!$e&&Object(oa.jsx)(Hn.a,{span:3,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2 w-100",onClick:function(){var e=h.getFieldValue("passengerPhoneNumber");xe({phone:e})},children:"Search"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"passengerEmail",children:Object(oa.jsx)(Wn.a,{placeholder:"Email",autoComplete:"email",onChange:function(e){}})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"pickupLocation",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(ai,{placeholder:"Pick up location",onChange:function(e){vt({pickupLocation:e}),N(Object(d.a)(Object(d.a)({},S),{},{map:!0}))}})})})}),Object(oa.jsx)("hr",{}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"dispatch",rules:[{required:!0,message:"**Required Field"},{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if("schedule"!==(null===n||void 0===n?void 0:n.value)||null!==n&&void 0!==n&&n.date&&null!==n&&void 0!==n&&n.time){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(Gn.a,{className:"",placeholder:"Select pickup time slot",onFocus:function(){rt(new Date)},onSelect:function(e){var t=e.split(" "),n=Object(u.a)(t,2),a=n[0],i=n[1],c=a.split(":"),o=Object(u.a)(c,2),l=o[0],s=o[1];l=parseInt(l,10),"PM"===i&&12!==l&&(l+=12);var r=new Date;r.setHours(l),r.setMinutes(s),r.setSeconds(0),r.setMilliseconds(0),h.setFieldsValue({dispatch:{value:e,type:"dispatchType",date:r,time:r}})},children:jt.filter(function(e){return!ot.includes(e)}).map(function(e){return Object(oa.jsx)(Gn.a.Option,{value:e,children:e},e)})})})})}),Object(oa.jsx)("hr",{}),Ce&&Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Hi,{onClose:function(){we(void 0)},socket:b,payment:Ce,onShare:function(){var e=h.getFieldValue("passengerPhoneNumber"),t=h.getFieldValue("passengerEmail");(e&&""!==e||t&&""!==t)&&(b.publishToEvent(m.PublishPageTopics,Xt(null===M||void 0===M?void 0:M.connectionId),Dn({userId:null===M||void 0===M?void 0:M.userId,notificationChannels:{email:t,phone:e}})),Lt("Payment link shared successfully","success","TOP_CENTER",1e3))}})})}),M&&!$e&&Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"vehicle",children:Object(oa.jsx)(zc,{placeholder:"Select vehicle",onChange:function(e){},socket:b,vehicleType:je})})})}),Object(oa.jsx)("hr",{})]}),Object(oa.jsx)("div",{className:"d-flex mt-3",children:Object(oa.jsxs)("div",{className:"sub-cards-block mr-1",style:{minHeight:100},children:[Object(oa.jsx)("h5",{children:"Number of people"}),Object(oa.jsx)(ei.a.Item,{name:"numberOfPeople",children:Object(oa.jsx)(Fc,{max:5,onChange:function(e){console.log("number of people",e)}})}),Object(oa.jsxs)("p",{style:{color:"#000",fontSize:14,marginTop:5},children:["Fare: $",et]})]})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:"instructions",children:Object(oa.jsx)(Sv,{autoSize:{minRows:4,maxRows:6},placeholder:"Instructions"})})})}),Object(oa.jsxs)(Yn.a,{className:"d-flex px-2",children:[Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("p",{children:"Optional"})}),Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)("p",{children:"max. 500 character"})})]})]}),y&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:y})}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:K?6:12,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full w-full",onClick:function(){bt()},children:"Clear"})}),K&&Object(oa.jsx)(Hn.a,{span:6,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full w-full",onClick:function(){Me(!0)},disabled:"black"===ne,children:"Cancel"})}),Object(oa.jsx)(Hn.a,{span:K?6:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",htmlType:"submit",loading:_,disabled:ze||"green"===ne,onClick:function(){Le.current=!0},children:"Dispatch"})}),K&&Object(oa.jsx)(Hn.a,{span:6,className:"pl-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full",htmlType:"submit",loading:_,disabled:ze,onClick:function(){Le.current=!1},children:"New"})})]})]})}),Pe&&Object(oa.jsx)(xv,{onClose:function(){Me(void 0)},handleConfirm:function(){b.publishToEvent(m.PublishPageTopics,Jt(null===M||void 0===M?void 0:M.connectionId),Dn({pageId:K,userId:null===M||void 0===M?void 0:M.userId,cudbServiceId:null===w||void 0===w?void 0:w.userServiceId,dispatcher:!0})),Me(void 0)},message:"Are you sure you want to cancel ride?"}),(null===ge||void 0===ge?void 0:ge.phone)&&Object(oa.jsx)(yv,{socket:b,phone:null===ge||void 0===ge?void 0:ge.phone,onClose:function(){xe(void 0)}}),Se&&Object(oa.jsx)(Iv,{onClose:function(){Ne(!1)},socket:b})]})},kv=Object(da.compose)(Object(da.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?key=AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M&v=3.exp&libraries=geometry,drawing,places",loadingElement:Object(oa.jsx)("div",{style:{height:"100%"}}),containerElement:Object(oa.jsx)("div",{style:{height:"100%"}}),mapElement:Object(oa.jsx)("div",{style:{height:"100%"}})}),Object(da.withStateHandlers)(function(){return{isOpen:!1,activeMarker:null,directions:null,selectDirectionPin:null,drawingMode:null,activeInfo:null}},{onToggleOpen:function(e){var t=e.isOpen;return function(e){return{isOpen:!t,activeMarker:e}}},showDirection:function(){return function(e){return{directions:e}}},setDrawingMode:function(){return function(e){return{drawingMode:e}}},setSelectDirectionPin:function(){return function(e){return{selectDirectionPin:e}}},setActiveInfo:function(){return function(e){return{activeInfo:e}}}}),ua.withScriptjs,ua.withGoogleMap)(function(e){e.isOpen,e.active,e.setActive;var t,n,i,c=e.markers,o=e.assetMarkers,l=e.currentMarkers,r=e.currentLocation,d=e.getPlaces,u=e.setActiveInfo,v=e.activeInfo,b=e.showDirection,j=e.directions,m=e.polygon,p=e.circle,O=e.stands,f=Object(a.useRef)(null),h=Object(a.useRef)(!1),g=Object(s.c)(function(e){return e.auth}),x=g.selectedResponders,y=g.selectedAssets,I=Object(s.b)();Object(a.useEffect)(function(){x&&x.length>0&&console.log("update component")},[x]);var S=function(){i&&clearTimeout(i),i=setTimeout(function(){if(f.current){var e=f.current.getBounds();if(e){var t=e.getNorthEast(),n=e.getSouthWest();d({center:f.current.getCenter(),bounds:{minLat:n.lat(),maxLat:t.lat(),minLon:n.lng(),maxLon:t.lng()}})}}},500)};Object(a.useEffect)(function(){var e,t;!function(){var e=new google.maps.LatLngBounds;c.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),o.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),l.forEach(function(t){e.extend({lat:t.lat,lng:t.lng})}),O.forEach(function(t){var n,a;e.extend({lat:null===(n=t.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=t.location.coordinates)||void 0===a?void 0:a.long})}),e.isEmpty()||f.current.fitBounds(e)}(),l&&2===l.length?(h.current=!0,e=l[0],t=l[1],(new google.maps.DirectionsService).route({origin:new google.maps.LatLng(e.lat,e.lng),destination:new google.maps.LatLng(t.lat,t.lng),travelMode:google.maps.TravelMode.DRIVING},function(e,t){t===google.maps.DirectionsStatus.OK?h.current&&b(e):console.error("error fetching directions ".concat(e))})):(h.current=!1,b(void 0))},[c,l,o,O]);return Object(oa.jsxs)(ua.GoogleMap,{defaultZoom:14,options:{maxZoom:19,styles:[{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]}]},center:r,onZoomChanged:function(){S()},onCenterChanged:function(){S()},onTilesLoaded:function(){f.current&&r&&S()},ref:f,children:[m&&Object(oa.jsx)(ua.Polygon,{path:m.paths,editable:!1,options:{strokeColor:"#FF0000",fillColor:"#FF0000"},onClick:function(e){}}),p&&Object(oa.jsx)(ua.Circle,{center:{lat:null===(t=p.location.coordinates)||void 0===t?void 0:t[1],lng:null===(n=p.location.coordinates)||void 0===n?void 0:n[0]},radius:p.radius,options:{strokeColor:"FF0000",fillColor:"FF0000"},onClick:function(e){}}),null===O||void 0===O?void 0:O.map(function(e,t){var n,a;return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-green.svg",scaledSize:new google.maps.Size(22,34)},position:{lat:null===(n=e.location.coordinates)||void 0===n?void 0:n.lat,lng:null===(a=e.location.coordinates)||void 0===a?void 0:a.long},onClick:function(){I({type:Ee,payload:e})}},t)}),c.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/car-".concat(-1===x.findIndex(function(t){return t.id===e.id})?e.status:"blue",".svg"),scaledSize:new google.maps.Size(60,60)},position:{lat:e.lat,lng:e.lng},onClick:function(){"green"===(null===e||void 0===e?void 0:e.status)&&I({type:Ce,payload:e})},label:e.title},t)}),o.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===y.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){I({type:we,payload:e})},label:e.title},t)}),l.map(function(e,t){return Object(oa.jsx)(ua.Marker,{icon:e.markerIcon?e.markerIcon:{url:"/images/map-plain-icon-".concat(-1===x.findIndex(function(t){return t.id===e.id})?e.color:"green",".svg"),scaledSize:new google.maps.Size(22,34)},position:{lat:e.lat,lng:e.lng},onClick:function(){u(t)},children:v===t&&Object(oa.jsx)(ua.InfoWindow,{onCloseClick:function(){u(null)},children:Object(oa.jsx)("div",{children:Object(oa.jsx)("div",{children:e.title})})})},t)}),Object(oa.jsx)(ua.Marker,{position:r,icon:{url:"/images/map-plain-icon-blue.svg",scaledSize:new google.maps.Size(22,34)},onClick:function(){}}),j&&Object(oa.jsx)(ua.DirectionsRenderer,{directions:j,options:{markerOptions:{opacity:1},panel:document.getElementById("direction-panel")}})]})}),Tv={lat:29.95106579999999,lng:-90.0715323};var Cv=function(e){var t=e.socket,n=e.params,i=n.screens,c=(n.setScreens,Object(a.useState)()),o=Object(u.a)(c,2),r=(o[0],o[1],Object(a.useState)()),v=Object(u.a)(r,2),b=v[0],j=v[1],p=Object(a.useState)(!0),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(a.useState)(!0),x=Object(u.a)(g,2),y=x[0],I=(x[1],Object(a.useState)([])),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(a.useState)([]),C=Object(u.a)(T,2),w=C[0],E=C[1],R=Object(a.useState)([]),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Object(a.useState)(!1),L=Object(u.a)(M,2),U=L[0],q=L[1],F=Object(a.useReducer)(function(e){return e+1},0),B=Object(u.a)(F,2),_=(B[0],B[1],Object(s.c)(function(e){return e.auth})),$=_.responders,Y=_.vehicles,H=(_.incidentLocation,_.project),W=_.otherLocations,V=_.assets,z=_.geofenceLocation,Q=_.standLocations,G=_.encrypted_token,J=Object(l.g)().search,K=Object(a.useState)(),Z=Object(u.a)(K,2),X=Z[0],ee=Z[1],te=(Object(s.b)(),function(){var e=Object(a.useState)(!1),t=Object(u.a)(e,2),n=t[0],i=t[1];Object(a.useEffect)(function(){i(!0)},[])}(),{createPlaceMarker:function(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m=arguments.length>1&&void 0!==arguments[1]&&arguments[1],p=arguments.length>2?arguments[2]:void 0;null===e||void 0===e||null===(t=e.location)||void 0===t||null===(n=t.geoJson)||void 0===n||null===(a=n.features)||void 0===a||a.map(function(e){(null===e||void 0===e?void 0:e.geometry.coordinates.length)>0&&(j=e.geometry)});var O=(null===(i=e.beamIds)||void 0===i?void 0:i[0])||"".concat(e.profile.firstName,".").concat(e.profile.lastName);return null===p||void 0===p||p.map(function(t){t.id===e.id&&(O=t.name)}),Object(d.a)(Object(d.a)({},e),{},{lat:null===(c=j)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o[1],lng:null===(l=j)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s[0],title:O,color:"orange",paths:{lat:null===(r=j)||void 0===r||null===(u=r.coordinates)||void 0===u?void 0:u[1],lng:null===(v=j)||void 0===v||null===(b=v.coordinates)||void 0===b?void 0:b[0]},type:"marker",filter:"viewOnly",fitBounds:m})},createCurrentMarker:function(e){var t,n,a,i,c,o,l,s;return console.log("render point here",e),Object(d.a)(Object(d.a)({},e),{},{lat:null===e||void 0===e||null===(t=e.value)||void 0===t||null===(n=t.coordinates)||void 0===n?void 0:n.lat,lng:null===e||void 0===e||null===(a=e.value)||void 0===a||null===(i=a.coordinates)||void 0===i?void 0:i.long,title:null===e||void 0===e?void 0:e.label,color:"blue",paths:{lat:null===e||void 0===e||null===(c=e.value)||void 0===c||null===(o=c.coordinates)||void 0===o?void 0:o.lat,lng:null===e||void 0===e||null===(l=e.value)||void 0===l||null===(s=l.coordinates)||void 0===s?void 0:s.long},type:"marker"})},createAssetMarker:function(e){var t,n,a,i,c,o,l,s,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"fixedAsset"===(null===e||void 0===e||null===(t=e.metadata)||void 0===t?void 0:t.type)?s=null===e||void 0===e?void 0:e.asset:"poi"===(null===e||void 0===e||null===(n=e.metadata)||void 0===n?void 0:n.type)&&(s=null===e||void 0===e?void 0:e.poi);var u=s.location;return Object(d.a)(Object(d.a)({},s),{},{id:e.id,assetType:null===e||void 0===e||null===(a=e.metadata)||void 0===a?void 0:a.type,lat:null===u||void 0===u||null===(i=u.coordinates)||void 0===i?void 0:i.lat,lng:null===u||void 0===u||null===(c=u.coordinates)||void 0===c?void 0:c.long,title:u.attributes.title,color:"orange",paths:{lat:null===u||void 0===u||null===(o=u.coordinates)||void 0===o?void 0:o.lat,lng:null===u||void 0===u||null===(l=u.coordinates)||void 0===l?void 0:l.long},type:"marker",filter:"viewOnly",fitBounds:r})}}),ne=te.createPlaceMarker,ae=te.createCurrentMarker,ie=te.createAssetMarker,ce=Object(a.useState)(!1),oe=Object(u.a)(ce,2),le=oe[0],se=oe[1],re=Object(a.useState)(void 0),de=Object(u.a)(re,2),ue=de[0],ve=de[1],be=Object(a.useState)(void 0),je=Object(u.a)(be,2),me=je[0],pe=je[1],Oe=Object(a.useState)([]),fe=Object(u.a)(Oe,2),he=fe[0],ge=fe[1];Object(a.useEffect)(function(){var e=new URLSearchParams(J),t=e.get("lat"),n=e.get("lng");t&&n?j({lat:parseFloat(t),lng:parseFloat(n),current:!0}):xe()},[J]),Object(a.useEffect)(function(){if(W){console.log("other locations",W);var e=Object.keys(W).map(function(e){return ae(W[e])});A(e)}},[W]),Object(a.useEffect)(function(){if(z)if(console.log("geofence location",z),"Polygon"===(null===z||void 0===z?void 0:z.location.type)){var e=null===z||void 0===z?void 0:z.location.coordinates.map(function(e){return{lat:null===e||void 0===e?void 0:e[1],lng:null===e||void 0===e?void 0:e[0]}});ve({paths:e})}else pe(z);else ve(void 0),pe(void 0)},[z]),Object(a.useEffect)(function(){Q&&(console.log("stand locations",Q),ge(Q))},[Q]);Object(a.useEffect)(function(){if(H&&X)X.latLong,X.height,X.width},[H]),Object(a.useEffect)(function(){if(se(!1),$){var e=$.map(function(e){return ne(e,!1,Y)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),console.log("markers here",e),k(e)}},[$]),Object(a.useEffect)(function(){if(se(!1),V&&V.length>0){console.log("assets here",V);var e=V.map(function(e){return ie(e)});e=e.filter(function(e){return void 0!==e.lat&&void 0!==e.lng}),E(e)}},[V]);var xe=function(){b&&null!==b&&void 0!==b&&b.current?j(Object(d.a)({},b)):navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t,n,a,i,c;j({lat:null===e||void 0===e||null===(t=e.coords)||void 0===t?void 0:t.latitude,lng:null===e||void 0===e||null===(n=e.coords)||void 0===n?void 0:n.longitude,current:!0}),gc.a.fromLatLng(null===e||void 0===e||null===(a=e.coords)||void 0===a||null===(i=a.latitude)||void 0===i?void 0:i.toString(),null===(c=e.coords.longitude)||void 0===c?void 0:c.toString()).then(function(e){for(var t=0,n=e.results[0].address_components.length;t<n;t++){var a=e.results[0].address_components[t];a.types.indexOf("administrative_area_level_1")>=0&&a.short_name,a.types.indexOf("country")>=0&&a.short_name}},function(e){console.error(e),j(Tv)})},function(e){console.error(e),j(Tv)}):(alert("Geolocation is not supported by this browser."),j(Tv))},ye=function(e,t,n,a){var i=Ie(n-e),c=Ie(a-t),o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(Ie(e))*Math.cos(Ie(n))*Math.sin(c/2)*Math.sin(c/2);return 1e3*(6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))))},Ie=function(e){return e*(Math.PI/180)};return Object(oa.jsx)("div",{className:"main-column map-panel mr-4",children:Object(oa.jsxs)("div",{className:"main-content",children:[Object(oa.jsx)("div",{className:"search-bar mt-3",children:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)("div",{className:"g-map-search-input",children:Object(oa.jsx)(Ii.a,{autocompletionRequest:{},selectProps:{onChange:function(e){e&&function(e){Object(Ii.b)(e.place_id).then(function(e){e[0].geometry&&j({lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),current:!1})}).catch(function(e){return console.error(e)})}(e.value)},isClearable:!0,placeholder:"Search map",styles:{input:function(e){return Object(d.a)(Object(d.a)({},e),{},{fontFamily:"Nunito-Regular"})}}},apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/location-icon.svg",onClick:xe})}),Object(oa.jsx)(Vn.a,{className:"beam-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/reload-icon.svg",onClick:function(){h(!1),q(!1),k([]),E([]),xe()}})})]})}),Object(oa.jsx)("div",{className:"main-cards",children:Object(oa.jsxs)(Yn.a,{className:"map-container-layout",children:[Object(oa.jsx)(Hn.a,{md:i.active&&U?6:0,children:Object(oa.jsx)("div",{id:"direction-panel"})}),Object(oa.jsx)(Hn.a,{md:i.active&&U?18:24,children:y&&Object(oa.jsx)(kv,{currentLocation:b,markers:N,assetMarkers:w,currentMarkers:D,polygon:ue,circle:me,stands:he,active:f,setActive:h,getPlaces:function(e){var t=e.bounds,n=e.center,a=ye(t.minLat,t.maxLon,t.maxLat,t.maxLon),i=ye(t.minLat,t.maxLon,t.minLat,t.minLon),c={lat:n.lat(),long:n.lng()};ee({latLong:c,height:a,width:i})}})}),G&&!(null!==G&&void 0!==G&&G.cudbServiceId)&&Object(oa.jsxs)(Yn.a,{className:"lock-icons",onClick:function(){var e;if(!le&&X){var n=X.latLong;X.height,X.width;e=n,se(!0),t.publishToEvent(m.PublishPageTopics,Yt(null===G||void 0===G?void 0:G.connectionId),Dn({userId:null===G||void 0===G?void 0:G.userId,projectId:H,latLng:e,height:3e5,width:3e5}))}},children:[le&&Object(oa.jsx)(Hn.a,{span:2,children:Object(oa.jsx)(Ic.a,{type:"TailSpin",color:"#fff",height:15,width:15})}),Object(oa.jsx)(Hn.a,{span:22,children:"Search & select the available driver in the area"})]})]})})]})})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var wv=function(e){var t=e.socket,n=(Object(l.f)(),Object(s.b)(),Object(a.useState)({form:!0,map:!0})),i=Object(u.a)(n,2),c=i[0],o={screens:c,setScreens:i[1]};return Object(oa.jsxs)(Yn.a,{className:"main-layout",children:[c.form&&Object(oa.jsx)(Hn.a,{md:c.map?12:24,xs:24,className:"form"===c.active?"active-screen":"",children:c.form&&Object(oa.jsx)(Nv,{socket:t,params:o,fullScreen:!0})}),c.map&&Object(oa.jsx)(Hn.a,{md:12,xs:24,className:"map"===c.active?"active-screen":"",children:Object(oa.jsx)(Cv,{socket:t,params:o})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})};Dc.d.register(Dc.a,Dc.j,Dc.e);var Ev=function(e){var t=e.socket,n=(e.params,e.onClose),c=e.payment,o=Object(s.c)(function(e){return e.auth}).encrypted_token,l=(Object(s.b)(),Object(a.useState)(!0)),r=Object(u.a)(l,2),d=r[0],v=r[1],b=Object(a.useState)(!1),j=Object(u.a)(b,2),p=j[0],O=j[1],f=Object(a.useState)([]),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)(),I=Object(u.a)(y,2),S=I[0],N=I[1],k=Object(a.useRef)();Object(a.useEffect)(function(){if(o){k.current=o;var e=[];console.log("payment",c),Object.keys((null===c||void 0===c?void 0:c.stripe)||{}).map(function(t){"string"!==typeof c.stripe[t]&&"number"!==typeof c.stripe[t]||e.push({name:t,value:c.stripe[t]}),"status"===t&&N(c.stripe[t])}),x(e),t.subscribeToEvent(m.SubscribePageTopics,tn(null===o||void 0===o?void 0:o.connectionId),function(e){var t,n=e.response;(O(!1),null!==n&&void 0!==n&&n.status)?Lt("Refund Successful","success","TOP_CENTER",3e3):Lt(null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.details,"error","TOP_CENTER",3e3)})}},[o]);return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsxs)($n.a,{title:"Payment",visible:d,onCancel:function(){v(!1),n&&n()},width:"600px",className:"beam-modal",footer:[],destroyOnClose:!0,children:[Object(oa.jsx)(Yn.a,{className:"beam-modal analytics-summary-modal",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("ul",{className:"incident-information mt-2",children:g.map(function(e,t){return Object(oa.jsx)("li",{children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.name})}),Object(oa.jsx)(Hn.a,{span:12,children:Object(oa.jsx)("p",{children:e.value})})]})},t)})})})}),"succeeded"===S&&Object(oa.jsxs)(Yn.a,{className:"action-grp mt-3",children:[Object(oa.jsx)(Hn.a,{span:12,className:"px-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn bordered w-full",loading:p,disabled:!0,onClick:function(){},children:"Partial Refund"})}),Object(oa.jsx)(Hn.a,{span:12,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:p,onClick:function(){1==window.confirm("Are you sure you want to refund amount?")&&(O(!0),t.publishToEvent(m.PublishPageTopics,en(null===o||void 0===o?void 0:o.connectionId),Dn({userId:null===o||void 0===o?void 0:o.userId,pageId:null===c||void 0===c?void 0:c.pageId})))},children:"Refund"})})]})]})})};Za.a.Panel;Dc.d.register(Dc.a,Dc.j,Dc.e);Gn.a.Option;var Rv,Pv=function(e){return e.Dispatching="pending",e.Assigned="assigned",e.Started="started",e.Completed="completed",e.Escalated="escalated",e.Cancelled="cancelled",e.Processed="processed",e}({}),Dv={green:Pv.Completed,amber:Pv.Assigned,red:Pv.Escalated,blue:Pv.Started,purple:Pv.Dispatching,black:Pv.Cancelled,gray:Pv.Processed},Av=function(e){var t=e.socket,n=(e.params,e.filter),c=e.selected,o=e.componentUuid,r=(Object(l.g)().search,Object(s.c)(function(e){return e.auth})),v=r.userRequests,b=r.projects,j=(r.pageAggregateBds,r.selectedPage),p=r.encrypted_token,O=r.searchByPhone,f=Object(s.b)(),h=Object(a.useState)("project"),g=Object(u.a)(h,2),x=g[0],I=g[1],S=Object(a.useState)("state"),N=Object(u.a)(S,2),k=N[0],w=N[1],E=Object(a.useState)(!1),R=Object(u.a)(E,2),P=R[0],D=R[1],A=Object(a.useState)(void 0),M=Object(u.a)(A,2),L=M[0],U=M[1],q=Object(a.useState)(void 0),F=Object(u.a)(q,2),B=F[0],_=F[1],$=Object(a.useState)(!1),Y=Object(u.a)($,2),H=Y[0],Q=Y[1],G=Object(a.useState)(!1),J=Object(u.a)(G,2),K=J[0],Z=J[1],X=Object(a.useState)([]),ee=Object(u.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)([]),ie=Object(u.a)(ae,2),ce=ie[0],oe=ie[1],le=Object(a.useState)([]),se=Object(u.a)(le,2),re=(se[0],se[1]),de=Object(a.useState)([]),ue=Object(u.a)(de,2),ve=(ue[0],ue[1]),be=Object(a.useState)(),je=Object(u.a)(be,2),me=je[0],pe=je[1],Oe=Object(a.useRef)(W()),fe=(Object(a.useRef)(W()),Object(a.useRef)(void 0)),he=Object(a.useRef)(void 0),ge=Object(a.useRef)(0),xe=Object(a.useRef)(void 0),ye=Object(a.useRef)(!1),Ie=Object(a.useState)(),Se=Object(u.a)(Ie,2),Ne=Se[0],ke=Se[1],Te=Object(a.useState)({all:0,live:0,amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0}),Ce=Object(u.a)(Te,2),we=Ce[0],Ee=Ce[1],Re=Object(a.useState)(0),Pe=Object(u.a)(Re,2),De=Pe[0],Ae=Pe[1],Me=Object(a.useState)([]),Le=Object(u.a)(Me,2),Ue=Le[0],qe=Le[1],Fe=Object(a.useRef)(void 0),Be=Object(a.useRef)(void 0),_e=Object(a.useState)([]),$e=Object(u.a)(_e,2),Ye=$e[0],He=$e[1],We=Object(a.useState)(!1),Ve=Object(u.a)(We,2),ze=Ve[0],Qe=Ve[1],Ge=Object(a.useState)([]),Je=Object(u.a)(Ge,2),Ke=(Je[0],Je[1]),Ze=Object(a.useState)(void 0),Xe=Object(u.a)(Ze,2),et=Xe[0],nt=Xe[1],at=Mn().getUserRequestPayload,it=Object(a.useRef)(void 0),ct=Object(a.useRef)({project:void 0,user:void 0,area:void 0,time:void 0}),ot=Object(a.useRef)({status:void 0,time:void 0,phone:void 0}),lt=Object(a.useRef)({}),st=Object(a.useRef)(),rt=Object(a.useRef)([]),dt=Object(a.useCallback)(Object(Ac.a)(2e3,function(){console.log("debounce"),gt()},{atBegin:!0}),[]),ut=Object(a.useCallback)(function(e){var t,n,a;null!==(t=lt.current)&&void 0!==t&&t[e]||(lt.current[e]=Object(Ac.a)(2e3,function(e){console.log("search page here",e),ht(e)},{atBegin:!1})),null===(n=lt.current)||void 0===n||null===(a=n[e])||void 0===a||a.call(n,e)},[]),vt=function(e){ot.current.status=e?"@rideStatus:{".concat(Dv[e],"}"):void 0,ot.current.phone=void 0,Q(!0),xe.current=e,nt(e),xt()},bt=function(e){ot.current.phone=e?"@passengerPhoneNumber:{".concat(z(e),"}"):void 0,Q(!0),ot.current.status=void 0,xe.current="lime",nt("lime"),xt()};Object(a.useEffect)(function(){O&&(console.log("search by phone",O),bt(null===O||void 0===O?void 0:O.phone))},[O]);var jt=function(e,t){if("start"===e?fe.current=t:he.current=t,fe.current&&he.current){var n=new Date(fe.current);n.setHours(0),n.setMinutes(1);var a=new Date(he.current);a.setHours(23),a.setMinutes(59),ot.current.time="@createdAt:[".concat(n.getTime(),",+inf]@createdAt:[-inf, ").concat(a.getTime(),"]"),Z(!0),xt()}else fe.current||fe.current||(ot.current.time="",Z(!0),xt())},mt=function(e){var t,n;if(x!==e&&null!==b&&void 0!==b&&b.projects&&it.current){U(void 0),ne([]);var a=[];switch(e){case"project":console.log("projects",b),null===b||void 0===b||null===(t=b.projects)||void 0===t||t.filter(function(e){return null===e.type}).map(function(e){a.push({label:e.name,value:e.id})}),ne(a);break;case"vehicle":null===b||void 0===b||null===(n=b.projects)||void 0===n||n.filter(function(e){return"vehicle"===e.type}).map(function(e){a.push({label:e.name,value:e.id})}),ne(a);break;case"manager":Ot(it.current,"manager");break;case"dispatcher":Ot(it.current,"dispatcher");break;case"responder":Ot(it.current,"responder")}I(e)}},pt=function(e){k!==e&&(_(void 0),oe([]),ft(e),w(e))},Ot=function(e,n){var a;switch(n){case"dispatcher":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1===e.permissions.indexOf("admin")});break;case"responder":a=e.filter(function(e){return-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")});break;case"manager":a=e.filter(function(e){return-1!==e.permissions.indexOf("cad")&&-1!==e.permissions.indexOf("onMove")&&-1===e.permissions.indexOf("admin")})}var i=a.map(function(e){return"@roleId === '".concat(e._id,"'")}),c={select:{index:{searchIndex:"".concat("beamdevlive",":userNameIndex"),searchQuery:"@serviceId:{'".concat(z(null===b||void 0===b?void 0:b.userServiceId),"'}"),searchOptions:"TIMEOUT 5000"},load:{id:"$.objectId",status:"$.nonpersistent.static.live.status",live:"$.persistent.static.live",roleId:"$..admin.profile.roleId"}},apply:{expression:"",name:""},result:{},filter:{expression:"exists(@roleId) && (".concat(i.join("||"),")")},anyStatus:!1};t.publishToEvent(m.PublishPageTopics,xn(null===p||void 0===p?void 0:p.connectionId),Dn(c,"".concat(Oe.current,":").concat(n))),D(!0)},ft=function(e){Z(!0);var t={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===p||void 0===p?void 0:p.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(T.a)({},e,"$.persistent.static.profile.".concat(e))},groupBy:{properties:["@".concat(e)],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:""}};f(tt({requestData:t,callback:function(e){Z(!1);var t=[];null===e||void 0===e||e.map(function(e){e[Object.keys(e)[0]]&&t.push({label:e[Object.keys(e)[0]],value:e[Object.keys(e)[0]]})}),oe(t)}}))},ht=function(e){var t;if("string"===typeof e){var n={select:{index:{searchIndex:"".concat("beamdevlive",":pageUpdatedAtIndex"),searchQuery:"@pageMembers:{'".concat(null===(t=st.current)||void 0===t?void 0:t.userId,"'}"),searchOptions:"VERBATIM TIMEOUT 10000"},list:{objectIds:[e]},load:{persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId"}},filter:{expression:""}};f(tt({requestData:n,callback:function(e){ke(null===e||void 0===e?void 0:e[0])}}))}},gt=function(){var e,t=[],n="";if(ot.current.time)n+=ot.current.time;else{var a=new Date;a.setHours(0),a.setMinutes(1),n+="@createdAt:[".concat(a.getTime(),",+inf]")}ct.current&&Object.keys(ct.current).map(function(e){var n,a;null!==(n=ct.current)&&void 0!==n&&n[e]&&t.push(null===(a=ct.current)||void 0===a?void 0:a[e])});var i={};rt.current&&rt.current.map(function(e){i[e.key]=e.value});var c={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{'".concat(null===st||void 0===st||null===(e=st.current)||void 0===e?void 0:e.userId,"'}").concat(ye.current?"":"(-@rideType:{hail})","@pageType:{event}").concat(n),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)({profile:"$..profile",rideType:"$..profile.type",persistent:"$.persistent",nonpersistent:"$.nonpersistent",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",status:"$.nonpersistent.static.live.status.name",vehicleProjectId:"$..profile.vehicleProjectId"},i)},groupBy:{properties:["@status"],reducers:[{func:"COUNT",arguments:[],name:"count"}]},filter:{expression:t.join("&&")}};f(tt({requestData:c,callback:function(e){var t=0,n={amber:0,purple:0,red:0,green:0,blue:0,grey:0,black:0,brown:0,aqua:0};e.map(function(e){n[e.status]=e.count,t+=e.count}),Ee(Object(d.a)({all:t,live:t},n))}}))};Object(a.useEffect)(function(){we&&Ae(De+1)},[JSON.stringify(we)]),Object(a.useEffect)(function(){if(Ne){var e,t,n,a,i,c,o,l,s,r,u,v,j,m,p,O,f,h,g,x,y,I,S,N,k,T,w,E,R,P,D,A,M,L,U,q,F,B,_,$,Y=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===Ne||void 0===Ne||null===(e=Ne.persistent)||void 0===e||null===(t=e.static)||void 0===t?void 0:t.profile)||{}),(null===Ne||void 0===Ne||null===(n=Ne.persistent)||void 0===n||null===(a=n.static)||void 0===a?void 0:a.dashboard)||{}),(null===Ne||void 0===Ne||null===(i=Ne.persistent)||void 0===i||null===(c=i.static)||void 0===c?void 0:c.ride)||{}),(null===Ne||void 0===Ne||null===(o=Ne.persistent)||void 0===o||null===(l=o.dynamic)||void 0===l?void 0:l.ride)||{}),H=null===Ne||void 0===Ne||null===(s=Ne.nonpersistent)||void 0===s||null===(r=s.static)||void 0===r||null===(u=r.live)||void 0===u||null===(v=u.status)||void 0===v?void 0:v.name,W=null===Ne||void 0===Ne||null===(j=Ne.persistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.profile)||void 0===p?void 0:p.type,V=null===Ne||void 0===Ne||null===(O=Ne.persistent)||void 0===O||null===(f=O.static)||void 0===f||null===(h=f.metadata)||void 0===h?void 0:h.type;if(!ye.current&&"hail"===W||"event"!==V)return void console.log("show hail false");var z=Object(C.a)(Ue),Q=z.findIndex(function(e){return e.key===Ne.pageId});if(dt(),xe.current&&xe.current!==H)return void(-1!==Q&&(z.splice(Q,1),qe(z),Fe.current=z));var G={};Object.keys(Y).map(function(e){"string"===typeof Y[e]&&(G[e]=Y[e])});var J,K,Z,X,ee,te=(null===(g=Be.current)||void 0===g||null===(x=g.find(function(e){var t,n,a;return e.id===(null===Ne||void 0===Ne||null===(t=Ne.nonpersistent)||void 0===t||null===(n=t.dynamic)||void 0===n||null===(a=n.ride)||void 0===a?void 0:a.dispatchRequestBy)}))||void 0===x?void 0:x.beamId)||"",ne=(null===(y=Be.current)||void 0===y||null===(I=y.find(function(e){var t,n,a,i;return e.id===(null===(t=Object.keys((null===Ne||void 0===Ne||null===(n=Ne.nonpersistent)||void 0===n||null===(a=n.dynamic)||void 0===a||null===(i=a.ride)||void 0===i?void 0:i.manualUsers)||{}))||void 0===t?void 0:t[0])||""}))||void 0===I?void 0:I.beamId)||"";if(null===(S=Object.keys((null===Ne||void 0===Ne||null===(N=Ne.persistent)||void 0===N||null===(k=N.static)||void 0===k||null===(T=k.payment)||void 0===T?void 0:T.stripe)||{}))||void 0===S||S.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Ne||void 0===Ne||null===(t=Ne.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"succeeded"===(null===Ne||void 0===Ne||null===(o=Ne.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(J=null===Ne||void 0===Ne||null===(u=Ne.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])}),!J)null===(K=Object.keys((null===Ne||void 0===Ne||null===(Z=Ne.persistent)||void 0===Z||null===(X=Z.static)||void 0===X||null===(ee=X.payment)||void 0===ee?void 0:ee.stripe)||{}))||void 0===K||K.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j;"payment_intent"===(null===Ne||void 0===Ne||null===(t=Ne.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.payment)||void 0===a||null===(i=a.stripe)||void 0===i||null===(c=i[e])||void 0===c?void 0:c.object)&&"requires_capture"===(null===Ne||void 0===Ne||null===(o=Ne.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.payment)||void 0===s||null===(r=s.stripe)||void 0===r||null===(d=r[e])||void 0===d?void 0:d.status)&&(J=null===Ne||void 0===Ne||null===(u=Ne.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.payment)||void 0===b||null===(j=b.stripe)||void 0===j?void 0:j[e])});var ae,ie,ce=Object(d.a)(Object(d.a)({key:Ne.pageId,pageStatus:null===Ne||void 0===Ne||null===(w=Ne.nonpersistent)||void 0===w||null===(E=w.static)||void 0===E||null===(R=E.live)||void 0===R||null===(P=R.status)||void 0===P?void 0:P.name,requestedBy:te,requestedAt:new Date(null===Ne||void 0===Ne||null===(D=Ne.persistent)||void 0===D||null===(A=D.static)||void 0===A||null===(M=A.metadata)||void 0===M?void 0:M.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:ne,name:null===Ne||void 0===Ne||null===(L=Ne.persistent)||void 0===L||null===(U=L.static)||void 0===U||null===(q=U.metadata)||void 0===q?void 0:q.title,action:{pageId:Ne.pageId,page:Object(d.a)(Object(d.a)({},Ne),{},{profile:Y}),summary:G.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId,stripe:J}},G),{},{address:null!==G&&void 0!==G&&G.address&&""!==(null===G||void 0===G?void 0:G.adress)?null===G||void 0===G?void 0:G.address:null===Y||void 0===Y||null===(F=Y.pickupLocation)||void 0===F||null===(B=F.attributes)||void 0===B?void 0:B.address,dropoffAddress:null!==G&&void 0!==G&&G.dropoffAddress&&""!==(null===G||void 0===G?void 0:G.dropoffAddress)?null===G||void 0===G?void 0:G.dropoffAddress:null===Y||void 0===Y||null===(_=Y.dropoffLocation)||void 0===_||null===($=_.attributes)||void 0===$?void 0:$.address});if(console.log("source updated",ce),-1!==Q)z[Q]=Object(d.a)(Object(d.a)({},ce),{},{invited:null===Fe||void 0===Fe||null===(ae=Fe.current)||void 0===ae||null===(ie=ae[Q])||void 0===ie?void 0:ie.invited});else z.unshift(ce);ve(null===z||void 0===z?void 0:z.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f;return{lat:null===e||void 0===e||null===(t=e.action)||void 0===t||null===(n=t.page)||void 0===n||null===(a=n.persistent)||void 0===a||null===(i=a.static)||void 0===i||null===(c=i.live)||void 0===c||null===(o=c.location)||void 0===o||null===(l=o.coordinates)||void 0===l?void 0:l.lat,lng:null===e||void 0===e||null===(s=e.action)||void 0===s||null===(r=s.page)||void 0===r||null===(d=r.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.live)||void 0===v||null===(b=v.location)||void 0===b?void 0:b.coordinates.long,title:null===e||void 0===e||null===(j=e.action)||void 0===j||null===(m=j.page)||void 0===m||null===(p=m.persistent)||void 0===p||null===(O=p.static)||void 0===O||null===(f=O.metadata)||void 0===f?void 0:f.title}})),qe(z),Fe.current=z}},[Ne]);var xt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=[],n="",a="",i="";if("advance"===c)xe.current="brown",a="@rideStatus:{".concat(Dv.brown,"}");else if("dispatch"===c)xe.current="purple",a="@rideStatus:{".concat(Dv.purple,"}");else if(ct.current)if(Object.keys(ct.current).map(function(e){var n,a;null!==(n=ct.current)&&void 0!==n&&n[e]&&t.push(null===(a=ct.current)||void 0===a?void 0:a[e])}),ot.current.time||ot.current.phone)ot.current.time&&(n+=ot.current.time);else{var o=new Date;o.setHours(0),o.setMinutes(1),n+="@createdAt:[".concat(o.getTime(),",+inf]")}ot.current.status&&(a=ot.current.status),ot.current.phone&&(i=ot.current.phone);var l={};rt.current&&rt.current.map(function(e){l[e.key]=e.value}),ge.current=e;var s={select:{index:{searchIndex:"".concat("beamdevlive",":page:ride"),searchQuery:"@pageMembers:{".concat(null===p||void 0===p?void 0:p.userId,"}").concat(ye.current?"":"(-@rideType:{hail})","@pageType:{event}").concat(n).concat(a).concat(i),searchOptions:"VERBATIM TIMEOUT 10000"},load:Object(d.a)(Object(T.a)({profile:"$..profile",ride:"$.persistent.static.ride",stripe:"$.persistent.static.payment.stripe",type:"$..persistent.static.metadata.type",pageId:"$.objectId",iotAssetConfigId:"$.persistent.static.iotAsset.config.iotAssetConfigId",createdAt:"$.persistent.static.metadata.createdAt",updatedAt:"$.nonpersistent.dynamic.metadata.lastSent.members.updatedAt",status:"$.nonpersistent.static.live.status.name",rideType:"$..profile.type",phone:"$..profile.passengerPhoneNumber",vehicleProjectId:"$..profile.vehicleProjectId"},k,"$..profile.".concat(k)),l)},filter:{expression:t.join("&&")},sortBy:{properties:["advance"===c?{field:"@createdAt",order:"ASC"}:{field:"@updatedAt",order:"DESC"}],max:1e3},result:ot.current.phone?{pagination:{offset:e,limit:50}}:{}};console.log("page request 1",s),f(tt({requestData:s,callback:function(t){console.log("resppnse",t),re(t),ge.current=ge.current+30;var n=e>0?Object(C.a)(Ue):[],a=[{title:"Status",key:"pageStatus",dataIndex:"pageStatus",render:function(e){return Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",children:Object(oa.jsx)(fa.a,{src:"/images/flag-icon.svg",className:"".concat(null!==e&&void 0!==e?e:"gray","-icon")})})}},{title:"Schedule Date",key:"scheduleDate",dataIndex:"scheduleDate"},{title:"Schedule Time",key:"scheduleTime",dataIndex:"scheduleTime"},{title:"Address",key:"address",dataIndex:"address"},{title:"Passenger Name",key:"passengerName",dataIndex:"passengerName"},{title:"Passenger Phone",key:"passengerPhoneNumber",dataIndex:"passengerPhoneNumber"},{title:"Passenger Email",key:"passengerEmail",dataIndex:"passengerEmail"},{title:"Driver Name",key:"driverName",dataIndex:"driverName"},{title:"Vehicle Name",key:"vehicleName",dataIndex:"vehicleName"}];null===t||void 0===t||t.map(function(e,t){var a,i,c,o,l,s,r,u=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{}),v={};Object.keys(u).map(function(e){"string"===typeof u[e]&&(v[e]=u[e])});var j,m,p=Be.current||JSON.parse(localStorage.getItem("rideUsers")||"[]"),O=(null===p||void 0===p||null===(a=p.find(function(t){var n;return t.id===(null===e||void 0===e||null===(n=e.requestedBy)||void 0===n?void 0:n.toString())}))||void 0===a?void 0:a.beamId)||"",f=(null===p||void 0===p||null===(i=p.find(function(t){var n;return t.id===(null===(n=Object.keys((null===e||void 0===e?void 0:e.manualUsers)||{}))||void 0===n?void 0:n[0])||""}))||void 0===i?void 0:i.beamId)||"";(null===(c=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===c||c.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"succeeded"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(j=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}),j)||(null===(m=Object.keys((null===e||void 0===e?void 0:e.stripe)||{}))||void 0===m||m.map(function(t){var n,a,i,c,o;"payment_intent"===(null===e||void 0===e||null===(n=e.stripe)||void 0===n||null===(a=n[t])||void 0===a?void 0:a.object)&&"requires_capture"===(null===e||void 0===e||null===(i=e.stripe)||void 0===i||null===(c=i[t])||void 0===c?void 0:c.status)&&(j=null===e||void 0===e||null===(o=e.stripe)||void 0===o?void 0:o[t])}));n.push(Object(d.a)(Object(d.a)({key:e.pageId,pageStatus:e.status,name:"",action:{pageId:e.pageId,page:Object(d.a)(Object(d.a)({},e),{},{profile:u}),summary:v.summary,cudbServiceId:null===b||void 0===b?void 0:b.userServiceId,stripe:j}},v),{},{address:null!==v&&void 0!==v&&v.address&&""!==(null===v||void 0===v?void 0:v.adress)?null===v||void 0===v?void 0:v.address:null===u||void 0===u||null===(o=u.pickupLocation)||void 0===o||null===(l=o.attributes)||void 0===l?void 0:l.address,dropoffAddress:null!==v&&void 0!==v&&v.dropoffAddress&&""!==(null===v||void 0===v?void 0:v.dropoffAddress)?null===v||void 0===v?void 0:v.dropoffAddress:null===u||void 0===u||null===(s=u.dropoffLocation)||void 0===s||null===(r=s.attributes)||void 0===r?void 0:r.address,invited:"",requestedBy:O,requestedAt:new Date(null===e||void 0===e?void 0:e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),assigned:f}))}),console.log("source data",n),n.map(function(e){var t=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},(null===e||void 0===e?void 0:e.profile)||{}),(null===e||void 0===e?void 0:e.dashboard)||{}),(null===e||void 0===e?void 0:e.ride)||{}),(null===e||void 0===e?void 0:e.dynamic)||{});Object.keys(t||{}).map(function(e){-1===a.findIndex(function(t){return t.key===e})&&t[e]})}),a.push({title:"Action",key:"action",dataIndex:"action",render:function(e){return Object(oa.jsxs)(Yn.a,{style:{width:135},children:[Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",onClick:function(){V("".concat("https://live.staging.beam.live","/page/").concat(null===e||void 0===e?void 0:e.pageId),"BeamLive",.7*window.innerWidth,.9*window.innerHeight)},children:Object(oa.jsx)(Zc.a,{})})}),(null===e||void 0===e?void 0:e.summary)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){var t;window.open("".concat(window.location.origin,"/").concat(null!==(t=null===e||void 0===e?void 0:e.summary)&&void 0!==t?t:"summary","?connectionId=").concat(null===p||void 0===p?void 0:p.connectionId,"&pageId=").concat(null===e||void 0===e?void 0:e.pageId,"&cudbServiceId=").concat(null===e||void 0===e?void 0:e.cudbServiceId),"_blank")},children:Object(oa.jsx)(Ec.a,{})})}),(null===e||void 0===e?void 0:e.stripe)&&Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn ml-2",onClick:function(){pe({stripe:null===e||void 0===e?void 0:e.stripe,pageId:null===e||void 0===e?void 0:e.pageId})},children:Object(oa.jsx)(Oo.a,{})})})]})}}),He(a),qe(n),Fe.current=n,ve(null===t||void 0===t?void 0:t.map(function(e){var t,n,a,i,c,o,l,s,r,d,u,v;return{lat:null===e||void 0===e||null===(t=e.persistent)||void 0===t||null===(n=t.static)||void 0===n||null===(a=n.live)||void 0===a||null===(i=a.location)||void 0===i||null===(c=i.coordinates)||void 0===c?void 0:c.lat,lng:null===e||void 0===e||null===(o=e.persistent)||void 0===o||null===(l=o.static)||void 0===l||null===(s=l.live)||void 0===s||null===(r=s.location)||void 0===r?void 0:r.coordinates.long,title:null===e||void 0===e||null===(d=e.persistent)||void 0===d||null===(u=d.static)||void 0===u||null===(v=u.metadata)||void 0===v?void 0:v.title}})),Q(!1),D(!1),Z(!1)}})),dt()};return Object(a.useEffect)(function(){p&&(st.current=p,t.subscribeToEvent(m.SubscribePageTopics,qt(null===p||void 0===p?void 0:p.connectionId)),t.publishToEvent(m.PublishPageTopics,Ft(null===p||void 0===p?void 0:p.connectionId),Dn({userId:null===p||void 0===p?void 0:p.userId})),t.subscribeToEvent(m.SubscribePageTopics,Rn(null===p||void 0===p?void 0:p.userId),function(e){ut(null===e||void 0===e?void 0:e.data)},o),D(!0),xt(),ft("state"),Ke(JSON.parse(localStorage.getItem("tableHideList"))||[]))},[p]),Object(a.useEffect)(function(){if(b){var e,n=[];null===b||void 0===b||null===(e=b.projects)||void 0===e||e.filter(function(e){return null===e.type}).map(function(e){n.push({label:e.name,value:e.id})}),ne(n),null!==b&&void 0!==b&&b.adminUserId&&(a=null===b||void 0===b?void 0:b.adminUserId,i=null===b||void 0===b?void 0:b.userServiceId,it.current||(t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,at(a,"$","$..role"),hn(null===p||void 0===p?void 0:p.connectionId),i),t.subscribeToSurvey(m.SurveyTopics,hn(null===p||void 0===p?void 0:p.connectionId),function(e){var t,n;it.current=null===(t=e.data)||void 0===t||null===(n=t[0])||void 0===n?void 0:n[0]},o)),t.subscribeToEvent(m.SubscribePageTopics,bn(null===p||void 0===p?void 0:p.connectionId,null===b||void 0===b?void 0:b.userServiceId)),t.subscribeToEvent(m.SubscribePageTopics,yn(null===p||void 0===p?void 0:p.connectionId)))}var a,i},[b]),Object(a.useEffect)(function(){if(v&&t.client){var e,n,a;if(!Be.current&&null!==v&&void 0!==v&&v[null===(e=Object.keys(v))||void 0===e?void 0:e[0]])console.log("user requests here",null===v||void 0===v?void 0:v[null===(n=Object.keys(v))||void 0===n?void 0:n[0]]),Be.current=null===v||void 0===v?void 0:v[null===(a=Object.keys(v))||void 0===a?void 0:a[0]],localStorage.setItem("rideUsers",JSON.stringify(Be.current));if(null!==v&&void 0!==v&&v["".concat(Oe.current,":").concat(x)]){var i;D(!1);var c=[];null===v||void 0===v||null===(i=v["".concat(Oe.current,":").concat(x)])||void 0===i||i.map(function(e){c.push({label:"".concat(e.fullName,": ").concat(e.email),value:e.id})}),ne(c)}}},[v,t.client]),Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsxs)(Yn.a,{gutter:30,className:"mb-2",style:ze?{}:{display:"none"},children:[Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{gutter:16,className:"d-flex px-1 flex-wrap",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){mt("project")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("project"===x?"green-btn cover":""),children:"Route"})}),Object(oa.jsx)("div",{onClick:function(){mt("vehicle")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("vehicle"===x?"green-btn cover":""),children:"Vehicle"})}),Object(oa.jsx)("div",{onClick:function(){mt("dispatcher")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("dispatcher"===x?"green-btn cover":""),children:"Dispatcher"})}),Object(oa.jsx)("div",{onClick:function(){mt("responder")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("responder"===x?"green-btn cover":""),children:"Driver"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:P,value:L,allowClear:!0,showSearch:!0,filterOption:function(e,t){var n;return null===(n=t.label)||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},options:te,onChange:function(e){!function(e){switch(U(e),x){case"project":ct.current.project=e?"exists(@iotAssetConfigId) && @iotAssetConfigId === '".concat(e,"'"):void 0,ct.current.user=void 0,D(!0);break;case"vehicle":ct.current.project=e?"exists(@vehicleProjectId) && @vehicleProjectId === '".concat(e,"'"):void 0,ct.current.user=void 0,D(!0);break;case"responder":case"dispatcher":rt.current=[{key:"user",value:"$.persistent.static.metadata.members.users.".concat(e)}],ct.current.user=e?"exists(@user)":void 0,ct.current.project=void 0,D(!0)}xt()}(e)}})})}),Object(oa.jsx)(Yn.a,{gutter:15,className:"d-flex px-2 flex-wrap mt-4",children:Object(oa.jsx)(Hn.a,{sm:24,md:4,children:Object(oa.jsx)("h5",{className:"mb-0",children:"Search"})})}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Fi.a,{placeholder:"Parent phone number",defaultCountry:"US",allowClear:!0,onChange:function(e){console.log("phone",e),Rv&&clearTimeout(Rv),Rv=setTimeout(function(){bt(e)},700)}})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:10,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsxs)(Yn.a,{className:"d-flex flex-wrap",id:"filters",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)("h5",{className:"mb-0",children:"Filters"})}),Object(oa.jsx)("div",{onClick:function(){pt("state")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("state"===k?"green-btn cover":""),children:"State"})}),Object(oa.jsx)("div",{onClick:function(){pt("city")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("city"===k?"green-btn cover":""),children:"City"})}),Object(oa.jsx)("div",{onClick:function(){pt("county")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("county"===k?"green-btn cover":""),children:"County"})}),Object(oa.jsx)("div",{onClick:function(){pt("zip")},children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-70 ".concat("zip"===k?"green-btn cover":""),children:"Zip"})})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{xs:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select ID",loading:K,allowClear:!0,options:ce,value:B,onChange:function(e){!function(e){_(e),ct.current.time=e?"exists(@".concat(k,") && @").concat(k," === '").concat(e,"'"):void 0,Z(!0),xt()}(e)}})})}),Object(oa.jsxs)(Yn.a,{gutter:15,className:"d-flex flex-wrap mt-3 mx-0",children:[Object(oa.jsxs)(Hn.a,{xs:24,md:10,className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png",alt:""}),Object(oa.jsx)(Jn.a,{placeholder:"From",suffixIcon:Object(oa.jsx)(aa.a,{}),onChange:function(e){jt("start",e)}})]}),Object(oa.jsx)(Hn.a,{xs:24,md:4,className:"d-flex justify-content-center",children:Object(oa.jsx)(fa.a,{src:"/images/next.svg"})}),Object(oa.jsxs)(Hn.a,{xs:24,md:10,className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png",alt:""}),Object(oa.jsx)(Jn.a,{placeholder:"To",suffixIcon:Object(oa.jsx)(aa.a,{}),onChange:function(e){jt("end",e)}})]})]}),Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{className:"w-full",placeholder:"Select Hour(s)",disabled:!0})})})]})}),Object(oa.jsx)(Hn.a,{className:"gutter-row",sm:24,md:4,children:Object(oa.jsxs)(Cc.a,{className:"filter-card",children:[Object(oa.jsx)("p",{className:"mb-2 text-center",children:"Export to"}),Object(oa.jsxs)("div",{className:"d-flex flex-row flex-md-column justify-content-center",children:[Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-csv.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-xls.svg"})})}),Object(oa.jsx)("div",{children:Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0",disabled:!0,children:Object(oa.jsx)(fa.a,{src:"/images/export-pdf.svg"})})})]})]})})]}),n&&Object(oa.jsxs)(Yn.a,{className:"d-flex mb-2",children:[Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat(void 0===et?"status-selected":""),onClick:function(){vt(void 0)},children:Object(oa.jsxs)("div",{children:[Object(oa.jsx)("span",{children:"All"}),Object(oa.jsx)("h4",{children:we.live})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("purple"===et?"status-selected":""),onClick:function(){vt("purple")},children:Object(oa.jsxs)("div",{className:"purple",children:[Object(oa.jsx)("span",{children:"Pending"}),Object(oa.jsx)("h4",{children:we.purple})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("amber"===et?"status-selected":""),onClick:function(){vt("amber")},children:Object(oa.jsxs)("div",{className:"amber",children:[Object(oa.jsx)("span",{children:"Assigned"}),Object(oa.jsx)("h4",{children:we.amber})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("blue"===et?"status-selected":""),onClick:function(){vt("blue")},children:Object(oa.jsxs)("div",{className:"blue",children:[Object(oa.jsx)("span",{children:"Started"}),Object(oa.jsx)("h4",{children:we.blue})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("red"===et?"status-selected":""),onClick:function(){vt("red")},children:Object(oa.jsxs)("div",{className:"red",children:[Object(oa.jsx)("span",{children:"Escalated"}),Object(oa.jsx)("h4",{children:we.red})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("green"===et?"status-selected":""),onClick:function(){vt("green")},children:Object(oa.jsxs)("div",{className:"green",children:[Object(oa.jsx)("span",{children:"Completed"}),Object(oa.jsx)("h4",{children:we.green})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("grey"===et?"status-selected":""),onClick:function(){vt("grey")},children:Object(oa.jsxs)("div",{className:"grey",children:[Object(oa.jsx)("span",{children:"Processed"}),Object(oa.jsx)("h4",{children:we.grey})]})}),Object(oa.jsx)(Hn.a,{span:2,className:"border rounded text-center p-2 mx-2 cursor-pointer ".concat("black"===et?"status-selected":""),onClick:function(){vt("black")},children:Object(oa.jsxs)("div",{className:"black",children:[Object(oa.jsx)("span",{children:"Cancelled"}),Object(oa.jsx)("h4",{children:we.black})]})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 0 10px 0"},onClick:function(){Qe(!ze)},children:Object(oa.jsx)(Rc.a,{})}),Object(oa.jsx)(Vn.a,{className:"beam-btn icon-btn",style:{float:"right",margin:"10px 10px 10px 0"},loading:P||H,onClick:function(){D(!0),xt()},children:!P&&!H&&Object(oa.jsx)(Pc.a,{})})]}),Object(oa.jsx)(Yn.a,{gutter:20,className:"scrollable-table",style:{display:"grid"},children:Object(oa.jsx)(Hn.a,{xs:24,sm:24,md:24,style:{maxHeight:1e3,overflow:"scroll"},children:Object(oa.jsx)(Xi.a,{dataSource:Ue,className:(null===Ue||void 0===Ue?void 0:Ue.length)>0?"":"table-empty",onRow:function(e){return{onDoubleClick:function(){var t;f({type:"SET_SELECTED_PAGE",payload:{page:null===e||void 0===e||null===(t=e.action)||void 0===t?void 0:t.page}})},onClick:function(){}}},columns:Ye,scroll:{x:!0},onChange:function(e){console.log("event here",e)},rowClassName:function(e,t){var n;return(null===e||void 0===e?void 0:e.key)===(null===j||void 0===j||null===(n=j.page)||void 0===n?void 0:n.pageId)?"row-selected":""}})})}),me&&Object(oa.jsx)(Ev,{socket:t,payment:me,onClose:function(){pe(void 0)}})]})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var Mv=function(e){var t=e.socket,n=(Object(l.f)(),Object(s.b)(),Object(a.useState)({form:!0,map:!0})),i=Object(u.a)(n,2),c=i[0],o=i[1],r=Object(a.useState)("map"),d=Object(u.a)(r,2),b=(d[0],d[1],Object(a.useState)({driver:W(),advance:W(),dispatch:W(),all:W()})),j=Object(u.a)(b,2),m=j[0],p=(j[1],{screens:c,setScreens:o});return Object(oa.jsxs)(Yn.a,{className:"main-layout",style:{transform:"scale(0.8)",transformOrigin:"0 0",width:"125vw",height:"100vh"},children:[c.form&&Object(oa.jsx)(Hn.a,{md:c.map?7:24,xs:24,className:"form"===c.active?"active-screen":"",style:{height:"calc((100vh / 0.8) - 50px)",overflow:"scroll"},children:c.form&&Object(oa.jsx)(Nv,{socket:t,params:p,fullScreen:!0,scale:!0})}),c.map&&Object(oa.jsx)(Hn.a,{span:17,style:{height:"calc((100vh / 0.8) - 70px)",overflow:"scroll"},children:Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:24,className:"ride-container ".concat("map"===c.active?"active-screen":""),children:Object(oa.jsx)(Cv,{socket:t,params:p})}),Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)("div",{className:"beam-modal analytics-summary-modal mr-4",children:Object(oa.jsx)(v.a,{className:"main-layout exec-layout mt-3",style:{padding:0},children:Object(oa.jsx)(Av,{socket:t,filter:!0,componentUuid:m.all})})})})]})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})},Lv=(n(991),function(e){e.headerTitle;var t=e.handleCancel,n=e.onCreate,i=e.data,c=e.isEditQuestion,o=e.maxLimit,l=e.sections,s=Object(a.useState)(c?i:{name:"",label:"",type:S.ThreeButton,value:"",isMulti:!1,options:[],ColSize:6}),r=Object(u.a)(s,2),v=r[0],b=r[1],j=Object(a.useState)(""),m=Object(u.a)(j,2),p=m[0],O=(m[1],Object(a.useState)(c?null===i||void 0===i?void 0:i.type:S.ThreeButton)),f=Object(u.a)(O,2),h=f[0],g=f[1],x=Object(a.useState)(1),y=Object(u.a)(x,2),I=y[0],N=y[1],k=Object(a.useState)(),T=Object(u.a)(k,2),C=T[0],w=T[1];Object(a.useEffect)(function(){var e=Na.codes().map(function(e){return{label:e,value:e}});w(e)},[]),Object(a.useEffect)(function(){c&&(g(i.type),b(i),i.type===S.MultipleChoice&&N(i.options.length))},[]);return Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Yn.a,{className:"mb-4",children:Object(oa.jsx)(Yn.a,{className:"mb-1 d-flex justify-content-center",children:Object(oa.jsx)(Hn.a,{})})}),Object(oa.jsx)(Yn.a,{className:"d-flex",children:qa.map(function(e,t){return Object(oa.jsx)(Hn.a,{span:e.span,className:"mb-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn w-full ".concat(h===e.label?"green-btn cover":""),onClick:function(){g(e.label),b(Object(d.a)(Object(d.a)({},v),{},{type:e.label}))},children:e.label})},t)})}),Object(oa.jsxs)(Yn.a,{className:"mt-4 mb-4",children:[Object(oa.jsx)("span",{className:"col-label",children:"Select Size:"}),Object(oa.jsx)(ea.a,{className:"w-100",defaultValue:v.ColSize,max:o,onChange:function(e){b(Object(d.a)(Object(d.a)({},v),{},{ColSize:e}))}})]}),Object(oa.jsx)(Yn.a,{className:"mt-4 mb-4",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)(Wn.a,{value:v.name,placeholder:"Type Question field name",onChange:function(e){b(Object(d.a)(Object(d.a)({},v),{},{name:e.target.value}))}}),p&&Object(oa.jsx)("span",{className:"error-text",children:"Please fill this field"})]})}),Object(oa.jsx)(Yn.a,{className:"mt-4 mb-4",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)(Wn.a,{value:v.label,placeholder:"Type Question",onChange:function(e){b(Object(d.a)(Object(d.a)({},v),{},{label:e.target.value}))}}),p&&Object(oa.jsx)("span",{className:"error-text",children:"Please fill this field"})]})}),Object(oa.jsx)(Yn.a,{className:"mt-4 mb-4",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Xn.a,{className:"mr-2",checked:v.required,defaultChecked:!1,onChange:function(e){b(Object(d.a)(Object(d.a)({},v),{},{required:e.target.checked}))},children:"is Required ?"})})}),Object(oa.jsx)(Ba,{item:v,setItem:b,choiceCount:I,setChoiceCount:N,activeType:h,currencyCodeList:C,sections:l}),Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:8,className:"pr-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",onClick:function(){n(v)},disabled:0===o,children:c?"Edit":"Add"})}),Object(oa.jsx)(Hn.a,{span:8,className:"pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn orange-btn bordered w-full",onClick:t,children:"Cancel"})})]})]})}),Uv=["Custom"],qv=Kl.a.TabPane,Fv={Account:{name:"Account",conditional:!1},Why:{name:"Why",conditional:!1},Where:{name:"Where",conditional:!1},Who:{name:"Who",conditional:!1},When:{name:"When",conditional:!1},What:{name:"What",conditional:!1},Custom:{name:"Custom",conditional:!1},Conditional:{name:"Conditional",conditional:!0}},Bv=function(e){var t=e.onClick,n=e.label;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-20 action-buttons delete-btn mr-2",src:"/images/delete-icon.svg",title:n,onClick:t})},"list-loadmore-edit")},_v=function(e){var t=e.onClick,n=e.label;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-20 action-buttons mr-2",src:"/images/add-icon.svg",title:n,onClick:t})},"list-loadmore-edit")},$v=function(e){var t=e.onClick,n=e.label;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-14 action-buttons mr-2",src:"/images/edit-icon.svg",title:n,onClick:t})},"list-loadmore-edit")},Yv=function(e){var t=e.item,n=e.editQuestion,a=e.deleteQuestion,i=e.socket,c=e.onServiceChange;return Object(oa.jsx)(Yn.a,{className:"w-100",children:t.Cols.map(function(e,o){return Object(oa.jsxs)(Hn.a,{span:e.ColSize,className:"d-flex w-100 flex-column align-items-center justify-content-start tiles mt-3",style:{marginLeft:0===o?-5*(t.Cols.length-1):0,marginRight:o!==t.Cols.length-1?5:0},children:[Object(oa.jsxs)(Yn.a,{className:"d-flex w-100 justify-content-end",children:[Object(oa.jsx)($v,{label:"Edit Question",onClick:function(){return n(o)}}),Object(oa.jsx)(Bv,{label:"Delete Question",onClick:function(){return a(o)}})]}),Object(oa.jsx)("div",{className:"w-100",children:Object(oa.jsx)(dc,{data:e,socket:i,serviceDisabled:!0,onServiceChange:c})})]},o)})})},Hv=Za.a.Panel,Wv=function(e){var t=e.item,n=e.addNewQuestion,i=e.addNewRow,c=e.onServiceChange,o=e.deleteRow,l=e.editQuestion,s=e.deleteQuestion,r=e.deleteSection,d=e.isMultiClick,v=e.type,b=(e.changeOrder,e.socket),j=Object(a.useState)(t.sectionName),m=Object(u.a)(j,2),p=(m[0],m[1]);t.sectionName,Object(Ka.a)(Fv,Uv);return Object(oa.jsx)("div",{style:{display:((null===t||void 0===t?void 0:t.conditional)||!1)===("conditional"===v)?void 0:"none"},children:Object(oa.jsx)(Yn.a,{className:"d-flex",style:{justifyContent:"end"},children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Za.a,{defaultActiveKey:[],bordered:!1,className:"simple-collapse mt-3",onChange:function(e){},children:Object(oa.jsxs)(Hv,{header:Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h5",{className:"input-section",children:Object(oa.jsx)(Wn.a,{placeholder:"Enter Section Name",value:t.sectionName,onChange:function(e){t.sectionName=e.target.value,p(e.target.value)}})})}),children:[Object(oa.jsx)(Yn.a,{className:"d-flex",style:{justifyContent:"end"},children:Object(oa.jsx)(Hn.a,{children:Object(oa.jsx)(Bv,{label:"Delete Section",onClick:function(){return r()}})})}),Object(oa.jsx)(Yn.a,{children:t.Rows.map(function(e,t){return Object(oa.jsxs)("div",{className:"w-100 d-flex tiles mt-3",style:{border:0},children:[Object(oa.jsxs)(Yn.a,{className:" d-flex tiles w-100 mt-3",style:{background:"#edf0f5",border:0,borderRadius:10,boxShadow:"-6px 0px 10px #ffffff, 8px 8px 10px #dfe5ee"},children:[e.Cols.length?Object(oa.jsxs)("div",{className:"d-flex w-100 justify-content-end",children:[Object(oa.jsx)(Xn.a,{className:"mr-2",checked:e.isMulti,defaultChecked:!1,onChange:function(e){return d(t,e.target.checked)},children:"is Multi ?"}),Object(oa.jsx)(_v,{label:"Add New Col",onClick:function(){return n(t)}})]}):Object(oa.jsxs)(Yn.a,{className:"d-flex w-100 justify-content-center",children:[Object(oa.jsx)(_v,{label:"Add New Col",onClick:function(){return n(t)}}),Object(oa.jsx)("h5",{children:"Click to add new question"})]}),Object(oa.jsx)(Yv,{item:e,editQuestion:function(e){return l(t,e)},deleteQuestion:function(e){return s(t,e)},onServiceChange:c,socket:b})]},t),Object(oa.jsxs)("div",{className:"d-flex flex-column align-items-center ml-3",children:[Object(oa.jsx)(_v,{label:"Add New Row",onClick:function(){return i(t)}}),Object(oa.jsx)(Bv,{label:"Delete Row",onClick:function(){return o(t)}})]})]},t)})})]},"account")})})})})},Vv=function(e){var t=e.socket,n=Object(a.useState)([]),c=Object(u.a)(n,2),o=c[0],l=c[1],r=Object(s.c)(function(e){return e.auth}).sectionList,v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=b[0],p=b[1],O=Object(a.useState)(!1),h=Object(u.a)(O,2),g=h[0],x=h[1],I=Object(a.useState)("unconditional"),S=Object(u.a)(I,2),N=S[0],k=S[1],w=Object(a.useState)(!1),E=Object(u.a)(w,2),R=E[0],P=E[1],D=Object(a.useState)({sectionIndex:0,rowIndex:0,limit:0,colIndex:0}),A=Object(u.a)(D,2),M=A[0],L=A[1],U=Object(a.useState)(!0),q=Object(u.a)(U,2),F=(q[0],q[1]),B=Mn(),_=B.getUserRequestPayload,$=B.updateUserRequestPayload,Y=Object(a.useState)({}),H=Object(u.a)(Y,2),W=H[0],V=H[1],z=function(e){var t=e.itemName,n=e.value;V({itemName:t,data:n})};Object(a.useEffect)(function(){var e=Mt("projectId"),t=e&&""!==e?r[e]||[]:r;l(t)},[r]),Object(a.useEffect)(function(){if(t.client){var e=Mt("projectId");t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,_(Mt("userId"),"$",e&&""!==e?"/persistent/static/live/projectSections":"/persistent/static/live/sections"),f.GetSectionList,Mt("serviceId")),t.subscribeToSurvey(m.SurveyTopics,f.GetSectionList,function(){F(!1)})}},[t.client]);return Object(oa.jsxs)($n.a,{title:"",visible:!0,width:"100%",className:"beam-modal-cad survey-modal",footer:[],closable:!1,children:[j&&Object(oa.jsx)($n.a,{visible:!0,onOk:function(){},onCancel:function(){p(!j)},width:"480px",className:"beam-modal-cad",footer:[],destroyOnClose:!0,closable:!0,children:Object(oa.jsx)(Lv,{headerTitle:"Choose the Questionaire Type:",handleCancel:function(){return p(!j)},onCreate:function(e){return t=e,p(!j),R?o[M.sectionIndex].Rows[M.rowIndex].Cols[M.colIndex]=Object(d.a)(Object(d.a)({},t),{},{label:t.label,value:""}):o[M.sectionIndex].Rows[M.rowIndex].Cols.push(Object(d.a)(Object(d.a)({},t),{},{label:t.label,value:""})),void l(Object(C.a)(o));var t},data:o[M.sectionIndex].Rows[M.rowIndex].Cols[M.colIndex],maxLimit:M.limit,isEditQuestion:R,sections:o})}),g&&Object(oa.jsxs)($n.a,{visible:g,onOk:function(){},closable:!0,onCancel:function(){x(!g)},width:"480px",className:"beam-modal-cad",footer:[],destroyOnClose:!0,children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)("span",{className:"col-label",children:"Select Type of Section"})}),Object(oa.jsx)(Yn.a,{className:"mt-2",children:Object.entries(Fv).map(function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover mt-2 mb-2 section-type-btn",onClick:function(){var e;e=a,x(!1),o.push({sectionName:null===e||void 0===e?void 0:e.name,conditional:null===e||void 0===e?void 0:e.conditional,Rows:[{isMulti:!1,Cols:[]}]}),l(Object(C.a)(o))},children:n})},"".concat(n,"-").concat(a))})})]}),Object(oa.jsxs)(Yn.a,{className:"d-flex justify-content-space-between",children:[Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover",onClick:function(){return x(!0)},children:"Add Section"}),Object(oa.jsx)(Vn.a,{className:"beam-btn export mb-0 mb-md-2 mr-3 mr-md-0 h-50",onClick:function(){return function(){var e=["title","location-lat","location-long"];o.forEach(function(t){t.Rows.forEach(function(t){t.Cols.forEach(function(t){e.push(t.name)})})});var t={data:[],filename:"event_template",delimiter:",",headers:e};Object(vl.a)(t)}()},children:Object(oa.jsx)(fa.a,{src:"/images/export-csv.svg"})})]}),Object(oa.jsx)("br",{}),Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Kl.a,{defaultActiveKey:"unconditional",type:"line",onChange:function(e){k(e)},children:[Object(oa.jsx)(qv,{tab:"Sections"},"unconditional"),Object(oa.jsx)(qv,{tab:"Conditional"},"conditional")]})}),Object(oa.jsx)(Cc.a,{className:"filter-card mt-3 main-cards",children:Object(oa.jsx)(zn.b,{className:"demo-loadmore-list  cad-form-modal",itemLayout:"horizontal",dataSource:o,renderItem:function(e,n){return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(Wv,{socket:t,type:N,item:e,deleteSection:function(){o.splice(n,1),l(Object(C.a)(o))},isMultiClick:function(e,t){o[n].Rows[e].isMulti=t,l(Object(C.a)(o))},editQuestion:function(e,t){var a=24-o[n].Rows[e].Cols.reduce(function(e,t){return e+t.ColSize},0)+o[n].Rows[e].Cols[t].ColSize;L({sectionIndex:n,rowIndex:e,colIndex:t,limit:a}),P(!0),p(!0)},deleteQuestion:function(e,t){o[n].Rows[e].Cols.splice(t,1),l(Object(C.a)(o))},addNewQuestion:function(e){p(!0),P(!1);var t=24-o[n].Rows[e].Cols.reduce(function(e,t){return e+t.ColSize},0);L({sectionIndex:n,rowIndex:e,colIndex:0,limit:t})},addNewRow:function(e){return function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;o[arguments.length>0&&void 0!==arguments[0]?arguments[0]:0].Rows.splice(e+1,0,{Cols:[],isMulti:!1}),l(Object(C.a)(o))}(n,e)},deleteRow:function(e){return function(e,t){o[e].Rows.splice(t,1),l(Object(C.a)(o))}(n,e)},onServiceChange:z,changeOrder:function(e){if("up"!==e||0!==n){if("up"===e){for(var t,a=n-1;a>0;a--){var i,c,s;if("unconditional"===N&&(void 0===(null===(i=o[n])||void 0===i?void 0:i.conditional)||!1===(null===(c=o[n])||void 0===c?void 0:c.conditional))||"conditional"===N&&!0===(null===(s=o[n])||void 0===s?void 0:s.conditional)){t=a;break}}if(void 0===t)return;var r=o[n];o[n]=o[t],o[t]=r,l(Object(C.a)(o))}if("down"===e){for(var d,u=n+1;u<o.length;u++){var v,b,j;if("unconditional"===N&&(void 0===(null===(v=o[n])||void 0===v?void 0:v.conditional)||!1===(null===(b=o[n])||void 0===b?void 0:b.conditional))||"conditional"===N&&!0===(null===(j=o[n])||void 0===j?void 0:j.conditional)){d=u;break}}if(void 0===d)return;var m=o[n];o[n]=o[d],o[d]=m,l(Object(C.a)(o))}}}})})}})}),Object(oa.jsx)(Yn.a,{className:"d-flex justify-content-end mt-4",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover",onClick:function(){o.map(function(e,t){e.Rows.map(function(e,n){e.Cols.map(function(e,a){var i;""===e.name||""===e.name?e.name="question".concat(t).concat(n).concat(a):(null===W||void 0===W||null===(i=W.itemName)||void 0===i?void 0:i.length)>1&&e.name===(null===W||void 0===W?void 0:W.itemName[1])&&"service"===(null===e||void 0===e?void 0:e.type)&&(e.value=null===W||void 0===W?void 0:W.data)})})}),F(!0);var e=Mt("projectId");t.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,$(Mt("userId"),"replace",e&&""!==e?"/persistent/static/live/projectSections":"/persistent/static/live/sections",e&&""!==e?Object(d.a)(Object(d.a)({},r),{},Object(T.a)({},e,Object(C.a)(o))):Object(C.a)(o)),f.UpdateSectionList,Mt("serviceId")),console.log($(Mt("userId"),"replace",e&&""!==e?"/persistent/static/live/projectSections":"/persistent/static/live/sections",e&&""!==e?Object(d.a)(Object(d.a)({},r),{},Object(T.a)({},e,Object(C.a)(o))):Object(C.a)(o))),t.subscribeToSurvey(m.SurveyTopics,f.UpdateSectionList,function(e){F(!1),Lt("CAD Sections Updated.","successs","TOP_CENTER",1e3)})},children:"Save"})})]})},zv=(n(992),["Custom"]),Qv={Account:"Account",Why:"Why",Where:"Where",Who:"Who",When:"When",What:"What",Custom:""},Gv=function(e){var t=e.onClick,n=e.label;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-20 action-buttons delete-btn mr-2",src:"/images/delete-icon.svg",title:n,onClick:t})},"list-loadmore-edit")},Jv=function(e){var t=e.onClick,n=e.label;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-20 action-buttons mr-2",src:"/images/add-icon.svg",title:n,onClick:t})},"list-loadmore-edit")},Kv=function(e){var t=e.onClick,n=e.label;return Object(oa.jsx)("a",{children:Object(oa.jsx)(fa.a,{className:"sz-14 action-buttons mr-2",src:"/images/edit-icon.svg",title:n,onClick:t})},"list-loadmore-edit")},Zv=function(e){var t=e.item,n=e.editQuestion,a=e.deleteQuestion;return Object(oa.jsx)(Yn.a,{className:"w-100",children:t.Cols.map(function(e,i){return Object(oa.jsxs)(Hn.a,{span:e.ColSize,className:"d-flex w-100 flex-column align-items-center justify-content-start tiles mt-3",style:{marginLeft:0===i?-5*(t.Cols.length-1):0,marginRight:i!==t.Cols.length-1?5:0},children:[Object(oa.jsxs)(Yn.a,{className:"d-flex w-100 justify-content-end",children:[Object(oa.jsx)(Kv,{label:"Edit Question",onClick:function(){return n(i)}}),Object(oa.jsx)(Gv,{label:"Delete Question",onClick:function(){return a(i)}})]}),Object(oa.jsx)("div",{className:"w-100",children:Object(oa.jsx)(dc,{data:e})})]},i)})})},Xv=(Za.a.Panel,function(e){var t=e.item,n=e.addNewQuestion,i=e.addNewRow,c=e.deleteRow,o=e.editQuestion,l=e.deleteQuestion,s=(e.deleteSection,e.isMultiClick),r=Object(a.useState)(t.sectionName),d=Object(u.a)(r,2);d[0],d[1],t.sectionName,Object(Ka.a)(Qv,zv);return Object(oa.jsx)(Yn.a,{children:t.Rows.map(function(e,t){return Object(oa.jsxs)("div",{className:"w-100 d-flex tiles mt-3",style:{border:0},children:[Object(oa.jsxs)(Yn.a,{className:" d-flex tiles w-100 mt-3",style:{background:"#edf0f5",border:0,borderRadius:10,boxShadow:"-6px 0px 10px #ffffff, 8px 8px 10px #dfe5ee"},children:[e.Cols.length?Object(oa.jsxs)("div",{className:"d-flex w-100 justify-content-end",children:[Object(oa.jsx)(Xn.a,{className:"mr-2",checked:e.isMulti,defaultChecked:!1,onChange:function(e){return s(t,e.target.checked)},children:"is Multi ?"}),Object(oa.jsx)(Jv,{label:"Add New Col",onClick:function(){return n(t)}})]}):Object(oa.jsxs)(Yn.a,{className:"d-flex w-100 justify-content-center",children:[Object(oa.jsx)(Jv,{label:"Add New Col",onClick:function(){return n(t)}}),Object(oa.jsx)("h5",{children:"Click to add new question"})]}),Object(oa.jsx)(Zv,{item:e,editQuestion:function(e){return o(t,e)},deleteQuestion:function(e){return l(t,e)}})]},t),Object(oa.jsxs)("div",{className:"d-flex flex-column align-items-center ml-3",children:[Object(oa.jsx)(Jv,{label:"Add New Row",onClick:function(){return i(t)}}),Object(oa.jsx)(Gv,{label:"Delete Row",onClick:function(){return c(t)}})]})]},t)})})}),eb=function(e){var t=e.socket,n=Object(a.useState)([]),c=Object(u.a)(n,2),o=c[0],l=c[1],r=Object(s.c)(function(e){return e.auth}).sectionList,v=Object(a.useState)(!1),b=Object(u.a)(v,2),j=b[0],p=b[1],O=Object(a.useState)(!1),h=Object(u.a)(O,2),g=h[0],x=h[1],I=Object(a.useState)(!1),S=Object(u.a)(I,2),N=S[0],k=S[1],T=Object(a.useState)({sectionIndex:0,rowIndex:0,limit:0,colIndex:0}),w=Object(u.a)(T,2),E=w[0],R=w[1],P=Object(a.useState)(!0),D=Object(u.a)(P,2),A=(D[0],D[1]),M=Mn(),L=M.getUserRequestPayload,U=M.updateUserRequestPayload;Object(a.useEffect)(function(){var e=Mt("projectId"),t=e&&""!==e?r[e]||[]:r;l(t)},[r]),Object(a.useEffect)(function(){if(t.client){Mt("projectId");t.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,L(Mt("userId"),"$","/persistent/static/admin/customer"),f.GetSectionList,Mt("serviceId")),t.subscribeToSurvey(m.SurveyTopics,f.GetSectionList,function(){A(!1)})}},[t.client]);return Object(oa.jsxs)($n.a,{title:"",visible:!0,width:"100%",className:"beam-modal-cad survey-modal",footer:[],closable:!1,children:[j&&Object(oa.jsx)($n.a,{visible:!0,onOk:function(){},onCancel:function(){p(!j)},width:"480px",className:"beam-modal-cad",footer:[],destroyOnClose:!0,closable:!0,children:Object(oa.jsx)(Lv,{headerTitle:"Choose the Questionaire Type:",handleCancel:function(){return p(!j)},onCreate:function(e){return t=e,p(!j),N?o[E.sectionIndex].Rows[E.rowIndex].Cols[E.colIndex]=Object(d.a)(Object(d.a)({},t),{},{label:t.label,value:""}):o[E.sectionIndex].Rows[E.rowIndex].Cols.push(Object(d.a)(Object(d.a)({},t),{},{label:t.label,value:""})),void l(Object(C.a)(o));var t},data:o[E.sectionIndex].Rows[E.rowIndex].Cols[E.colIndex],maxLimit:E.limit,isEditQuestion:N})}),g&&Object(oa.jsxs)($n.a,{visible:g,onOk:function(){},closable:!0,onCancel:function(){x(!g)},width:"480px",className:"beam-modal-cad",footer:[],destroyOnClose:!0,children:[Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)("span",{className:"col-label",children:"Select Type of Section"})}),Object(oa.jsx)(Yn.a,{className:"mt-2",children:Object.entries(Qv).map(function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return Object(oa.jsx)(Hn.a,{span:8,children:Object(oa.jsx)(Vn.a,{className:"beam-btn cover mt-2 mb-2 section-type-btn",onClick:function(){var e;e=a,x(!1),o.push({sectionName:e,Rows:[{isMulti:!1,Cols:[]}]}),l(Object(C.a)(o))},children:n})},"".concat(n,"-").concat(a))})})]}),Object(oa.jsx)(zn.b,{className:"demo-loadmore-list  cad-form-modal",itemLayout:"horizontal",dataSource:o,renderItem:function(e,t){return Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(Xv,{item:e,deleteSection:function(){o.splice(t,1),l(Object(C.a)(o))},isMultiClick:function(e,n){o[t].Rows[e].isMulti=n,l(Object(C.a)(o))},editQuestion:function(e,n){var a=24-o[t].Rows[e].Cols.reduce(function(e,t){return e+t.ColSize},0)+o[t].Rows[e].Cols[n].ColSize;R({sectionIndex:t,rowIndex:e,colIndex:n,limit:a}),k(!0),p(!0)},deleteQuestion:function(e,n){o[t].Rows[e].Cols.splice(n,1),l(Object(C.a)(o))},addNewQuestion:function(e){p(!0),k(!1);var n=24-o[t].Rows[e].Cols.reduce(function(e,t){return e+t.ColSize},0);R({sectionIndex:t,rowIndex:e,colIndex:0,limit:n})},addNewRow:function(e){return function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;o[arguments.length>0&&void 0!==arguments[0]?arguments[0]:0].Rows.splice(e+1,0,{Cols:[],isMulti:!1}),l(Object(C.a)(o))}(t,e)},deleteRow:function(e){return function(e,t){o[e].Rows.splice(t,1),l(Object(C.a)(o))}(t,e)}})})}}),Object(oa.jsx)(Yn.a,{className:"d-flex justify-content-end mt-4",children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover",onClick:function(){A(!0),t.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,U(Mt("userId"),"replace","/persistent/static/admin/customer",Object(C.a)(o)),f.UpdateSectionList,Mt("serviceId")),t.subscribeToSurvey(m.SurveyTopics,f.UpdateSectionList,function(e){A(!1),Lt("CAD Sections Updated.","successs","TOP_CENTER",1e3)})},children:"Save"})})]})},tb=Gn.a.Option,nb=Wn.a.TextArea,ab=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ib=[15,30,45,60],cb=function(e){var t,n,c,o=e.data,l=e.name,s=e.restFields,r=(e.socket,e.onChange),v=[l,null===o||void 0===o?void 0:o.name],b="",j=Object(a.useState)(o||{}),m=Object(u.a)(j,2),p=m[0],O=m[1],f=Object(a.useState)([]),h=Object(u.a)(f,2),g=h[0],x=h[1],y=Object(a.useState)([]),I=Object(u.a)(y,2),N=I[0],k=I[1];Object(a.useEffect)(function(){(null===o||void 0===o?void 0:o.type)===S.Category&&k((null===o||void 0===o?void 0:o.value)||[])},[o]);var T=function(e,t,n){var a=Object(C.a)(p.options);a[e].operationHours[t]=n;var i=Object(d.a)(Object(d.a)({},p),{},{options:a});O(i),r(i)};switch(o.type){case S.Text:b=Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(nb,{autoSize:null!==o&&void 0!==o&&o.isMulti?{minRows:4,maxRows:6}:{minRows:1,maxRows:3},onChange:function(e){r(e.target.value)}})})]});break;case S.YesNo:b=Object(oa.jsx)(ei.a.Item,Object(d.a)(Object(d.a)({},s),{},{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(ii,{placeholder:null===o||void 0===o?void 0:o.label,onChange:function(e){r(e)}})}));break;case S.ThreeButton:b=Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(ci,{placeholder:null===o||void 0===o?void 0:o.label,onChange:function(e){r(e)}})});break;case S.Number:b=Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),Object(oa.jsx)(Yn.a,{className:"w-100 mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(la,{value:o.value,onChange:function(e){r(e)}})})})})]});break;case S.MultipleChoice:b=Object(oa.jsx)(i.a.Fragment,{children:Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(li,{value:null===o||void 0===o?void 0:o.value,options:null===o||void 0===o?void 0:o.options,isMulti:o.isMulti,placeholder:null===o||void 0===o?void 0:o.label,onChange:function(e){r(null===e||void 0===e?void 0:e.option)}})})});break;case S.Bar:b=Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(ri,{options:null===o||void 0===o?void 0:o.options,placeholder:null===o||void 0===o?void 0:o.label,onChange:function(e){r(e)}})});break;case S.Date:b=Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"},{message:"**Date must be in MM/DD/YYYY format",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(a=/^(0[1-9]|1[0-2])\/(0[1-9]|[12][0-9]|3[01])\/\d{4}$/,!n||a.test(n)){e.n=1;break}return e.a(2,Promise.reject("Date must be in MM/DD/YYYY format"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(Wn.a,{maxLength:8,placeholder:"MMDDYYYY",onChange:function(e){r(e.target.value)}})})]})});break;case S.DateTime:b=Object(oa.jsx)(Yn.a,{children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),Object(oa.jsx)(ei.a.Item,{name:v,children:Object(oa.jsx)(di,{onChange:function(e){r(e)}})})]})});break;case S.Currency:b=Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),Object(oa.jsx)(Yn.a,{className:"w-100 mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(sa,{suffix:o.options[0],onChange:function(e){r(e)}})})})})]});break;case S.Location:case S.GPS:b=Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(ai,{placeholder:null===o||void 0===o?void 0:o.label,onChange:function(e){r(e)}})});break;case S.File:b=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:v,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("value",n),void 0!==n&&0!==(null===n||void 0===n||null===(a=n.files)||void 0===a?void 0:a.length)){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(vi,{placeholder:null===o||void 0===o?void 0:o.label,name:v,onChange:function(e){r(e)}})})})});break;case S.Signature:b=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:v,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("value",n),void 0!==n&&0!==(null===n||void 0===n||null===(a=n.files)||void 0===a?void 0:a.length)){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(vi,{placeholder:null===o||void 0===o?void 0:o.label,onChange:function(e){r(e)}})})})});break;case S.Media:b=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:v,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("value",n),void 0!==n&&0!==(null===n||void 0===n||null===(a=n.files)||void 0===a?void 0:a.length)){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(vi,{placeholder:null===o||void 0===o?void 0:o.label,onChange:function(e){r(e)}})})})});break;case S.Capture:b=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:v,rules:[{message:"**Required Field",validator:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("value",n),void 0!==n&&0!==(null===n||void 0===n||null===(a=n.files)||void 0===a?void 0:a.length)){e.n=1;break}return e.a(2,Promise.reject("**Required Field"));case 1:return e.a(2)}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],children:Object(oa.jsx)(vi,{placeholder:null===o||void 0===o?void 0:o.label,onChange:function(e){r(e)}})})})});break;case S.Email:b=Object(oa.jsxs)(i.a.Fragment,{children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"},{type:"email",message:"**Input is not valid e-mail"}],children:Object(oa.jsx)(Wn.a,{onChange:function(e){r(e.target.value)}})})]});break;case S.Tag:case S.TagNot:b=Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(ra,{placeholder:null===o||void 0===o?void 0:o.label,onChange:function(e){r(e)}})});break;case S.Phone:b=Object(oa.jsx)(Yn.a,{className:"d-flex",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(Bi,{onChange:function(e){r(e)}})})]})});break;case S.Name:b=Object(oa.jsx)(Yn.a,{className:"d-flex",children:Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{className:"w-full",onChange:function(e){r(e.target.value)}})})]})});break;case S.Time:b=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png",alt:""}),Object(oa.jsx)(ei.a.Item,{name:v,rules:[{required:null===o||void 0===o?void 0:o.required,message:"**Required Field"}],children:Object(oa.jsx)(gi,{name:null===o||void 0===o?void 0:o.label,onChange:function(e){r(e)}})})]})})});break;case S.Password:b=Object(oa.jsxs)(Hn.a,{span:24,children:[Object(oa.jsx)(ei.a.Item,{name:"pin",rules:[{required:!0,message:"**Required Field"}],children:Object(oa.jsx)(Wn.a,{type:"password",placeholder:"Enter 5-Digit Security PIN"})}),Object(oa.jsx)(ei.a.Item,{name:"confirm-pin",dependencies:["pin"],rules:[{required:!0,message:"Please confirm your pin!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("pin")!==n?Promise.reject(new Error("The two pins that you entered do not match!")):Promise.resolve()}}}],children:Object(oa.jsx)(Wn.a,{type:"password",style:{width:"100%"},className:"mt-2",placeholder:"Confirm PIN",onChange:function(e){r(e.target.value)}})})]});break;case S.Category:b=Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select categories",value:g,onChange:function(e){x(e)},children:o.options.map(function(e){return Object(oa.jsx)(tb,{value:e.name,children:e.name},e.name)})})})}),o.options.length>0&&(b=Object(oa.jsxs)(oa.Fragment,{children:[b,Object(oa.jsx)(Yn.a,{className:"mt-3",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(Gn.a,{mode:"multiple",style:{width:"100%"},placeholder:"Select subcategories",value:N,onChange:function(e){O(e),k(e),r(e)},children:null===o||void 0===o?void 0:o.options.filter(function(e){return g.includes(e.name)}).flatMap(function(e){return e.subCategories}).map(function(e){return Object(oa.jsx)(tb,{value:e,children:e},e)})})})})]}));break;case S.Calendar:b=Object(oa.jsxs)(Yn.a,{className:"tiles",children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),Object(oa.jsx)(Yn.a,{className:"mb-2 w-100 mt-3",children:Object(oa.jsxs)(Hn.a,{span:24,className:"operation-time custom-tag",children:[Object(oa.jsx)(Jn.a,{style:{width:"100%"},onChange:function(e){if(e){var t=e.format("YYYY-MM-DD"),n=Object(C.a)((null===p||void 0===p?void 0:p.holidays)||[]);n=n.includes(t)?n.filter(function(e){return e!==t}):[].concat(Object(C.a)(n),[t]);var a=Object(d.a)(Object(d.a)({},p),{},{holidays:n});O(a),r(a)}},value:null,placeholder:"Select holidays"}),Object(oa.jsx)("div",{children:null===p||void 0===p||null===(t=p.holidays)||void 0===t?void 0:t.map(function(e){return Object(oa.jsx)(Kn.a,{className:"tag-item",closable:!0,onClose:function(){return function(e){var t=Object(C.a)((null===p||void 0===p?void 0:p.holidays)||[]);t=t.filter(function(t){return t!==e});var n=Object(d.a)(Object(d.a)({},p),{},{holidays:t});O(n),r(n)}(e)},children:e},e)})})]})}),Object(oa.jsx)(Yn.a,{className:"mb-2 w-100",children:Object(oa.jsx)(Hn.a,{span:24,className:"operation-time custom-tag",children:Object(oa.jsx)(Gn.a,{placeholder:"Select appointment duration",onChange:function(e){!function(e){var t=Object(d.a)(Object(d.a)({},p),{},{appointmentDuration:e});O(t),r(t)}(e)},style:{width:"100%"},value:null===p||void 0===p?void 0:p.appointmentDuration,children:ib.map(function(e){return Object(oa.jsx)(tb,{value:e,children:e},e)})})})}),null===p||void 0===p||null===(n=p.options)||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsxs)(Yn.a,{gutter:8,className:"mb-3 w-100",children:[Object(oa.jsx)(Hn.a,{span:23,children:Object(oa.jsx)(Gn.a,{placeholder:"Select operation days",onChange:function(e){!function(e,t){var n=Object(C.a)(p.options);n[e].daysOfWeek=t;var a=Object(d.a)(Object(d.a)({},p),{},{options:n});O(a),r(a)}(t,e)},mode:"multiple",style:{width:"100%"},value:null===e||void 0===e?void 0:e.daysOfWeek,children:ab.map(function(e){return Object(oa.jsx)(tb,{value:e,children:e},e)})})}),Object(oa.jsx)(Hn.a,{span:1,className:"t-right",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",type:"link",onClick:function(){return function(e){var t=Object(C.a)(p.options);t.splice(e,1);var n=Object(d.a)(Object(d.a)({},p),{},{options:t});O(n),r(n)}(t)},children:Object(oa.jsx)(na.a,{})})}),Object(oa.jsxs)(Hn.a,{span:24,className:"mt-1 t-right operation-time",children:[e.operationHours.map(function(e,n){return Object(oa.jsxs)(Yn.a,{gutter:8,className:"mt-1 t-right",children:[Object(oa.jsx)(Hn.a,{span:10,children:Object(oa.jsx)(Zn.a,{placeholder:"Start operation time",format:"HH:mm",value:null!==e&&void 0!==e&&e.startTime?H()(null===e||void 0===e?void 0:e.startTime,"HH:mm"):null,onChange:function(a){T(t,n,{startTime:a?a.format("HH:mm"):null,endTime:e.endTime})}})}),Object(oa.jsx)(Hn.a,{span:11,children:Object(oa.jsx)(Zn.a,{placeholder:"End operation time",format:"HH:mm",value:null!==e&&void 0!==e&&e.endTime?H()(null===e||void 0===e?void 0:e.endTime,"HH:mm"):null,onChange:function(a){T(t,n,{startTime:e.startTime,endTime:a?a.format("HH:mm"):null})}})}),Object(oa.jsx)(Hn.a,{span:1,className:"t-right",children:Object(oa.jsx)(Vn.a,{type:"link",className:"beam-btn",onClick:function(){return function(e,t){var n=Object(C.a)(p.options);n[e].operationHours.splice(t,1);var a=Object(d.a)(Object(d.a)({},p),{},{options:n});O(a),r(a)}(t,n)},children:Object(oa.jsx)(na.a,{})})})]},n)}),Object(oa.jsx)(Vn.a,{className:"t-right mr-2 beam-btn",type:"link",onClick:function(){!function(e){var t=Object(C.a)(p.options);t[e].operationHours.push({startTime:void 0,endTime:void 0});var n=Object(d.a)(Object(d.a)({},p),{},{options:t});O(n),r(n)}(t)},children:"Add time"})]})]},t)}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right mt-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){var e=Object(d.a)(Object(d.a)({},p),{},{options:[].concat(Object(C.a)((null===p||void 0===p?void 0:p.options)||[]),[{daysOfWeek:[],operationHours:[{startTime:void 0,endTime:void 0}]}])});O(e),r(e)},children:"Add days"})})]});break;case S.Payment:b=Object(oa.jsxs)(Yn.a,{className:"tiles",children:[Object(oa.jsx)("span",{className:"col-label",children:null===o||void 0===o?void 0:o.label}),null===p||void 0===p||null===(c=p.options)||void 0===c?void 0:c.map(function(e,t){return Object(oa.jsxs)(Yn.a,{className:"w-100 mt-3",children:[Object(oa.jsx)(Hn.a,{span:23,className:"mb-3",children:Object(oa.jsx)(Wn.a,{value:e.title,className:"beam-input",onChange:function(e){var n=p.options;n[t].title=e.target.value;var a=Object(d.a)(Object(d.a)({},p),{},{options:n});console.log("tempValue",a),O(a),r(a)},placeholder:"title"})},t),Object(oa.jsx)(Hn.a,{span:1,className:"t-right pl-2",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){var e=p.options;e.splice(t,1);var n=Object(d.a)(Object(d.a)({},p),{},{options:e});O(n),r(n)},children:Object(oa.jsx)(na.a,{})})}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right",children:Object(oa.jsx)(la,{value:e.price,onChange:function(e){var n=p.options;n[t].price=e;var a=Object(d.a)(Object(d.a)({},p),{},{options:n});O(a),r(a)},placeholder:"amount"})})]})}),Object(oa.jsx)(Hn.a,{span:24,className:"t-right mt-3",children:Object(oa.jsx)(Vn.a,{className:"beam-btn",onClick:function(){var e=(null===p||void 0===p?void 0:p.options)||[];e.push({title:"",price:0});var t=Object(d.a)(Object(d.a)({},p),{},{options:e});O(t),r(t)},children:"Add service rate"})})]});break;case S.SectionDocument:b=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Wn.a,{value:null===o||void 0===o?void 0:o.value,className:"w-full",onChange:function(e){r(e.target.value)},placeholder:null===o||void 0===o?void 0:o.label})});break;default:b=""}return b},ob=Za.a.Panel,lb=function(e){var t,n,i=e.socket,c=ei.a.useForm(),o=Object(u.a)(c,1)[0],l=Object(a.useState)(""),r=Object(u.a)(l,2),v=r[0],b=r[1],j=Object(s.b)(),p=Object(s.c)(function(e){return e.auth}),O=p.bio,f=p.rolesList,g=p.urlParams,N=p.survey,k=Object(a.useState)(!1),T=Object(u.a)(k,2),w=T[0],E=T[1],R=Object(a.useState)({}),P=Object(u.a)(R,2),D=P[0],A=P[1],M=Object(a.useRef)({basicBio:[],extendedBio:[]}),L=Object(a.useState)([]),U=Object(u.a)(L,2),q=(U[0],U[1]),F=[{Cols:[{name:"email",label:"Enter Email",type:S.Email,value:"",isMulti:!1,options:[],ColSize:24}]},{Cols:[{name:"phone",label:"Enter Phone Number",type:S.Phone,value:"",isMulti:!1,options:[],ColSize:24}]},{Cols:[{name:"beamIds",label:"Enter Beam ID",type:S.Text,value:"",isMulti:!1,options:[],ColSize:24}]},{Cols:[{name:"firstName",label:"Enter First Name",type:S.Text,value:"",isMulti:!1,options:[],ColSize:8},{name:"middleName",label:"Enter Middle Name",type:S.Text,value:"",isMulti:!1,options:[],ColSize:8},{name:"lastName",label:"Enter last Name",type:S.Text,value:"",isMulti:!1,options:[],ColSize:8}]},{Cols:[{name:"gender",label:"Select Gender",type:S.MultipleChoice,value:"",isMulti:!1,options:["male","female"],ColSize:24}]},{Cols:[{name:"doB",label:"Date of Birth",type:S.Date,value:"",isMulti:!1,options:[],ColSize:24}]},{Cols:[{name:"location",label:"Enter Location",type:S.Location,value:"",isMulti:!1,options:[],ColSize:24}]},{Cols:[{name:"password",label:"Enter password",type:"password",value:"",options:[],ColSize:24}]}],_=Mn(),$=_.getUserRequestPayload,Y=_.updateUserRequestPayloadV2,H=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n,a,c){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e,o){var l=a.email,s=a.phone,r=a.beamIds,d=a.dob,u=a.gender,v=a.location,b=a.firstName,j=a.lastName,p=[];c&&p.push({op:"add",path:"/persistent/static/".concat(n,"/extendedBio"),value:Object(C.a)(c)}),l&&(p.push({op:"add",path:"/persistent/static/live/alternativeIds/email",value:l}),p.push({op:"add",path:"/persistent/static/metadata/notificationChannels/emails",value:[l]})),s&&(p.push({updatedUserData:"add",path:"/persistent/static/live/alternativeIds/phone",value:s}),p.push({op:"add",path:"/persistent/static/metadata/notificationChannels/phones",value:[s]})),null!==D&&void 0!==D&&D.roleId&&p.push({op:"add",path:"/persistent/static/admin",value:{profile:{roleId:null===D||void 0===D?void 0:D.roleId}}}),r&&p.push({op:"add",path:"/persistent/static/live/beamIds",value:[r]}),b&&p.push({op:"add",path:"/persistent/static/live/profile/firstName",value:b}),j&&p.push({op:"add",path:"/persistent/static/live/profile/lastName",value:j}),d&&p.push({op:"add",path:"/persistent/static/live/profile/dob",value:d}),u&&p.push({op:"add",path:"/persistent/static/live/profile/gender",value:u}),v&&p.push({op:"add",path:"/persistent/static/live/profile/location",value:v}),i.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,Y(t,p),x.UpdateUserBio,n),i.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(t){console.log("update user response",t),e(t)})}))},e)}));return function(t,n,a,i){return e.apply(this,arguments)}}(),W=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a,i,c,l,s,r;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(n=[],a={},M.current.extendedBio.map(function(e){e.Cols.map(function(e){"payment"===e.type||"calendar"===e.type?n.push(Object(d.a)(Object(d.a)({},e),{},{value:Object(d.a)(Object(d.a)({},e),{},{value:""})})):n.push(e)})}),M.current.basicBio.map(function(e){e.Cols.map(function(e){a[null===e||void 0===e?void 0:e.name]=null===e||void 0===e?void 0:e.value})}),i=a.email,a.customId,c=a.phone,a.beamIds,l=a.password,a.roleId,s=a.firstName,r=a.lastName,console.log("test",n,a),null===D||void 0===D||!D.userId){e.n=2;break}return E(!0),e.n=1,H(null===D||void 0===D?void 0:D.userId,D.cudbServiceId,{},n);case 1:Lt("User updated successfully","success","TOP_CENTER",3e3),E(!1),e.n=7;break;case 2:if(i&&""!==i||c&&""!==c){e.n=3;break}return b("Please enter email or phone to complete registeration"),e.a(2);case 3:if(s&&""!==s){e.n=4;break}return b("Please enter first name to complete registeration"),e.a(2);case 4:if(r&&""!==r){e.n=5;break}return b("Please enter last name to complete registeration"),e.a(2);case 5:if(l&&""!==l){e.n=6;break}return b("Please enter security pin to complete registeration"),e.a(2);case 6:E(!0),b(void 0),j(rt({request:{email:i,phoneNumber:c},callback:function(e){if(console.log("verify response",e),e.status){var t=[];i&&t.push({email:i}),c&&t.push({phone:c});var s={name:"registerUserByAdmin",changes:[],timeout:1e4,request:{data:{cudbServiceId:D.cudbServiceId,userIds:t,deviceIds:[{udid:Object(B.uuid)()}],authTypeParams:[{typeId:2,force1FR:!1,forceDeviceIndependent:!1,param:{password:l,useMultiOtp:!0,verificationChannels:t}}]}}};r=s,d=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var i,c,l,s,r,d,u,v;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(console.log("create user response",t),console.log("userId",null===t||void 0===t||null===(i=t.data)||void 0===i||null===(c=i[0])||void 0===c?void 0:c.userId),null===t||void 0===t||null===(l=t.data)||void 0===l||null===(s=l[0])||void 0===s||!s.userId){e.n=3;break}return e.n=1,H(null===t||void 0===t||null===(r=t.data)||void 0===r||null===(d=r[0])||void 0===d?void 0:d.userId,D.cudbServiceId,a,n);case 1:return e.n=2,H(null===t||void 0===t||null===(u=t.data)||void 0===u||null===(v=u[0])||void 0===v?void 0:v.userId,"cudb-live",a,n);case 2:E(!1),Lt("User registered successfully. Redirecting..","success","TOP_CENTER",2e3),localStorage.removeItem("form"),j({type:De,payload:!1}),o.resetFields(),setTimeout(function(){window.location.href="https://live.staging.beam.live/auth/login?verify=true&selectedOrg=".concat(D.cudbServiceId)},2e3),e.n=4;break;case 3:E(!1),Lt("Something went wrong","error","TOP_CENTER",3e3);case 4:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),j(st({request:r,callback:function(e){d&&d(e)}}))}else E(!1),Lt("User with credentials already exists","error","TOP_CENTER",3e3);var r,d}}));case 7:b(void 0);case 8:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)(function(){if(Object.keys(O).length&&f.length&&null!==D&&void 0!==D&&D.userId){var e,t,n,a,i,c,l,s;console.log("bio here",O),q(Object(C.a)(f));var r,u,v=[],j=Object(d.a)(Object(d.a)({email:null===O||void 0===O?void 0:O.live.alternativeIds.email,phone:null===O||void 0===O?void 0:O.live.alternativeIds.phone,customId:null===O||void 0===O?void 0:O.live.alternativeIds.customId,roleId:null===O||void 0===O||null===(e=O.admin)||void 0===e||null===(t=e.profile)||void 0===t?void 0:t.roleId,beamIds:Array.isArray(null===O||void 0===O||null===(n=O.live)||void 0===n?void 0:n.beamIds[0])?null===O||void 0===O||null===(a=O.live)||void 0===a?void 0:a.beamIds[0]:null===O||void 0===O||null===(i=O.live)||void 0===i?void 0:i.beamIds},null===O||void 0===O?void 0:O.live.profile),{},{gender:{option:null===O||void 0===O||null===(c=O.live)||void 0===c||null===(l=c.profile)||void 0===l?void 0:l.gender}}),m={};if(Array.isArray(null===(s=O[D.cudbServiceId])||void 0===s?void 0:s.extendedBio))null===(r=O[D.cudbServiceId])||void 0===r||null===(u=r.extendedBio)||void 0===u||u.map(function(e){m[null===e||void 0===e?void 0:e.name]=e});var p=f.find(function(e){return(null===e||void 0===e?void 0:e._id)===(null===j||void 0===j?void 0:j.roleId)});o.setFieldsValue({undefined:Object(d.a)(Object(d.a)({},j),m)}),p&&(v=p.extendedBio.map(function(e){return{Cols:[m[e.name]?Object(d.a)({},m[e.name]):Object(d.a)(Object(d.a)({},e),{},{ColSize:24,value:e.value})]}})),M.current={basicBio:[],extendedBio:Object(C.a)(v)}}else if((null===f||void 0===f?void 0:f.length)>0&&(null===D||void 0===D||!D.userId)){var h=[],g=f.find(function(e){return(null===e||void 0===e?void 0:e._id)===(null===D||void 0===D?void 0:D.roleId)});g&&(h=g.extendedBio.map(function(e){return{Cols:[Object(d.a)(Object(d.a)({},e),{},{ColSize:24,value:void 0})]}}));var x=F.map(function(e){return{Cols:e.Cols.map(function(e){return Object(d.a)(Object(d.a)({},e),{},{value:void 0,options:"roleId"===e.name?f.map(function(e){return{_id:e._id,name:e.name}}):e.options})})}});M.current={basicBio:Object(C.a)(x),extendedBio:Object(C.a)(h)},b(void 0)}},[f,O,D,N]),Object(a.useEffect)(function(){var e=Mt("token");j(at({payload:e}))},[]),Object(a.useEffect)(function(){var e;null!==(e=Object.keys(g))&&void 0!==e&&e.length&&A(g)},[g]),Object(a.useEffect)(function(){var e;i.client&&null!==(e=Object.keys(D))&&void 0!==e&&e.length&&((null===D||void 0===D?void 0:D.type)===I.Vehicle?(i.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,$(D.adminId,"$","$..admin.vehicleSettings.extendedBio"),x.GetVehicleBio,D.cudbServiceId),i.subscribeToSurvey(m.SurveyTopics,x.GetVehicleBio,function(){})):(i.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,$(D.adminId,"$","$..admin.role"),h.GetRoleList,D.cudbServiceId),i.subscribeToSurvey(m.SurveyTopics,h.GetRoleList)),D.userId&&(i.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,$(D.userId,"$","$..persistent.static"),h.GetBio,D.cudbServiceId),i.subscribeToSurvey(m.SurveyTopics,h.GetBio)))},[i.client,D]),Object(oa.jsx)("div",{className:"main-column ride-dispatch-panel mobile-responsive mr-4",children:Object(oa.jsx)("div",{className:"main-content",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:o,onFinish:W,requiredMark:!1,onValuesChange:function(e,t){},children:[Object(oa.jsx)("div",{className:"main-cards",children:Object(oa.jsxs)(Za.a,{bordered:!1,activeKey:["basicBio","extendedBio"],className:"simple-collapse",onChange:function(e){localStorage.setItem("active",JSON.stringify(e))},children:[(null===(t=M.current.basicBio)||void 0===t?void 0:t.length)>0&&(null===D||void 0===D?void 0:D.type)!==I.Vehicle&&Object(oa.jsx)(ob,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/account-icon.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"Basic Bio"})]}),children:Object(oa.jsx)("div",{className:"sub-cards-2",children:M.current.basicBio.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3 mobile-row",children:e.Cols.map(function(e,n){return Object(oa.jsxs)(Hn.a,{className:"pl-2",span:e.ColSize,xs:24,sm:e.ColSize,children:[Object(oa.jsx)(cb,{data:e,onChange:function(e){!function(e,t,n){var a=Object(C.a)(M.current.basicBio);a[e].Cols[t].value=n,M.current={basicBio:a,extendedBio:M.current.extendedBio}}(t,n,e)}})," "]},"".concat(n,"-cols"))})},t)})})},"basicBio"),(null===(n=M.current.extendedBio)||void 0===n?void 0:n.length)&&Object(oa.jsx)(ob,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/account-icon.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"Extended Bio"})]}),children:Object(oa.jsx)("div",{className:"sub-cards-2",children:M.current.extendedBio.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3 mobile-row",children:e.Cols.map(function(e,n){return Object(oa.jsxs)(Hn.a,{className:"pl-2",span:e.ColSize,xs:24,sm:e.ColSize,children:[Object(oa.jsx)(cb,{data:e,onChange:function(e){!function(e,t,n){var a=Object(C.a)(M.current.extendedBio);null!==n&&void 0!==n&&n._id?a[e].Cols[t]=n:a[e].Cols[t].value=n,M.current={basicBio:M.current.basicBio,extendedBio:a}}(t,n,e)}})," "]},"".concat(n,"-cols"))})},t)})})},"extendedBio")]})}),v&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:v})}),Object(oa.jsx)(Yn.a,{className:"action-grp mt-3 justify-content-end",children:Object(oa.jsx)(Hn.a,{span:4,className:"pr-2",xs:24,sm:4,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:w,onClick:W,children:"Submit"})})})})]})})})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var sb=function(e){var t=e.socket,n=(Object(l.f)(),Object(s.b)(),Object(a.useState)(void 0)),i=Object(u.a)(n,2),c=(i[0],i[1],Object(a.useState)(!1)),o=Object(u.a)(c,2),r=(o[0],o[1],Object(a.useState)(!1)),d=Object(u.a)(r,2),v=(d[0],d[1],Object(a.useState)({form:!0,map:!1})),b=Object(u.a)(v,2),j=b[0],m={screens:j,setScreens:b[1]};return Object(oa.jsxs)(Yn.a,{className:"main-layout",children:[j.form&&Object(oa.jsx)(Hn.a,{md:j.map?12:24,xs:24,className:"form"===j.active?"active-screen":"",children:j.form&&Object(oa.jsx)(lb,{socket:t,params:m})}),j.map&&Object(oa.jsx)(Hn.a,{md:12,xs:24,className:"map"===j.active?"active-screen":"",children:Object(oa.jsx)(Nc,{socket:t,params:m})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})},rb=function(e){var t,n=e.value,i=void 0===n?null:n,c=(e.size,e.placeholder),o=e.onChange,l=Object(a.useState)((null===i||void 0===i||null===(t=i.attributes)||void 0===t?void 0:t.address)||null),s=Object(u.a)(l,2),r=s[0],v=s[1];Object(a.useEffect)(function(){},[r]);var b=Object(a.useState)(i||{coordinates:{lat:0,long:0},attributes:{address:"",zip:"",stAddressOne:"",stAddressTwo:"",city:"",state:"",country:""}}),j=Object(u.a)(b,2),m=j[0],p=j[1];return Object(oa.jsxs)("div",{children:[Object(oa.jsx)(Yn.a,{className:"datetime-item",children:Object(oa.jsx)(Ii.a,{selectProps:{value:r,onChange:function(e){null!==e&&void 0!==e&&e.value&&(v(e),Object(Ii.b)(e.value.place_id).then(function(e){var t;null!==(t=e[0])&&void 0!==t&&t.address_components&&function(e){var t,n={coordinates:{lat:0,long:0},attributes:{address:"",zip:"",stAddressOne:"",stAddressTwo:"",city:"",state:"",country:""}},a=Object(k.a)(e[0].address_components);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.types.includes("postal_code")?n.attributes.zip=i.short_name||"":i.types.includes("locality")||i.types.includes("sublocality_level_1")?n.attributes.city=i.short_name:i.types.includes("administrative_area_level_1")?n.attributes.state=i.short_name:i.types.includes("country")&&(n.attributes.country=i.long_name)}}catch(c){a.e(c)}finally{a.f()}n.attributes.address=e[0].formatted_address,n.coordinates={lat:e[0].geometry.location.lat(),long:e[0].geometry.location.lng()},o(n),p(n)}(e)}).catch(function(e){return console.error(e)}))},isClearable:!1,placeholder:c,styles:{input:function(e){return Object(d.a)(Object(d.a)({},e),{},{fontFamily:"Nunito-Regular"})},control:function(){return{backgroundColor:"transparent",display:"flex"}},container:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{width:"100%",background:"transparent"})},placeholder:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{color:"#000",fontSize:16,padding:8})},singleValue:function(e,t){return Object(d.a)(Object(d.a)({},e),{},{color:"#000",fontSize:16,padding:8})}}},apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"})}),Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:8,className:"location-item pr-2 mt-2",xs:24,sm:8,children:Object(oa.jsx)(Wn.a,{value:m.attributes.stAddressOne,placeholder:"Street Address One",onChange:function(e){p({coordinates:Object(d.a)({},m.coordinates),attributes:Object(d.a)(Object(d.a)({},m.attributes),{},{stAddressOne:e.target.value})}),o(m)}})}),Object(oa.jsx)(Hn.a,{span:8,className:"location-item pr-2 mt-2",xs:24,sm:8,children:Object(oa.jsx)(Wn.a,{value:m.attributes.stAddressTwo,placeholder:"Street Address Two",onChange:function(e){p({coordinates:Object(d.a)({},m.coordinates),attributes:Object(d.a)(Object(d.a)({},m.attributes),{},{stAddressTwo:e.target.value})}),o(m)}})}),Object(oa.jsx)(Hn.a,{span:8,className:"location-item mt-2",xs:24,sm:8,children:Object(oa.jsx)(Wn.a,{value:m.attributes.zip,placeholder:"Enter Zip Code",onChange:function(e){p({coordinates:Object(d.a)({},m.coordinates),attributes:Object(d.a)(Object(d.a)({},m.attributes),{},{zip:e.target.value})}),o(m)}})})]}),Object(oa.jsxs)(Yn.a,{children:[Object(oa.jsx)(Hn.a,{span:8,className:"location-item pr-2 mt-2",xs:24,sm:8,children:Object(oa.jsx)(Wn.a,{value:m.attributes.city,placeholder:"City",onChange:function(e){p({coordinates:Object(d.a)({},m.coordinates),attributes:Object(d.a)(Object(d.a)({},m.attributes),{},{city:e.target.value})}),o(m)}})}),Object(oa.jsx)(Hn.a,{span:8,className:"location-item pr-2 mt-2",xs:24,sm:8,children:Object(oa.jsx)(Wn.a,{value:m.attributes.state,placeholder:"State",onChange:function(e){p({coordinates:Object(d.a)({},m.coordinates),attributes:Object(d.a)(Object(d.a)({},m.attributes),{},{state:e.target.value})}),o(m)}})}),Object(oa.jsx)(Hn.a,{span:8,className:"location-item mt-2",xs:24,sm:8,children:Object(oa.jsx)(Wn.a,{value:m.attributes.country,placeholder:"Country",onChange:function(e){p({coordinates:Object(d.a)({},m.coordinates),attributes:Object(d.a)(Object(d.a)({},m.attributes),{},{country:e.target.value})}),o(m)}})})]})]})},db=["email","customId","phone","beamIds","roleId"],ub=["email","phone","customId","roleId","beamIds","gender","firstName","middleName","lastName","location"],vb=Gn.a.Option,bb=Za.a.Panel,jb=function(e){var t,n,i=e.socket,c=e.params,o=ei.a.useForm(),r=Object(u.a)(o,1)[0],v=Object(a.useState)(""),b=Object(u.a)(v,2),j=b[0],p=b[1],O=c.screens,f=c.setScreens,g=Object(l.g)().search,N=Object(l.f)(),k=Object(s.b)(),w=Object(s.c)(function(e){return e.auth}),E=w.projects,R=w.bio,P=w.rolesList,D=w.urlParams,A=w.survey,M=Object(a.useState)(!1),L=Object(u.a)(M,2),U=L[0],q=L[1],F=Object(a.useState)({}),B=Object(u.a)(F,2),_=B[0],$=B[1],Y=Object(a.useRef)({basicBio:[],extendedBio:[]}),W=Object(a.useState)([]),V=Object(u.a)(W,2),z=(V[0],V[1]),Q=Ha(),G=Q.getLocalStorageItem,J=(Q.setLocalStorageItem,[{Cols:[{name:"email",label:"Enter Email",type:S.Email,value:"",isMulti:!1,options:[],ColSize:8},{name:"phone",label:"Enter Phone Number",type:S.Phone,value:"",isMulti:!1,options:[],ColSize:8},{name:"customId",label:"Enter Custom ID",type:S.Text,value:"",isMulti:!1,options:[],ColSize:8}]},{Cols:[{name:"beamIds",label:"Enter Beam ID",type:S.Text,value:"",isMulti:!1,options:[],ColSize:8},{name:"roleId",label:"Select Role",type:S.Search,value:"",isMulti:!1,options:[],ColSize:8,onChange:function(e){var t;((null===(t=P.find(function(t){return t._id===e}))||void 0===t?void 0:t.extendedBio)||[]).map(function(e){return{Cols:[{name:e.name,label:null===e||void 0===e?void 0:e.label,type:e.type,value:"",isMulti:e.isMulti,options:e.isMulti,ColSize:24}]}});Y.current={basicBio:Y.current.basicBio,extendedBio:[]}}},{name:"doB",label:"Date of Birth",type:S.Date,value:"",isMulti:!1,options:[],ColSize:8}]},{Cols:[{name:"firstName",label:"Enter First Name",type:S.Text,value:"",isMulti:!1,options:[],ColSize:8},{name:"middleName",label:"Enter Middle Name",type:S.Text,value:"",isMulti:!1,options:[],ColSize:8},{name:"lastName",label:"Enter last Name",type:S.Text,value:"",isMulti:!1,options:[],ColSize:8}]},{Cols:[{name:"gender",label:"Select Gender",type:S.MultipleChoice,value:"",isMulti:!1,options:["male","female"],ColSize:4},{name:"location",label:"Enter Location",type:S.Location,value:"",isMulti:!1,options:[],ColSize:20}]}]),K=Mn(),Z=K.getUserRequestPayload,X=K.updateUserRequestPayloadV2,ee=function(e){var t,n,i,c=e.data,o=e.name,l=e.restFields,s=e.onChange,r=Object(a.useState)(""),v=Object(u.a)(r,2),b=(v[0],v[1],Object(a.useState)((null===c||void 0===c?void 0:c.value)||"")),j=Object(u.a)(b,2),m=j[0],p=(j[1],Object(a.useState)("")),O=Object(u.a)(p,2),f=O[0],h=O[1],g=Object(a.useState)(""),x=Object(u.a)(g,2),y=x[0],I=x[1];Object(a.useEffect)(function(){(null===c||void 0===c?void 0:c.type)===S.DateTime?h(H()(null===c||void 0===c?void 0:c.value)):(null===c||void 0===c?void 0:c.type)===S.Time&&I(H()(null===c||void 0===c?void 0:c.value).format("hh:mm a"))},[]);var N=[o,null===c||void 0===c?void 0:c.name],k=Object(a.useState)((null===c||void 0===c?void 0:c.value)||""),T=Object(u.a)(k,2),C=T[0],w=T[1],R="";switch(c.type){case S.DropDown:break;case S.Text:R=Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(Wn.a,{defaultValue:C,value:C,placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){w(e.target.value),s(e.target.value)}})});break;case S.YesNo:R=Object(oa.jsx)(ei.a.Item,Object(d.a)(Object(d.a)({},l),{},{name:N,children:Object(oa.jsx)(ii,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){s(e)}})}));break;case S.ThreeButton:R=Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(ci,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){s(e)}})});break;case S.Number:R=Object(oa.jsxs)("div",{className:"tiles padding-12",children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(Yn.a,{className:"w-100 mt-2",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(la,{value:c.value,onChange:function(e){s(e),c.value=e}})})})})]});break;case S.MultipleChoice:R=Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(li,{value:null===c||void 0===c?void 0:c.value,options:null===c||void 0===c?void 0:c.options,isMulti:c.isMulti,placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){s(e)}})});break;case S.Bar:R=Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(ri,{value:null===c||void 0===c?void 0:c.value,options:null===c||void 0===c?void 0:c.options,placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){s(e)}})});break;case S.Date:R=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png",alt:""}),Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(di,{placeholder:null===c||void 0===c?void 0:c.label,value:null===c||void 0===c?void 0:c.value,onChange:function(e){h(e),s(e)}})})]})})});break;case S.DateTime:R=Object(oa.jsx)(Yn.a,{className:" w-full mt-2",children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/date.png",alt:""}),Object(oa.jsx)(Jn.a,{showTime:!0,placeholder:null===c||void 0===c?void 0:c.label,suffixIcon:Object(oa.jsx)(aa.a,{}),value:f,onChange:function(e){s(e)}})]})});break;case S.Currency:R=Object(oa.jsxs)("div",{className:"tiles padding-12 mt-4",children:[Object(oa.jsx)("span",{className:"col-label",children:null===c||void 0===c?void 0:c.label}),Object(oa.jsx)(Yn.a,{className:"w-100 mt-2",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(sa,{suffix:c.options[0],onChange:function(e){s(e)}})})})})]});break;case S.Location:R=Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(rb,{placeholder:null===c||void 0===c?void 0:c.label,value:(null===c||void 0===c?void 0:c.value)||null,onChange:function(e){s(e)}})});break;case S.GPS:R=Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(rb,{placeholder:null===c||void 0===c?void 0:c.label,value:(null===c||void 0===c?void 0:c.value)||null,onChange:function(e){s(m)}})});break;case S.File:case S.Signature:case S.Media:case S.Capture:R=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(Oa,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){}})})})});break;case S.Email:R=Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:N,rules:[{required:!0,message:"Email is required"},{pattern:/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,message:"This field must be a valid email. Example: xyz@beam.live"}],children:Object(oa.jsx)(Wn.a,{defaultValue:null===c||void 0===c?void 0:c.value,value:null===c||void 0===c?void 0:c.value,placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){c.value=e.target.value}})})});break;case S.Tag:case S.TagNot:R=Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(ra,{placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){s(e)}})});break;case S.Phone:R=Object(oa.jsx)(Yn.a,{className:"d-flex",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:N,rules:[{required:!0,message:"Phone is required"},{pattern:/^[+][(]?[0-9]{3}[)]?[-\s.]?[0-9]{3}[-\s.]?[0-9]{2,10}$/im,message:"This field must be a valid phone number. Example: +3163633634"}],children:Object(oa.jsx)(Wn.a,{defaultValue:null===c||void 0===c?void 0:c.value,value:null===c||void 0===c?void 0:c.value,placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){c.value=e.target.value}})})})});break;case S.Name:R=Object(oa.jsx)(Yn.a,{className:"d-flex",children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(Wn.a,{className:"w-full",placeholder:null===c||void 0===c?void 0:c.label})})})});break;case S.Time:R=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsxs)("div",{className:"datetime-item",children:[Object(oa.jsx)("img",{src:"/images/time.png",alt:""}),Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(gi,{name:null===c||void 0===c?void 0:c.label,value:y,onChange:function(e){s(e)}})})]})})});break;case S.Project:R=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:N,children:Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){ne(e)},filterOption:function(e,t){return t.children.toLowerCase().includes(e.toLowerCase())},children:null===E||void 0===E||null===(t=E.projects)||void 0===t?void 0:t.map(function(e,t){return Object(oa.jsx)(vb,{value:e.id,children:e.name},t)})})})})});break;case S.Search:R=Object(oa.jsx)(Yn.a,{children:Object(oa.jsx)(Hn.a,{span:24,children:Object(oa.jsx)(ei.a.Item,{name:N,children:null!==c&&void 0!==c&&c.isMulti?Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",placeholder:null===c||void 0===c?void 0:c.label,mode:"multiple",value:null===c||void 0===c?void 0:c.value,defaultValue:null===c||void 0===c?void 0:c.value,onChange:function(e){ne(e)},children:null===c||void 0===c||null===(n=c.options)||void 0===n?void 0:n.map(function(e,t){return Object(oa.jsx)(vb,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},t)})}):Object(oa.jsx)(Gn.a,{showSearch:!0,className:"w-full",value:null===c||void 0===c?void 0:c.value,defaultValue:null===c||void 0===c?void 0:c.value,placeholder:null===c||void 0===c?void 0:c.label,onChange:function(e){s(e)},children:null===c||void 0===c||null===(i=c.options)||void 0===i?void 0:i.map(function(e,t){return Object(oa.jsx)(vb,{value:null===e||void 0===e?void 0:e._id,children:null===e||void 0===e?void 0:e.name},t)})})})})});break;default:R=""}return R},te=function(e){var t=[];if((null===_||void 0===_?void 0:_.type)!==I.Vehicle){var n,a,c={},o={};Y.current.extendedBio.map(function(e){e.Cols.map(function(e){c[null===e||void 0===e?void 0:e.name]=null===e||void 0===e?void 0:e.value})}),Y.current.basicBio.map(function(e){e.Cols.map(function(e){o[null===e||void 0===e?void 0:e.name]=null===e||void 0===e?void 0:e.value})});var l=o.email,s=o.customId,r=o.phone,u=o.beamIds,v=o.roleId,b=Object(Ka.a)(o,db),j="admin"===(null===_||void 0===_?void 0:_.role)?"adminEdited":"userEdited",O={},f={},h={},g={email:l,customId:s,phone:r},S=Object.values(null===R||void 0===R||null===(n=R.metadata)||void 0===n?void 0:n.bulk)[0].fields;Object.keys(b).map(function(e){var t,n,a,i,c;"location"===e?null!==b&&void 0!==b&&b.location&&(f=Object(d.a)(Object(d.a)({},f),{},Object(T.a)(Object(T.a)(Object(T.a)({},"".concat(e,"-lat"),Object(d.a)(Object(d.a)({},S["".concat(e,"-lat")]),{},{value:null!==b&&void 0!==b&&b.location?null===b||void 0===b||null===(t=b.location)||void 0===t?void 0:t.coordinates.lat:null===(n=S["".concat(e,"-lat")])||void 0===n?void 0:n.value})),"".concat(e,"-long"),Object(d.a)(Object(d.a)({},S["".concat(e,"-long")]),{},{value:null!==b&&void 0!==b&&b.location?null===b||void 0===b||null===(a=b.location)||void 0===a?void 0:a.coordinates.long:null===(i=S["".concat(e,"-long")])||void 0===i?void 0:i.value})),"attributes",{value:null===b||void 0===b||null===(c=b.location)||void 0===c?void 0:c.attributes,identifier:null,status:"ok",reason:"",ref:"/persistent/static/live/profile/location/attributes",approved:!1}))):f=Object(d.a)(Object(d.a)({},f),{},Object(T.a)({},e,Object(d.a)(Object(d.a)({},S[e]),{},{value:b[e]})))}),f=Object(d.a)(Object(d.a)({},f),{},{roleId:Object(d.a)(Object(d.a)({},S.roleId),{},{value:v})}),f=Object(d.a)(Object(d.a)({},f),{},{beamIds:Object(d.a)(Object(d.a)({},S.beamIds),{},{value:u})}),Object.keys(c).map(function(e){h=Object(d.a)(Object(d.a)({},h),{},Object(T.a)({},e,Object(d.a)(Object(d.a)({},S[e]),{},{value:c[e]})))}),Object.keys(g).forEach(function(e){O=Object(d.a)(Object(d.a)({},O),{},Object(T.a)({},e,Object(d.a)(Object(d.a)({},S[e]),{},{value:g[e]})))});var N=Object.keys(null===R||void 0===R||null===(a=R.metadata)||void 0===a?void 0:a.bulk)[0]||Math.floor(1e3+9e3*Math.random());t=[{op:"add",path:"/persistent/static/metadata/bulk/".concat(N,"/fields"),value:Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},S),O),f),h)},{op:"add",path:"/persistent/static/metadata/bulk/".concat(N,"/header/editingStatus"),value:j}]}else{var k={};Y.current.extendedBio.map(function(e){e.Cols.map(function(e){k[null===e||void 0===e?void 0:e.name]=null===e||void 0===e?void 0:e.value})}),t=[{op:"add",path:"/persistent/static/".concat(_.cudbServiceId,"/extendedBio"),value:Object(d.a)({},k)}]}i.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,X(_.userId,t),x.UpdateUserBio,_.cudbServiceId),i.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(e){q(!1),Lt("Bio Updated.","successs","TOP_CENTER",1e3)}),p(void 0)};Object(a.useEffect)(function(){if((null===_||void 0===_?void 0:_.type)!==I.Vehicle){if(Object.keys(R).length&&P.length){var e;z(Object(C.a)(P));var t=Object.values(null===R||void 0===R||null===(e=R.metadata)||void 0===e?void 0:e.bulk),n=P.find(function(e){var n,a,i;return(null===e||void 0===e?void 0:e._id)===(null===(n=t[0])||void 0===n||null===(a=n.fields)||void 0===a||null===(i=a.roleId)||void 0===i?void 0:i.value)}),a={},i=[],c={};if(null!==t&&void 0!==t&&t.length){var o,l=null===(o=t[0])||void 0===o?void 0:o.fields,s={};Object.keys(l).map(function(e){var t;s=Object(d.a)(Object(d.a)({},s),{},Object(T.a)({},e,null===(t=l[e])||void 0===t?void 0:t.value))});var u=s,v=u.email,b=u.phone,j=u.customId,m=u.roleId,p=u.beamIds,O=u.gender,f=u.firstName,h=u.middleName,g=u.lastName,x=(u.location,Object(Ka.a)(u,ub)),y=Array.isArray(p)?p[0]:p,S={coordinates:{lat:x["loaction-lat"]||0,long:x["loaction-long"]||0},attributes:(null===x||void 0===x?void 0:x.attributes)||{address:"",zip:"",stAddressOne:"",stAddressTwo:"",city:"",state:"",country:""}};a={email:v,phone:b,customId:j,roleId:m,beamIds:y,gender:O,firstName:f,middleName:h,lastName:g,location:S},c=Object(d.a)({},x)}else{var N,k,w,E,D,M;a=Object(d.a)({email:null===R||void 0===R?void 0:R.live.alternativeIds.email,phone:null===R||void 0===R?void 0:R.live.alternativeIds.phone,customId:null===R||void 0===R?void 0:R.live.alternativeIds.customId,roleId:null===R||void 0===R||null===(N=R.admin)||void 0===N||null===(k=N.profile)||void 0===k?void 0:k.roleId,beamIds:Array.isArray(null===R||void 0===R||null===(w=R.live)||void 0===w?void 0:w.beamIds[0])?null===R||void 0===R||null===(E=R.live)||void 0===E?void 0:E.beamIds[0]:null===R||void 0===R||null===(D=R.live)||void 0===D?void 0:D.beamIds},null===R||void 0===R?void 0:R.live.profile),c=Object(d.a)({},null===(M=R[_.cudbServiceId])||void 0===M?void 0:M.extendedBio)}r.setFieldsValue({undefined:Object(d.a)(Object(d.a)({},a),c)}),n&&(i=n.extendedBio.map(function(e){return{Cols:[Object(d.a)(Object(d.a)({},e),{},{ColSize:24,value:c[e.name]||e.value})]}}));var L=J.map(function(e){return{Cols:e.Cols.map(function(e){return Object(d.a)(Object(d.a)({},e),{},{value:a[e.name]||e.value,options:"roleId"===e.name?P.map(function(e){return{_id:e._id,name:e.name}}):e.options})})}});Y.current={basicBio:Object(C.a)(L),extendedBio:Object(C.a)(i)}}}else if((null===_||void 0===_?void 0:_.type)===I.Vehicle){var U,q=Object(d.a)({},null===(U=R[_.cudbServiceId])||void 0===U?void 0:U.extendedBio);r.setFieldsValue({undefined:Object(d.a)({},q)});var F=A.questions.map(function(e){return{Cols:[Object(d.a)(Object(d.a)({},e),{},{ColSize:24,value:q[e.name]||e.value})]}});Y.current={basicBio:[],extendedBio:Object(C.a)(F)}}},[P,R,_,A]),Object(a.useEffect)(function(){var e=Mt("token");k(at({payload:e}))},[]),Object(a.useEffect)(function(){var e;null!==(e=Object.keys(D))&&void 0!==e&&e.length&&$(D)},[D]),Object(a.useEffect)(function(){var e;i.client&&null!==(e=Object.keys(_))&&void 0!==e&&e.length&&((null===_||void 0===_?void 0:_.type)===I.Vehicle?(i.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Z(G("userId"),"$","$..admin.vehicleSettings.extendedBio"),x.GetVehicleBio,_.cudbServiceId),i.subscribeToSurvey(m.SurveyTopics,x.GetVehicleBio,function(){})):(i.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Z(_.adminId,"$","$..admin.role"),h.GetRoleList,_.cudbServiceId),i.subscribeToSurvey(m.SurveyTopics,h.GetRoleList)),i.publishToServiceIdSurvey(m.SurveyTopics,y.SearchInUser,Z(_.userId,"$","$..persistent.static"),h.GetBio,_.cudbServiceId),i.subscribeToSurvey(m.SurveyTopics,h.GetBio))},[i.client,_]);var ne=function(e){k({type:Pe,payload:e})};return Object(oa.jsx)("div",{className:"main-column ride-dispatch-panel mobile-responsive mr-4",children:Object(oa.jsx)("div",{className:"main-content",children:Object(oa.jsxs)(ei.a,{className:"auth-form",name:"register-form",id:"register-form",layout:"vertical",form:r,onFinish:te,requiredMark:!1,onValuesChange:function(e,t){},children:[(null===_||void 0===_?void 0:_.type)&&Object(oa.jsxs)("div",{className:"main-header",children:[Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)("h3",{className:"ml-3",children:_.type===I.Vehicle?"Vehicle Bio":"User Bio"})}),Object(oa.jsx)("div",{className:"d-flex",children:Object(oa.jsx)(fa.a,{src:"/images/close-icon.svg",className:"close-icon",onClick:function(){setTimeout(function(){localStorage.removeItem("form"),localStorage.removeItem("form"),k({type:De,payload:!1}),r.resetFields(),f(Object(d.a)(Object(d.a)({},O),{},{map:!1}));var e=new URLSearchParams(g);e.delete("pageId"),N.replace({search:e.toString()})})}})})]}),Object(oa.jsx)("div",{className:"main-cards",children:Object(oa.jsxs)(Za.a,{defaultActiveKey:JSON.parse(localStorage.getItem("active")),bordered:!1,className:"simple-collapse",onChange:function(e){localStorage.setItem("active",JSON.stringify(e))},children:[(null===(t=Y.current.basicBio)||void 0===t?void 0:t.length)&&(null===_||void 0===_?void 0:_.type)!==I.Vehicle&&Object(oa.jsx)(bb,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/account-icon.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"Basic Bio"})]}),children:Object(oa.jsx)("div",{className:"sub-cards-2",children:Y.current.basicBio.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3 mobile-row",children:e.Cols.map(function(e,n){return Object(oa.jsxs)(Hn.a,{className:"pl-2",span:e.ColSize,xs:24,sm:e.ColSize,children:[Object(oa.jsx)(ee,{data:e,onChange:function(e){!function(e,t,n){var a=Object(C.a)(Y.current.basicBio);a[e].Cols[t].value=n,Y.current={basicBio:a,extendedBio:Y.current.extendedBio}}(t,n,e)}})," "]},"".concat(n,"-cols"))})},t)})})},"basicBio"),(null===(n=Y.current.extendedBio)||void 0===n?void 0:n.length)&&Object(oa.jsx)(bb,{header:Object(oa.jsxs)("div",{className:"d-flex",children:[Object(oa.jsx)(fa.a,{src:"/images/account-icon.svg"}),Object(oa.jsx)("h5",{className:"ml-3",children:"Extended Bio"})]}),children:Object(oa.jsx)("div",{className:"sub-cards-2",children:Y.current.extendedBio.map(function(e,t){return Object(oa.jsx)(Yn.a,{className:"mt-3 mobile-row",children:e.Cols.map(function(e,n){return Object(oa.jsxs)(Hn.a,{className:"pl-2",span:e.ColSize,xs:24,sm:e.ColSize,children:[Object(oa.jsx)(ee,{data:e,onChange:function(e){!function(e,t,n){var a=Object(C.a)(Y.current.extendedBio);a[e].Cols[t].value=n,Y.current={basicBio:Y.current.basicBio,extendedBio:a}}(t,n,e)}})," "]},"".concat(n,"-cols"))})},t)})})},"extendedBio")]})}),j&&Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)("p",{className:"error",children:j})}),"admin"===(null===_||void 0===_?void 0:_.role)&&Object(oa.jsxs)(Yn.a,{className:"action-grp mt-4",children:[Object(oa.jsx)(Hn.a,{span:8,className:"pr-2",xs:24,sm:8,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn cover w-full",loading:U,onClick:te,children:"Submit"})})}),_.type!==I.Vehicle&&Object(oa.jsx)(Hn.a,{span:8,className:"pr-2",xs:24,sm:8,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn green-btn cover w-full",loading:U,onClick:function(){var e,t=Object.keys(null===R||void 0===R||null===(e=R.metadata)||void 0===e?void 0:e.bulk)[0],n={};Y.current.basicBio.map(function(e){e.Cols.map(function(e){n[null===e||void 0===e?void 0:e.name]=null===e||void 0===e?void 0:e.value})});var a=n.email,c=n.phone,o=[];a&&o.push({email:a}),c&&o.push({phone:c});var l=[{op:"add",path:"/persistent/static/metadata/bulk/".concat(t,"/header/isAdminApproved"),value:!0},{op:"add",path:"/persistent/static/metadata/bulk/".concat(t,"/header/addAuthRequest/userIds"),value:[{rootUserId:_.userId}]},{op:"add",path:"/persistent/static/metadata/bulk/".concat(t,"/header/addAuthRequest/newAuthTypeParam/param/verificationChannels"),value:o}];i.publishToServiceIdSurvey(m.SurveyTopics,y.UpdateUser,X(_.userId,l),x.UpdateUserBio,_.cudbServiceId),i.subscribeToSurvey(m.SurveyTopics,x.UpdateUserBio,function(e){q(!1),te({}),Lt("User Approved Successfully","successs","TOP_CENTER",1e3)})},children:"Approve"})})})]}),"user"===(null===_||void 0===_?void 0:_.role)&&Object(oa.jsx)(Yn.a,{className:"action-grp mt-3 ",children:Object(oa.jsx)(Hn.a,{span:8,className:"pr-2",xs:24,sm:8,children:Object(oa.jsx)(ei.a.Item,{children:Object(oa.jsx)(Vn.a,{className:"beam-btn yellow-btn cover w-full",loading:U,onClick:te,children:"Save"})})})})]})})})};gc.a.setApiKey("AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M"),gc.a.setLanguage("en"),gc.a.setRegion("us");var mb=function(e){var t=e.socket,n=(Object(l.f)(),Object(s.b)(),Object(a.useState)(void 0)),i=Object(u.a)(n,2),c=(i[0],i[1],Object(a.useState)(!1)),o=Object(u.a)(c,2),r=(o[0],o[1],Object(a.useState)(!1)),d=Object(u.a)(r,2),v=(d[0],d[1],Object(a.useState)({form:!0,map:!1})),b=Object(u.a)(v,2),j=b[0],m={screens:j,setScreens:b[1]};return Object(oa.jsxs)(Yn.a,{className:"main-layout",children:[j.form&&Object(oa.jsx)(Hn.a,{md:j.map?12:24,xs:24,className:"form"===j.active?"active-screen":"",children:j.form&&Object(oa.jsx)(jb,{socket:t,params:m})}),j.map&&Object(oa.jsx)(Hn.a,{md:12,xs:24,className:"map"===j.active?"active-screen":"",children:Object(oa.jsx)(Nc,{socket:t,params:m})}),Object(oa.jsx)(Tc.a,{apiKey:"AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M",style:{display:"none"},options:{types:["(regions)"],componentRestrictions:{country:["us","ca","uk"]}}})]})},pb=Object(j.a)("pk_live_51MyyRYCFnkD3M6HjXbfzl6NpmEK2rc0RZzyiIhfD3A65zcqf7oEkszPqn8m8qykKN8dqxTeEURAhWhq1ACjmvytL00k1LMsAxw"),Ob=(v.a.Header,v.a.Content),fb=(v.a.Footer,function(){Object(l.f)();var e=Object(a.useState)(),t=Object(u.a)(e,2),n=(t[0],t[1],Fn()),i=Ha();i.getLocalStorageItem,i.setLocalStorageItem;return Object(a.useEffect)(function(){n.connect()},[]),Object(oa.jsx)(b.Elements,{stripe:pb,children:Object(oa.jsx)(v.a,{children:Object(oa.jsx)(Ob,{className:"site-layout",children:Object(oa.jsxs)(l.c,{children:[Object(oa.jsx)(l.a,{path:"/survey",render:function(e){return Object(oa.jsx)(Ja,Object(d.a)(Object(d.a)({},e),{},{socket:n,onClose:function(){return!1}}))}}),Object(oa.jsx)(l.a,{path:"/911",render:function(e){return Object(oa.jsx)(Uc,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/coach",render:function(e){return Object(oa.jsx)(hv,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/rx",render:function(e){return Object(oa.jsx)(zd,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/ride",render:function(e){return Object(oa.jsx)(Mr,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/ride2",render:function(e){return Object(oa.jsx)(qo,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/shuttle",render:function(e){return Object(oa.jsx)(wv,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/shuttle2",render:function(e){return Object(oa.jsx)(Mv,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/medical",render:function(e){return Object(oa.jsx)(nr,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/lighthouse",render:function(e){return Object(oa.jsx)(Ir,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/school",render:function(e){return Object(oa.jsx)(Od,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/ride-dashboard",render:function(e){return Object(oa.jsx)(po,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/call-center",render:function(e){return Object(oa.jsx)(uu,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/cpc",render:function(e){return Object(oa.jsx)(fd,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/customer-cpc",render:function(e){return Object(oa.jsx)(Nd,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/cad",render:function(e){return Object(oa.jsx)(Vv,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/customer-cad",render:function(e){return Object(oa.jsx)(eb,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/summary",render:function(e){return Object(oa.jsx)(Md,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/ride-summary",render:function(e){return Object(oa.jsx)(qd,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/dashboard",render:function(e){return Object(oa.jsx)(Fd,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/profile",render:function(e){return Object(oa.jsx)(Ar,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/signup",render:function(e){return Object(oa.jsx)(sb,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/bio",render:function(e){return Object(oa.jsx)(mb,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}}),Object(oa.jsx)(l.a,{path:"/service-form",render:function(e){return Object(oa.jsx)(gv,Object(d.a)(Object(d.a)({},e),{},{socket:n}))}})]})})})})}),hb=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function gb(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),e.waiting.postMessage({type:"SKIP_WAITING"}),alert("New update is available. Your browser will be automatically refreshed on OK"),window.location.reload(),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during services worker registration:",e)})}var xb=n(110),yb=n(394),Ib=n(535),Sb=n(1037),Nb=Object(xb.b)({routing:Ib.routerReducer,auth:At,form:Sb.a}),kb=function(e,t){return"RESET_ALL_DATA"===t.type&&(e={auth:e.auth}),Nb(e,t)},Tb=n(22),Cb=(n(995),"auth.api.access_token"),wb="auth0_user.id",Eb=new(function(){function e(){Object(cd.a)(this,e)}return Object(od.a)(e,[{key:"debug",value:function(t){e._decorateAndLog(t,"DEBUG")}},{key:"warn",value:function(t){e._decorateAndLog(t,"WARN")}},{key:"error",value:function(t){e._decorateAndLog(t,"ERROR")}}],[{key:"_decorateAndLog",value:function(e,t){var n=localStorage.getItem(wb)||null,a=Object(d.a)({logLevel:t,timeStamp:new Date,userId:n},e);JSON.stringify(a,function(e,t){return null===t?void 0:t})}}])}()),Rb=function(){return Object(od.a)(function e(t,n,a){if(Object(cd.a)(this,e),this.base=void 0,this.token=void 0,this.userId=void 0,void 0===t)throw new Error("base URL is required");this.base=t,this.token=n,this.userId=a},[{key:"getHeaders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={"Content-Type":"application/json",mode:"cors","Access-Control-Allow-Origin":"*",Origin:this.base};return e||(e=t),this.token&&(e.Authorization="Bearer "+this.token),this.userId&&(e["X-AUTH0-USER-ID"]=this.userId),e}},{key:"getUrl",value:function(e){return"".concat(this.base).concat(e)}},{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a,i,c,o,l=arguments;return Object(Bn.a)().w(function(e){for(;;)switch(e.p=e.n){case 0:return a=l.length>2&&void 0!==l[2]?l[2]:null,i={"Content-Type":"application/json",mode:"cors","Access-Control-Allow-Origin":"*",Origin:this.base},a||(a=i),this.token&&Object.assign(a,{Authorization:"Bearer ".concat(this.token)}),this.userId&&(a["X-AUTH0-USER-ID"]=this.userId),c=$.a.merge($.a.cloneDeep(n)||{},a),e.p=1,e.n=2,fetch("".concat(this.base).concat(t),c);case 2:return e.a(2,e.v);case 3:throw e.p=3,401===(o=e.v).statusCode&&Eb.error(Object(d.a)(Object(d.a)({},a),{},{message:"401 UnAuthorized"})),o;case 4:return e.a(2)}},e,this,[[1,3]])}));return function(t,n){return e.apply(this,arguments)}}())},{key:"fetchPost",value:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a,i,c;return Object(Bn.a)().w(function(e){for(;;)switch(e.p=e.n){case 0:return a={"Content-Type":"application/json"},i=$.a.merge($.a.cloneDeep(n)||{},{headers:a}),e.p=1,e.n=2,fetch("".concat(this.base).concat(t),i);case 2:return e.a(2,e.v);case 3:throw e.p=3,401===(c=e.v).statusCode&&Eb.error({message:"401 UnAuthorized"}),c;case 4:return e.a(2)}},e,this,[[1,3]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"fetchPostWithoutHeaders",value:function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t,n){var a,i;return Object(Bn.a)().w(function(e){for(;;)switch(e.p=e.n){case 0:return a=$.a.merge($.a.cloneDeep(n)||{}),e.p=1,e.n=2,fetch("".concat(this.base).concat(t),a);case 2:return e.a(2,e.v);case 3:throw e.p=3,401===(i=e.v).statusCode&&Eb.error({message:"401 UnAuthorized"}),i;case 4:return e.a(2)}},e,this,[[1,3]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(e,t){return this.fetch(e,{body:t,method:"DELETE"})}},{key:"get",value:function(e){return this.fetch(e,{})}},{key:"getWithHeaders",value:function(e,t){return this.fetch(e,{},t)}},{key:"post",value:function(e,t){return this.fetchPost(e,{body:t,method:"POST"})}},{key:"postWithHeaders",value:function(e,t,n){return this.fetch(e,{body:t,method:"POST"},n)}},{key:"postWithoutHeaders",value:function(e,t){return this.fetchPostWithoutHeaders(e,{body:t,method:"POST"})}},{key:"postJson",value:function(e,t){return this.post(e,JSON.stringify(t))}},{key:"put",value:function(e,t){return this.fetch(e,{body:t,method:"PUT"})}},{key:"putJson",value:function(e,t){return this.put(e,JSON.stringify(t))}},{key:"patch",value:function(e,t){return this.fetch(e,{body:t,method:"PATCH"})}},{key:"patchJson",value:function(e,t){return this.patch(e,JSON.stringify(t))}}])}();function Pb(){var e=localStorage.getItem("coachServiceId")||void 0;return new Rb(e?"https://".concat(e,"-api.staging.beam.live"):"".concat("https://cudb-live-api.staging.beam.live"),localStorage.getItem(Cb),localStorage.getItem(wb))}function Db(){return new Rb("".concat("https://live-react-api.staging.beam.live"))}function Ab(){return new Rb("".concat("https://media-api.staging.beam.live"),localStorage.getItem(Cb),localStorage.getItem(wb))}function Mb(){return new Rb("".concat("https://iot2-api.staging.beam.live"))}function Lb(){return new Rb("".concat("https://store-admin-api-dev.beam.live/api/v1"))}function Ub(){return new Rb("".concat("https://first-admin-api.staging.beam.live"))}function qb(){return new Rb("".concat("https://bds-api.staging.beam.live"))}function Fb(){return new Rb("".concat("https://ride-dps-api.staging.beam.live"))}function Bb(){return new Rb("".concat("https://twilio-api.staging.beam.live"))}function _b(){return new Rb("".concat("https://workflow2-api.staging.beam.live"))}function $b(){return new Rb("".concat("https://scheduler.staging.beam.live"))}function Yb(){return new Rb("".concat("https://work-admin-api.staging.beam.live"))}function Hb(){return new Rb("".concat("https://cudb-root-api.staging.beam.live"),localStorage.getItem(Cb),localStorage.getItem(wb))}function Wb(){return new Rb("https://maps.googleapis.com")}var Vb=n(29),zb=n(25),Qb=n(185),Gb=(Error,function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a;return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:if(void 0===t){e.n=4;break}return e.n=1,t.text();case 1:if(n=e.v,(a=n?JSON.parse(n):{}).status){e.n=2;break}return e.a(2,a);case 2:return e.a(2,a);case 3:e.n=5;break;case 4:throw new Error("Response is Required");case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}()),Jb=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Hb().postJson("/authenticate",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Kb=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Pb().postJson("/login",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Zb=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Pb().postJson("/logout",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Xb=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Pb().postJson("/authenticate",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),ej=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return t.email,t.password,t.phoneNumber,e.a(2,Pb().postJson("/register",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),tj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return t.email,t.password,t.phoneNumber,e.a(2,Pb().postJson("/modifyIds",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),nj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Pb().postJson("/searchInUser",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),aj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Pb().postJson("/updateUser",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),ij=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Db().postJson("/decryptPayloadTopic",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),cj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Ab().postWithoutHeaders("/createMedium",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),oj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Ab().postJson("/searchInMedium",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),lj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Lb().get("/visit/".concat(t)).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),sj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Lb().get("/staff/search/".concat(t)).then(function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,t.json())},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),rj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Ub().postWithoutHeaders("/api/v1/page-editor/createItemsUsingCSV",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),dj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,qb().postJson("/aggregateBds",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),uj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Fb().postJson("/".concat("beamdevlive","/connection/wc-plus/service/wc-plus/createRideRequest"),t.data).then(function(e){return Gb(e)}).catch(function(e){var t,n;return console.log("error",e),(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||(null===e||void 0===e?void 0:e.message)}))},e)}));return function(t){return e.apply(this,arguments)}}(),vj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Fb().postJson("/".concat("beamdevlive","/connection/wc-plus/service/wc-plus/cancelRideEvent"),t.data).then(function(e){return Gb(e)}).catch(function(e){var t,n;return console.log("error",e),(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||(null===e||void 0===e?void 0:e.message)}))},e)}));return function(t){return e.apply(this,arguments)}}(),bj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Db().postJson("/encryptPayloadTopic",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),jj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Db().postJson("/decryptPayloadTopic",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),mj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Mb().postJson("/getRange",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),pj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Bb().postJson("/".concat("beamdevlive","/wc-plus/wc-plus/service/wc-plus/twilioReservationAccepted"),t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Oj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Bb().postJson("/".concat("beamdevlive","/wc-plus/wc-plus/service/wc-plus/twilioReservationRejected"),t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),fj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Bb().postJson("/".concat("beamdevlive","/wc-plus/wc-plus/service/wc-plus/twilioTaskCompleted"),t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),hj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Bb().postJson("/".concat("beamdevlive","/wc-plus/wc-plus/service/wc-plus/getTwilioUserStatus"),t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),gj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Bb().postJson("/".concat("beamdevlive","/wc-plus/wc-plus/service/wc-plus/updateTwilioUserStatus"),t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),xj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Bb().postJson("/".concat("beamdevlive","/wc-plus/wc-plus/service/wc-plus/saveTwilioRecording"),t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),yj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Bb().postJson("/".concat("beamdevlive","/wc-plus/wc-plus/service/wc-plus/holdCall"),t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Ij=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Bb().postJson("/".concat("beamdevlive","/wc-plus/wc-plus/service/wc-plus/addParticipant"),t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Sj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Bb().postJson("/".concat("beamdevlive","/wc-plus/wc-plus/service/wc-plus/recordOutgoingCall"),t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Nj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,_b().postJson("/invokeWorkflow",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),kj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,$b().postJson("/createSchedule",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Tj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,$b().postJson("/deleteSchedule",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Cj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,$b().postJson("/updateSchedule",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),wj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Yb().postJson("/invokeWorkflow",t).then(function(e){return Gb(e)}).catch(function(e){return e.response.data.message}))},e)}));return function(t){return e.apply(this,arguments)}}(),Ej=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return e.a(2,Hb().postJson("/verifyNewIds",t.data).then(function(e){return Gb(e)}).catch(function(e){return e.response.data}))},e)}));return function(t){return e.apply(this,arguments)}}(),Rj=function(){var e=Object(_n.a)(Object(Bn.a)().m(function e(t){var n,a;return Object(Bn.a)().w(function(e){for(;;)if(0===e.n)return n=t.start,a=t.end,e.a(2,Wb().get("/maps/api/directions/json?origin=".concat(n.lat,",").concat(n.long,"&destination=").concat(a.lat,",").concat(a.long,"&departure_time=").concat(Date.now(),"&traffic_model=pessimistic&mode=driving&key=","AIzaSyDgNagv_ozKWc6IQ75Ol4cH8fxdntOaW6M")).then(function(e){return Gb(e)}).catch(function(e){return e.response.data}))},e)}));return function(t){return e.apply(this,arguments)}}(),Pj=Object(Bn.a)().m(xm),Dj=Object(Bn.a)().m(ym),Aj=Object(Bn.a)().m(Im),Mj=Object(Bn.a)().m(Sm),Lj=Object(Bn.a)().m(Nm),Uj=Object(Bn.a)().m(km),qj=Object(Bn.a)().m(Tm),Fj=Object(Bn.a)().m(Cm),Bj=Object(Bn.a)().m(wm),_j=Object(Bn.a)().m(Em),$j=Object(Bn.a)().m(Rm),Yj=Object(Bn.a)().m(Pm),Hj=Object(Bn.a)().m(Dm),Wj=Object(Bn.a)().m(Am),Vj=Object(Bn.a)().m(Mm),zj=Object(Bn.a)().m(Lm),Qj=Object(Bn.a)().m(Um),Gj=Object(Bn.a)().m(qm),Jj=Object(Bn.a)().m(Fm),Kj=Object(Bn.a)().m(Bm),Zj=Object(Bn.a)().m(_m),Xj=Object(Bn.a)().m($m),em=Object(Bn.a)().m(Ym),tm=Object(Bn.a)().m(Hm),nm=Object(Bn.a)().m(Wm),am=Object(Bn.a)().m(Vm),im=Object(Bn.a)().m(zm),cm=Object(Bn.a)().m(Qm),om=Object(Bn.a)().m(Gm),lm=Object(Bn.a)().m(Jm),sm=Object(Bn.a)().m(Km),rm=Object(Bn.a)().m(Zm),dm=Object(Bn.a)().m(Xm),um=Object(Bn.a)().m(ep),vm=Object(Bn.a)().m(tp),bm=Object(Bn.a)().m(np),jm=Object(Bn.a)().m(ap),mm=Object(Bn.a)().m(ip),pm=Object(Bn.a)().m(cp),Om=Object(Bn.a)().m(op),fm=Object(Bn.a)().m(lp),hm=Object(Bn.a)().m(sp),gm=Object(Bn.a)().m(rp);function xm(e){var t,n,a,i;return Object(Bn.a)().w(function(c){for(;;)switch(c.p=c.n){case 0:return c.p=0,c.n=1,Object(Tb.b)(cj,e.payload.form);case 1:if(t=c.v,console.log({response:t}),!t||!t.data){c.n=4;break}return n={objectId:t.data.mediumId,paths:["$"],returnPaths:["$"]},c.n=2,Object(Tb.b)(oj,n);case 2:return a=c.v,console.log("search medium request",a),c.n=3,Object(Tb.d)({type:"ADD_FILE",payload:{id:e.payload.id,media:a.data[0][0]}});case 3:c.n=5;break;case 4:Lt(t,"error","TOP_CENTER",1e3);case 5:c.n=7;break;case 6:c.p=6,i=c.v,console.log(i),Lt(i,"error","TOP_CENTER",1e3);case 7:return c.a(2)}},Pj,null,[[0,6]])}function ym(e){var t,n,a,i;return Object(Bn.a)().w(function(c){for(;;)switch(c.p=c.n){case 0:return c.p=0,c.n=1,Object(Tb.b)(lj,e.payload.visitId);case 1:return a=c.v,console.log("test here",null===a||void 0===a||null===(t=a.meta_data)||void 0===t?void 0:t.visit),c.n=2,Object(Tb.d)({type:"SET_VISIT",payload:null===a||void 0===a||null===(n=a.meta_data)||void 0===n?void 0:n.visit});case 2:c.n=4;break;case 3:c.p=3,i=c.v,console.log(i),Lt(i,"error","TOP_CENTER",1e3);case 4:return c.a(2)}},Dj,null,[[0,3]])}function Im(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.request,o.n=1,Object(Tb.b)(Rj,a);case 1:i=o.v,n&&n(i),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},Aj,null,[[0,2]])}function Sm(e){var t,n;return Object(Bn.a)().w(function(a){for(;;)switch(a.p=a.n){case 0:return a.p=0,a.n=1,Object(Tb.b)(sj,e.payload.staff);case 1:return t=a.v,console.log("staff response",t),a.n=2,Object(Tb.d)({type:"SET_STAFF",payload:t});case 2:a.n=4;break;case 3:a.p=3,n=a.v,console.log(n),Lt(n,"error","TOP_CENTER",1e3);case 4:return a.a(2)}},Mj,null,[[0,3]])}function Nm(e){var t,n,a,i,c,o,l,s;return Object(Bn.a)().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,Object(Tb.b)(ij,{data:e.payload});case 1:if(t=r.v,n={},!t.status){r.n=3;break}a=t.data.decryptedPayload,i=new URLSearchParams(a),c=i.entries(),o=Object(k.a)(c);try{for(o.s();!(l=o.n()).done;)s=l.value,n[s[0]]=s[1],console.log("".concat(s[0],": ").concat(s[1]))}catch(d){o.e(d)}finally{o.f()}return r.n=2,Object(Tb.d)({type:at,payload:n});case 2:r.n=4;break;case 3:Lt("There is something wrong with the url","error","TOP_CENTER",1e3);case 4:r.n=6;break;case 5:r.p=5,r.v,Lt("There is something wrong with the url","error","TOP_CENTER",1e3);case 6:return r.a(2)}},Lj,null,[[0,5]])}function km(e){var t,n,a,i,c,o;return Object(Bn.a)().w(function(l){for(;;)switch(l.p=l.n){case 0:return l.p=0,t=e.payload.objectType,l.n=1,Object(Tb.b)(dj,{data:e.payload});case 1:if(!(n=l.v)||!n.data){l.n=3;break}return"user"===t?a=null===(i=n.data)||void 0===i||null===(c=i.filter(function(e){return e.email||e.phone}))||void 0===c?void 0:c.map(function(e){var n,a,i,c,o,l,s,r,d,u,v,b,j,m,p,O,f,h;return console.log("user",e),{id:e.objectIds.toString(),name:(null===e||void 0===e||null===(n=e.profile)||void 0===n?void 0:n.firstName)+" "+(null===(a=e.profile)||void 0===a?void 0:a.lastName),extendedBio:null===e||void 0===e?void 0:e.extendedBio,extendedBioValue:null===e||void 0===e?void 0:e.extendedBioValue,firstName:null!==(i=null===e||void 0===e||null===(c=e.profile)||void 0===c?void 0:c.firstName)&&void 0!==i?i:"",lastName:null!==(o=null===e||void 0===e||null===(l=e.profile)||void 0===l?void 0:l.lastName)&&void 0!==o?o:"",gender:null!==(s=null===e||void 0===e||null===(r=e.profile)||void 0===r?void 0:r.gender)&&void 0!==s?s:"",dob:null!==(d=null===e||void 0===e||null===(u=e.profile)||void 0===u?void 0:u.dob)&&void 0!==d?d:"",email:e.email,phone:e.phone,beamId:"".concat(null===e||void 0===e||null===(v=e.profile)||void 0===v||null===(b=v.firstName)||void 0===b?void 0:b.toLowerCase(),".").concat(null===e||void 0===e||null===(j=e.profile)||void 0===j||null===(m=j.lastName)||void 0===m?void 0:m.toLowerCase()),objectType:t,location:null!==e&&void 0!==e&&null!==(p=e.profile)&&void 0!==p&&null!==(O=p.location)&&void 0!==O&&O.coordinates?{coordinates:[null===e||void 0===e||null===(f=e.profile)||void 0===f?void 0:f.location.coordinates.long,null===e||void 0===e||null===(h=e.profile)||void 0===h?void 0:h.location.coordinates.lat]}:void 0}}):"asset"===t&&(a=n.data.map(function(e){var n,a,i,c,o,l,s,r,d,u,v,b,j,m,p;return{id:e.objectId.toString(),name:null===e||void 0===e||null===(n=e.persistent)||void 0===n||null===(a=n.static)||void 0===a||null===(i=a.fixedAsset)||void 0===i||null===(c=i.location)||void 0===c||null===(o=c.attributes)||void 0===o?void 0:o.title,objectType:t,location:null!==e&&void 0!==e&&null!==(l=e.persistent)&&void 0!==l&&null!==(s=l.static)&&void 0!==s&&null!==(r=s.fixedAsset)&&void 0!==r&&null!==(d=r.location)&&void 0!==d&&d.coordinates?{coordinates:[null===e||void 0===e||null===(u=e.persistent)||void 0===u||null===(v=u.static)||void 0===v||null===(b=v.fixedAsset)||void 0===b?void 0:b.location.coordinates.long,null===e||void 0===e||null===(j=e.persistent)||void 0===j||null===(m=j.static)||void 0===m||null===(p=m.fixedAsset)||void 0===p?void 0:p.location.coordinates.lat]}:void 0}})),console.log("response",a),l.n=2,Object(Tb.d)({type:"ADD_MAP_".concat(e.payload.objectType.toUpperCase(),"_FILTER"),payload:a||[]});case 2:l.n=4;break;case 3:Lt(n,"error","TOP_CENTER",1e3);case 4:l.n=6;break;case 5:l.p=5,o=l.v,console.log(o),Lt(o,"error","TOP_CENTER",1e3);case 6:return l.a(2)}},Uj,null,[[0,5]])}function Tm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(dj,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},qj,null,[[0,2]])}function Cm(e){var t,n,a,i,c,o;return Object(Bn.a)().w(function(l){for(;;)switch(l.p=l.n){case 0:return l.p=0,t=e.payload,n=t.callback,a=t.requestData,l.n=1,Object(Tb.b)(uj,{data:a});case 1:(i=l.v)&&i.data?n&&n(i.data):n&&n({details:i}),l.n=3;break;case 2:l.p=2,o=l.v,c=e.payload.callback,console.log(o),c&&c({details:o});case 3:return l.a(2)}},Fj,null,[[0,2]])}function wm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(vj,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},Bj,null,[[0,2]])}function Em(e){var t;return Object(Bn.a)().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,Object(Tb.b)(rj,e.payload.form);case 1:return n.v,Lt("CSV uploaded successfully","success","TOP_CENTER",1e3),n.n=2,Object(Tb.d)({type:"ADD_CSV",payload:Date.now()});case 2:n.n=4;break;case 3:n.p=3,t=n.v,console.log(t),Lt(t,"error","TOP_CENTER",1e3);case 4:return n.a(2)}},_j,null,[[0,3]])}function Rm(e){var t,n;return Object(Bn.a)().w(function(a){for(;;)switch(a.p=a.n){case 0:return a.p=0,console.log("decrypt token"),a.n=1,Object(Tb.b)(jj,e.payload.data);case 1:if(t=a.v,console.log(t),!t||!t.data){a.n=3;break}return e.payload.callback&&e.payload.callback(t.data),a.n=2,Object(Tb.d)({type:"ADD_ENCRYPTED_TOKEN",payload:JSON.parse(t.data.decryptedPayload)});case 2:a.n=4;break;case 3:Lt(t,"error","TOP_CENTER",1e3);case 4:a.n=6;break;case 5:a.p=5,n=a.v,console.log(n),Lt(n,"error","TOP_CENTER",1e3);case 6:return a.a(2)}},$j,null,[[0,5]])}function Pm(e){var t,n;return Object(Bn.a)().w(function(a){for(;;)switch(a.p=a.n){case 0:return a.p=0,a.n=1,Object(Tb.b)(bj,e.payload.data);case 1:(t=a.v)&&t.data?e.payload.callback&&e.payload.callback(t.data):Lt(t,"error","TOP_CENTER",1e3),a.n=3;break;case 2:a.p=2,n=a.v,console.log(n),Lt(n,"error","TOP_CENTER",1e3);case 3:return a.a(2)}},Yj,null,[[0,2]])}function Dm(e){var t,n,a,i,c,o,l,s,r,v,b,j;return Object(Bn.a)().w(function(m){for(;;)switch(m.p=m.n){case 0:return console.log(e),t=e.payload,n=t.userId,a=t.deviceUdid,i=t.password,m.p=1,c={userIds:[{rootUserId:n}],deviceIds:[{udid:a}],authTypeParams:[{typeId:1,param:{password:i}}]},m.n=2,Object(Tb.d)({type:E});case 2:return m.n=3,Object(Tb.b)(Kb,{data:c});case 3:if(o=m.v,l=Object(u.a)(o.data,1),"0"!==(s=l[0]).authCode){m.n=8;break}if(!(s.authentications&&s.authentications.length>0)){m.n=5;break}return r=Object(u.a)(s.authentications,1),v=r[0],console.log(v),localStorage.setItem("TOKEN",v.connectionId),localStorage.setItem("CID",v.connectionId),localStorage.setItem("RID",s.userId),localStorage.setItem("NON_BEAMER_UDID",a),localStorage.setItem("NON_BEAMER_USER",n),localStorage.setItem("TYPE","nonBeamer"),Lt("User logged in","success","TOP_CENTER",1e3),m.n=4,Object(Tb.d)({type:w});case 4:m.n=7;break;case 5:return m.n=6,Object(Tb.d)({type:R});case 6:Lt("User not found","error","TOP_CENTER",1e3);case 7:m.n=14;break;case 8:if("1"!==s.authCode){m.n=10;break}return m.n=9,Object(Tb.d)({type:"REGISTRATION_SUCCESS",payload:{success:!0,email:e.payload.email}});case 9:m.n=14;break;case 10:if("3"!==s.authCode&&"4"!==s.authCode){m.n=12;break}return b=Object(d.a)(Object(d.a)({},e.payload.email.includes("@")?{email:e.payload.email.trim()}:{phone:e.payload.email.trim()}),{},{password:e.payload.password,reRegisteration:!0}),m.n=11,Object(Tb.b)(Am,{payload:b});case 11:m.n=14;break;case 12:return m.n=13,Object(Tb.d)({type:R});case 13:Lt("Email or password is incorrect","error","TOP_CENTER",1e3);case 14:m.n=17;break;case 15:return m.p=15,j=m.v,console.log(j),m.n=16,Object(Tb.d)({type:R});case 16:Lt(j,"error","TOP_CENTER",1e3);case 17:return m.a(2)}},Hj,null,[[1,15]])}function Am(e){var t,n,a,i,c,o;return Object(Bn.a)().w(function(l){for(;;)switch(l.p=l.n){case 0:return console.log(e),l.n=1,Object(Tb.d)({type:E});case 1:if(t=localStorage.getItem("UUID"),n={},l.p=2,e.payload.reRegisteration){l.n=7;break}return l.n=3,Object(Tb.b)(_m,e);case 3:if(!l.v.status){l.n=4;break}n={userIds:[],deviceIds:[{udid:t}],authTypeParams:[{typeId:2,param:{password:e.payload.password,useMultiOtp:!0,verificationChannels:[].concat(Object(C.a)(e.payload.email&&""!==e.payload.email?[{email:e.payload.email.trim()}]:[]),Object(C.a)(e.payload.phoneNumber&&""!==e.payload.phoneNumber?[{phone:e.payload.phoneNumber.trim()}]:[]))}}]},l.n=6;break;case 4:return l.n=5,Object(Tb.d)({type:R});case 5:return Lt("Email or phone number already in use","error","TOP_CENTER",1e3),l.a(2);case 6:l.n=8;break;case 7:n={userIds:[].concat(Object(C.a)(e.payload.email&&""!==e.payload.email?[{email:e.payload.email.trim()}]:[]),Object(C.a)(e.payload.phoneNumber&&""!==e.payload.phoneNumber?[{phone:e.payload.phoneNumber.trim()}]:[])),deviceIds:[{udid:t}],authTypeParams:[{typeId:2,param:{password:e.payload.password,useMultiOtp:!0,generatePassword:!1,verificationChannels:[].concat(Object(C.a)(e.payload.email&&""!==e.payload.email?[{email:e.payload.email.trim()}]:[]),Object(C.a)(e.payload.phoneNumber&&""!==e.payload.phoneNumber?[{phone:e.payload.phoneNumber.trim()}]:[]))}}]};case 8:return l.n=9,Object(Tb.d)({type:E});case 9:return l.n=10,Object(Tb.b)(ej,{data:n});case 10:if(a=l.v,console.log(a),i=Object(u.a)(a.data,1),c=i[0],!a||"1"!==c.authCode){l.n=12;break}return l.n=11,Object(Tb.d)({type:"REGISTRATION_SUCCESS",payload:{success:!0,email:e.payload.email||e.payload.phoneNumber,phone:e.payload.phoneNumber,payload:Object(d.a)(Object(d.a)({},e.payload),{},{userId:c.userId||localStorage.getItem("RID")})}});case 11:c.userId&&localStorage.setItem("RID",c.userId),Lt("Verification Code Sent","success","TOP_CENTER",1e3),l.n=14;break;case 12:return l.n=13,Object(Tb.d)({type:R});case 13:Lt(a,"error","TOP_CENTER",1e3);case 14:l.n=17;break;case 15:return l.p=15,o=l.v,console.log(o),l.n=16,Object(Tb.d)({type:R});case 16:Lt(o,"error","TOP_CENTER",1e3);case 17:return l.a(2)}},Wj,null,[[2,15]])}function Mm(e){var t,n,a;return Object(Bn.a)().w(function(i){for(;;)switch(i.p=i.n){case 0:return i.p=0,t=e.payload.requestData,i.n=1,Object(Tb.b)(mj,t);case 1:if(!(n=i.v)||!n.status){i.n=3;break}return i.n=2,Object(Tb.d)({type:"ADD_GPS",payload:{response:n}});case 2:i.n=4;break;case 3:Lt(n,"error","TOP_CENTER",1e3);case 4:i.n=6;break;case 5:i.p=5,a=i.v,console.log(a),Lt(a,"error","TOP_CENTER",1e3);case 6:return i.a(2)}},Vj,null,[[0,5]])}function Lm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return t=e.payload,n=t.request,a=t.callback,o.p=1,o.n=2,Object(Tb.b)(Nj,n);case 2:i=o.v,console.log("invoke",i),a&&a(i),o.n=4;break;case 3:o.p=3,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 4:return o.a(2)}},zj,null,[[1,3]])}function Um(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return t=e.payload,n=t.request,a=t.callback,o.p=1,o.n=2,Object(Tb.b)(kj,n);case 2:i=o.v,a&&a(i),o.n=4;break;case 3:o.p=3,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 4:return o.a(2)}},Qj,null,[[1,3]])}function qm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return t=e.payload,n=t.request,a=t.callback,o.p=1,o.n=2,Object(Tb.b)(Cj,n);case 2:i=o.v,a&&a(i),o.n=4;break;case 3:o.p=3,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 4:return o.a(2)}},Gj,null,[[1,3]])}function Fm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return t=e.payload,n=t.request,a=t.callback,o.p=1,o.n=2,Object(Tb.b)(Tj,n);case 2:i=o.v,a&&a(i),o.n=4;break;case 3:o.p=3,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 4:return o.a(2)}},Jj,null,[[1,3]])}function Bm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return t=e.payload,n=t.request,a=t.callback,o.p=1,o.n=2,Object(Tb.b)(wj,n);case 2:i=o.v,console.log("invoke",i),a&&a(i),o.n=4;break;case 3:o.p=3,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 4:return o.a(2)}},Kj,null,[[1,3]])}function _m(e){var t,n,a,i,c,o,l,s;return Object(Bn.a)().w(function(r){for(;;)switch(r.p=r.n){case 0:return t=e.payload,n=t.email,a=void 0===n?"":n,i=t.phoneNumber,c=void 0===i?"":i,console.log(e),r.p=1,o={userIds:[].concat(Object(C.a)(a?[{email:a}]:[]),Object(C.a)(c?[{phone:c}]:[]))},r.n=2,Object(Tb.b)(Ej,{data:o});case 2:return l=r.v,r.a(2,l);case 3:return r.p=3,s=r.v,console.log(s),r.n=4,Object(Tb.d)({type:R});case 4:Lt(s,"error","TOP_CENTER",1e3);case 5:return r.a(2)}},Zj,null,[[1,3]])}function $m(e){var t,n,a,i,c,o,l,s,r;return Object(Bn.a)().w(function(d){for(;;)switch(d.p=d.n){case 0:return t=e.payload,n=t.request,a=t.callback,i=n.email,c=n.phoneNumber,console.log(e),d.p=1,o=[],i&&o.push({email:i}),c&&o.push({phone:c}),l={userIds:o},d.n=2,Object(Tb.b)(Ej,{data:l});case 2:s=d.v,a&&a(s),d.n=4;break;case 3:d.p=3,r=d.v,console.log(r),Lt(r,"error","TOP_CENTER",1e3);case 4:return d.a(2)}},Xj,null,[[1,3]])}function Ym(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(pj,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},em,null,[[0,2]])}function Hm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(Oj,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},tm,null,[[0,2]])}function Wm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(fj,{data:a});case 1:(i=o.v)&&i.data&&n&&n(i.data),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c);case 3:return o.a(2)}},nm,null,[[0,2]])}function Vm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,console.log("get user srarys",e.payload),t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(hj,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},am,null,[[0,2]])}function zm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(gj,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},im,null,[[0,2]])}function Qm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(xj,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},cm,null,[[0,2]])}function Gm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(yj,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},om,null,[[0,2]])}function Jm(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(Ij,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},lm,null,[[0,2]])}function Km(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return o.p=0,t=e.payload,n=t.callback,a=t.requestData,o.n=1,Object(Tb.b)(Sj,{data:a});case 1:(i=o.v)&&i.data?n&&n(i.data):Lt(i,"error","TOP_CENTER",1e3),o.n=3;break;case 2:o.p=2,c=o.v,console.log(c),Lt(c,"error","TOP_CENTER",1e3);case 3:return o.a(2)}},sm,null,[[0,2]])}function Zm(e){var t,n,a,i,c,o,l;return Object(Bn.a)().w(function(s){for(;;)switch(s.p=s.n){case 0:return t={},Object.keys(e.payload).map(function(n){return t[n]=e.payload[n]}),delete t.registerRequest,delete t.silentRequest,n=[],t.email&&(n.push({op:"add",path:"/persistent/static/live/alternativeIds/email",value:t.email}),n.push({op:"add",path:"/persistent/static/metadata/notificationChannels/emails",value:[t.email]})),t.phone&&(n.push({op:"add",path:"/persistent/static/live/alternativeIds/phone",value:t.phone}),n.push({op:"add",path:"/persistent/static/metadata/notificationChannels/phones",value:[t.phone]})),t.stripeCustomerId&&n.push({op:"add",path:"/persistent/static/live/alternativeIds/stripeCustomerId",value:t.stripeCustomerId}),t.stripePaymentMethods&&n.push({op:"add",path:"/persistent/static/live/profile/stripePaymentMethods",value:t.stripePaymentMethods}),t.lastSetupIntentId&&n.push({op:"add",path:"/persistent/static/stripe/lastSetupIntentId",value:t.lastSetupIntentId}),t.beamId&&n.push({op:"add",path:"/persistent/static/live/beamIds",value:[t.beamId]}),t.firstName&&n.push({op:"add",path:"/persistent/static/live/profile/firstName",value:t.firstName}),t.lastName&&n.push({op:"add",path:"/persistent/static/live/profile/lastName",value:t.lastName}),t.dob&&n.push({op:"add",path:"/persistent/static/live/profile/dob",value:t.dob}),t.gender&&n.push({op:"add",path:"/persistent/static/live/profile/gender",value:t.gender}),t.location&&n.push({op:"add",path:"/persistent/static/live/profile/location",value:t.location}),t.profileImage&&n.push({op:"add",path:"/persistent/static/live/profile/profileImage",value:t.profileImage}),(a=localStorage.getItem("userType"))&&(i="coach"===a?localStorage.getItem("coachRoleId"):localStorage.getItem("candidateRoleId"),n.push({op:"add",path:"/persistent/static/coach/type",value:a}),n.push({op:"add",path:"/persistent/static/admin/profile/roleId",value:i}),localStorage.removeItem("userType"),localStorage.removeItem("coachRoleId"),localStorage.removeItem("candidateRoleId")),console.log("update user",t.objectId,n),s.p=1,c={header:{accessToken:"",connectionId:localStorage.getItem("CID"),rootUserId:t.objectId||localStorage.getItem("RID"),udid:""},objectId:t.objectId||localStorage.getItem("RID"),changes:n},s.n=2,Object(Tb.b)(aj,{data:c});case 2:o=s.v,console.log("update user",o),o&&o.status?e.payload.registerRequest||e.payload.silentRequest||Lt("User updated successfully","success","TOP_CENTER",1e3):Lt(o,"error","TOP_CENTER",1e3),s.n=4;break;case 3:s.p=3,l=s.v,console.log(l),Lt(l,"error","TOP_CENTER",1e3);case 4:return s.a(2)}},rm,null,[[1,3]])}function Xm(e){var t,n,a,i,c,o,l,s,r,v,b,j,m,p,O;return Object(Bn.a)().w(function(f){for(;;)switch(f.p=f.n){case 0:return t=localStorage.getItem("UUID"),n=e.payload,a=n.registerRequest,i=n.email,c=n.phone,o=n.password,l=n.verificationCodePhone,f.p=1,s={userIds:[].concat(Object(C.a)(a?[{phone:c.trim()}]:[]),Object(C.a)(e.payload.email.includes("@")?[{email:i.trim()}]:[{phone:i.trim()}])),deviceIds:[{udid:t}],authTypeParams:[].concat(Object(C.a)(a?[{typeId:2,param:{password:l}}]:[]),[{typeId:2,param:{password:o}}])},f.n=2,Object(Tb.d)({type:E});case 2:return f.n=3,Object(Tb.b)(Kb,{data:s});case 3:if(r=f.v,v=Object(u.a)(r.data,1),"0"!==(b=v[0]).authCode){f.n=8;break}if(!(b.authentications&&b.authentications.length>0)){f.n=5;break}return j=Object(u.a)(b.authentications,1),m=j[0],localStorage.setItem("TOKEN",m.connectionId),localStorage.setItem("CID",m.connectionId),localStorage.setItem("RID",b.userId),localStorage.setItem("UID",m.localUserId),localStorage.setItem("TYPE","beamer"),Lt("User logged in","success","TOP_CENTER",1e3),f.n=4,Object(Tb.d)({type:w});case 4:f.n=7;break;case 5:return f.n=6,Object(Tb.d)({type:R});case 6:Lt("User not found","error","TOP_CENTER",1e3);case 7:f.n=14;break;case 8:if("1"!==b.authCode){f.n=10;break}return f.n=9,Object(Tb.d)({type:"REGISTRATION_SUCCESS",payload:{success:!0,email:e.payload.email}});case 9:f.n=14;break;case 10:if("3"!==b.authCode&&"4"!==b.authCode){f.n=12;break}return p=Object(d.a)(Object(d.a)({},e.payload.email.includes("@")?{email:e.payload.email.trim()}:{phone:e.payload.email.trim()}),{},{password:e.payload.password,reRegisteration:!0}),f.n=11,Object(Tb.b)(Am,{payload:p});case 11:f.n=14;break;case 12:return f.n=13,Object(Tb.d)({type:R});case 13:Lt("Email or password is incorrect","error","TOP_CENTER",1e3);case 14:f.n=17;break;case 15:return f.p=15,O=f.v,console.log(O),f.n=16,Object(Tb.d)({type:R});case 16:Lt(O,"error","TOP_CENTER",1e3);case 17:return f.a(2)}},dm,null,[[1,15]])}function ep(e){var t,n,a,i;return Object(Bn.a)().w(function(c){for(;;)switch(c.p=c.n){case 0:return t=localStorage.getItem("RID"),c.p=1,n={userId:t,operations:{userIds:{add:[].concat(Object(C.a)(e.payload.email?[{email:e.payload.email.trim()}]:[]),Object(C.a)(e.payload.phone?[{phone:e.payload.phone.trim()}]:[]))}}},c.n=2,Object(Tb.d)({type:E});case 2:return c.n=3,Object(Tb.b)(tj,{data:n});case 3:if(a=c.v,!e.payload.hideToast){c.n=4;break}return c.a(2,a);case 4:if(!a.status){c.n=6;break}return Lt(a.message,"success","TOP_CENTER",1e3),e.payload.email?localStorage.setItem("email",e.payload.email):localStorage.setItem("phone",e.payload.phone),c.n=5,Object(Tb.d)({type:"IDENTIFIER_ADDED",payload:!0});case 5:c.n=8;break;case 6:return c.n=7,Object(Tb.d)({type:R});case 7:Lt(a,"error","TOP_CENTER",1e3);case 8:c.n=11;break;case 9:return c.p=9,i=c.v,console.log(i),c.n=10,Object(Tb.d)({type:R});case 10:Lt(i,"error","TOP_CENTER",1e3);case 11:return c.a(2)}},um,null,[[1,9]])}function tp(e){var t,n,a,i,c,o,l,s,r,v,b,j,m,p;return Object(Bn.a)().w(function(O){for(;;)switch(O.p=O.n){case 0:return t=localStorage.getItem("UUID"),n=e.payload,a=n.email,i=n.password,c=n.verificationCodePhone,o=n.registrationPayload,O.p=1,l={userIds:[{rootUserId:o.userId}],deviceIds:[{udid:t}],authTypeParams:[].concat(Object(C.a)(!o.reRegisteration&&c?[{typeId:2,param:{password:c}}]:[]),[{typeId:2,param:{password:i}}])},O.n=2,Object(Tb.d)({type:E});case 2:return O.n=3,Object(Tb.b)(Kb,{data:l});case 3:if(s=O.v,r=Object(u.a)(s.data,1),"0"!==(v=r[0]).authCode){O.n=15;break}if(!(v.authentications&&v.authentications.length>0)){O.n=12;break}if(b=Object(u.a)(v.authentications,1),j=b[0],console.log(j),localStorage.setItem("TOKEN",j.connectionId),localStorage.setItem("CID",j.connectionId),localStorage.setItem("RID",v.userId),localStorage.setItem("UID",j.localUserId),o.reRegisteration){O.n=10;break}return O.n=4,Object(Tb.b)(ep,{payload:{email:o.email,phone:o.phoneNumber,hideToast:!0}});case 4:if(!O.v.status){O.n=7;break}return O.n=5,Object(Tb.b)(Zm,{payload:{firstName:o.firstName,lastName:o.lastName,registerRequest:!0,email:o.email,phone:o.phoneNumber}});case 5:return O.n=6,Object(Tb.b)(Xm,{payload:{email:a,password:o.password,phoneNumber:"+92w3123322112"}});case 6:O.n=9;break;case 7:return O.n=8,Object(Tb.d)({type:R});case 8:Lt("Email or phone number already in use. Please try with some other email or phone","error","TOP_CENTER",3e3);case 9:O.n=11;break;case 10:return Lt("User logged in","success","TOP_CENTER",1e3),O.n=11,Object(Tb.d)({type:w});case 11:O.n=14;break;case 12:return O.n=13,Object(Tb.d)({type:R});case 13:Lt("User not found","error","TOP_CENTER",1e3);case 14:O.n=21;break;case 15:if("1"!==v.authCode){O.n=17;break}return O.n=16,Object(Tb.d)({type:"REGISTRATION_SUCCESS",payload:{success:!0,email:e.payload.email,registrationPayload:{userId:localStorage.getItem("RID")}}});case 16:O.n=21;break;case 17:if("3"!==v.authCode&&"4"!==v.authCode){O.n=19;break}return m=Object(d.a)(Object(d.a)({},e.payload.email.includes("@")?{email:e.payload.email.trim()}:{phone:e.payload.email.trim()}),{},{password:e.payload.password,reRegisteration:!0}),console.log(m),O.n=18,Object(Tb.b)(Am,{payload:m});case 18:O.n=21;break;case 19:return O.n=20,Object(Tb.d)({type:R});case 20:Lt("Email or password is incorrect","error","TOP_CENTER",1e3);case 21:O.n=24;break;case 22:return O.p=22,p=O.v,console.log(p),O.n=23,Object(Tb.d)({type:R});case 23:Lt(p,"error","TOP_CENTER",1e3);case 24:return O.a(2)}},vm,null,[[1,22]])}function np(e){var t,n,a,i,c,o,l;return Object(Bn.a)().w(function(s){for(;;)switch(s.p=s.n){case 0:return t=localStorage.getItem("UUID"),n=localStorage.getItem("NON_BEAMER_USER"),s.p=1,a={userIds:[{rootUserId:n}],deviceIds:[{udid:t}],authTypeParams:[{typeId:2,param:{password:e.payload.password}}]},s.n=2,Object(Tb.d)({type:E});case 2:return s.n=3,Object(Tb.b)(Xb,{data:a});case 3:if(i=s.v,c=Object(u.a)(i.data,1),"0"!==(o=c[0]).authCode&&"1"!==o.authCode){s.n=5;break}return s.n=4,Object(Tb.d)({type:"AUTHENTICATION_SUCCESSFULL"});case 4:s.n=7;break;case 5:return s.n=6,Object(Tb.d)({type:"AUTHENTICATION_FAILED"});case 6:Lt("Verification Code incorrect","error","TOP_CENTER",1e3);case 7:return s.a(2,i);case 8:return s.p=8,l=s.v,console.log(l),s.n=9,Object(Tb.d)({type:"AUTHENTICATION_FAILED"});case 9:Lt("Verification Code incorrect","error","TOP_CENTER",1e3);case 10:return s.a(2)}},bm,null,[[1,8]])}function ap(e){var t,n,a,i,c,o,l,s;return Object(Bn.a)().w(function(r){for(;;)switch(r.p=r.n){case 0:if(t=e.payload,n=t.email,a=t.phone,i=t.password,c=t.verificationCodePhone,o=t.registrationPayload,r.p=1,localStorage.getItem("emailVerified")===localStorage.getItem("RID")){r.n=4;break}return r.n=2,Object(Tb.b)(np,{payload:{password:i}});case 2:if("2"!==r.v.data[0].authCode){r.n=3;break}return r.a(2);case 3:localStorage.setItem("emailVerified",localStorage.getItem("RID"));case 4:if(localStorage.getItem("phoneVerified")===localStorage.getItem("RID")){r.n=7;break}return r.n=5,Object(Tb.b)(np,{payload:{password:c}});case 5:if("2"!==r.v.data[0].authCode){r.n=6;break}return r.a(2);case 6:localStorage.setItem("phoneVerified",localStorage.getItem("RID"));case 7:return r.n=8,Object(Tb.d)({type:E});case 8:return r.n=9,Object(Tb.b)(ep,{payload:{email:n,phone:a,hideToast:!0}});case 9:if(l=r.v,console.log("nodify ids response",l),!l.status){r.n=10;break}return r.n=10,Object(Tb.b)(Zm,{payload:{firstName:o.firstName,lastName:o.lastName,registerRequest:!0,email:o.email,phone:o.phoneNumber}});case 10:return Lt("Registration completed successfully","success","TOP_CENTER",1e3),r.n=11,Object(Tb.d)({type:w});case 11:r.n=14;break;case 12:return r.p=12,s=r.v,console.log(s),r.n=13,Object(Tb.d)({type:R});case 13:Lt(s,"error","TOP_CENTER",1e3);case 14:return r.a(2)}},jm,null,[[1,12]])}function ip(e){var t,n;return Object(Bn.a)().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=localStorage.getItem("CID"),e.p=1,n={connectionId:t},e.n=2,Object(Tb.b)(Zb,{data:n});case 2:return e.n=3,Object(Tb.d)({type:"logoutUser"});case 3:e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},mm,null,[[1,4]])}function cp(e){var t,n,a,i,c,o,l,s,r,u,v,b,j,m,p,O,f,h,g,x,y,I;return Object(Bn.a)().w(function(e){for(;;)switch(e.p=e.n){case 0:return t=localStorage.getItem("RID"),e.p=1,n={objectId:t,paths:["$"],returnPaths:["$"],resultType:"value"},e.n=2,Object(Tb.b)(nj,{data:n});case 2:if(!(a=e.v)||!a.data){e.n=4;break}return(y=Object(d.a)(Object(d.a)(Object(d.a)({},null===(i=a.data[0][0])||void 0===i||null===(c=i.persistent)||void 0===c||null===(o=c.static)||void 0===o||null===(l=o.live)||void 0===l?void 0:l.alternativeIds),null===(s=a.data[0][0])||void 0===s||null===(r=s.persistent)||void 0===r||null===(u=r.static)||void 0===u||null===(v=u.live)||void 0===v?void 0:v.profile),{},{stripe:null===(b=a.data[0][0])||void 0===b||null===(j=b.persistent)||void 0===j||null===(m=j.static)||void 0===m?void 0:m.stripe},null!==(p=a.data[0][0])&&void 0!==p&&null!==(O=p.persistent)&&void 0!==O&&null!==(f=O.static)&&void 0!==f&&f.coach?{coach:null===(h=a.data[0][0])||void 0===h||null===(g=h.persistent)||void 0===g||null===(x=g.static)||void 0===x?void 0:x.coach}:{}))&&y.email&&localStorage.setItem("email",y.email),y&&y.phone&&localStorage.setItem("phone",y.phone),e.n=3,Object(Tb.d)({type:P,payload:y});case 3:e.n=5;break;case 4:Lt(a,"error","TOP_CENTER",1e3);case 5:e.n=7;break;case 6:e.p=6,I=e.v,console.log(I),Lt(I,"error","TOP_CENTER",1e3);case 7:return e.a(2)}},pm,null,[[1,6]])}function op(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return t=e.payload.udid,o.p=1,n={userIds:[].concat(Object(C.a)(e.payload.email&&""!==e.payload.email?[{email:e.payload.email.trim()}]:[]),Object(C.a)(e.payload.phoneNumber&&""!==e.payload.phoneNumber?[{phone:e.payload.phoneNumber.trim()}]:[])),deviceIds:[{udid:t}],authTypeParams:[{typeId:e.payload.typeId||9,param:{password:e.payload.password}}]},o.n=2,Object(Tb.d)({type:E});case 2:if(!e.payload.root){o.n=4;break}return o.n=3,Object(Tb.b)(Jb,{data:n});case 3:a=o.v,o.n=6;break;case 4:return o.n=5,Object(Tb.b)(Xb,{data:n});case 5:a=o.v;case 6:if(console.log(a),i=Object(u.a)(a.data,1),"0"!==i[0].authCode){o.n=8;break}return o.n=7,Object(Tb.d)({type:"AUTHENTICATION_SUCCESSFULL"});case 7:Lt("User authenticated successfully","success","TOP_CENTER",1e3),o.n=10;break;case 8:return o.n=9,Object(Tb.d)({type:"AUTHENTICATION_FAILED"});case 9:Lt("Verification Code incorrect","error","TOP_CENTER",1e3);case 10:o.n=13;break;case 11:return o.p=11,c=o.v,console.log(c),o.n=12,Object(Tb.d)({type:"AUTHENTICATION_FAILED"});case 12:Lt("Verification Code incorrect","error","TOP_CENTER",1e3);case 13:return o.a(2)}},Om,null,[[1,11]])}function lp(e){var t,n,a,i,c;return Object(Bn.a)().w(function(o){for(;;)switch(o.p=o.n){case 0:return t={},n=e.payload.uuid,e.payload.pinVerification?(a=[],a=e.payload.newIdentifier?[e.payload.newIdentifier.includes("@")?{email:e.payload.newIdentifier.trim()}:{phone:e.payload.newIdentifier.trim()}]:[e.payload.email.includes("@")?{email:e.payload.email.trim()}:{phone:e.payload.email.trim()}],t={userIds:[e.payload.email.includes("@")?{email:e.payload.email.trim()}:{phone:e.payload.email.trim()}],deviceIds:[{udid:n}],authTypeParams:[{typeId:9,param:{verificationChannels:a}}]}):t={userIds:[e.payload.email.includes("@")?{email:e.payload.email.trim()}:{phone:e.payload.email.trim()}],deviceIds:[{udid:n}],authTypeParams:[{typeId:9,param:{verificationChannels:[e.payload.email.includes("@")?{email:e.payload.email.trim()}:{phone:e.payload.email.trim()}]}}]},o.p=1,o.n=2,Object(Tb.d)({type:E});case 2:return o.n=3,Object(Tb.b)(Xb,{data:t});case 3:if(!(i=o.v)||!i.status){o.n=5;break}if(!e.payload.pinVerification){o.n=4;break}return o.n=4,Object(Tb.d)({type:ut,payload:e.payload});case 4:o.n=8;break;case 5:return o.n=6,Object(Tb.d)({type:R});case 6:if(!e.payload.pinVerification){o.n=7;break}return Lt("Verification Failed","error","TOP_CENTER",1e3),o.n=7,Object(Tb.d)({type:"VERIFICATION_FAILED",payload:e.payload});case 7:Lt(i,"error","TOP_CENTER",1e3);case 8:o.n=12;break;case 9:return o.p=9,c=o.v,o.n=10,Object(Tb.d)({type:R});case 10:if(!e.payload.pinVerification){o.n=11;break}return o.n=11,Object(Tb.d)({type:"VERIFICATION_FAILED",payload:e.payload});case 11:Lt(c,"error","TOP_CENTER",1e3);case 12:return o.a(2)}},fm,null,[[1,9]])}function sp(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Object(Tb.e)(ye,xm);case 1:return e.n=2,Object(Tb.e)(Ie,Em);case 2:return e.n=3,Object(Tb.e)(Ze,ym);case 3:return e.n=4,Object(Tb.e)(pt,Im);case 4:return e.n=5,Object(Tb.e)(Xe,Sm);case 5:return e.n=6,Object(Tb.e)(at,Nm);case 6:return e.n=7,Object(Tb.e)(it,km);case 7:return e.n=8,Object(Tb.e)(et,Tm);case 8:return e.n=9,Object(Tb.e)(tt,Tm);case 9:return e.n=10,Object(Tb.e)(Ot,Cm);case 10:return e.n=11,Object(Tb.e)(ft,wm);case 11:return e.n=12,Object(Tb.e)(ht,Ym);case 12:return e.n=13,Object(Tb.e)(gt,Hm);case 13:return e.n=14,Object(Tb.e)(xt,Wm);case 14:return e.n=15,Object(Tb.e)(yt,Vm);case 15:return e.n=16,Object(Tb.e)(It,zm);case 16:return e.n=17,Object(Tb.e)(St,Qm);case 17:return e.n=18,Object(Tb.e)(Nt,Gm);case 18:return e.n=19,Object(Tb.e)(kt,Jm);case 19:return e.n=20,Object(Tb.e)(Tt,Km);case 20:return e.n=21,Object(Tb.e)(lt,Lm);case 21:return e.n=22,Object(Tb.e)(st,Bm);case 22:return e.n=23,Object(Tb.e)(bt,Um);case 23:return e.n=24,Object(Tb.e)(mt,qm);case 24:return e.n=25,Object(Tb.e)(jt,Fm);case 25:return e.n=26,Object(Tb.e)(rt,$m);case 26:return e.n=27,Object(Tb.e)(dt,Zm);case 27:return e.n=28,Object(Tb.e)(vt,cp);case 28:return e.n=29,Object(Tb.e)(nt,Tm);case 29:return e.n=30,Object(Tb.e)(ct,Rm);case 30:return e.n=31,Object(Tb.e)(be,Dm);case 31:return e.n=32,Object(Tb.e)(ve,Xm);case 32:return e.n=33,Object(Tb.e)(ot,Mm);case 33:return e.n=34,Object(Tb.e)(le,tp);case 34:return e.n=35,Object(Tb.e)(re,ep);case 35:return e.n=36,Object(Tb.e)(se,ap);case 36:return e.n=37,Object(Tb.e)(ue,ip);case 37:return e.n=38,Object(Tb.e)(ae,Am);case 38:return e.n=39,Object(Tb.e)(ce,Pm);case 39:return e.n=40,Object(Tb.e)(ie,op);case 40:return e.n=41,Object(Tb.e)(oe,lp);case 41:return e.a(2)}},hm)}function rp(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Object(Tb.a)([sp()]);case 1:return e.a(2)}},gm)}var dp=n(538),up=Object(Bn.a)().m(bp);function vp(e){var t=e.payload;return Object(Bn.a)().m(function e(){var n,a,i,c;return Object(Bn.a)().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,n=t.message,a=n.event,i=n.eventState,console.log(i),console.log(a),e.n=2;break;case 1:return e.p=1,c=e.v,e.n=2,dp.captureException(c);case 2:return e.a(2)}},e,null,[[0,1]])})()}function bp(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Object(Tb.e)(Object(F.a)("ON_MESSAGE_FROM_EVENT_LISTENER"),vp);case 1:return e.a(2)}},up)}var jp=Object(Bn.a)().m(mp);function mp(){return Object(Bn.a)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,Object(Tb.a)([Object(Tb.c)(rp),Object(Tb.c)(bp)]);case 1:return e.a(2)}},jp)}Object(yb.a)(),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||xb.c;n(1001),n(1002);var pp=n(127),Op=Object(pp.a)(),fp={user:null},hp=n(1041);Array.prototype.forEach||(Array.prototype.forEach=function(e){var t,n;if(null==this)throw new TypeError("this is null or not defined");var a=Object(this),i=a.length>>>0;if("function"!==typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(t=arguments[1]),n=0;n<i;){var c;n in a&&(c=a[n],e.call(t,c,n,a)),n++}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!==typeof e)throw new TypeError("predicate must be a function");for(var a=arguments[1],i=0;i<n;){var c=t[i];if(e.call(a,c,i,t))return c;i++}}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),a=n.length>>>0;if(0===a)return!1;var i=0|t,c=Math.max(i>=0?i:a-Math.abs(i),0);function o(e,t){return e===t||"number"===typeof e&&"number"===typeof t&&isNaN(e)&&isNaN(t)}for(;c<a;){if(o(n[c],e))return!0;c++}return!1}});var gp,xp=function(e){var t,n=Object(yb.a)(),a=Object(xb.c)(Object(xb.a)(n));return t=Object(xb.d)(kb,e,a),n.run(mp),t}(fp),yp=function(e,t){return xp.dispatch({type:e,payload:t})};r.a.configure(),o.a.render(Object(oa.jsx)(s.a,{store:xp,children:Object(oa.jsx)(l.b,{history:Op,children:Object(oa.jsx)(ud.a,{children:Object(oa.jsx)(hp.a,{children:Object(oa.jsx)(a.Suspense,{fallback:"Loading...",children:Object(oa.jsx)(fb,{})})})})})}),document.getElementById("root")),"serviceWorker"in navigator&&window.addEventListener("load",function(){var e="".concat(window.location.origin,"/service-worker.js");hb?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):gb(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e,gp),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a services worker. To learn more, visit https://bit.ly/CRA-PWA")})):gb(e,gp)})},129:function(e,t,n){},140:function(e,t,n){},212:function(e,t,n){},244:function(e,t,n){},366:function(e,t,n){},381:function(e,t,n){},425:function(e,t){},502:function(e,t,n){},511:function(e,t,n){},580:function(e,t){},582:function(e,t){},620:function(e,t){},648:function(e,t){},655:function(e,t,n){},955:function(e,t,n){},957:function(e,t,n){},958:function(e,t,n){},972:function(e,t,n){},973:function(e,t,n){},977:function(e,t,n){},978:function(e,t,n){},981:function(e,t,n){},982:function(e,t,n){},983:function(e,t,n){},984:function(e,t,n){},985:function(e,t,n){},986:function(e,t,n){},987:function(e,t,n){},988:function(e,t,n){},989:function(e,t,n){},990:function(e,t,n){},991:function(e,t,n){},992:function(e,t,n){}},[[1003,1,2]]]);
//# sourceMappingURL=main.12418911.chunk.js.map